<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Keep Moving â€¢ Posts by &#34;ai&#34; category</title>
        <link>http://qianqiu-cell.github.io</link>
        <description>ğŸŒ¸å­¦ä¹ ç¬”è®°ğŸŒ¸</description>
        <language>zh-CN</language>
        <pubDate>Mon, 03 Feb 2025 00:00:00 +0800</pubDate>
        <lastBuildDate>Mon, 03 Feb 2025 00:00:00 +0800</lastBuildDate>
        <category>AI</category>
        <category>ç”µè„‘ç¡¬ä»¶çŸ¥è¯†</category>
        <category>æ˜¾ç¤ºå™¨</category>
        <category>åšå®¢æ­å»º</category>
        <category>linux</category>
        <category>æ§åˆ¶å·¥ç¨‹</category>
        <category>æ•°å­¦åŸºç¡€</category>
        <category>latexæŠ€å·§</category>
        <category>è®ºæ–‡ç¼–è¾‘</category>
        <category>åŒºé—´ä¸ç¡®å®šæ€§</category>
        <category>officeæŠ€å·§</category>
        <category>æœ€ä¼˜åŒ–</category>
        <category>å¤šç›®æ ‡æœ€ä¼˜åŒ–</category>
        <category>å•ç›®æ ‡æœ€ä¼˜åŒ–</category>
        <category>ç§‘å­¦ç ”ç©¶</category>
        <category>ç¡¬ä»¶å¼€å‘</category>
        <category>leetcode</category>
        <category>ç¼–ç¨‹æŠ€å·§</category>
        <category>C++</category>
        <category>matlab</category>
        <category>python</category>
        <category>ç³»ç»Ÿè®¾è®¡</category>
        <category>Qt</category>
        <category>ç•Œé¢å¼€å‘</category>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2025/02/03/AI/LLM_base/</guid>
            <title>å¤§æ¨¡å‹åŸºç¡€è¯¾ç¨‹ï¼ˆæµ™æ±Ÿå¤§å­¦ï¼‰</title>
            <link>http://qianqiu-cell.github.io/2025/02/03/AI/LLM_base/</link>
            <category>AI</category>
            <pubDate>Mon, 03 Feb 2025 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVBCNlhZRkVUMj9zcG1faWRfZnJvbT0zMzMuNzg4LnZpZGVvcG9kLnNlY3Rpb25zJmFtcDt2ZF9zb3VyY2U9ZTAxMTcyZWEyOTJjMWM2MDViMzQ2MTAxZDcwMDZjNjE=&#34;&gt;https://www.bilibili.com/video/BV1PB6XYFET2?spm_id_from=333.788.videopod.sections&amp;amp;vd_source=e01172ea292c1c605b346101d7006c61&lt;/span&gt;ã€&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1pKVS1MTE1zL0ZvdW5kYXRpb25zLW9mLUxMTXMvdHJlZS9tYWlu&#34;&gt;https://github.com/ZJU-LLMs/Foundations-of-LLMs/tree/main&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸€-è¯­è¨€æ¨¡å‹åŸºç¡€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-è¯­è¨€æ¨¡å‹åŸºç¡€&#34;&gt;#&lt;/a&gt; ä¸€ã€è¯­è¨€æ¨¡å‹åŸºç¡€&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒè¯­è¨€æ˜¯æ¦‚ç‡çš„ï¼Œå¹¶ä¸”è¯­è¨€çš„æ¦‚ç‡æ€§ä¸è®¤çŸ¥çš„æ¦‚ç‡æ€§ä¹Ÿå­˜åœ¨ç€å¯†ä¸å¯åˆ†çš„å…³ç³»ã€‚&lt;strong&gt;è¯­è¨€æ¨¡å‹ï¼ˆLanguageModels, LMsï¼‰æ—¨åœ¨å‡†ç¡®é¢„æµ‹è¯­è¨€ç¬¦å·çš„æ¦‚ç‡&lt;/strong&gt;ã€‚ä» ELIZA åˆ° GPT-4ï¼Œè¯­è¨€æ¨¡å‹ç»å†äº†&lt;strong&gt;ä»è§„åˆ™æ¨¡å‹åˆ°ç»Ÿè®¡æ¨¡å‹ï¼Œå†åˆ°ç¥ç»ç½‘ç»œæ¨¡å‹çš„å‘å±•å†ç¨‹&lt;/strong&gt;ï¼Œé€æ­¥ä»å‘†æ¿çš„æœºæ¢°å¼é—®ç­”ç¨‹åºæˆé•¿ä¸ºå…·æœ‰å¼ºå¤§æ³›åŒ–èƒ½åŠ›çš„å¤šä»»åŠ¡æ™ºèƒ½æ¨¡å‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;11-åŸºäºç»Ÿè®¡æ–¹æ³•çš„è¯­è¨€æ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#11-åŸºäºç»Ÿè®¡æ–¹æ³•çš„è¯­è¨€æ¨¡å‹&#34;&gt;#&lt;/a&gt; 1.1 åŸºäºç»Ÿè®¡æ–¹æ³•çš„è¯­è¨€æ¨¡å‹&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;åŸºäºç»Ÿè®¡çš„è¯­è¨€æ¨¡å‹é€šè¿‡ç›´æ¥ç»Ÿè®¡è¯­è¨€ç¬¦å·åœ¨è¯­æ–™åº“ä¸­å‡ºç°çš„é¢‘ç‡æ¥é¢„æµ‹è¯­è¨€ç¬¦å·çš„æ¦‚ç‡&lt;/strong&gt;ã€‚å…¶ä¸­ï¼Œ&lt;strong&gt;n-grams&lt;/strong&gt; æ˜¯æœ€å…·ä»£è¡¨æ€§çš„ç»Ÿè®¡è¯­è¨€æ¨¡å‹ã€‚&lt;strong&gt;n-grams è¯­è¨€æ¨¡å‹åŸºäºé©¬å°”å¯å¤«å‡è®¾å’Œç¦»æ•£å˜é‡çš„æå¤§ä¼¼ç„¶ä¼°è®¡ç»™å‡ºè¯­è¨€ç¬¦å·çš„æ¦‚ç‡ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;111-n-grams-è¯­è¨€æ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#111-n-grams-è¯­è¨€æ¨¡å‹&#34;&gt;#&lt;/a&gt; 1.1.1 n-grams è¯­è¨€æ¨¡å‹&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒn-grams è¯­è¨€æ¨¡å‹ä¸­çš„ n-gram æŒ‡çš„æ˜¯é•¿åº¦ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; çš„è¯åºåˆ—ã€‚n-grams è¯­è¨€æ¨¡å‹é€šè¿‡ä¾æ¬¡ç»Ÿè®¡æ–‡æœ¬ä¸­çš„ n-gram åŠå…¶å¯¹åº”çš„ (n-1)-gram åœ¨è¯­æ–™åº“ä¸­å‡ºç°çš„ç›¸å¯¹é¢‘ç‡æ¥è®¡ç®—æ–‡æœ¬&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\omega_{1:N}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å‡ºç°çš„æ¦‚ç‡ã€‚è®¡ç®—å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;âˆ&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;P_{n-grams}(w_{1:N})=\prod_{i=n}^N\frac{C(w_{1+i-n:i})}{C(w_{1+i-n:i-1})}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.036108em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.25833100000000003em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.106005em;vertical-align:-1.277669em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8283360000000002em;&#34;&gt;&lt;span style=&#34;top:-1.872331em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.050005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;âˆ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.3000050000000005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.277669em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.936em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé€šä¿—å¯ç†è§£ä¸ºå‰ n ä¸ªè¯å‡ºç°çš„æƒ…å†µä¸‹ï¼Œå°†åä¸€ä¸ªè¯åœ¨è¯­æ–™åº“ä¸­å‡ºç°çš„æ¦‚ç‡ä½œä¸ºé¢„æµ‹æ¦‚ç‡ã€‚è¯¦ç»†çš„è§£é‡Šå¯å‚è€ƒ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1pKVS1MTE1zL0ZvdW5kYXRpb25zLW9mLUxMTXMvdHJlZS9tYWlu&#34;&gt; github&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ºå˜é‡ï¼Œå½“&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n=1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ—¶ï¼Œç§°ä¹‹ä¸º unigramï¼Œå…¶ä¸è€ƒè™‘æ–‡æœ¬çš„ä¸Šä¸‹æ–‡å…³ç³»ã€‚å½“&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n=2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ—¶ï¼Œç§°ä¹‹ä¸º bigramsï¼Œå…¶å¯¹å‰ä¸€ä¸ªè¯è¿›è¡Œè€ƒè™‘ã€‚å½“&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n=3&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ—¶ï¼Œç§°ä¹‹ä¸º trigramsï¼Œå…¶å¯¹å‰ä¸¤ä¸ªè¯è¿›è¡Œè€ƒè™‘ã€‚å½“&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n=4&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ—¶ï¼Œç§°ä¹‹ä¸º 4-gramsï¼Œå…¶å¯¹å‰ä¸‰ä¸ªè¯è¿›è¡Œè€ƒè™‘â€¦&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒn-grams å…·å¤‡å¯¹æœªçŸ¥æ–‡æœ¬çš„æ³›åŒ–èƒ½åŠ›ã€‚è¿™ä¹Ÿæ˜¯å…¶ç›¸è¾ƒäºä¼ ç»ŸåŸºäºè§„åˆ™çš„æ–¹æ³•çš„ä¼˜åŠ¿ã€‚ä½†æ˜¯ï¼Œè¿™ç§æ³›åŒ–èƒ½åŠ›ä¼šéšç€ n çš„å¢å¤§è€Œé€æ¸å‡å¼±ã€‚å› æ­¤ï¼Œåœ¨ n-grams è¯­è¨€æ¨¡å‹ä¸­ï¼Œn ä»£è¡¨äº†æ‹Ÿåˆè¯­æ–™åº“çš„èƒ½åŠ›ä¸å¯¹æœªçŸ¥æ–‡æœ¬çš„æ³›åŒ–èƒ½åŠ›ä¹‹é—´çš„æƒè¡¡ã€‚&lt;strong&gt;å½“ n è¿‡å¤§æ—¶ï¼Œè¯­æ–™åº“ä¸­éš¾ä»¥æ‰¾åˆ°ä¸ n-gram ä¸€æ¨¡ä¸€æ ·çš„è¯åºåˆ—ï¼Œå¯èƒ½å‡ºç°å¤§é‡ â€œé›¶æ¦‚ç‡â€ ç°è±¡ï¼›åœ¨ n è¿‡å°æ—¶ï¼Œn-gram éš¾ä»¥æ‰¿è½½è¶³å¤Ÿçš„è¯­è¨€ä¿¡æ¯ï¼Œä¸è¶³ä»¥ååº”è¯­æ–™åº“çš„ç‰¹æ€§&lt;/strong&gt;ã€‚å› æ­¤ï¼Œåœ¨ n-grams è¯­è¨€æ¨¡å‹ä¸­ï¼Œn çš„å€¼æ˜¯å½±å“æ€§èƒ½çš„å…³é”®å› ç´ ã€‚&lt;/p&gt;
&lt;h3 id=&#34;112-n-grams-çš„ç»Ÿè®¡å­¦åŸç†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#112-n-grams-çš„ç»Ÿè®¡å­¦åŸç†&#34;&gt;#&lt;/a&gt; 1.1.2 n-grams çš„ç»Ÿè®¡å­¦åŸç†&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒn-grams è¯­è¨€æ¨¡å‹æ˜¯åœ¨&lt;strong&gt; n é˜¶é©¬å°”å¯å¤«å‡è®¾&lt;/strong&gt;ä¸‹ï¼Œå¯¹è¯­æ–™åº“ä¸­å‡ºç°çš„é•¿åº¦ä¸º n çš„è¯åºåˆ—å‡ºç°æ¦‚ç‡çš„&lt;strong&gt;æå¤§ä¼¼ç„¶ä¼°è®¡&lt;/strong&gt;ã€‚ è¯¦ç»†è¯æ˜è§&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1pKVS1MTE1zL0ZvdW5kYXRpb25zLW9mLUxMTXMvdHJlZS9tYWlu&#34;&gt; github&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;12-åŸºäºrnnçš„è¯­è¨€æ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#12-åŸºäºrnnçš„è¯­è¨€æ¨¡å‹&#34;&gt;#&lt;/a&gt; 1.2 åŸºäº RNN çš„è¯­è¨€æ¨¡å‹&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒn-grams è¯­è¨€æ¨¡å‹å¯¹æœªçŸ¥åºåˆ—æœ‰ä¸€å®šçš„æ³›åŒ–æ€§ï¼Œä½†ä¹Ÿå®¹æ˜“é™·å…¥ â€œé›¶æ¦‚ç‡â€ çš„å›°å¢ƒã€‚åŸºäºç¥ç»ç½‘ç»œçš„è¯­è¨€æ¨¡å‹ä¸å†é€šè¿‡æ˜¾æ€§çš„è®¡ç®—å…¬å¼å¯¹è¯­è¨€ç¬¦å·çš„æ¦‚ç‡è¿›è¡Œè®¡ç®—ï¼Œè€Œæ˜¯åˆ©ç”¨è¯­æ–™åº“ä¸­çš„æ ·æœ¬å¯¹ç¥ç»ç½‘ç»œæ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRecurrentNeuralNetwork,RNNï¼‰å¯ä»¥åŸºäºå†å²è§„å¾‹ï¼Œå¯¹æœªæ¥è¿›è¡Œé¢„æµ‹ã€‚&lt;strong&gt;åŸºäº RNN çš„è¯­è¨€æ¨¡å‹ï¼Œä»¥è¯åºåˆ—ä½œä¸ºè¾“å…¥ï¼ŒåŸºäºè¢«å¾ªç¯ç¼–ç çš„ä¸Šæ–‡å’Œå½“å‰è¯æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªè¯å‡ºç°çš„æ¦‚ç‡ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;121-å¾ªç¯ç¥ç»ç½‘ç»œrnn&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#121-å¾ªç¯ç¥ç»ç½‘ç»œrnn&#34;&gt;#&lt;/a&gt; 1.2.1 å¾ªç¯ç¥ç»ç½‘ç»œ RNN&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒRNN å¯ä»¥å°†å†å²çŠ¶æ€ä»¥éšå˜é‡çš„å½¢å¼å¾ªç¯å åŠ åˆ°å½“å‰çŠ¶æ€ä¸Šï¼Œå¯¹å†å²ä¿¡æ¯è¿›è¡Œè€ƒè™‘ã€‚ä½†æ˜¯è¿™æ ·çš„ç¯è·¯ç»“æ„ç»™ RNN çš„è®­ç»ƒå¸¦æ¥äº†æŒ‘æˆ˜ã€‚åœ¨è®­ç»ƒ RNN æ—¶ï¼Œæ¶‰åŠå¤§é‡çš„çŸ©é˜µè”ä¹˜æ“ä½œï¼Œå®¹æ˜“å¼•å‘æ¢¯åº¦è¡°å‡æˆ–æ¢¯åº¦çˆ†ç‚¸é—®é¢˜ã€‚ä¸ºäº†è§£å†³æ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸é—®é¢˜ï¼ŒGRU å’Œ LSTM å¼•å…¥é—¨æ§ç»“æ„ï¼Œå–å¾—äº†è‰¯å¥½æ•ˆæœï¼Œæˆä¸ºä¸»æµçš„ RNN ç½‘ç»œæ¶æ„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;122-åŸºäºrnnçš„è¯­è¨€æ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#122-åŸºäºrnnçš„è¯­è¨€æ¨¡å‹&#34;&gt;#&lt;/a&gt; 1.2.2 åŸºäº RNN çš„è¯­è¨€æ¨¡å‹&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹è¯åºåˆ—&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;.&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;.&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;.&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&#34;true&#34;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\left \{ \omega_1,\omega_2,\omega_3,...,\omega_N \right \}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼ŒåŸºäº RNN çš„è¯­è¨€æ¨¡å‹æ¯æ¬¡æ ¹æ®å½“å‰è¯&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\omega_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œå¾ªç¯è¾“å…¥çš„éšè—çŠ¶æ€&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mtext&gt;âˆ’&lt;/mtext&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;h_{iâˆ’1}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.902771em;vertical-align:-0.208331em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œæ¥é¢„æµ‹ä¸‹ä¸€ä¸ªè¯&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\omega_{i+1}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.638891em;vertical-align:-0.208331em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å‡ºç°çš„æ¦‚ç‡ï¼Œå³&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;âˆ&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;P(w_{1:N})=\prod_{i=1}^{N-1}P(w_{i+1}|w_i,h_{i-1})
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.1060050000000006em;vertical-align:-1.277669em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8283360000000004em;&#34;&gt;&lt;span style=&#34;top:-1.872331em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.050005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;âˆ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.300005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.277669em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;P(w_{i+1}|w_{1:i})=P(w_{i+1}|w_i,h_{i-1})
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ â€œ&lt;strong&gt;è‡ªå›å½’&lt;/strong&gt;â€ çš„èŒƒå¼ä¸‹å®Œæˆæ–‡æœ¬ç”Ÿæˆä»»åŠ¡ï¼Œç¬¬ä¸€è½®ï¼Œé¦–å…ˆå°†ç¬¬ä¸€ä¸ªè¯è¾“å…¥ç»™ RNN è¯­è¨€æ¨¡å‹ï¼Œç»è¿‡è§£ç ï¼Œå¾—åˆ°ä¸€ä¸ªè¾“å‡ºè¯ã€‚ç„¶åï¼Œå°†ç¬¬ä¸€è½®è¾“å‡ºçš„è¯ä¸ç¬¬ä¸€è½®è¾“å…¥çš„è¯æ‹¼æ¥ï¼Œä½œä¸ºç¬¬äºŒè½®çš„è¾“å…¥ï¼Œç„¶åè§£ç å¾—åˆ°ç¬¬äºŒè½®çš„è¾“å‡ºã€‚æ¥ç€ï¼Œå°†ç¬¬äºŒè½®çš„è¾“å‡ºå’Œè¾“å…¥æ‹¼æ¥ï¼Œä½œä¸ºç¬¬ä¸‰è½®çš„è¾“å…¥ï¼Œä»¥æ­¤ç±»æ¨ã€‚åœ¨å¾ªç¯è¿­ä»£çš„ â€œè‡ªå›å½’â€ è¿‡ç¨‹ä¸­ï¼Œä¸æ–­ç”Ÿæˆæ–°çš„è¯ï¼Œè¿™äº›è¯ä¾¿æ„æˆäº†ä¸€æ®µæ–‡æœ¬ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä½†ä¸Šè¿° â€œè‡ªå›å½’â€ è¿‡ç¨‹å­˜åœ¨ç€ä¸¤ä¸ªé—®é¢˜ï¼šï¼ˆ1ï¼‰&lt;strong&gt;é”™è¯¯çº§è”æ”¾å¤§&lt;/strong&gt;ï¼Œé€‰ç”¨æ¨¡å‹è‡ªå·±ç”Ÿæˆçš„è¯ä½œä¸ºè¾“å…¥å¯èƒ½ä¼šæœ‰é”™è¯¯ï¼Œè¿™æ ·çš„é”™è¯¯å¾ªç¯è¾“å…¥ï¼Œå°†ä¼šä¸æ–­çš„æ”¾å¤§é”™è¯¯ï¼Œå¯¼è‡´æ¨¡å‹ä¸èƒ½å¾ˆå¥½æ‹Ÿåˆè®­ç»ƒé›†ï¼›ï¼ˆ2ï¼‰&lt;strong&gt;ä¸²è¡Œè®¡ç®—æ•ˆç‡ä½&lt;/strong&gt;ï¼Œå› ä¸ºä¸‹ä¸€ä¸ªè¦é¢„æµ‹çš„è¯ä¾èµ–ä¸Šä¸€æ¬¡çš„é¢„æµ‹ï¼Œæ¯æ¬¡é¢„æµ‹ä¹‹é—´æ˜¯ä¸²è¡Œçš„ï¼Œéš¾ä»¥è¿›è¡Œå¹¶è¡ŒåŠ é€Ÿã€‚ä¸ºäº†è§£å†³ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ï¼Œâ€œ&lt;strong&gt;Teacher Forcing&lt;/strong&gt;â€ åœ¨è¯­è¨€æ¨¡å‹é¢„è®­ç»ƒè¿‡ç¨‹ä¸­è¢«å¹¿æ³›åº”ç”¨ã€‚&lt;strong&gt;åœ¨ Teacher Forcing ä¸­ï¼Œæ¯è½®éƒ½ä»…å°†è¾“å‡ºç»“æœä¸ â€œæ ‡å‡†ç­”æ¡ˆâ€ï¼ˆGroundTruthï¼‰è¿›è¡Œæ‹¼æ¥ä½œä¸ºä¸‹ä¸€è½®çš„è¾“å…¥&lt;/strong&gt;ã€‚å¦‚ä¾‹å­ä¸­ï¼Œç¬¬äºŒè½®å¾ªç¯ä¸­ï¼Œç”¨ â€œé•¿é¢ˆé¹¿è„–å­â€ æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªè¯ â€œé•¿â€ï¼Œè€Œéé€‰ç”¨ o1 ä¸­æ¦‚ç‡æœ€é«˜çš„è¯ â€œåƒâ€ æˆ–è€…å…¶ä»–å¯èƒ½è¾“å‡ºçš„è¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/1.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä½†æ˜¯ï¼ŒTeacher Forcing çš„è®­ç»ƒæ–¹å¼å°†å¯¼è‡´&lt;strong&gt;æ›å…‰åå·®&lt;/strong&gt;ï¼ˆExposure Biasï¼‰çš„é—®é¢˜ã€‚æ›å…‰åå·®æ˜¯æŒ‡ Teacher Forcing &lt;strong&gt;è®­ç»ƒæ¨¡å‹çš„è¿‡ç¨‹å’Œæ¨¡å‹åœ¨æ¨ç†è¿‡ç¨‹å­˜åœ¨å·®å¼‚&lt;/strong&gt;ã€‚Teacher Forcing åœ¨è®­ç»ƒä¸­ï¼Œæ¨¡å‹å°†ä¾èµ–äº â€œæ ‡å‡†ç­”æ¡ˆâ€ è¿›è¡Œä¸‹ä¸€æ¬¡çš„é¢„æµ‹ï¼Œä½†æ˜¯åœ¨æ¨ç†é¢„æµ‹ä¸­ï¼Œæ¨¡å‹ â€œè‡ªå›å½’â€ çš„äº§ç”Ÿæ–‡æœ¬ï¼Œæ²¡æœ‰ â€œæ ‡å‡†ç­”æ¡ˆâ€ å¯å‚è€ƒã€‚æ‰€ä»¥æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å’Œæ¨ç†è¿‡ç¨‹ä¸­å­˜åœ¨åå·®ï¼Œå¯èƒ½æ¨ç†æ•ˆæœè¾ƒå·®ã€‚ä¸ºè§£å†³æ›å…‰åå·®çš„é—®é¢˜ï¼ŒBengio ç­‰äººæå‡ºäº†é’ˆå¯¹ RNN æå‡ºäº†&lt;strong&gt; Scheduled Sampling æ–¹æ³•&lt;/strong&gt;ã€‚å…¶åœ¨ Teacher Forcing çš„è®­ç»ƒè¿‡ç¨‹ä¸­å¾ªåºæ¸è¿›çš„ä½¿ç”¨ä¸€å°éƒ¨åˆ†æ¨¡å‹è‡ªå·±ç”Ÿæˆçš„è¯ä»£æ›¿ â€œæ ‡å‡†ç­”æ¡ˆâ€ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯¹æ¨ç†ä¸­æ—  â€œæ ‡å‡†ç­”æ¡ˆâ€ çš„æƒ…å†µè¿›è¡Œé¢„æ¼”ã€‚&lt;/p&gt;
&lt;h2 id=&#34;13-åŸºäºtransformer-çš„è¯­è¨€æ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#13-åŸºäºtransformer-çš„è¯­è¨€æ¨¡å‹&#34;&gt;#&lt;/a&gt; 1.3 åŸºäº Transformer çš„è¯­è¨€æ¨¡å‹&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒTransformer æ˜¯ä¸€ç±»åŸºäºæ³¨æ„åŠ›æœºåˆ¶ï¼ˆAttentionï¼‰çš„æ¨¡å—åŒ–æ„å»ºçš„ç¥ç»ç½‘ç»œç»“æ„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;131-transformer&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#131-transformer&#34;&gt;#&lt;/a&gt; 1.3.1 Transformer&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒTransformer æ˜¯ç”±ä¸¤ç§æ¨¡å—ç»„åˆæ„å»ºçš„æ¨¡å—åŒ–ç½‘ç»œç»“æ„ã€‚ä¸¤ç§æ¨¡å—åˆ†åˆ«ä¸ºï¼šæ³¨æ„åŠ›ï¼ˆAttentionï¼‰æ¨¡å—å’Œå…¨è¿æ¥å‰é¦ˆ Fully-connectedFeedforwadï¼‰æ¨¡å—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/1.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ³¨æ„åŠ›å±‚ï¼ˆAttentionLayerï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒå…·ä½“å†…å®¹å‚è€ƒ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1pKVS1MTE1zL0ZvdW5kYXRpb25zLW9mLUxMTXMvdHJlZS9tYWlu&#34;&gt; github&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…¨è¿æ¥å‰é¦ˆå±‚ï¼ˆFully-connected Feedforwad Layerï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;å…¨è¿æ¥å‰é¦ˆå±‚å æ®äº† Tranformer è¿‘ä¸‰åˆ†ä¹‹äºŒçš„å‚æ•°ï¼ŒæŒç®¡ç€ Tranformer æ¨¡å‹çš„è®°å¿†&lt;/strong&gt;ã€‚å…¶å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§ Key-Value æ¨¡å¼çš„è®°å¿†å­˜å‚¨ç®¡ç†æ¨¡å— [7]ã€‚å…¨è¿æ¥å‰é¦ˆå±‚åŒ…å«ä¸¤å±‚ï¼Œä¸¤å±‚ä¹‹é—´ç”± ReLU ä½œä¸ºæ¿€æ´»å‡½æ•°ã€‚è®¾å…¨è¿æ¥å‰é¦ˆå±‚çš„è¾“å…¥ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;v&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, å…¨è¿æ¥å‰é¦ˆå±‚å¯ç”±ä¸‹å¼è¡¨ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;max&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;FFN(v)=\max(0,W_1v+b_1)W_2+b_2
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå…¶ä¸­ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;W1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;W2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; åˆ†åˆ«ä¸ºç¬¬ä¸€å±‚å’Œç¬¬äºŒå±‚çš„æƒé‡å‚æ•°ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;b1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;b2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; åˆ†åˆ«ä¸ºç¬¬ä¸€å±‚å’Œç¬¬äºŒå±‚çš„åç½®å‚æ•°ã€‚å…¶ä¸­ç¬¬ä¸€å±‚çš„å¯çœ‹ä½œç¥ç»è®°å¿†ä¸­çš„ keyï¼Œè€Œç¬¬äºŒå±‚å¯çœ‹ä½œ valueã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å±‚æ­£åˆ™åŒ–ï¼ˆLayerNormalizationï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;å±‚æ­£åˆ™åŒ–ç”¨ä»¥åŠ é€Ÿç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹å¹¶å–å¾—æ›´å¥½çš„æ³›åŒ–æ€§èƒ½ã€‚&lt;/strong&gt; å…·ä½“å†…å®¹å‚è€ƒ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1pKVS1MTE1zL0ZvdW5kYXRpb25zLW9mLUxMTXMvdHJlZS9tYWlu&#34;&gt; github&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ®‹å·®è¿æ¥ï¼ˆResidualConnectionsï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;å¼•å…¥æ®‹å·®è¿æ¥å¯ä»¥æœ‰æ•ˆè§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚åœ¨åŸºæœ¬çš„ Transformer ç¼–ç æ¨¡å—ä¸­åŒ…å«ä¸¤ä¸ªæ®‹å·®è¿æ¥ã€‚&lt;/strong&gt; ç¬¬ä¸€ä¸ªæ®‹å·®è¿æ¥æ˜¯å°†è‡ªæ³¨æ„åŠ›å±‚çš„è¾“å…¥ç”±ä¸€æ¡æ—è·¯å åŠ åˆ°è‡ªæ³¨æ„åŠ›å±‚çš„è¾“å‡ºä¸Šï¼Œç„¶åè¾“å…¥ç»™å±‚æ­£åˆ™åŒ–ã€‚ç¬¬äºŒä¸ªæ®‹å·®è¿æ¥æ˜¯å°†å…¨è¿æ¥å‰é¦ˆå±‚çš„è¾“å…¥ç”±ä¸€æ¡æ—è·¯å¼•åˆ°å…¨è¿æ¥å‰é¦ˆå±‚çš„è¾“å‡ºä¸Šï¼Œç„¶åè¾“å…¥ç»™å±‚æ­£åˆ™åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸Šè¿°&lt;strong&gt;å°†å±‚æ­£åˆ™åŒ–ç½®äºæ®‹å·®è¿æ¥ä¹‹åçš„ç½‘ç»œç»“æ„è¢«ç§°ä¸º Post-LN Transformer&lt;/strong&gt;ã€‚ä¸ä¹‹ç›¸å¯¹çš„ï¼Œè¿˜æœ‰ä¸€ç§&lt;strong&gt;å°†å±‚æ­£åˆ™åŒ–ç½®äºæ®‹å·®è¿æ¥ä¹‹å‰çš„ç½‘ç»œç»“æ„ï¼Œç§°ä¹‹ä¸º Pre-LN Transformers&lt;/strong&gt;ã€‚å¯¹æ¯”ä¸¤è€…ï¼ŒPost-LN Transformer åº”å¯¹è¡¨å¾åå¡Œï¼ˆRepresentation Collapseï¼‰çš„èƒ½åŠ›æ›´å¼ºï¼Œä½†å¤„ç†æ¢¯åº¦æ¶ˆå¤±ç•¥å¼±ã€‚è€Œ Pre-LN Transformers å¯ä»¥æ›´å¥½çš„åº”å¯¹æ¢¯åº¦æ¶ˆå¤±ï¼Œä½†å¤„ç†è¡¨å¾åå¡Œçš„èƒ½åŠ›ç•¥å¼±ã€‚&lt;/p&gt;
&lt;h3 id=&#34;132-åŸºäºtransformer-çš„è¯­è¨€æ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#132-åŸºäºtransformer-çš„è¯­è¨€æ¨¡å‹&#34;&gt;#&lt;/a&gt; 1.3.2 åŸºäº Transformer çš„è¯­è¨€æ¨¡å‹&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒç›¸è¾ƒäº RNN æ¨¡å‹ä¸²è¡Œçš„å¾ªç¯è¿­ä»£æ¨¡å¼ï¼ŒTransformer å¹¶è¡Œè¾“å…¥çš„ç‰¹æ€§ï¼Œä½¿å…¶&lt;strong&gt;å®¹æ˜“è¿›è¡Œå¹¶è¡Œè®¡ç®—&lt;/strong&gt;ã€‚ä½†æ˜¯ï¼ŒTransformer å¹¶è¡Œè¾“å…¥çš„èŒƒå¼ä¹Ÿå¯¼è‡´&lt;strong&gt;ç½‘ç»œæ¨¡å‹çš„è§„æ¨¡éšè¾“å…¥åºåˆ—é•¿åº¦çš„å¢é•¿è€Œå¹³æ–¹æ¬¡å¢é•¿&lt;/strong&gt;ã€‚è¿™ä¸ºåº”ç”¨ Transformer å¤„ç†é•¿åºåˆ—å¸¦æ¥æŒ‘æˆ˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;14-è¯­è¨€æ¨¡å‹çš„é‡‡æ ·æ–¹æ³•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#14-è¯­è¨€æ¨¡å‹çš„é‡‡æ ·æ–¹æ³•&#34;&gt;#&lt;/a&gt; 1.4 è¯­è¨€æ¨¡å‹çš„é‡‡æ ·æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒè¯­è¨€æ¨¡å‹çš„è¾“å‡ºä¸ºä¸€ä¸ªå‘é‡ï¼Œè¯¥å‘é‡çš„æ¯ä¸€ç»´ä»£è¡¨ç€è¯å…¸ä¸­å¯¹åº”è¯çš„æ¦‚ç‡ã€‚å½“å‰ï¼Œä¸¤ç±»ä¸»æµçš„è§£ç æ–¹æ³•å¯ä»¥æ€»ç»“ä¸º (1). æ¦‚ç‡æœ€å¤§åŒ–æ–¹æ³•ï¼›(2). éšæœºé‡‡æ ·æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;141-æ¦‚ç‡æœ€å¤§åŒ–æ–¹æ³•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#141-æ¦‚ç‡æœ€å¤§åŒ–æ–¹æ³•&#34;&gt;#&lt;/a&gt; 1.4.1 æ¦‚ç‡æœ€å¤§åŒ–æ–¹æ³•&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒè®¾è¯å…¸å¤§å°ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;D&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œè¾“å…¥æ–‡æœ¬ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;.&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;.&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;.&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&#34;true&#34;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\left \{ \omega_1,\omega_2,\omega_3,...,\omega_N \right \}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œæ¨¡å‹åœ¨&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;M&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;M&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è½®è‡ªå›å½’åç”Ÿæˆçš„æ–‡æœ¬ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;.&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;.&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;.&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï‰&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&#34;true&#34;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\left \{ \omega_{N+1},\omega_{N+2},\omega_{N+3},...,\omega_{N+M} \right \}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.328331em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.328331em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.328331em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï‰&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.328331em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;M&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚ç”Ÿæˆæ–‡æ¡£çš„å‡ºç°çš„æ¦‚ç‡å¯ç”±ä¸‹å¼è¿›è¡Œè®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;âˆ&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;P(w_{N+1:N+M})=\prod_{i=N}^{N+M-1}P(w_{i+1}|w_{1:i})
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.328331em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;M&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.1226720000000006em;vertical-align:-1.294336em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8283360000000004em;&#34;&gt;&lt;span style=&#34;top:-1.855664em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.050005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;âˆ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.300005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;M&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.294336em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåŸºäºæ¦‚ç‡æœ€å¤§åŒ–çš„è§£ç æ–¹æ³•æ—¨åœ¨æœ€å¤§åŒ–&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;P(w_{N+1:N+M})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.328331em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;M&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œä»¥ç”Ÿæˆå‡ºå¯èƒ½æ€§æœ€é«˜çš„æ–‡æœ¬ã€‚è¯¥é—®é¢˜çš„æœç´¢ç©ºé—´å¤§å°ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;D^M&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8413309999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8413309999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;M&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œæ˜¯ NP-Hard é—®é¢˜ã€‚ç°æœ‰æ¦‚ç‡æœ€å¤§åŒ–æ–¹æ³•é€šå¸¸é‡‡ç”¨å¯å‘å¼æœç´¢æ–¹æ³•ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è´ªå¿ƒæœç´¢&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;è´ªå¿ƒæœç´¢åœ¨åœ¨æ¯è½®é¢„æµ‹ä¸­éƒ½é€‰æ‹©æ¦‚ç‡æœ€å¤§çš„è¯ã€‚è´ªå¿ƒæœç´¢åªé¡¾ â€œçœ¼å‰åˆ©ç›Šâ€ï¼Œå¿½ç•¥äº† â€œè¿œæœŸæ•ˆç›Šâ€ã€‚å½“å‰æ¦‚ç‡å¤§çš„è¯æœ‰å¯èƒ½å¯¼è‡´åç»­çš„è¯æ¦‚ç‡éƒ½å¾ˆå°ã€‚è´ªå¿ƒæœç´¢å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼Œéš¾ä»¥è¾¾åˆ°å…¨å±€æœ€ä¼˜è§£ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ³¢æŸæœç´¢ï¼ˆBeamSearchï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;æ³¢æŸæœç´¢åœ¨æ¯è½®é¢„æµ‹ä¸­éƒ½å…ˆä¿ç•™&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;b&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ªå¯èƒ½æ€§æœ€é«˜çš„è¯&lt;/strong&gt;ã€‚æ¨¡å‹åœ¨ç»“æŸ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;M&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;M&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è½®çš„æ¨ç†åå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ¨ç†ç»“æœé›†åˆï¼Œä»è¯¥é›†åˆä¸­æ‰¾å‡ºä½¿&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;P(w_{N+1:N+M})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.328331em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;M&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æœ€å¤§çš„é¢„æµ‹ç»“æœã€‚&lt;/p&gt;
&lt;h3 id=&#34;142-éšæœºé‡‡æ ·æ–¹æ³•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#142-éšæœºé‡‡æ ·æ–¹æ³•&#34;&gt;#&lt;/a&gt; 1.4.2 éšæœºé‡‡æ ·æ–¹æ³•&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒæ¦‚ç‡æœ€å¤§çš„æ–‡æœ¬é€šå¸¸æ˜¯æœ€ä¸ºå¸¸è§çš„æ–‡æœ¬ï¼Œå…¶æ‰€ç”Ÿæˆçš„æ–‡æœ¬ç¼ºä¹å¤šæ ·æ€§ã€‚ä¸ºäº†å¢åŠ ç”Ÿæˆæ–‡æœ¬çš„å¤šæ ·æ€§ï¼Œ&lt;strong&gt;éšæœºé‡‡æ ·çš„æ–¹æ³•åœ¨é¢„æµ‹æ—¶å¢åŠ äº†éšæœºæ€§&lt;/strong&gt;ã€‚åœ¨æ¯è½®é¢„æµ‹æ—¶ï¼Œå…¶å…ˆé€‰å‡ºä¸€ç»„å¯èƒ½æ€§é«˜çš„å€™é€‰è¯ï¼Œç„¶åæŒ‰ç…§å…¶æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œéšæœºé‡‡æ ·ï¼Œé‡‡æ ·å‡ºçš„è¯ä½œä¸ºæœ¬è½®çš„é¢„æµ‹ç»“æœã€‚å½“å‰ï¼Œ&lt;strong&gt;ä¸»æµçš„ Top-K é‡‡æ ·å’Œ Top-P é‡‡æ ·&lt;/strong&gt;æ–¹æ³•åˆ†åˆ«é€šè¿‡æŒ‡å®šå€™é€‰è¯æ•°é‡å’Œåˆ’å®šå€™é€‰è¯æ¦‚ç‡é˜ˆå€¼çš„æ–¹æ³•å¯¹å€™é€‰è¯è¿›è¡Œé€‰æ‹©ã€‚åœ¨é‡‡æ ·æ–¹æ³•ä¸­åŠ å…¥&lt;strong&gt; Temperature æœºåˆ¶&lt;/strong&gt;å¯ä»¥å¯¹å€™é€‰è¯çš„æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œè°ƒæ•´ã€‚&lt;/p&gt;
&lt;h2 id=&#34;15-è¯­è¨€æ¨¡å‹çš„è¯„æµ‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#15-è¯­è¨€æ¨¡å‹çš„è¯„æµ‹&#34;&gt;#&lt;/a&gt; 1.5 è¯­è¨€æ¨¡å‹çš„è¯„æµ‹&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒè¯„æµ‹è¯­è¨€æ¨¡å‹ç”Ÿæˆèƒ½åŠ›çš„æ–¹æ³•å¯ä»¥åˆ†ä¸ºä¸¤ç±»ã€‚ç¬¬ä¸€ç±»æ–¹æ³•ä¸ä¾èµ–å…·ä½“ä»»åŠ¡ï¼Œç›´æ¥é€šè¿‡è¯­è¨€æ¨¡å‹çš„è¾“å‡ºæ¥è¯„æµ‹æ¨¡å‹çš„ç”Ÿæˆèƒ½åŠ›ï¼Œç§°ä¹‹ä¸ºå†…åœ¨è¯„æµ‹ï¼ˆIntrinsicEvaluationï¼‰ã€‚ç¬¬äºŒç±»æ–¹æ³•é€šè¿‡æŸäº›å…·ä½“ä»»åŠ¡ï¼Œå¦‚æœºå™¨ç¿»è¯‘ã€æ‘˜è¦ç”Ÿæˆç­‰ï¼Œæ¥è¯„æµ‹è¯­è¨€æ¨¡å‹å¤„ç†è¿™äº›å…·ä½“ç”Ÿæˆä»»åŠ¡çš„èƒ½åŠ›ï¼Œç§°ä¹‹ä¸ºå¤–åœ¨è¯„æµ‹ï¼ˆExtrinsicEvaluationï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;151-å†…åœ¨è¯„æµ‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#151-å†…åœ¨è¯„æµ‹&#34;&gt;#&lt;/a&gt; 1.5.1 å†…åœ¨è¯„æµ‹&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨å†…åœ¨è¯„æµ‹ä¸­ï¼Œæµ‹è¯•æ–‡æœ¬é€šå¸¸ç”±ä¸é¢„è®­ç»ƒä¸­æ‰€ç”¨çš„æ–‡æœ¬ç‹¬ç«‹åŒåˆ†å¸ƒçš„æ–‡æœ¬æ„æˆï¼Œ&lt;strong&gt;ä¸ä¾èµ–äºå…·ä½“ä»»åŠ¡&lt;/strong&gt;ã€‚æœ€ä¸ºå¸¸ç”¨çš„å†…éƒ¨è¯„æµ‹æŒ‡æ ‡æ˜¯&lt;strong&gt;å›°æƒ‘åº¦&lt;/strong&gt;ï¼ˆPerplexityï¼‰ã€‚å…¶åº¦é‡äº†è¯­è¨€æ¨¡å‹å¯¹æµ‹è¯•æ–‡æœ¬æ„Ÿåˆ° â€œå›°æƒ‘â€ çš„ç¨‹åº¦ã€‚å…·ä½“å†…å®¹å‚è€ƒ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1pKVS1MTE1zL0ZvdW5kYXRpb25zLW9mLUxMTXMvdHJlZS9tYWlu&#34;&gt; github&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;152-å¤–åœ¨è¯„æµ‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#152-å¤–åœ¨è¯„æµ‹&#34;&gt;#&lt;/a&gt; 1.5.2 å¤–åœ¨è¯„æµ‹&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨å¤–åœ¨è¯„æµ‹ä¸­ï¼Œ&lt;strong&gt;æµ‹è¯•æ–‡æœ¬é€šå¸¸åŒ…æ‹¬è¯¥ä»»åŠ¡ä¸Šçš„é—®é¢˜å’Œå¯¹åº”çš„æ ‡å‡†ç­”æ¡ˆï¼Œå…¶ä¾èµ–äºå…·ä½“ä»»åŠ¡ã€‚&lt;/strong&gt; å¤–åœ¨è¯„æµ‹æ–¹æ³•é€šå¸¸å¯ä»¥åˆ†ä¸º&lt;strong&gt;åŸºäºç»Ÿè®¡æŒ‡æ ‡çš„è¯„æµ‹æ–¹æ³•å’ŒåŸºäºè¯­è¨€æ¨¡å‹çš„è¯„æµ‹æ–¹æ³•ä¸¤ç±»&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŸºäºç»Ÿè®¡æŒ‡æ ‡çš„è¯„æµ‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒåŸºäºç»Ÿè®¡æŒ‡æ ‡çš„æ–¹æ³•æ„é€ ç»Ÿè®¡æŒ‡æ ‡æ¥è¯„æµ‹è¯­è¨€æ¨¡å‹çš„è¾“å‡ºä¸æ ‡å‡†ç­”æ¡ˆé—´çš„å¥‘åˆç¨‹åº¦ï¼Œå¹¶ä»¥æ­¤ä½œä¸ºè¯„æµ‹è¯­è¨€æ¨¡å‹ç”Ÿæˆèƒ½åŠ›çš„ä¾æ®ã€‚BLEUï¼ˆBiLingualEvaluation Understudyï¼‰å’Œ ROUGEï¼ˆRecall-Oriented Understudy for Gisting Evaluationï¼‰æ˜¯åº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ä¸¤ç§ç»Ÿè®¡æŒ‡æ ‡ã€‚å…¶ä¸­ï¼ŒBLEU æ˜¯ç²¾åº¦å¯¼å‘çš„æŒ‡æ ‡ï¼Œè€Œ ROUGE æ˜¯å¬å›å¯¼å‘çš„æŒ‡æ ‡ã€‚å…·ä½“å†…å®¹å‚è€ƒ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1pKVS1MTE1zL0ZvdW5kYXRpb25zLW9mLUxMTXMvdHJlZS9tYWlu&#34;&gt; github&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;åŸºäºè¯­è¨€æ¨¡å‹çš„è¯„æµ‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒç›®å‰åŸºäºè¯­è¨€æ¨¡å‹çš„è¯„æµ‹æ–¹æ³•ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼šï¼ˆ1ï¼‰åŸºäºä¸Šä¸‹æ–‡è¯åµŒå…¥ï¼ˆContextual Embeddingsï¼‰çš„è¯„æµ‹æ–¹æ³•ï¼›ï¼ˆ2ï¼‰åŸºäºç”Ÿæˆæ¨¡å‹çš„è¯„æµ‹æ–¹æ³•ã€‚å…¸å‹çš„åŸºäºä¸Šä¸‹æ–‡è¯åµŒå…¥çš„è¯„æµ‹æ–¹æ³•æ˜¯ BERTScore [24]ã€‚å…¸å‹çš„åŸºäºç”Ÿæˆæ¨¡å‹çš„è¯„æµ‹æ–¹æ³•æ˜¯ G-EVALã€‚ä¸ BERTScore ç›¸æ¯”ï¼ŒG-EVAL æ— éœ€äººç±»æ ‡æ³¨çš„å‚è€ƒç­”æ¡ˆã€‚è¿™ä½¿å…¶å¯ä»¥æ›´å¥½çš„é€‚åº”åˆ°ç¼ºä¹äººç±»æ ‡æ³¨çš„ä»»åŠ¡ä¸­ã€‚&lt;/p&gt;
&lt;h1 id=&#34;å…­-æ£€ç´¢å¢å¼ºç”Ÿæˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å…­-æ£€ç´¢å¢å¼ºç”Ÿæˆ&#34;&gt;#&lt;/a&gt; å…­ã€æ£€ç´¢å¢å¼ºç”Ÿæˆ&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒç”±äºè®­ç»ƒæ•°æ®çš„æ­£ç¡®æ€§ã€æ—¶æ•ˆæ€§å’Œå®Œå¤‡æ€§å¯èƒ½å­˜åœ¨ä¸è¶³ï¼Œå…¶éš¾ä»¥å®Œå…¨è¦†ç›–ç”¨æˆ·çš„éœ€æ±‚ã€‚åŒæ—¶ï¼Œç”±äºå‚æ•°ç©ºé—´æœ‰é™ï¼Œå¤§è¯­è¨€æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®çš„å­¦ä¹ ä¹Ÿéš¾ä»¥è¾¾åˆ°å®Œç¾ã€‚ä¸Šè¿°è®­ç»ƒæ•°æ®å’Œå‚æ•°å­¦ä¹ ä¸Šçš„ä¸è¶³å°†å¯¼è‡´ï¼šå¤§è¯­è¨€æ¨¡å‹åœ¨é¢å¯¹æŸäº›é—®é¢˜æ—¶æ— æ³•ç»™å‡ºæ­£ç¡®ç­”æ¡ˆï¼Œç”šè‡³å‡ºç° â€œå¹»è§‰â€ï¼Œå³ç”Ÿæˆçœ‹ä¼¼åˆç†å®åˆ™é€»è¾‘æ··ä¹±æˆ–è¿èƒŒäº‹å®çš„å›ç­”ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†è§£å†³è¿™äº›é—®é¢˜å¹¶è¿›ä¸€æ­¥æå‡å¤§è¯­è¨€æ¨¡å‹çš„ç”Ÿæˆè´¨é‡ï¼Œ&lt;strong&gt;å¯ä»¥å°†ç›¸å…³ä¿¡æ¯å­˜å‚¨åœ¨å¤–éƒ¨æ•°æ®åº“ä¸­ï¼Œä¾›å¤§è¯­è¨€æ¨¡å‹è¿›è¡Œæ£€ç´¢å’Œè°ƒç”¨ã€‚è¿™ç§ä»å¤–éƒ¨æ•°æ®åº“ä¸­æ£€ç´¢å‡ºç›¸å…³ä¿¡æ¯æ¥è¾…åŠ©æ”¹å–„å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆè´¨é‡çš„ç³»ç»Ÿè¢«ç§°ä¹‹ä¸ºæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRetrieval-AugmentedGenerationï¼ŒRAGï¼‰ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;61-æ£€ç´¢å¢å¼ºç”Ÿæˆç®€ä»‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#61-æ£€ç´¢å¢å¼ºç”Ÿæˆç®€ä»‹&#34;&gt;#&lt;/a&gt; 6.1 æ£€ç´¢å¢å¼ºç”Ÿæˆç®€ä»‹&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æ—¨åœ¨é€šè¿‡&lt;strong&gt;æ£€ç´¢å’Œæ•´åˆå¤–éƒ¨çŸ¥è¯†&lt;/strong&gt;æ¥å¢å¼ºå¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆæ–‡æœ¬çš„å‡†ç¡®æ€§å’Œä¸°å¯Œæ€§ï¼Œå…¶æ˜¯ä¸€ä¸ªé›†æˆäº†&lt;strong&gt;å¤–éƒ¨çŸ¥è¯†åº“ã€ä¿¡æ¯æ£€ç´¢å™¨ã€å¤§è¯­è¨€æ¨¡å‹&lt;/strong&gt;ç­‰å¤šä¸ªåŠŸèƒ½æ¨¡å—çš„ç³»ç»Ÿã€‚RAG åˆ©ç”¨ä¿¡æ¯æ£€ç´¢ã€æ·±åº¦å­¦ä¹ ç­‰å¤šç§æŠ€æœ¯ä¸ºå¤§è¯­è¨€æ¨¡å‹åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­å¼•å…¥æœ€æ–°çš„ã€ç‰¹å®šé¢†åŸŸçš„çŸ¥è¯†ï¼Œä»è€Œå…‹æœä¼ ç»Ÿå¤§è¯­è¨€æ¨¡å‹çš„å±€é™æ€§ï¼Œæä¾›æ›´åŠ ç²¾å‡†å’Œå¯é çš„ç”Ÿæˆå†…å®¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;611-æ£€ç´¢å¢å¼ºç”Ÿæˆçš„ç»„æˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#611-æ£€ç´¢å¢å¼ºç”Ÿæˆçš„ç»„æˆ&#34;&gt;#&lt;/a&gt; 6.1.1 æ£€ç´¢å¢å¼ºç”Ÿæˆçš„ç»„æˆ&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒRAG é€šå¸¸é›†æˆäº†å¤–éƒ¨çŸ¥è¯†åº“ï¼ˆCorpusï¼‰ã€ä¿¡æ¯æ£€ç´¢å™¨ï¼ˆRetrieverï¼‰ã€ç”Ÿæˆå™¨ï¼ˆGeneratorï¼Œå³å¤§è¯­è¨€æ¨¡å‹ï¼‰ç­‰å¤šä¸ªåŠŸèƒ½æ¨¡å—ã€‚å…¶åŸºæœ¬æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå…·ä½“è€Œè¨€ï¼Œç»™å®šä¸€ä¸ªè‡ªç„¶è¯­è¨€é—®é¢˜ï¼ˆQueryï¼‰ï¼Œæ£€ç´¢å™¨å°†é—®é¢˜è¿›è¡Œç¼–ç ï¼Œå¹¶ä»çŸ¥è¯†åº“ï¼ˆå¦‚ç»´åŸºç™¾ç§‘ï¼‰ä¸­é«˜æ•ˆæ£€ç´¢å‡ºä¸é—®é¢˜ç›¸å…³çš„æ–‡æ¡£ã€‚ç„¶åï¼Œå°†æ£€ç´¢åˆ°çš„çŸ¥è¯†å’ŒåŸå§‹é—®é¢˜ä¸€å¹¶ä¼ é€’ç»™å¤§è¯­è¨€æ¨¡å‹ï¼Œå¤§è¯­è¨€æ¨¡å‹æ ¹æ®æ£€ç´¢åˆ°çš„çŸ¥è¯†å’ŒåŸå§‹é—®é¢˜ç”Ÿæˆæœ€ç»ˆçš„è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒRAG çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºä¸éœ€è¦å¯¹å¤§è¯­è¨€æ¨¡å‹çš„å†…éƒ¨çŸ¥è¯†è¿›è¡Œæ›´æ–°ï¼ˆå³ä¸éœ€è¦é‡æ–°è®­ç»ƒï¼‰ï¼Œä¾¿å¯æ”¹å–„å¤§è¯­è¨€æ¨¡å‹çš„å¹»è§‰ç°è±¡ï¼Œæé«˜ç”Ÿæˆè´¨é‡ã€‚è¿™å¯ä»¥æœ‰æ•ˆé¿å…å†…éƒ¨çŸ¥è¯†æ›´æ–°å¸¦æ¥çš„è®¡ç®—æˆæœ¬å’Œå¯¹æ—§çŸ¥è¯†çš„ç¾éš¾æ€§é—å¿˜ï¼ˆCatastrophic Forgettingï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;62-æ£€ç´¢å¢å¼ºç”Ÿæˆæ¶æ„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#62-æ£€ç´¢å¢å¼ºç”Ÿæˆæ¶æ„&#34;&gt;#&lt;/a&gt; 6.2 æ£€ç´¢å¢å¼ºç”Ÿæˆæ¶æ„&lt;/h2&gt;
&lt;h3 id=&#34;621-ragæ¶æ„åˆ†ç±»&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#621-ragæ¶æ„åˆ†ç±»&#34;&gt;#&lt;/a&gt; 6.2.1 RAG æ¶æ„åˆ†ç±»&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒé’ˆå¯¹ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼ŒRAG ä¸­çš„ç”Ÿæˆå™¨å¯ä»¥é€‰ç”¨ä¸åŒçš„å¤§è¯­è¨€æ¨¡å‹ï¼Œè€ƒè™‘åˆ°å¤§è¯­è¨€æ¨¡å‹çš„å¼€æº / é—­æºã€å¾®è°ƒæˆæœ¬ç­‰é—®é¢˜ï¼ŒRAG ä¸­çš„å¤§è¯­è¨€æ¨¡å‹å¯ä»¥æ˜¯å‚æ•°ä¸å¯æ„ŸçŸ¥ / è°ƒèŠ‚çš„ â€œé»‘ç›’â€ æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å‚æ•°å¯æ„ŸçŸ¥å’Œå¾®è°ƒçš„ â€œç™½ç›’â€ æ¨¡å‹ã€‚ä»æ˜¯å¦å¯¹å¤§è¯­è¨€æ¨¡å‹è¿›è¡Œå¾®è°ƒçš„è§’åº¦å‡ºå‘ï¼Œæœ¬å°èŠ‚å°† RAG æ¶æ„åˆ†ç±»ä¸¤å¤§ç±»ï¼š&lt;strong&gt;é»‘ç›’å¢å¼ºæ¶æ„&lt;/strong&gt;å’Œ&lt;strong&gt;ç™½ç›’å¢å¼ºæ¶æ„&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé»‘ç›’å¢å¼ºæ¶æ„å¯æ ¹æ®æ˜¯å¦å¯¹æ£€ç´¢å™¨è¿›è¡Œå¾®è°ƒåˆ†ä¸ºä¸¤ç±»ï¼š&lt;strong&gt;æ— å¾®è°ƒ&lt;/strong&gt;ã€&lt;strong&gt;æ£€ç´¢å™¨å¾®è°ƒ&lt;/strong&gt;ã€‚ç™½ç›’å¢å¼ºæ¶æ„ä¹Ÿå¯æ ¹æ®æ˜¯å¦å¯¹æ£€ç´¢å™¨è¿›è¡Œå¾®è°ƒåˆ†ä¸ºä¸¤ç±»ï¼š&lt;strong&gt;ä»…å¾®è°ƒå¤§è¯­è¨€æ¨¡å‹&lt;/strong&gt;ã€&lt;strong&gt;æ£€ç´¢å™¨ä¸å¤§è¯­è¨€æ¨¡å‹ååŒå¾®è°ƒ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;622-é»‘ç›’å¢å¼ºæ¶æ„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#622-é»‘ç›’å¢å¼ºæ¶æ„&#34;&gt;#&lt;/a&gt; 6.2.2 é»‘ç›’å¢å¼ºæ¶æ„&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æ— å¾®è°ƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒæ— å¾®è°ƒæ¶æ„æ˜¯æ‰€æœ‰ RAG æ¶æ„ä¸­å½¢å¼æœ€ç®€å•çš„ã€‚è¯¥æ¶æ„ä¸­ï¼Œ&lt;strong&gt;æ£€ç´¢å™¨å’Œè¯­è¨€æ¨¡å‹ç»è¿‡åˆ†åˆ«ç‹¬ç«‹çš„é¢„è®­ç»ƒåå‚æ•°ä¸å†æ›´æ–°&lt;/strong&gt;ï¼Œç›´æ¥ç»„åˆä½¿ç”¨ã€‚In-Context RALM æ˜¯è¯¥æ¡†æ¶ä¸‹çš„ä»£è¡¨æ€§æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.3.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æ£€ç´¢å™¨å¾®è°ƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒè™½ç„¶æ— å¾®è°ƒæ¶æ„åœ¨å®ç°å’Œéƒ¨ç½²ä¸Šéå¸¸ä¾¿æ·ï¼Œä½†å®ƒå®Œå…¨æ²¡æœ‰è€ƒè™‘æ£€ç´¢å™¨ä¸è¯­è¨€æ¨¡å‹ä¹‹é—´æ½œåœ¨çš„ååŒæ•ˆåº”ï¼Œæ•ˆæœæœ‰å¾…æå‡ã€‚ä¸ºäº†è¿›ä¸€æ­¥æå‡æ•ˆæœï¼Œå¯ä»¥é‡‡ç”¨æ£€ç´¢å™¨å¾®è°ƒæ¶æ„å¯¹æ£€ç´¢å™¨è¿›è¡Œå¾®è°ƒï¼Œä»¥æ›´å¥½åœ°é€‚ç”¨äºé»‘ç›’å¢å¼ºçš„ç¯å¢ƒã€‚åœ¨æ£€ç´¢å™¨å¾®è°ƒæ¶æ„ä¸­ï¼Œ&lt;strong&gt;å¤§è¯­è¨€æ¨¡å‹çš„å‚æ•°ä¿æŒä¸å˜ï¼Œä»…ç”¨å…¶è¾“å‡ºæŒ‡å¯¼æ£€ç´¢å™¨çš„å¾®è°ƒ&lt;/strong&gt;ã€‚REPLUG LSR æ˜¯æ£€ç´¢å™¨å¾®è°ƒæ¡†æ¶çš„ä»£è¡¨æ€§æ–¹æ³•ã€‚å…¶å¾®è°ƒæ£€ç´¢å™¨çš„è¿‡ç¨‹ä¸­é‡‡ç”¨&lt;strong&gt; KL æ•£åº¦æŸå¤±å‡½æ•°æ¥è®­ç»ƒæ£€ç´¢å™¨&lt;/strong&gt;ï¼Œç›®çš„æ˜¯å¯¹é½æ£€ç´¢åˆ°çš„æ–‡æ¡£çš„ç›¸å…³æ€§åˆ†å¸ƒä¸è¿™äº›æ–‡æ¡£å¯¹è¯­è¨€æ¨¡å‹æ€§èƒ½æå‡çš„è´¡çŒ®åˆ†å¸ƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.4.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;623-ç™½ç›’å¢å¼ºæ¶æ„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#623-ç™½ç›’å¢å¼ºæ¶æ„&#34;&gt;#&lt;/a&gt; 6.2.3 ç™½ç›’å¢å¼ºæ¶æ„&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ä»…å¾®è°ƒè¯­è¨€æ¨¡å‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒä»…å¾®è°ƒè¯­è¨€æ¨¡å‹æŒ‡çš„æ˜¯&lt;strong&gt;æ£€ç´¢å™¨ä½œä¸ºä¸€ä¸ªé¢„å…ˆè®­ç»ƒå¥½çš„ç»„ä»¶å…¶å‚æ•°ä¿æŒä¸å˜ï¼Œå¤§è¯­è¨€æ¨¡å‹æ ¹æ®æ£€ç´¢å™¨æä¾›çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¯¹è‡ªèº«å‚æ•°è¿›è¡Œå¾®è°ƒ&lt;/strong&gt;ã€‚RETRO æ˜¯ä»…&lt;br&gt;
å¾®è°ƒè¯­è¨€æ¨¡å‹çš„ä»£è¡¨æ€§æ–¹æ³•ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.5.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æ£€ç´¢å™¨å’Œè¯­è¨€æ¨¡å‹ååŒå¾®è°ƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æ£€ç´¢å™¨å’Œè¯­è¨€æ¨¡å‹ååŒå¾®è°ƒçš„æ¶æ„ä¸­ï¼Œ&lt;strong&gt;æ£€ç´¢å™¨å’Œè¯­è¨€æ¨¡å‹çš„å‚æ•°æ›´æ–°åŒæ­¥è¿›è¡Œ&lt;/strong&gt;ã€‚è¿™ç§å¾®è°ƒçš„æ–¹å¼ä½¿å¾—æ£€ç´¢å™¨èƒ½å¤Ÿåœ¨æ£€ç´¢çš„åŒæ—¶å­¦ä¹ å¦‚ä½•æ›´æœ‰æ•ˆåœ°æ”¯æŒè¯­è¨€æ¨¡å‹çš„éœ€æ±‚ï¼Œè€Œè¯­è¨€æ¨¡å‹åˆ™å¯ä»¥æ›´å¥½åœ°é€‚åº”å¹¶åˆ©ç”¨æ£€ç´¢åˆ°çš„ä¿¡æ¯ï¼Œä»¥è¿›ä¸€æ­¥æå‡ RAG çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒAtlas æ˜¯è¯¥æ¶æ„çš„ä»£è¡¨æ€§å·¥ä½œï¼Œå…¶æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸ REPLUGLSR ç±»&lt;br&gt;
ä¼¼ï¼Œå…¶åœ¨é¢„è®­ç»ƒå’Œå¾®è°ƒé˜¶æ®µä½¿ç”¨&lt;strong&gt; KL æ•£åº¦æŸå¤±å‡½æ•°&lt;/strong&gt;æ¥è”åˆè®­ç»ƒæ£€ç´¢å™¨å’Œè¯­è¨€æ¨¡å‹ï¼Œ&lt;br&gt;
ä»¥ç¡®ä¿æ£€ç´¢å™¨è¾“å‡ºçš„æ–‡æ¡£ç›¸å…³æ€§åˆ†å¸ƒä¸æ–‡æ¡£å¯¹è¯­è¨€æ¨¡å‹çš„è´¡çŒ®åˆ†å¸ƒç›¸ä¸€è‡´ã€‚ä¸åŒ&lt;br&gt;
ä¹‹å¤„åœ¨äºï¼ŒAtlas åœ¨é¢„è®­ç»ƒå’Œå¾®è°ƒè¿‡ç¨‹ä¸­ï¼Œ&lt;strong&gt;æ£€ç´¢å™¨å’Œè¯­è¨€æ¨¡å‹å‚æ•°åŒæ­¥è¢«æ›´æ–°&lt;/strong&gt;ï¼Œæ£€&lt;br&gt;
ç´¢å™¨å­¦ä¹ å‘è¯­è¨€æ¨¡å‹æä¾›æœ€ç›¸å…³çš„æ–‡æ¡£ï¼Œè€Œè¯­è¨€æ¨¡å‹åˆ™å­¦ä¹ å¦‚ä½•åˆ©ç”¨è¿™äº›æ–‡æ¡£æ¥&lt;br&gt;
æ”¹å–„å…¶å¯¹æŸ¥è¯¢çš„å“åº”ã€‚ä¸ºäº†ç¡®ä¿æ£€ç´¢ç»“æœä¸æ¨¡å‹æœ€æ–°çŠ¶æ€ä¿æŒåŒæ­¥ï¼ŒAtlas åŒæ ·éœ€&lt;br&gt;
è¦å®šæœŸæ›´æ–°è¯­æ–™åº“æ–‡æ¡£çš„å‘é‡ç¼–ç ï¼Œä»è€Œç»´æŒæ£€ç´¢çš„å‡†ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.6.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;624-å¯¹æ¯”ä¸åˆ†æ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#624-å¯¹æ¯”ä¸åˆ†æ&#34;&gt;#&lt;/a&gt; 6.2.4 å¯¹æ¯”ä¸åˆ†æ&lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.7.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;63-çŸ¥è¯†æ£€ç´¢&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#63-çŸ¥è¯†æ£€ç´¢&#34;&gt;#&lt;/a&gt; 6.3 çŸ¥è¯†æ£€ç´¢&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ RAG ä¸­ï¼Œæ£€ç´¢çš„æ•ˆæœï¼ˆå¬å›ç‡ã€ç²¾åº¦ã€å¤šæ ·æ€§ç­‰ï¼‰ä¼šç›´æ¥å½±å“å¤§è¯­è¨€æ¨¡å‹çš„ç”Ÿæˆè´¨é‡ã€‚æ­¤å¤–ï¼Œæ£€ç´¢çš„æ—¶é—´ä¹Ÿæ˜¯ RAG æ€»è€—æ—¶çš„å…³é”®éƒ¨åˆ†ï¼Œå› æ­¤æ£€ç´¢çš„æ•ˆç‡å°†å½±å“ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒã€‚&lt;strong&gt;ä¼˜åŒ–æ£€ç´¢è¿‡ç¨‹ï¼Œæå‡æ£€ç´¢çš„æ•ˆæœå’Œæ•ˆç‡&lt;/strong&gt;ï¼Œå¯¹æ”¹å–„ RAG çš„æ€§èƒ½å…·æœ‰é‡è¦æ„ä¹‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;631-çŸ¥è¯†åº“æ„å»º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#631-çŸ¥è¯†åº“æ„å»º&#34;&gt;#&lt;/a&gt; 6.3.1 çŸ¥è¯†åº“æ„å»º&lt;/h3&gt;
&lt;p&gt;åœ¨ RAG æ¡†æ¶ä¸­ï¼ŒçŸ¥è¯†åº“æ„å»ºä¸»è¦æ¶‰åŠ&lt;strong&gt;æ•°æ®é‡‡é›†åŠé¢„å¤„ç†&lt;/strong&gt;ä¸&lt;strong&gt;çŸ¥è¯†åº“å¢å¼º&lt;/strong&gt;ä¸¤ä¸ªæ­¥éª¤ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ•°æ®é‡‡é›†åŠé¢„å¤„ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æ„å»ºæ–‡æœ¬å‹çŸ¥è¯†åº“çš„æ•°æ®é‡‡é›†è¿‡ç¨‹ä¸­ï¼Œæ¥è‡ªä¸åŒæ¸ é“çš„æ•°æ®è¢«æ•´åˆã€è½¬æ¢ä¸ºç»Ÿä¸€çš„æ–‡æ¡£å¯¹è±¡ã€‚è¿™äº›æ–‡æ¡£å¯¹è±¡ä¸ä»…åŒ…å«&lt;strong&gt;åŸå§‹çš„æ–‡æœ¬ä¿¡æ¯&lt;/strong&gt;ï¼Œè¿˜æºå¸¦æœ‰å…³æ–‡æ¡£çš„&lt;strong&gt;å…ƒä¿¡æ¯&lt;/strong&gt;ï¼ˆMetadataï¼‰ï¼Œä¾‹å¦‚æ–‡ç« æ ‡é¢˜ï¼Œåˆ†ç±»ä¿¡æ¯ï¼Œæ—¶é—´ä¿¡æ¯ï¼Œå…³é”®è¯ç­‰ã€‚å…ƒä¿¡æ¯å¯ä»¥ç”¨äºåç»­çš„æ£€ç´¢å’Œè¿‡æ»¤ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨é‡‡é›†åˆ°ç›¸åº”çš„æ•°æ®åï¼Œè¿˜éœ€é€šè¿‡æ•°æ®é¢„å¤„ç†æ¥æå‡æ•°æ®è´¨é‡å’Œå¯ç”¨æ€§ã€‚åœ¨æ„å»ºæ–‡æœ¬å‹çŸ¥è¯†åº“æ—¶ï¼Œæ•°æ®é¢„å¤„ç†ä¸»è¦åŒ…æ‹¬&lt;strong&gt;æ•°æ®æ¸…æ´—&lt;/strong&gt;å’Œ&lt;strong&gt;æ–‡æœ¬åˆ†å—&lt;/strong&gt;ä¸¤ä¸ªè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ–‡æœ¬åˆ†å—çš„æ•ˆæœç›´æ¥å½±å“åç»­æ£€ç´¢ç»“æœçš„è´¨é‡ã€‚åˆ¶å®šåˆé€‚çš„åˆ†å—ç­–ç•¥è‡³å…³é‡è¦ï¼ŒåŒ…æ‹¬ç¡®å®šåˆ‡åˆ†æ–¹æ³•ï¼ˆå¦‚æŒ‰å¥å­æˆ–æ®µè½åˆ‡åˆ†ï¼‰ã€è®¾å®šå—å¤§å°ï¼Œä»¥åŠæ˜¯å¦å…è®¸å—ä¹‹é—´æœ‰é‡å ã€‚æ–‡æœ¬åˆ†å—çš„å…·ä½“å®æ–½æµç¨‹é€šå¸¸å¼€å§‹äº&lt;strong&gt;å°†é•¿æ–‡æœ¬æ‹†è§£ä¸ºè¾ƒå°çš„è¯­ä¹‰å•å…ƒï¼Œå¦‚å¥å­æˆ–æ®µè½&lt;/strong&gt;ã€‚éšåï¼Œ&lt;strong&gt;è¿™äº›å•å…ƒè¢«é€æ­¥ç»„åˆæˆæ›´å¤§çš„å—ï¼Œç›´åˆ°è¾¾åˆ°é¢„è®¾çš„å—å¤§å°&lt;/strong&gt;ï¼Œæ„å»ºå‡ºç‹¬ç«‹çš„æ–‡æœ¬ç‰‡æ®µã€‚ä¸ºäº†ä¿æŒè¯­ä¹‰è¿è´¯æ€§ï¼Œ&lt;strong&gt;é€šå¸¸è¿˜ä¼šåœ¨ç›¸é‚»çš„æ–‡æœ¬ç‰‡æ®µä¹‹é—´è®¾ç½®ä¸€å®šçš„é‡å åŒºåŸŸ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;çŸ¥è¯†åº“å¢å¼º&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒçŸ¥è¯†åº“å¢å¼ºæ˜¯é€šè¿‡æ”¹è¿›å’Œä¸°å¯ŒçŸ¥è¯†åº“çš„å†…å®¹å’Œç»“æ„ï¼Œä»¥æå‡å…¶è´¨é‡å’Œå®ç”¨æ€§ã€‚è¿™ä¸€è¿‡ç¨‹é€šå¸¸æ¶‰åŠ&lt;strong&gt;æŸ¥è¯¢ç”Ÿæˆ&lt;/strong&gt;ä¸&lt;strong&gt;æ ‡é¢˜ç”Ÿæˆ&lt;/strong&gt;ç­‰å¤šä¸ªæ­¥éª¤ï¼Œä»¥æ­¤ä¸ºæ–‡æ¡£å»ºç«‹è¯­ä¹‰ â€œé”šç‚¹â€ï¼Œæ–¹ä¾¿æ£€ç´¢æ—¶å‡†ç¡®å®šä½åˆ°ç›¸åº”æ–‡æœ¬ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;æŸ¥è¯¢ç”Ÿæˆ&lt;/strong&gt;æŒ‡çš„æ˜¯åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆä¸æ–‡æ¡£å†…å®¹ç´§å¯†ç›¸å…³çš„&lt;strong&gt;ä¼ªæŸ¥è¯¢&lt;/strong&gt;ã€‚è¿™äº›ä¼ªæŸ¥è¯¢ä»æŸ¥è¯¢çš„è§’åº¦æ¥è¡¨è¾¾æ–‡æ¡£çš„è¯­ä¹‰ï¼Œå¯ä»¥&lt;strong&gt;ä½œä¸ºç›¸å…³æ–‡æ¡£çš„ â€œé”®â€ï¼Œä¾›æ£€ç´¢æ—¶ä¸ç”¨æˆ·æŸ¥è¯¢è¿›è¡ŒåŒ¹é…&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;æ ‡é¢˜ç”Ÿæˆ&lt;/strong&gt;æŒ‡çš„æ˜¯åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹ä¸ºæ²¡æœ‰æ ‡é¢˜çš„æ–‡æ¡£&lt;strong&gt;ç”Ÿæˆåˆé€‚çš„æ ‡é¢˜&lt;/strong&gt;ã€‚è¿™äº›ç”Ÿæˆçš„æ ‡é¢˜æä¾›äº†æ–‡æ¡£çš„å…³é”®è¯å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œèƒ½æ¥ç”¨æ¥&lt;strong&gt;å¸®åŠ©å¿«é€Ÿç†è§£æ–‡æ¡£å†…å®¹&lt;/strong&gt;ï¼Œå¹¶åœ¨æ£€ç´¢æ—¶æ›´å‡†ç¡®åœ°å®šä½åˆ°ä¸ç”¨æˆ·æé—®ç›¸å…³çš„ä¿¡æ¯ã€‚å¯¹äºé‚£äº›åŸå§‹æ–‡æ¡£ä¸­ç¼ºä¹æ ‡é¢˜çš„æƒ…å†µï¼Œ&lt;strong&gt;é€šè¿‡è¯­è¨€æ¨¡å‹ç”Ÿæˆæ ‡é¢˜&lt;/strong&gt;æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚&lt;/p&gt;
&lt;h3 id=&#34;632-æŸ¥è¯¢å¢å¼º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#632-æŸ¥è¯¢å¢å¼º&#34;&gt;#&lt;/a&gt; 6.3.2 æŸ¥è¯¢å¢å¼º&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒçŸ¥è¯†åº“æ¶µç›–çš„çŸ¥è¯†è¡¨è¾¾å½¢å¼æ˜¯æœ‰é™çš„ï¼Œä½†ç”¨æˆ·çš„æé—®æ–¹å¼å´æ˜¯åƒäººåƒé¢çš„ã€‚è¿™å¯èƒ½å¯¼è‡´ç”¨æˆ·æŸ¥è¯¢å’ŒçŸ¥è¯†åº“ä¹‹é—´ä¸èƒ½å¾ˆå¥½åŒ¹é…ï¼Œä»è€Œé™ä½æ£€ç´¢æ•ˆæœã€‚ä¸ºäº†è§£å†³æ­¤é—®é¢˜ï¼Œå¯ä»¥&lt;strong&gt;å¯¹ç”¨æˆ·æŸ¥è¯¢çš„è¯­ä¹‰å’Œå†…å®¹è¿›è¡Œæ‰©å±•ï¼Œå³æŸ¥è¯¢å¢å¼º&lt;/strong&gt;ï¼Œä»¥æ›´å¥½çš„åŒ¹é…çŸ¥è¯†åº“ä¸­çš„æ–‡æœ¬ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æŸ¥è¯¢è¯­ä¹‰å¢å¼º&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒæŸ¥è¯¢è¯­ä¹‰å¢å¼ºæ—¨åœ¨&lt;strong&gt;é€šè¿‡åŒä¹‰æ”¹å†™å’Œå¤šè§†è§’åˆ†è§£ç­‰æ–¹æ³•æ¥æ‰©å±•ã€ä¸°å¯Œç”¨æˆ·æŸ¥è¯¢çš„è¯­ä¹‰&lt;/strong&gt;ï¼Œä»¥æé«˜æ£€ç´¢çš„å‡†ç¡®æ€§å’Œå…¨é¢æ€§ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(1) åŒä¹‰æ”¹å†™&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒåŒä¹‰æ”¹å†™é€šè¿‡&lt;strong&gt;å°†åŸå§‹æŸ¥è¯¢æ”¹å†™æˆç›¸åŒè¯­ä¹‰ä¸‹ä¸åŒçš„è¡¨è¾¾æ–¹å¼&lt;/strong&gt;ï¼Œæ¥è§£å†³ç”¨æˆ·æŸ¥&lt;br&gt;
è¯¢å•ä¸€çš„è¡¨è¾¾å½¢å¼å¯èƒ½æ— æ³•å…¨é¢è¦†ç›–åˆ°çŸ¥è¯†åº“ä¸­å¤šæ ·åŒ–è¡¨è¾¾çš„çŸ¥è¯†ã€‚&lt;strong&gt;æ”¹å†™å·¥ä½œå¯ä»¥è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹å®Œæˆ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(2) å¤šè§†è§’åˆ†è§£&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒå¤šè§†è§’åˆ†è§£é‡‡ç”¨åˆ†è€Œæ²»ä¹‹çš„æ–¹æ³•æ¥å¤„ç†å¤æ‚æŸ¥è¯¢ï¼Œ&lt;strong&gt;å°†å¤æ‚æŸ¥è¯¢åˆ†è§£ä¸ºæ¥è‡ªä¸åŒè§†è§’çš„å­æŸ¥è¯¢&lt;/strong&gt;ï¼Œä»¥æ£€ç´¢åˆ°æŸ¥è¯¢ç›¸å…³çš„ä¸åŒè§’åº¦çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æŸ¥è¯¢å†…å®¹å¢å¼º&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒæŸ¥è¯¢å†…å®¹å¢å¼ºæ—¨åœ¨é€šè¿‡&lt;strong&gt;ç”Ÿæˆä¸åŸå§‹æŸ¥è¯¢ç›¸å…³çš„èƒŒæ™¯ä¿¡æ¯å’Œä¸Šä¸‹æ–‡&lt;/strong&gt;ï¼Œä»è€Œä¸°å¯ŒæŸ¥è¯¢å†…å®¹ï¼Œæé«˜æ£€ç´¢çš„å‡†ç¡®æ€§å’Œå…¨é¢æ€§ã€‚&lt;strong&gt;ç”ŸæˆèƒŒæ™¯æ–‡æ¡£&lt;/strong&gt;æ˜¯ä¸€ç§æŸ¥è¯¢å†…å®¹å¢å¼ºçš„æ–¹æ³•ã€‚å®ƒæŒ‡çš„æ˜¯åœ¨åŸå§‹æŸ¥è¯¢çš„åŸºç¡€ä¸Šï¼Œ&lt;strong&gt;åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆä¸æŸ¥è¯¢å†…å®¹ç›¸å…³çš„èƒŒæ™¯æ–‡æ¡£&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;633-æ£€ç´¢å™¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#633-æ£€ç´¢å™¨&#34;&gt;#&lt;/a&gt; 6.3.3 æ£€ç´¢å™¨&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒç»™å®šçŸ¥è¯†åº“å’Œç”¨æˆ·æŸ¥è¯¢ï¼Œæ£€ç´¢å™¨æ—¨åœ¨æ‰¾åˆ°çŸ¥è¯†åº“ä¸­ä¸ç”¨æˆ·æŸ¥è¯¢ç›¸å…³çš„çŸ¥è¯†æ–‡æœ¬ã€‚æ£€ç´¢å™¨å¯åˆ†ä¸º&lt;strong&gt;åˆ¤åˆ«å¼æ£€ç´¢å™¨&lt;/strong&gt;å’Œ&lt;strong&gt;ç”Ÿæˆå¼æ£€ç´¢å™¨&lt;/strong&gt;ä¸¤ç±»ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ¤åˆ«å¼æ£€ç´¢å™¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒåˆ¤åˆ«å¼æ£€ç´¢å™¨&lt;strong&gt;é€šè¿‡åˆ¤åˆ«æ¨¡å‹å¯¹æŸ¥è¯¢å’Œæ–‡æ¡£æ˜¯å¦ç›¸å…³è¿›è¡Œæ‰“åˆ†&lt;/strong&gt;ã€‚åˆ¤åˆ«å¼æ£€ç´¢å™¨é€šå¸¸åˆ†ä¸ºä¸¤å¤§ç±»ï¼š&lt;strong&gt;ç¨€ç–æ£€ç´¢å™¨&lt;/strong&gt;å’Œ&lt;strong&gt;ç¨ å¯†æ£€ç´¢å™¨&lt;/strong&gt;ã€‚ç¨€ç–æ£€ç´¢å™¨åˆ©ç”¨ç¦»æ•£çš„ã€åŸºäºè¯é¢‘çš„æ–‡æ¡£ç¼–ç å‘é‡è¿›è¡Œæ£€ç´¢ï¼Œè€Œç¨ å¯†æ£€ç´¢å™¨åˆ™åˆ©ç”¨ç¥ç»ç½‘ç»œç”Ÿæˆçš„è¿ç»­çš„ã€ç¨ å¯†å‘é‡å¯¹æ–‡æ¡£è¿›è¡Œæ£€ç´¢ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(1) ç¨€ç–æ£€ç´¢å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒç¨€ç–æ£€ç´¢å™¨ï¼ˆSparseRetrieverï¼‰æ˜¯æŒ‡ä½¿ç”¨&lt;strong&gt;ç¨€ç–è¡¨ç¤ºæ–¹æ³•&lt;/strong&gt;æ¥åŒ¹é…æ–‡æœ¬çš„æ¨¡å‹ã€‚è¿™ç±»æ£€ç´¢å™¨é€šè¿‡ç»Ÿè®¡æ–‡æ¡£ä¸­ç‰¹å®šè¯é¡¹å‡ºç°çš„ç»Ÿè®¡ç‰¹å¾æ¥å¯¹æ–‡æ¡£è¿›è¡Œç¼–ç ï¼Œç„¶ååŸºäºæ­¤ç¼–ç è®¡ç®—æŸ¥è¯¢ä¸çŸ¥è¯†åº“ä¸­çš„æ–‡æ¡£çš„ç›¸ä¼¼åº¦æ¥è¿›è¡Œæ£€ç´¢ã€‚å…¸å‹çš„ç¨€ç–æ£€ç´¢æŠ€æœ¯åŒ…æ‹¬ TF-IDF å’Œ BM25 ç­‰ï¼Œå®ƒä»¬é€šè¿‡åˆ†æè¯é¡¹çš„åˆ†å¸ƒå’Œé¢‘ç‡æ¥è¯„ä¼°æ–‡æ¡£ä¸æŸ¥è¯¢çš„ç›¸å…³æ€§ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒTF-IDF åŸºäºè¯é¢‘ï¼ˆTFï¼‰å’Œé€†æ–‡æ¡£é¢‘ç‡ï¼ˆIDFï¼‰æ¥&lt;strong&gt;è¡¡é‡è¯è¯­åœ¨æ–‡æ¡£æˆ–è¯­æ–™åº“ä¸­çš„é‡è¦æ€§&lt;/strong&gt;ï¼Œç„¶åç”¨æ­¤é‡è¦æ€§å¯¹æ–‡æœ¬è¿›è¡Œç¼–ç ã€‚è¯é¢‘ï¼ˆTFï¼‰è¡¨ç¤ºè¯è¯­åœ¨æ–‡æ¡£ä¸­çš„å‡ºç°é¢‘ç‡ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathrm{tf}_{i,j}=\frac{n_{i,j}}{\sum_{k}n_{k,j}}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.980548em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathrm&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34; style=&#34;margin-right:0.07778em;&#34;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.09327em;vertical-align:-0.9857100000000001em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.1075599999999999em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mop&#34;&gt;&lt;span class=&#34;mop op-symbol small-op&#34; style=&#34;position:relative;top:-0.0000050000000000050004em;&#34;&gt;âˆ‘&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1863979999999999em;&#34;&gt;&lt;span style=&#34;top:-2.40029em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.29971000000000003em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361079999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9857100000000001em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé€†æ–‡æ¡£é¢‘ç‡ï¼ˆIDFï¼‰è¡¡é‡è¯è¯­çš„æ™®éæ€§ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;{&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;}&lt;/mo&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathrm{idf}_i=\log\frac{|D|}{|\{j:t_i\in d_j\}|}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathrm&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34; style=&#34;margin-right:0.07778em;&#34;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.399108em;vertical-align:-0.972108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;lo&lt;span style=&#34;margin-right:0.01389em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.972108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæœ€ç»ˆï¼ŒTF-IDF å€¼ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathrm{tfidf}_{i,j}=\mathrm{tf}_{i,j}\times\mathrm{idf}_i
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.980548em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathrm&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34; style=&#34;margin-right:0.07778em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34; style=&#34;margin-right:0.07778em;&#34;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.980548em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathrm&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34; style=&#34;margin-right:0.07778em;&#34;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathrm&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34; style=&#34;margin-right:0.07778em;&#34;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒTF-IDF é€šè¿‡é«˜è¯é¢‘å’Œä½æ–‡æ¡£é¢‘ç‡äº§ç”Ÿé«˜æƒé‡ï¼Œå€¾å‘äºè¿‡æ»¤å¸¸è§è¯è¯­ï¼Œä¿ç•™é‡è¦è¯è¯­ã€‚BM25 æ˜¯ä¸€ç§æ”¹è¿›çš„æ–‡æœ¬æ£€ç´¢ç®—æ³•ï¼Œå®ƒåœ¨ TF-IDF åŸºç¡€ä¸Šé€šè¿‡æ–‡æ¡£é•¿åº¦å½’ä¸€åŒ–å’Œè¯é¡¹é¥±å’Œåº¦è°ƒæ•´ï¼Œæ›´ç²¾ç¡®åœ°è¯„ä¼°è¯é¡¹é‡è¦æ€§ï¼Œä¼˜åŒ–äº†è¯é¢‘å’Œé€†æ–‡æ¡£é¢‘ç‡çš„è®¡ç®—ï¼Œå¹¶è€ƒè™‘äº†æ–‡æ¡£é•¿åº¦å¯¹è¯„åˆ†çš„å½±å“ã€‚è™½ç„¶ä¸æ¶‰åŠè¯é¡¹ä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯ BM25 åœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®æ—¶è¡¨ç°ä¼˜å¼‚ï¼Œå¹¿æ³›åº”ç”¨äºæœç´¢å¼•æ“å’Œä¿¡æ¯æ£€ç´¢ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(2) ç¨ å¯†æ£€ç´¢å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒç¨ å¯†æ£€ç´¢å™¨ä¸€èˆ¬&lt;strong&gt;åˆ©ç”¨é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹å¯¹æ–‡æœ¬ç”Ÿæˆä½ç»´ã€å¯†é›†çš„å‘é‡è¡¨ç¤º&lt;/strong&gt;ï¼Œé€š&lt;br&gt;
è¿‡è®¡ç®—å‘é‡é—´çš„ç›¸ä¼¼åº¦è¿›è¡Œæ£€ç´¢ã€‚æŒ‰ç…§æ‰€ä½¿ç”¨çš„æ¨¡å‹ç»“æ„çš„ä¸åŒï¼Œç¨ å¯†æ£€ç´¢å™¨å¤§&lt;br&gt;
è‡´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š&lt;strong&gt;äº¤å‰ç¼–ç ç±»&lt;/strong&gt;ï¼ˆCross-Encoderï¼‰ã€&lt;strong&gt;åŒç¼–ç å™¨ç±»&lt;/strong&gt;ï¼ˆBi-Encoderï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.8.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒäº¤å‰ç¼–ç ç±» â€œ&lt;strong&gt;ç«¯åˆ°ç«¯&lt;/strong&gt;â€ çš„ç»™å‡ºæŸ¥è¯¢å’Œæ–‡æ¡£çš„ç›¸ä¼¼åº¦ã€‚&lt;strong&gt;è¿™ç±»æ¨¡å‹å°†æŸ¥è¯¢å’Œæ–‡æ¡£æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œéšååˆ©ç”¨é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ä½œä¸ºç¼–ç å™¨ï¼ˆä¾‹å¦‚ BERTï¼‰ç”Ÿæˆä¸€ä¸ªå‘é‡è¡¨ç¤ºã€‚æ¥ç€ï¼Œé€šè¿‡ä¸€ä¸ªåˆ†ç±»å™¨å¤„ç†è¿™ä¸ªå‘é‡ï¼Œæœ€ç»ˆè¾“å‡ºä¸€ä¸ªä»‹äº 0 å’Œ 1 ä¹‹é—´çš„æ•°å€¼ï¼Œè¡¨ç¤ºè¾“å…¥çš„æŸ¥è¯¢å’Œæ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦&lt;/strong&gt;ã€‚å…¶ä¼˜ç‚¹åœ¨äºæ¨¡å‹ç»“æ„ç®€å•ï¼Œèƒ½å¤Ÿå®ç°æŸ¥è¯¢å’Œæ–‡æ¡£ä¹‹é—´çš„æ·±åº¦äº¤äº’ã€‚ç„¶è€Œï¼Œç”±äº&lt;strong&gt;äº¤å‰ç¼–ç ç±»æ¨¡å‹éœ€è¦è¿›è¡Œé«˜å¤æ‚åº¦çš„äº¤å‰æ³¨æ„åŠ›æ“ä½œï¼Œè®¡ç®—é‡å¤§ï¼Œå› æ­¤ä¸é€‚åˆåœ¨å¤§è§„æ¨¡æ£€ç´¢é˜¶æ®µä½¿ç”¨&lt;/strong&gt;ã€‚è¿™ç§æ¨¡å‹æ›´é€‚ç”¨äºå¯¹å°‘é‡å€™é€‰æ–‡æ¡£è¿›è¡Œæ›´ç²¾ç¡®æ’åºçš„é˜¶æ®µï¼Œå¯ä»¥æ˜¾è‘—æå‡æ£€ç´¢ç»“æœçš„ç›¸å…³æ€§ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåŒç¼–ç ç±»æ¨¡å‹é‡‡ç”¨äº†ä¸€ç§ â€œä¸¤æ­¥èµ°â€ çš„ç­–ç•¥ã€‚ç¬¬ä¸€æ­¥ï¼ŒæŸ¥è¯¢å’Œæ–‡æ¡£é¦–å…ˆå„è‡ªé€šè¿‡ç‹¬ç«‹çš„ç¼–ç å™¨ç”Ÿæˆå„è‡ªçš„å‘é‡è¡¨ç¤ºï¼›ç¬¬äºŒæ­¥ï¼Œå¯¹è¿™ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦è¿›è¡Œè®¡ç®—ï¼Œä»¥è¯„ä¼°å®ƒä»¬çš„ç›¸å…³æ€§ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºï¼Œå®ƒ&lt;strong&gt;å…è®¸é¢„å…ˆç¦»çº¿è®¡ç®—å¹¶å­˜å‚¨æ‰€æœ‰æ–‡æ¡£çš„å‘é‡è¡¨ç¤ºï¼Œåœ¨çº¿æ£€ç´¢æ—¶åˆ™å¯ç›´æ¥è¿›è¡Œå‘é‡åŒ¹é…&lt;/strong&gt;ã€‚å› æ­¤ï¼ŒåŒç¼–ç å™¨éå¸¸é€‚åˆåœ¨å·¥ä¸šç¯å¢ƒä¸­éƒ¨ç½²ï¼Œå…·æœ‰æé«˜çš„åŒ¹é…æ•ˆç‡ã€‚ç„¶è€Œï¼Œåœ¨è¿™ç§åˆ†ç¦»çš„å¤„ç†æ–¹å¼ä¸­ï¼ŒæŸ¥è¯¢ä¸æ–‡æ¡£åœ¨æå–ç‰¹å¾å‘é‡æ—¶ç¼ºä¹äº¤äº’ã€‚è¿™å¯èƒ½ä¼šå¯¹åŒ¹é…çš„ç²¾ç¡®åº¦äº§ç”Ÿå½±å“ã€‚ä¸ºäº†ç¼“è§£æŸ¥è¯¢ä¸æ–‡æ¡£åœ¨æå–ç‰¹å¾å‘é‡æ—¶ç¼ºä¹äº¤äº’çš„é—®é¢˜ï¼Œå¯ä»¥åœ¨åŒç¼–ç å™¨çš„åŸºç¡€ä¸Šå¼•å…¥æŸ¥è¯¢ä¸æ–‡æ¡£çš„äº¤äº’ï¼Œé€šè¿‡&lt;strong&gt;å¯¹æ¯”å­¦ä¹ &lt;/strong&gt;å¯¹åŒç¼–ç å™¨è¿›è¡Œå¾®è°ƒï¼Œä»¥&lt;strong&gt;ä½¿åŒç¼–ç å™¨ç¼–ç çš„ç‰¹å¾å‘é‡å¯ä»¥å…¼é¡¾æŸ¥è¯¢å’Œæ–‡æ¡£&lt;/strong&gt;ï¼Œä»¥è¿›ä¸€æ­¥æå‡åŒç¼–ç å™¨çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ç”Ÿæˆå¼æ£€ç´¢å™¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;ç”Ÿæˆå¼æ£€ç´¢å™¨é€šè¿‡ç”Ÿæˆæ¨¡å‹å¯¹è¾“å…¥æŸ¥è¯¢ç›´æ¥ç”Ÿæˆç›¸å…³æ–‡æ¡£çš„æ ‡è¯†ç¬¦&lt;/strong&gt;ã€‚ç”Ÿæˆå¼æ£€ç´¢å™¨é€šå¸¸é‡‡ç”¨åŸºäº Encoder-Decoder æ¶æ„çš„ç”Ÿæˆæ¨¡å‹ï¼Œå¦‚ T5ã€BART ç­‰ã€‚ç”Ÿæˆå¼æ£€ç´¢å™¨çš„è®­ç»ƒè¿‡ç¨‹é€šå¸¸åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µã€‚åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œæ¨¡å‹é€šè¿‡åºåˆ—åˆ°åºåˆ—çš„å­¦ä¹ æ–¹æ³•ï¼Œ&lt;strong&gt;å­¦ä¹ å¦‚ä½•å°†æŸ¥è¯¢æ˜ å°„åˆ°ç›¸å…³çš„æ–‡æ¡£æ ‡è¯†ç¬¦&lt;/strong&gt;ã€‚è¿™ä¸€é˜¶æ®µä¸»è¦é€šè¿‡æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆMLEï¼‰æ¥ä¼˜åŒ–æ¨¡å‹ï¼Œç¡®ä¿ç”Ÿæˆçš„æ–‡æ¡£æ ‡è¯†ç¬¦å°½å¯èƒ½å‡†ç¡®ã€‚åœ¨ç¬¬äºŒé˜¶æ®µï¼Œ&lt;strong&gt;é€šè¿‡æ•°æ®å¢å¼ºå’Œæ’åä¼˜åŒ–è¿›ä¸€æ­¥æé«˜æ£€ç´¢æ•ˆç‡å’Œå‡†ç¡®æ€§&lt;/strong&gt;ã€‚æ•°æ®å¢å¼ºä¸»è¦é€šè¿‡ç”Ÿæˆä¼ªæŸ¥è¯¢æˆ–ä½¿ç”¨æ–‡æ¡£ç‰‡æ®µä½œä¸ºæŸ¥è¯¢è¾“å…¥ï¼Œä»¥å¢åŠ è®­ç»ƒæ•°æ®çš„å¤šæ ·æ€§å’Œè¦†ç›–é¢ã€‚æ’åä¼˜åŒ–åˆ™æ¶‰åŠä½¿ç”¨ç‰¹å®šçš„æŸå¤±å‡½æ•°ï¼Œå¦‚å¯¹æ¯”æŸå¤±æˆ–æ’åæŸå¤±ï¼Œæ¥è°ƒæ•´æ¨¡å‹ç”Ÿæˆæ–‡æ¡£æ ‡è¯†ç¬¦çš„é¡ºåºå’Œç›¸å…³æ€§ï¼Œä»è€Œæ›´å¥½åœ°åŒ¹é…æŸ¥è¯¢çš„éœ€æ±‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ç”Ÿæˆå¼æ£€ç´¢å™¨ä¸­ï¼Œ&lt;strong&gt;DocID çš„è®¾è®¡è‡³å…³é‡è¦ã€‚å…¶éœ€è¦åœ¨è¯­ä¹‰ä¿¡æ¯çš„ä¸°å¯Œæ€§ä¸æ ‡è¯†ç¬¦çš„ç®€æ´æ€§ä¹‹é—´å–å¾—å¹³è¡¡&lt;/strong&gt;ã€‚å¸¸ç”¨çš„ DocID å½¢å¼åˆ†ä¸ºä¸¤ç±»ï¼šåŸºäºæ•°å­—çš„ DocID å’ŒåŸºäºè¯çš„ DocIDã€‚åŸºäºæ•°å­—çš„ DocID æ–¹æ³•ä½¿ç”¨å”¯ä¸€çš„æ•°å­—å€¼æˆ–æ•´æ•°å­—ç¬¦ä¸²æ¥è¡¨ç¤ºæ–‡æ¡£ï¼Œè™½ç„¶æ„å»ºç®€å•ï¼Œä½†åœ¨å¤„ç†å¤§é‡æ–‡æ¡£æ—¶å¯èƒ½å¯¼è‡´æ ‡è¯†ç¬¦æ•°é‡æ¿€å¢ï¼Œå¢åŠ è®¡ç®—å’Œå­˜å‚¨è´Ÿæ‹…ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒåŸºäºè¯çš„ DocID æ–¹æ³•ç›´æ¥ä»æ–‡æ¡£çš„æ ‡é¢˜ã€URL æˆ– N-gram ä¸­æå–è¡¨ç¤ºï¼Œèƒ½æ›´è‡ªç„¶åœ°ä¼ è¾¾æ–‡æ¡£çš„è¯­ä¹‰ä¿¡æ¯ã€‚é€šå¸¸ï¼Œæ ‡é¢˜æ˜¯æœ€ä½³é€‰æ‹©ï¼Œå› ä¸ºå®ƒæä¾›äº†æ–‡æ¡£çš„å®è§‚æ¦‚è¿°ã€‚ä½†åœ¨ç¼ºä¹é«˜è´¨é‡æ ‡é¢˜æ—¶ï¼ŒURL æˆ– N-gram ä¹Ÿå¯ä½œä¸ºæœ‰æ•ˆçš„æ›¿ä»£æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå°½ç®¡ç”Ÿæˆå¼æ£€ç´¢å™¨åœ¨æ€§èƒ½ä¸Šå–å¾—äº†ä¸€å®šçš„è¿›æ­¥ï¼Œä½†ä¸ç¨ å¯†æ£€ç´¢å™¨ç›¸æ¯”ï¼Œå…¶æ•ˆæœä»ç¨é€Šä¸€ç­¹ã€‚æ­¤å¤–ï¼Œç”Ÿæˆå¼æ£€ç´¢å™¨è¿˜é¢ä¸´ç€ä¸€ç³»åˆ—æŒ‘æˆ˜ï¼ŒåŒ…æ‹¬å¦‚ä½•çªç ´æ¨¡å‹è¾“å…¥é•¿åº¦çš„é™åˆ¶ã€å¦‚ä½•æœ‰æ•ˆå¤„ç†å¤§è§„æ¨¡æ–‡æ¡£ä»¥åŠåŠ¨æ€æ–°å¢æ–‡æ¡£çš„è¡¨ç¤ºå­¦ä¹ ç­‰ï¼Œè¿™äº›éƒ½æ˜¯äºŸå¾…è§£å†³çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;634-æ£€ç´¢æ•ˆç‡å¢å¼º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#634-æ£€ç´¢æ•ˆç‡å¢å¼º&#34;&gt;#&lt;/a&gt; 6.3.4 æ£€ç´¢æ•ˆç‡å¢å¼º&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒçŸ¥è¯†åº“ä¸­é€šå¸¸åŒ…å«æµ·é‡çš„æ–‡æœ¬ï¼Œå¯¹çŸ¥è¯†åº“ä¸­æ–‡æœ¬è¿›è¡Œé€ä¸€æ£€ç´¢ç¼“æ…¢è€Œä½æ•ˆã€‚ä¸ºæå‡æ£€ç´¢æ•ˆç‡ï¼Œå¯ä»¥å¼•å…¥&lt;strong&gt;å‘é‡æ•°æ®åº“&lt;/strong&gt;æ¥å®ç°æ£€ç´¢ä¸­çš„é«˜æ•ˆå‘é‡å­˜å‚¨å’ŒæŸ¥è¯¢ã€‚å‘é‡æ•°æ®åº“çš„æ ¸å¿ƒæ˜¯è®¾è®¡é«˜æ•ˆçš„ç›¸ä¼¼åº¦ç´¢å¼•ç®—æ³•ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç›¸ä¼¼åº¦ç´¢å¼•ç®—æ³•&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨å‘é‡æ£€ç´¢ä¸­ï¼Œå¸¸ç”¨çš„ç´¢å¼•æŠ€æœ¯ä¸»è¦åˆ†æˆä¸‰å¤§ç±»ï¼š&lt;strong&gt;åŸºäºç©ºé—´åˆ’åˆ†çš„æ–¹æ³•&lt;/strong&gt;ã€&lt;strong&gt;åŸºäºé‡åŒ–æ–¹æ³•&lt;/strong&gt;å’Œ&lt;strong&gt;åŸºäºå›¾çš„æ–¹æ³•&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;åŸºäºç©ºé—´åˆ’åˆ†çš„æ–¹æ³•&lt;/strong&gt;å°†æœç´¢ç©ºé—´åˆ’åˆ†ä¸ºå¤šä¸ªåŒºåŸŸæ¥å®ç°ç´¢å¼•ï¼Œä¸»è¦åŒ…æ‹¬&lt;strong&gt;åŸºäºæ ‘çš„ç´¢å¼•æ–¹æ³•&lt;/strong&gt;å’Œ&lt;strong&gt;åŸºäºå“ˆå¸Œçš„æ–¹æ³•&lt;/strong&gt;ä¸¤ç±»ã€‚å…¶ä¸­ï¼ŒåŸºäºæ ‘çš„ç´¢å¼•æ–¹æ³•é€šè¿‡ä¸€ç³»åˆ—è§„åˆ™é€’å½’åœ°åˆ’åˆ†ç©ºé—´ï¼Œå½¢æˆä¸€ç§æ ‘çŠ¶ç»“æ„ï¼Œæ¯ä¸ªå¶èŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªè¾ƒå°åŒºåŸŸï¼ŒåŒºåŸŸå†…çš„æ•°æ®ç‚¹å½¼æ­¤æ¥è¿‘ã€‚åœ¨æŸ¥è¯¢æ—¶ï¼Œ&lt;strong&gt;ç®—æ³•ä»æ ‘çš„æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œé€æ­¥æ·±å…¥åˆ°åˆé€‚çš„å¶èŠ‚ç‚¹ï¼Œæœ€ååœ¨å¶èŠ‚ç‚¹å†…éƒ¨è¿›è¡Œæ•°æ®ç‚¹çš„ç›¸ä¼¼åº¦æ¯”è¾ƒï¼Œä»¥æ‰¾åˆ°æœ€è¿‘çš„å‘é‡&lt;/strong&gt;ã€‚å¸¸è§çš„åŸºäºæ ‘çš„ç´¢å¼•åŒ…æ‹¬ KD æ ‘ [4] å’Œ Ball æ ‘ [13] ç­‰ã€‚è€ŒåŸºäºå“ˆå¸Œçš„æ–¹æ³•ï¼ˆå¦‚å±€éƒ¨æ•æ„Ÿå“ˆå¸Œï¼ˆLSHï¼‰[11]ï¼‰&lt;strong&gt;é€šè¿‡å“ˆå¸Œå‡½æ•°å°†å‘é‡æ˜ å°„åˆ°å“ˆå¸Œè¡¨çš„ä¸åŒæ¡¶ä¸­ï¼Œä½¿å¾—ç›¸ä¼¼å‘é‡é€šå¸¸ä½äºåŒä¸€æ¡¶å†…&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;åŸºäºå›¾çš„æ–¹æ³•&lt;/strong&gt;é€šè¿‡æ„å»ºä¸€ä¸ªé‚»è¿‘å›¾ï¼Œå°†å‘é‡æ£€ç´¢è½¬åŒ–ä¸ºå›¾çš„éå†é—®é¢˜ã€‚è¿™ç±»æ–¹æ³•åœ¨ç´¢å¼•æ„å»ºé˜¶æ®µï¼Œå°†æ•°æ®é›†ä¸­çš„æ¯ä¸ªå‘é‡è¡¨ç¤ºä¸ºå›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶æ ¹æ®å‘é‡é—´çš„è·ç¦»æˆ–ç›¸ä¼¼æ€§å»ºç«‹è¾¹çš„è¿æ¥ã€‚ä¸åŒçš„å›¾ç´¢å¼•ç»“æ„ä¸»è¦ä½“ç°åœ¨å…¶ç‹¬ç‰¹çš„èµ‹è¾¹ç­–ç•¥ä¸Šã€‚ç´¢å¼•æ„å»ºçš„æ ¸å¿ƒæ€æƒ³æºäºå°ä¸–ç•Œç½‘ç»œæ¨¡å‹ï¼Œæ—¨åœ¨åˆ›å»ºä¸€ä¸ªç»“æ„ï¼Œä½¿å¾—ä»ä»»æ„å…¥å£ç‚¹å‡ºå‘ï¼Œèƒ½åœ¨è¾ƒå°‘æ­¥æ•°å†…åˆ°è¾¾æŸ¥è¯¢ç‚¹çš„æœ€è¿‘é‚»ã€‚è¿™ç§ç»“æ„å…è®¸åœ¨æœç´¢æ—¶ä½¿ç”¨è´ªå©ªç®—æ³•ï¼Œé€æ­¥é€¼è¿‘ç›®æ ‡ã€‚ç„¶è€Œï¼Œå›¾ç´¢å¼•è®¾è®¡é¢ä¸´ç¨€ç–æ€§å’Œç¨ å¯†æ€§çš„æƒè¡¡ï¼šè¾ƒç¨€ç–çš„å›¾ç»“æ„æ¯æ­¥è®¡ç®—ä»£ä»·ä½ï¼Œè€Œè¾ƒç¨ å¯†çš„å›¾åˆ™å¯èƒ½ç¼©çŸ­æœç´¢è·¯å¾„ã€‚åŸºäºå›¾çš„ä»£è¡¨æ€§æ–¹æ³•æœ‰ NSW [32]ã€IPNSW [37] å’Œ HNSW [31] ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;åŸºäºä¹˜ç§¯é‡åŒ–çš„æ–¹æ³•&lt;/strong&gt;é€šè¿‡å°†é«˜ç»´å‘é‡ç©ºé—´åˆ’åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼Œå¹¶åœ¨æ¯ä¸ªå­ç©ºé—´ä¸­è¿›è¡Œèšç±»å¾—åˆ°ç æœ¬å’Œç å­—ï¼Œä»¥æ­¤ä½œä¸ºæ„å»ºç´¢å¼•çš„åŸºç¡€ [18]ã€‚è¿™ç±»æ–¹æ³•ä¸»è¦åŒ…æ‹¬è®­ç»ƒå’ŒæŸ¥è¯¢ä¸¤ä¸ªé˜¶æ®µã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œè¯¥æ–¹æ³•å­¦ä¹ å¦‚ä½•å°†é«˜ç»´å‘é‡æœ€ä¼˜åœ°é‡åŒ–ä¸ºç å­— ID åºåˆ—ã€‚é€šå¸¸è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠå°†åŸå§‹ç©ºé—´åˆ’åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼Œåœ¨æ¯ä¸ªå­ç©ºé—´å†…è¿›è¡Œèšç±»ï¼Œå¹¶é€šè¿‡èšç±»ä¸­å¿ƒå¾—åˆ°ç å­—å’Œç æœ¬ã€‚æ¯ä¸ªå­ç©ºé—´å†…çš„èšç±»ä¸­å¿ƒç‚¹å³ä¸ºç å­—ï¼Œæ‰€æœ‰ç å­—çš„é›†åˆæ„æˆç æœ¬ã€‚æ¯ä¸ªè®­ç»ƒæ ·æœ¬çš„æ¯ä¸ªå­å‘é‡å¯ä»¥éƒ½ç”¨ç›¸åº”å­ç©ºé—´çš„ç å­—æ¥è¿‘ä¼¼ï¼Œè¿™æ ·å°±å®ç°äº†ç å­— ID åºåˆ—æ¥è¡¨ç¤ºè®­ç»ƒæ ·æœ¬ï¼Œè¾¾åˆ°äº†æ•°æ®é‡åŒ–çš„ç›®çš„ã€‚åœ¨æŸ¥è¯¢é˜¶æ®µï¼Œç³»ç»ŸåŒæ ·å°†æŸ¥è¯¢å‘é‡åˆ’åˆ†ä¸ºå­å‘é‡ï¼Œå¹¶åœ¨æ¯ä¸ªå­ç©ºé—´ä¸­æ‰¾åˆ°æœ€è¿‘çš„ç å­—ï¼Œå¾—åˆ°ç å­— ID åºåˆ—ã€‚éšåï¼Œç³»ç»Ÿè®¡ç®—æŸ¥è¯¢å‘é‡çš„æ¯ä¸ªå­å‘é‡åˆ°æ‰€æœ‰å¯¹åº”å­ç©ºé—´çš„ç å­—çš„è·ç¦»ï¼Œå½¢æˆè·ç¦»è¡¨ã€‚æœ€åï¼Œç³»ç»Ÿåˆ©ç”¨è¿™ä¸ªè·ç¦»è¡¨å’Œæ•°æ®åº“ä¸­æ¯ä¸ªå‘é‡çš„ç å­— ID åºåˆ—ï¼Œå¿«é€ŸæŸ¥æ‰¾å¹¶ç´¯åŠ å„ä¸ªå­å‘é‡çš„å¯¹åº”è·ç¦»ï¼Œå¾—åˆ°æŸ¥è¯¢å‘é‡ä¸æ•°æ®åº“å‘é‡ä¹‹é—´çš„è¿‘ä¼¼è·ç¦»ã€‚é€šè¿‡å¯¹è¿™äº›è·ç¦»è¿›è¡Œæ’åºï¼Œç³»ç»Ÿæœ€ç»ˆå¾—åˆ°æœ€è¿‘é‚»ç»“æœã€‚è¯¥æ–¹æ³•åœ¨å‡å°‘å†…å­˜å ç”¨å’ŒåŠ å¿«è·ç¦»è®¡ç®—é€Ÿåº¦æ–¹é¢è¡¨ç°å‡ºè‰²ï¼Œä½†é‡åŒ–è¿‡ç¨‹ä¸­ä¼šä¸å¯é¿å…åœ°ä¼šå¼•å…¥ä¸€äº›è¯¯å·®ã€‚åœ¨æŸäº›éœ€è¦ç²¾åº¦æ›´é«˜çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ PQ çš„åŸºç¡€ä¸Šè¿›ä¸€æ­¥è¿›è¡Œç²¾ç¡®æ’åºï¼Œä»¥å¾—åˆ°ç²¾ç¡®çš„æœ€è¿‘é‚»ç»“æœã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å¸¸è§è½¯ä»¶åº“ä»‹ç»&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‘é‡æ•°æ®åº“&lt;/th&gt;
&lt;th&gt;URL&lt;/th&gt;
&lt;th&gt;GitHub Star&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;milvus&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL21pbHZ1cy1pby9taWx2dXM=&#34;&gt;https://github.com/milvus-io/milvus&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;28.4K&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;typesense&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3R5cGVzZW5zZS90eXBlc2Vuc2U=&#34;&gt;https://github.com/typesense/typesense&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;19.0K&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;qdrant&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3FkcmFudC9xZHJhbnQ=&#34;&gt;https://github.com/qdrant/qdrant&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;18.9K&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;chroma&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2Nocm9tYS1jb3JlL2Nocm9tYQ==&#34;&gt;https://github.com/chroma-core/chroma&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;13.7K&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;weaviate&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3dlYXZpYXRlL3dlYXZpYXRl&#34;&gt;https://github.com/weaviate/weaviate&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;10.4K&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;pinecone&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cucGluZWNvbmUuaW8v&#34;&gt;https://www.pinecone.io/&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;Ã—&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;635-æ£€ç´¢ç»“æœé‡æ’&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#635-æ£€ç´¢ç»“æœé‡æ’&#34;&gt;#&lt;/a&gt; 6.3.5 æ£€ç´¢ç»“æœé‡æ’&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒæ£€ç´¢å™¨å¯èƒ½æ£€ç´¢åˆ°ä¸æŸ¥è¯¢ç›¸å…³æ€§ä¸é«˜çš„æ–‡æ¡£ã€‚è¿™äº›æ–‡æ¡£å¦‚æœç›´æ¥è¾“å…¥ç»™å¤§è¯­è¨€æ¨¡å‹ï¼Œå¯èƒ½ä¼šå¼•å‘ç”Ÿæˆè´¨é‡çš„ä¸‹é™ã€‚ä¸ºæ­¤ï¼Œåœ¨å°†å…¶è¾“å…¥ç»™å¤§è¯­è¨€æ¨¡å‹ä¹‹å‰ï¼Œ&lt;strong&gt;è¿˜éœ€è¦å¯¹å…¶è¿›è¡Œè¿›ä¸€æ­¥çš„ç²¾é€‰ã€‚ç²¾é€‰çš„ä¸»è¦é€”å¾„æ˜¯å¯¹æ£€ç´¢åˆ°çš„æ–‡æ¡£è¿›è¡Œé‡æ–°æ’åºï¼Œç®€ç§°é‡æ’&lt;/strong&gt;ï¼Œç„¶åä»ä¸­é€‰æ‹©å‡ºæ’åºé å‰çš„æ–‡æ¡£ã€‚é‡æ’æ–¹æ³•ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼š&lt;strong&gt;åŸºäºäº¤å‰ç¼–ç çš„æ–¹æ³•&lt;/strong&gt;å’Œ&lt;strong&gt;åŸºäºä¸Šä¸‹æ–‡å­¦ä¹ çš„æ–¹æ³•&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;åŸºäºäº¤å‰ç¼–ç çš„é‡æ’æ–¹æ³•åˆ©ç”¨&lt;strong&gt;äº¤å‰ç¼–ç å™¨&lt;/strong&gt;ï¼ˆCross-Encodersï¼‰æ¥è¯„ä¼°æ–‡æ¡£ä¸æŸ¥è¯¢ä¹‹é—´çš„è¯­ä¹‰ç›¸å…³æ€§ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŸºäºä¸Šä¸‹æ–‡å­¦ä¹ çš„é‡æ’æ–¹æ³•æ˜¯æŒ‡&lt;strong&gt;é€šè¿‡è®¾è®¡ç²¾å·§çš„ Promptï¼Œä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹æ¥æ‰§è¡Œé‡æ’ä»»åŠ¡&lt;/strong&gt;ã€‚è¿™ç§æ–¹æ³•å¯ä»¥åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹ä¼˜è‰¯çš„æ·±å±‚è¯­ä¹‰ç†è§£èƒ½åŠ›ï¼Œä»è€Œå–å¾—äº†è‰¯å¥½çš„è¡¨ç°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;64-ç”Ÿæˆå¢å¼º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#64-ç”Ÿæˆå¢å¼º&#34;&gt;#&lt;/a&gt; 6.4 ç”Ÿæˆå¢å¼º&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒæ£€ç´¢å™¨å¾—åˆ°ç›¸å…³ä¿¡æ¯åï¼Œå°†å…¶ä¼ é€’ç»™å¤§è¯­è¨€æ¨¡å‹ä»¥æœŸå¢å¼ºæ¨¡å‹çš„ç”Ÿæˆèƒ½åŠ›ã€‚åˆ©ç”¨è¿™äº›ä¿¡æ¯è¿›è¡Œç”Ÿæˆå¢å¼ºæ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œä¸åŒçš„æ–¹å¼ä¼šæ˜¾è‘—å½±å“ RAG çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;641-ä½•æ—¶å¢å¼º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#641-ä½•æ—¶å¢å¼º&#34;&gt;#&lt;/a&gt; 6.4.1 ä½•æ—¶å¢å¼º&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒå¤§è¯­è¨€æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æŒæ¡äº†å¤§é‡çŸ¥è¯†ï¼Œè¿™äº›çŸ¥è¯†è¢«ç§°ä¸º&lt;strong&gt;å†…éƒ¨çŸ¥è¯†&lt;/strong&gt;ï¼ˆSelf Knowledgeï¼‰ã€‚åˆ¤æ–­æ˜¯å¦éœ€è¦å¢å¼ºçš„æ ¸å¿ƒåœ¨äº&lt;strong&gt;åˆ¤æ–­å¤§è¯­è¨€æ¨¡å‹æ˜¯å¦å…·æœ‰å†…éƒ¨çŸ¥è¯†&lt;/strong&gt;ã€‚åˆ¤æ–­æ¨¡å‹æ˜¯å¦å…·æœ‰å†…éƒ¨çŸ¥è¯†çš„æ–¹æ³•å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šï¼ˆ1ï¼‰&lt;strong&gt;å¤–éƒ¨è§‚æµ‹æ³•&lt;/strong&gt;ï¼Œé€šè¿‡ Prompt ç›´æ¥è¯¢é—®æ¨¡å‹æ˜¯å¦å…·å¤‡å†…éƒ¨çŸ¥è¯†ï¼Œæˆ–åº”ç”¨ç»Ÿè®¡æ–¹æ³•å¯¹æ˜¯å¦å…·å¤‡å†…éƒ¨çŸ¥è¯†è¿›è¡Œä¼°è®¡ï¼Œè¿™ç§æ–¹æ³•æ— éœ€æ„ŸçŸ¥æ¨¡å‹å‚æ•°ï¼›ï¼ˆ2ï¼‰&lt;strong&gt;å†…éƒ¨è§‚æµ‹æ³•&lt;/strong&gt;ï¼Œé€šè¿‡æ£€æµ‹æ¨¡å‹å†…éƒ¨ç¥ç»å…ƒçš„çŠ¶æ€ä¿¡æ¯æ¥åˆ¤æ–­æ¨¡å‹æ˜¯å¦å­˜åœ¨å†…éƒ¨çŸ¥è¯†ï¼Œè¿™ç§æ–¹æ³•éœ€è¦å¯¹æ¨¡å‹å‚æ•°è¿›è¡Œä¾µå…¥å¼çš„æ¢æµ‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¤–éƒ¨è§‚æµ‹æ³•&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äºå¤§è¯­è¨€æ¨¡å‹ï¼Œå¯ä»¥é€šè¿‡ä¸¤ç§é—®è¯¢çš„æ–¹å¼æ¥åˆ¤æ–­å¤§è¯­è¨€æ¨¡å‹æ˜¯å¦å…·å¤‡ç›¸åº”çš„å†…éƒ¨çŸ¥è¯†ï¼šï¼ˆ1ï¼‰&lt;strong&gt;Prompt ç›´æ¥è¯¢é—®å¤§è¯­è¨€æ¨¡å‹æ˜¯å¦å«æœ‰ç›¸åº”çš„å†…éƒ¨çŸ¥è¯†&lt;/strong&gt;ï¼›ï¼ˆ2ï¼‰&lt;strong&gt;åå¤è¯¢é—®å¤§è¯­è¨€æ¨¡å‹åŒä¸€ä¸ªé—®é¢˜è§‚å¯Ÿæ¨¡å‹å¤šæ¬¡å›ç­”çš„ä¸€è‡´æ€§&lt;/strong&gt;ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç¿»çœ‹å¤§è¯­è¨€æ¨¡å‹çš„ â€œæ•™è‚²ç»å†â€ï¼Œå³&lt;strong&gt;é€šè¿‡è®­ç»ƒæ•°æ®æ¥åˆ¤æ–­å…¶æ˜¯å¦å…·å¤‡å†…éƒ¨çŸ¥è¯†&lt;/strong&gt;ã€‚ä½†æ˜¯ï¼Œè®¸å¤šå¤§è¯­è¨€æ¨¡å‹çš„è®­ç»ƒæ•°æ®å¹¶æœªå…¬å¼€ï¼Œæ— æ³•ç›´æ¥è§‚æµ‹å®ƒä»¬çš„è®­ç»ƒæ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡&lt;strong&gt;è®¾è®¡ä¼ªè®­ç»ƒæ•°æ®ç»Ÿè®¡é‡æ¥æ‹ŸåˆçœŸå®è®­ç»ƒæ•°æ®çš„åˆ†å¸ƒ&lt;/strong&gt;ï¼Œä»è€Œé—´æ¥è¯„ä¼°æ¨¡å‹å¯¹ç‰¹å®šçŸ¥è¯†çš„å­¦ä¹ æƒ…å†µã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å†…éƒ¨è§‚æµ‹æ³•&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒç”±äºæ¨¡å‹çš„å†…éƒ¨çŸ¥è¯†æ£€ç´¢ä¸»è¦å‘ç”Ÿåœ¨ä¸­é—´å±‚çš„å‰é¦ˆç½‘ç»œä¸­ï¼Œå› æ­¤åœ¨å¤„ç†åŒ…å«æˆ–ä¸åŒ…å«å†…éƒ¨çŸ¥è¯†çš„ä¸åŒé—®é¢˜æ—¶ï¼Œ&lt;strong&gt;æ¨¡å‹çš„ä¸­é—´å±‚ä¼šå±•ç°å‡ºä¸åŒçš„åŠ¨æ€å˜åŒ–&lt;/strong&gt;ã€‚åŸºäºè¿™ä¸€ç‰¹æ€§ï¼Œå¯ä»¥è®­ç»ƒåˆ†ç±»å™¨è¿›è¡Œåˆ¤åˆ«ï¼Œè¿™ç§æ–¹æ³•è¢«ç§°ä¸º&lt;strong&gt;æ¢é’ˆ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.9.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;642-ä½•å¤„å¢å¼º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#642-ä½•å¤„å¢å¼º&#34;&gt;#&lt;/a&gt; 6.4.2 ä½•å¤„å¢å¼º&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒå¾—ç›Šäºå¤§è¯­è¨€æ¨¡å‹çš„ä¸Šä¸‹æ–‡å­¦ä¹ èƒ½åŠ›ã€æ³¨æ„åŠ›æœºåˆ¶çš„å¯æ‰©å±•æ€§ä»¥åŠè‡ªå›å½’ç”Ÿæˆèƒ½åŠ›ï¼Œå…¶&lt;strong&gt;è¾“å…¥ç«¯ã€ä¸­é—´å±‚å’Œè¾“å‡ºç«¯éƒ½å¯ä»¥è¿›è¡ŒçŸ¥è¯†èåˆæ“ä½œ&lt;/strong&gt;ã€‚åœ¨è¾“å…¥ç«¯ï¼Œå¯ä»¥å°†é—®é¢˜å’Œæ£€ç´¢åˆ°çš„å¤–éƒ¨çŸ¥è¯†æ‹¼æ¥åœ¨ Prompt ä¸­ï¼Œç„¶åè¾“å…¥ç»™å¤§è¯­è¨€æ¨¡å‹ï¼›åœ¨ä¸­é—´å±‚ï¼Œå¯ä»¥é‡‡ç”¨äº¤å‰æ³¨æ„åŠ›å°†å¤–éƒ¨çŸ¥è¯†ç›´æ¥ç¼–ç åˆ°æ¨¡å‹çš„éšè—çŠ¶æ€ä¸­ï¼›åœ¨è¾“å‡ºç«¯ï¼Œå¯ä»¥åˆ©ç”¨å¤–éƒ¨çŸ¥è¯†å¯¹ç”Ÿæˆçš„æ–‡æœ¬è¿›è¡ŒåçŸ«æ­£ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨è¾“å…¥ç«¯å¢å¼ºã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨è¾“å…¥ç«¯å¢å¼ºçš„æ–¹æ³•&lt;strong&gt;ç›´è§‚ä¸”æ˜“äºå®ç°&lt;/strong&gt;ã€‚åœ¨è¾“å…¥ç«¯å¢å¼ºçš„æ–¹æ³•ç›´æ¥å°†æ£€ç´¢åˆ°çš„å¤–éƒ¨çŸ¥è¯†æ–‡æœ¬ä¸ç”¨æˆ·æŸ¥è¯¢æ‹¼æ¥åˆ° Prompt ä¸­ï¼Œç„¶åè¾“å…¥ç»™å¤§è¯­è¨€æ¨¡å‹ã€‚å…¶æ˜¯å½“å‰ä¸»æµçš„å¢å¼ºæ–¹æ³•ã€‚æ­¤æ–¹å¼çš„&lt;strong&gt;é‡ç‚¹åœ¨äº Prompt è®¾è®¡&lt;/strong&gt;ä»¥åŠæ£€ç´¢åˆ°çš„å¤–éƒ¨çŸ¥è¯†çš„æ’åºã€‚åœ¨è®¾è®¡ Prompt çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥è¿ç”¨ CoT ç­‰ Prompt æŠ€å·§ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;åœ¨ä¸­é—´å±‚å¢å¼º&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ä¸­é—´å±‚å¢å¼ºå¢å¼ºçš„æ–¹æ³•åˆ©ç”¨æ³¨æ„åŠ›æœºåˆ¶çš„çµæ´»æ€§ï¼Œå…ˆå°†æ£€ç´¢åˆ°çš„&lt;strong&gt;å¤–éƒ¨çŸ¥è¯†è½¬æ¢ä¸ºå‘é‡è¡¨ç¤º&lt;/strong&gt;ï¼Œç„¶åå°†è¿™äº›å‘é‡è¡¨ç¤ºé€šè¿‡&lt;strong&gt;äº¤å‰æ³¨æ„åŠ›&lt;/strong&gt;èåˆåˆ°æ¨¡å‹çš„éšè—çŠ¶æ€ä¸­ã€‚è¿™ç§æ–¹æ³•èƒ½å¤Ÿ&lt;strong&gt;æ›´æ·±å…¥åœ°å½±å“æ¨¡å‹çš„å†…éƒ¨è¡¨ç¤º&lt;/strong&gt;ï¼Œå¯èƒ½æœ‰åŠ©äºæ¨¡å‹æ›´å¥½åœ°ç†è§£å’Œåˆ©ç”¨å¤–éƒ¨çŸ¥è¯†ã€‚åŒæ—¶ï¼Œç”±äºå‘é‡è¡¨ç¤ºé€šå¸¸æ¯”åŸå§‹æ–‡æœ¬æ›´ä¸ºç´§å‡‘ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥&lt;strong&gt;å‡å°‘å¯¹æ¨¡å‹è¾“å…¥é•¿åº¦çš„ä¾èµ–&lt;/strong&gt;ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•éœ€è¦å¯¹æ¨¡å‹çš„ç»“æ„è¿›è¡Œå¤æ‚çš„è®¾è®¡å’Œè°ƒæ•´ï¼Œ&lt;strong&gt;æ— æ³•åº”ç”¨äºé»‘ç›’æ¨¡å‹&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;åœ¨è¾“å‡ºç«¯å¢å¼º&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨è¾“å‡ºç«¯å¢å¼ºçš„æ–¹æ³•åˆ©ç”¨æ£€ç´¢åˆ°çš„å¤–éƒ¨çŸ¥è¯†å¯¹å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆçš„æ–‡æœ¬è¿›è¡Œ&lt;strong&gt;æ ¡å‡†&lt;/strong&gt;ï¼Œæ˜¯ä¸€ç§&lt;strong&gt;åå¤„ç†&lt;/strong&gt;çš„æ–¹æ³•ã€‚åœ¨æ­¤ç±»æ–¹æ³•ä¸­ï¼Œæ¨¡å‹é¦–å…ˆåœ¨æ— å¤–éƒ¨çŸ¥è¯†çš„æƒ…å†µä¸‹ç”Ÿæˆä¸€ä¸ªåˆæ­¥å›ç­”ï¼Œç„¶åå†åˆ©ç”¨æ£€ç´¢åˆ°çš„å¤–éƒ¨çŸ¥è¯†æ¥éªŒè¯æˆ–æ ¡å‡†è¿™ä¸€ç­”æ¡ˆã€‚&lt;strong&gt;æ ¡éªŒè¿‡ç¨‹åŸºäºç”Ÿæˆæ–‡æœ¬ä¸æ£€ç´¢æ–‡æœ¬çš„çŸ¥è¯†ä¸€è‡´æ€§å¯¹è¾“å‡ºè¿›è¡ŒçŸ«æ­£&lt;/strong&gt;ã€‚çŸ«æ­£å¯ä»¥é€šè¿‡å°†åˆæ­¥å›ç­”ä¸æ£€ç´¢åˆ°çš„ä¿¡æ¯æä¾›ç»™å¤§æ¨¡å‹ï¼Œè®©å¤§æ¨¡å‹æ£€æŸ¥å¹¶è°ƒæ•´ç”Ÿæˆçš„å›ç­”æ¥å®Œæˆã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥&lt;strong&gt;ç¡®ä¿ç”Ÿæˆçš„æ–‡æœ¬ä¸å¤–éƒ¨çŸ¥è¯†ä¿æŒä¸€è‡´&lt;/strong&gt;ï¼Œæé«˜ç­”æ¡ˆçš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚ç„¶è€Œï¼Œå…¶æ•ˆæœåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºæ£€ç´¢åˆ°çš„å¤–éƒ¨çŸ¥è¯†çš„è´¨é‡å’Œç›¸å…³æ€§ã€‚è‹¥æ£€ç´¢åˆ°çš„æ–‡æ¡£ä¸å‡†ç¡®æˆ–ä¸ç›¸å…³ï¼Œåˆ™ä¼šå¯¼è‡´é”™è¯¯çš„æ ¡å‡†ç»“æœã€‚&lt;/p&gt;
&lt;h3 id=&#34;643-å¤šæ¬¡å¢å¼º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#643-å¤šæ¬¡å¢å¼º&#34;&gt;#&lt;/a&gt; 6.4.3 å¤šæ¬¡å¢å¼º&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨å®é™…åº”ç”¨ä¸­ï¼Œç”¨æˆ·å¯¹å¤§è¯­è¨€æ¨¡å‹çš„æé—®å¯èƒ½æ˜¯&lt;strong&gt;å¤æ‚æˆ–æ¨¡ç³Š&lt;/strong&gt;çš„ã€‚å¤æ‚é—®é¢˜å¾€å¾€æ¶‰åŠå¤šä¸ªçŸ¥è¯†ç‚¹ï¼Œéœ€è¦å¤šè·³ï¼ˆmulti-hopï¼‰çš„ç†è§£ï¼›è€Œæ¨¡ç³Šé—®é¢˜å¾€å¾€æŒ‡ä»£èŒƒå›´ä¸æ˜ï¼Œéš¾ä»¥ä¸€æ¬¡å°±ç†è§£é—®é¢˜çš„å«ä¹‰ã€‚å¯¹äºå¤æ‚é—®é¢˜å’Œæ¨¡ç³Šé—®é¢˜ï¼Œéš¾ä»¥é€šè¿‡ä¸€æ¬¡æ£€ç´¢å¢å¼ºå°±ç¡®ä¿ç”Ÿæˆæ­£ç¡®ï¼Œå¤šæ¬¡è¿­ä»£æ£€ç´¢å¢å¼ºåœ¨æ‰€éš¾å…ã€‚å¤„ç†å¤æ‚é—®é¢˜æ—¶ï¼Œå¸¸é‡‡ç”¨&lt;strong&gt;åˆ†è§£å¼å¢å¼º&lt;/strong&gt;çš„æ–¹æ¡ˆã€‚è¯¥æ–¹æ¡ˆå°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªå­é—®é¢˜ï¼Œå­é—®é¢˜é—´è¿›è¡Œè¿­ä»£æ£€ç´¢å¢å¼ºï¼Œæœ€ç»ˆå¾—åˆ°æ­£ç¡®ç­”æ¡ˆã€‚å¤„ç†æ¨¡ç³Šé—®é¢˜æ—¶ï¼Œå¸¸é‡‡ç”¨&lt;strong&gt;æ¸è¿›å¼å¢å¼º&lt;/strong&gt;çš„æ–¹æ¡ˆã€‚è¯¥æ–¹æ¡ˆå°†é—®é¢˜çš„ä¸æ–­ç»†åŒ–ï¼Œç„¶ååˆ†åˆ«å¯¹ç»†åŒ–çš„é—®é¢˜è¿›è¡Œæ£€ç´¢å¢å¼ºï¼ŒåŠ›æ±‚ç»™å‡ºå…¨é¢çš„ç­”æ¡ˆï¼Œä»¥è¦†ç›–ç”¨æˆ·éœ€è¦çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ†è§£å¼å¢å¼º&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒå¤æ‚é—®é¢˜é€šå¸¸åŒ…å«å¤šä¸ªçŸ¥è¯†ç‚¹ã€‚å¯¹å¤æ‚é—®é¢˜è¿›è¡Œä½œç­”ï¼Œéœ€è¦å¤šè·³ç†è§£ã€‚å› æ­¤ï¼Œåœ¨å¤æ‚é—®é¢˜çš„æ£€ç´¢å¢å¼ºä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æ— æ³•ä»…é€šè¿‡ä¸€æ¬¡æ£€ç´¢å¢å¼ºå°±å¾—åˆ°æ»¡æ„çš„ç­”æ¡ˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¨¡å‹å¯ä»¥å°†å¤šè·³é—®é¢˜åˆ†è§£ä¸ºä¸€ä¸ªä¸ªå­é—®é¢˜ï¼Œç„¶ååœ¨å­é—®é¢˜é—´è¿­ä»£åœ°è¿›è¡Œæ£€ç´¢å¢å¼ºï¼Œæœ€åå¾—å‡ºæ­£ç¡®ç»“è®ºï¼Œå³åˆ†è§£å¼å¢å¼ºã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;DEMONSTRATEâ€“SEARCHâ€“PREDICTï¼ˆDSPï¼‰&lt;/strong&gt; æ˜¯ä¸€ç§å…·æœ‰ä»£è¡¨æ€§çš„åˆ†è§£å¼å¢å¼ºæ¡†æ¶ã€‚è¯¥æ¡†æ¶ä¸»è¦åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªæ¨¡å—ï¼šï¼ˆ1ï¼‰&lt;strong&gt;DEMONSTRATE æ¨¡å—&lt;/strong&gt;ï¼Œé€šè¿‡ä¸Šä¸‹æ–‡å­¦ä¹ çš„æ–¹æ³•ï¼Œå°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºå­é—®é¢˜ï¼›ï¼ˆ2ï¼‰&lt;strong&gt;SEARCH æ¨¡å—&lt;/strong&gt;ï¼Œå¯¹å­é—®é¢˜è¿›è¡Œè¿­ä»£æ£€ç´¢å¢å¼ºï¼Œä¸ºæœ€ç»ˆå†³ç­–æä¾›ç»¼åˆçš„å¤–éƒ¨çŸ¥è¯†ï¼›ï¼ˆ3ï¼‰&lt;strong&gt;PREDICT æ¨¡å—&lt;/strong&gt;ï¼Œæ ¹æ® SEARCH æä¾›çš„ç»¼åˆå¤–éƒ¨çŸ¥è¯†ç”Ÿæˆæœ€ç»ˆå›ç­”ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.10.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æ¸è¿›å¼å¢å¼º&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æ¨¡ç³Šé—®é¢˜ä¸­ï¼Œé—®é¢˜ä¸»ä½“é€šå¸¸æŒ‡ä»£ä¸æ˜ï¼Œå®¹æ˜“å¼•å‘æ­§ä¹‰ã€‚åœ¨å¤„ç†æ¨¡ç³Šé—®é¢˜æ—¶ï¼Œå¯ä»¥å¯¹é—®é¢˜è¿›è¡Œæ¸è¿›å¼åœ°æ‹†è§£ã€ç»†åŒ–ï¼Œç„¶åå¯¹ç»†åŒ–åçš„é—®é¢˜è¿›è¡Œæ£€ç´¢ï¼Œåˆ©ç”¨æ£€ç´¢åˆ°çš„ä¿¡æ¯å¢å¼ºå¤§æ¨¡å‹ã€‚è¿™ç§æ¸è¿›å¼çš„å¢å¼ºæ–¹æ³•å¯ä»¥å¸®åŠ©å¤§è¯­è¨€æ¨¡å‹æŒæ¡æ›´å…¨é¢çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;TREEOFCLARIFICATIONSï¼ˆTOCï¼‰&lt;/strong&gt; æ˜¯æ¸è¿›å¼å¢å¼ºçš„ä»£è¡¨æ€§æ¡†æ¶ã€‚è¯¥æ¡†æ¶é€šè¿‡é€’å½’å¼æ£€ç´¢æ¥å¼•å¯¼å¤§è¯­è¨€æ¨¡å‹åœ¨&lt;strong&gt;æ ‘çŠ¶ç»“æ„&lt;/strong&gt;ä¸­æ¢ç´¢ç»™å®šæ¨¡ç³Šé—®é¢˜çš„å¤šç§æ¾„æ¸…è·¯å¾„ã€‚TOC æ¡†æ¶é¦–å…ˆå¯åŠ¨ç¬¬ä¸€è½®æ£€ç´¢ï¼Œæ ¹æ®æ£€ç´¢åˆ°çš„ç›¸å…³æ–‡æ¡£å’ŒåŸå§‹é—®é¢˜ï¼Œç”Ÿæˆä¸€ç³»åˆ—å…·ä½“çš„ç»†åŒ–é—®é¢˜åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæ¡†æ¶ä¼šæ ¹æ®ç»†åŒ–é—®é¢˜ä¸åŸé—®é¢˜çš„ç›¸å…³æ€§åŠçŸ¥è¯†ä¸€è‡´æ€§è¿›è¡Œå‰ªæã€‚éšåï¼Œé’ˆå¯¹æ¯ä¸ªç»†åŒ–é—®é¢˜ï¼Œæ¡†æ¶ç‹¬ç«‹å±•å¼€æ·±å…¥çš„æ£€ç´¢å¹¶å¯¹é—®é¢˜è¿›ä¸€æ­¥ç»†åŒ–ï¼Œæœ€ç»ˆï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ„å»ºå‡ºå¤šæ¡å®Œæ•´çš„çŸ¥è¯†è·¯å¾„ï¼Œæ¯æ¡è·¯å¾„çš„æœ«ç«¯ï¼ˆå¶èŠ‚ç‚¹ï¼‰éƒ½ä»£è¡¨äº†å¯¹åŸå§‹é—®é¢˜çš„ä¸åŒä½†æ˜¯æœ‰æ•ˆçš„è§£ç­”ã€‚é€šè¿‡æ•´åˆæ‰€æœ‰æœ‰æ•ˆçš„å¶èŠ‚ç‚¹ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå¾—å‡ºä¸€ä¸ªç²¾ç¡®ä¸”å…¨é¢çš„é•¿å›ç­”&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_base/6.11.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè¿™ç§æ¸è¿›å¼çš„æ£€ç´¢æ–¹æ³•èƒ½å¤Ÿæ˜¾è‘—æ”¹å–„å¤§è¯­è¨€æ¨¡å‹å¯¹æ¨¡ç³Šé—®é¢˜çš„ç”Ÿæˆæ•ˆæœã€‚ç„¶è€Œï¼Œå…¶éœ€è¦è¿›è¡Œå¤šè½®æ£€ç´¢å¹¶ç”Ÿæˆå¤šä¸ªç­”æ¡ˆè·¯å¾„ï¼Œæ•´ä¸ªç³»ç»Ÿçš„è®¡ç®—é‡ä¼šéšç€é—®é¢˜å¤æ‚åº¦å‘ˆæŒ‡æ•°çº§å¢é•¿ã€‚æ­¤å¤–ï¼Œå¤šè½®çš„æ£€ç´¢ä¸ç”Ÿæˆä¸ä»…ä¼šå¸¦æ¥æ˜¾è‘—çš„æ—¶é—´å»¶è¿Ÿï¼Œå¤šä¸ªæ¨ç†è·¯å¾„è¿˜ä¸ºæ¨ç†å¸¦æ¥ä¸ç¨³å®šæ€§ï¼Œå®¹æ˜“å¼•å‘é”™è¯¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;644-é™æœ¬å¢æ•ˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#644-é™æœ¬å¢æ•ˆ&#34;&gt;#&lt;/a&gt; 6.4.4 é™æœ¬å¢æ•ˆ&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒæ£€ç´¢å‡ºçš„å¤–éƒ¨çŸ¥è¯†é€šå¸¸åŒ…å«å¤§é‡åŸå§‹æ–‡æœ¬ã€‚å°†å…¶é€šè¿‡ Prompt è¾“å…¥ç»™å¤§è¯­è¨€æ¨¡å‹æ—¶ï¼Œä¼šå¤§å¹…åº¦å¢åŠ è¾“å…¥ Token çš„æ•°é‡ï¼Œä»è€Œå¢åŠ äº†å¤§è¯­è¨€æ¨¡å‹çš„æ¨ç†è®¡ç®—æˆæœ¬ã€‚æ­¤é—®é¢˜å¯ä»&lt;strong&gt;å»é™¤å†—ä½™æ–‡æœ¬&lt;/strong&gt;ä¸&lt;strong&gt;å¤ç”¨è®¡ç®—ç»“æœ&lt;/strong&gt;ä¸¤ä¸ªè§’åº¦è¿›è¡Œè§£å†³ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å»é™¤å†—ä½™æ–‡æœ¬&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒå»é™¤å†—ä½™æ–‡æœ¬çš„æ–¹æ³•é€šè¿‡å¯¹æ£€ç´¢å‡ºçš„åŸå§‹æ–‡æœ¬çš„è¯å¥è¿›è¡Œè¿‡æ»¤ï¼Œä»ä¸­é€‰æ‹©å‡ºéƒ¨åˆ†æœ‰ç›Šäºå¢å¼ºç”Ÿæˆçš„éƒ¨åˆ†ã€‚å»é™¤å†—ä½™æ–‡æœ¬çš„æ–¹æ³•ä¸»è¦åˆ†ä¸ºä¸‰ç±»ï¼š&lt;strong&gt;Token çº§åˆ«çš„æ–¹æ³•&lt;/strong&gt;ï¼Œ&lt;strong&gt;å­æ–‡æœ¬çº§åˆ«çš„æ–¹æ³•&lt;/strong&gt;ä»¥åŠ&lt;strong&gt;å…¨æ–‡æœ¬çº§åˆ«çš„æ–¹æ³•&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å¤ç”¨è®¡ç®—ç»“æœ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨å¤§è¯­è¨€æ¨¡å‹è¿›è¡Œæ¨ç†çš„è‡ªå›å½’è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ª Token éƒ½éœ€è¦ç”¨åˆ°ä¹‹å‰ Token æ³¨æ„åŠ›æ¨¡å—æ¶‰åŠçš„ Key å’Œ Value çš„ç»“æœã€‚ä¸ºäº†é¿å…å¯¹æ¯ä¸ª Token éƒ½é‡æ–°è®¡ç®—å‰é¢çš„ Key å’Œ Value çš„ç»“æœï¼Œå¯ä»¥å°†ä¹‹å‰è®¡ç®—çš„ Key å’Œ Value çš„ç»“æœè¿›è¡Œç¼“å­˜ï¼ˆå³ KV-cacheï¼‰ï¼Œåœ¨éœ€è¦æ˜¯ç›´æ¥ä» KV-cache ä¸­è°ƒç”¨ç›¸å…³ç»“æœï¼Œä»è€Œé¿å…é‡å¤è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç»¼ä¸Šï¼Œé€šè¿‡ç»“åˆä¸Šè¿°&lt;strong&gt;è¾“å…¥ Prompt å‹ç¼©&lt;/strong&gt;ä¸&lt;strong&gt; KV-cache æœºåˆ¶&lt;/strong&gt;ï¼ŒRAG æ¡†æ¶å¯ä»¥åœ¨ä¿æŒé«˜æ€§èƒ½çš„åŒæ—¶ï¼Œæ˜¾è‘—æå‡å…¶æ•ˆç‡ã€‚è¿™ä¸ä»…æœ‰åŠ©äºåœ¨èµ„æºå—é™çš„ç¯å¢ƒä¸­éƒ¨ç½²æ¨¡å‹ï¼Œè¿˜å¯ä»¥æé«˜æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­çš„å“åº”é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;h2 id=&#34;65-å®è·µä¸åº”ç”¨&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#65-å®è·µä¸åº”ç”¨&#34;&gt;#&lt;/a&gt; 6.5 å®è·µä¸åº”ç”¨&lt;/h2&gt;
&lt;h3 id=&#34;651-æ­å»ºç®€å•ragç³»ç»Ÿ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#651-æ­å»ºç®€å•ragç³»ç»Ÿ&#34;&gt;#&lt;/a&gt; 6.5.1 æ­å»ºç®€å• RAG ç³»ç»Ÿ&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†åŠ©åŠ›å¼€å‘è€…ä»¬é«˜æ•ˆä¸”ä¾¿æ·åœ°æ„å»º RAG ç³»ç»Ÿï¼Œå½“å‰å·²æœ‰è¯¸å¤šæˆç†Ÿå¼€æºæ¡†æ¶å¯ä¾›é€‰æ‹©ï¼Œå…¶ä¸­æœ€å…·ä»£è¡¨æ€§çš„ä¾¿æ˜¯&lt;strong&gt; LangChain&lt;/strong&gt; ä¸&lt;strong&gt; LlamaIndex&lt;/strong&gt;ã€‚&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2025/01/02/AI/MinHash/</guid>
            <title>ä½¿ç”¨ MinHash è¿›è¡Œæ–‡æœ¬å»é‡</title>
            <link>http://qianqiu-cell.github.io/2025/01/02/AI/MinHash/</link>
            <category>AI</category>
            <pubDate>Thu, 02 Jan 2025 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;ä¸€-minhash&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-minhash&#34;&gt;#&lt;/a&gt; ä¸€ã€MinHash&lt;/h1&gt;
&lt;p&gt;MinHash æ˜¯ä¸€ç§&lt;strong&gt;ç”¨äºè¿‘ä¼¼é›†åˆç›¸ä¼¼åº¦è®¡ç®—çš„æŠ€æœ¯&lt;/strong&gt;ã€‚å®ƒè¢«å¹¿æ³›ç”¨äºå¤§è§„æ¨¡æ•°æ®é›†ä¸­çš„å¿«é€Ÿç›¸ä¼¼åº¦ä¼°è®¡ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æ–‡æœ¬ã€å›¾åƒå’Œç½‘ç»œæ•°æ®ç­‰é¢†åŸŸã€‚&lt;/p&gt;
&lt;p&gt;MinHash çš„åŸºæœ¬æ€æƒ³æ˜¯é€šè¿‡å°†é›†åˆä¸­çš„å…ƒç´ å“ˆå¸Œæˆä¸€ä¸ªè¾ƒå°çš„ç­¾åï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå›ºå®šé•¿åº¦çš„æ•´æ•°æˆ–æ¯”ç‰¹ä¸²ï¼‰ï¼Œä»è€Œ&lt;strong&gt;å¿«é€Ÿåœ°æ¯”è¾ƒä¸¤ä¸ªé›†åˆä¹‹é—´çš„ç›¸ä¼¼åº¦&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;MinHash ç®—æ³•çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é›†åˆè½¬æ¢æˆç­¾åï¼šå¯¹äºä¸€ä¸ªé›†åˆä¸­çš„å…ƒç´ ï¼Œé€šè¿‡å“ˆå¸Œå‡½æ•°å°†å…¶æ˜ å°„åˆ°ä¸€ä¸ªå›ºå®šé•¿åº¦çš„å“ˆå¸Œå€¼ã€‚é€šå¸¸ä¼šä½¿ç”¨å¤šä¸ªå“ˆå¸Œå‡½æ•°ç”Ÿæˆå¤šä¸ªå“ˆå¸Œå€¼ï¼Œè¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªç­¾åã€‚&lt;/li&gt;
&lt;li&gt;é€‰æ‹©æœ€å°å€¼ï¼šä»ç”Ÿæˆçš„å“ˆå¸Œå€¼ä¸­é€‰å–æœ€å°çš„ä¸€ä¸ªä½œä¸ºè¯¥é›†åˆçš„ MinHash å€¼ã€‚&lt;/li&gt;
&lt;li&gt;é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼šå¯¹äºæ¯ä¸ªé›†åˆï¼Œé‡å¤ä»¥ä¸Šä¸¤ä¸ªæ­¥éª¤ï¼Œå¾—åˆ°æ‰€æœ‰å…ƒç´ çš„ MinHash å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;MinHash çš„å…³é”®ä¼˜åŠ¿åœ¨äºå®ƒå¯ä»¥&lt;strong&gt;ä»¥å¾ˆå°çš„å†…å­˜å ç”¨å’Œä½è®¡ç®—æˆæœ¬æ¥ä¼°è®¡é›†åˆä¹‹é—´çš„ç›¸ä¼¼åº¦&lt;/strong&gt;ã€‚è¿™å¯¹äºå¤„ç†å¤§è§„æ¨¡æ•°æ®é›†æ˜¯éå¸¸é‡è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMinHash æ˜¯ä¸€ç§æ¦‚ç‡æ€§ç®—æ³•ï¼Œå®ƒæä¾›çš„ç›¸ä¼¼åº¦ä¼°è®¡æ˜¯ä»¥ä¸€å®šçš„æ¦‚ç‡ä¸ºåŸºç¡€çš„ã€‚å› æ­¤ï¼Œåœ¨åº”ç”¨ä¸­éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œé€‚å½“çš„å‚æ•°è®¾ç½®å’Œç»“æœè§£é‡Šã€‚&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-lsh&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-lsh&#34;&gt;#&lt;/a&gt; äºŒã€LSH&lt;/h1&gt;
&lt;p&gt;å±€éƒ¨æ•æ„Ÿå“ˆå¸Œï¼ˆLocality-Sensitive Hashingï¼ŒLSHï¼‰æ˜¯ä¸€ç§ç”¨äº&lt;strong&gt;åœ¨é«˜ç»´ç©ºé—´ä¸­å¿«é€Ÿæœç´¢ç›¸ä¼¼é¡¹çš„è¿‘ä¼¼æœç´¢æŠ€æœ¯&lt;/strong&gt;ã€‚å®ƒç‰¹åˆ«é€‚ç”¨äºå¤„ç†&lt;strong&gt;å¤§è§„æ¨¡æ•°æ®é›†&lt;/strong&gt;ï¼Œå…¶ä¸­ä¼ ç»Ÿçš„ç²¾ç¡®æœç´¢æ–¹æ³•å¯èƒ½å˜å¾—è¿‡äºæ˜‚è´µæˆ–ä¸å¯è¡Œã€‚&lt;/p&gt;
&lt;p&gt;LSH çš„ä¸»è¦æ€æƒ³æ˜¯å°†ç›¸ä¼¼çš„é¡¹æ˜ å°„åˆ°ç›¸åŒçš„æ¡¶ï¼ˆbucketsï¼‰ä¸­ï¼Œä»è€Œå¯ä»¥åœ¨ç›¸ä¼¼çš„é¡¹ä¹‹é—´è¿›è¡Œå¿«é€Ÿçš„æœç´¢ã€‚å®ƒé€šè¿‡åœ¨æ•°æ®é›†ä¸­æ„å»ºå“ˆå¸Œè¡¨æ¥å®ç°è¿™ä¸€ç›®çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ LSH çš„ä¸€èˆ¬å·¥ä½œæµç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç‰¹å¾æå–ï¼šå°†æ•°æ®ç‚¹è¡¨ç¤ºä¸ºç‰¹å¾å‘é‡ï¼Œè¿™äº›ç‰¹å¾å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„ï¼Œä¾‹å¦‚æ–‡æœ¬ã€å›¾åƒæˆ–æ•°å€¼æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;å“ˆå¸Œå‡½æ•°é€‰æ‹©ï¼šé€‰æ‹©ä¸€ç»„å“ˆå¸Œå‡½æ•°ï¼Œè¿™äº›å‡½æ•°å°†ç‰¹å¾å‘é‡æ˜ å°„åˆ°å“ˆå¸Œç©ºé—´ã€‚è¿™äº›å“ˆå¸Œå‡½æ•°é€šå¸¸è¢«è®¾è®¡ä¸ºå±€éƒ¨æ•æ„Ÿçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›¸ä¼¼çš„é¡¹åœ¨å“ˆå¸Œç©ºé—´ä¸­æœ‰æ›´é«˜çš„æ¦‚ç‡è¢«æ˜ å°„åˆ°ç›¸åŒçš„æ¡¶ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;æ¡¶çš„æ„å»ºï¼šå°†æ‰€æœ‰æ•°æ®ç‚¹é€šè¿‡å“ˆå¸Œå‡½æ•°æ˜ å°„åˆ°æ¡¶ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢ï¼šç»™å®šä¸€ä¸ªæŸ¥è¯¢é¡¹ï¼Œå°†å…¶é€šè¿‡ç›¸åŒçš„å“ˆå¸Œå‡½æ•°æ˜ å°„åˆ°å“ˆå¸Œç©ºé—´ï¼Œå¹¶æŸ¥æ‰¾ç›¸åŒæ¡¶ä¸­çš„é¡¹ï¼Œä»¥æ‰¾åˆ°è¿‘ä¼¼çš„é‚»å±…ã€‚&lt;/li&gt;
&lt;li&gt;å€™é€‰é¡¹ç­›é€‰ï¼šå¯¹äºè¿”å›çš„ç›¸é‚»é¡¹é›†ï¼Œé€šè¿‡è¿›ä¸€æ­¥çš„è®¡ç®—æˆ–ç­›é€‰æ¥ç¡®å®šæœ€ç»ˆçš„ç›¸ä¼¼é¡¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸¸è§çš„ LSH å˜ä½“åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MinHash LSH * ç”¨äºå¤„ç†é›†åˆæ•°æ®çš„ LSH å˜ä½“ï¼Œé€šè¿‡å°†é›†åˆæ˜ å°„åˆ° MinHash ç­¾åæ¥è¿›è¡Œç›¸ä¼¼åº¦æœç´¢ã€‚&lt;/li&gt;
&lt;li&gt;LSH Forest * ç”¨äºé«˜ç»´ç©ºé—´ä¸­çš„èŒƒå›´æœç´¢ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å¤„ç†æœ€è¿‘é‚»æœç´¢ã€‚&lt;/li&gt;
&lt;li&gt;SimHash LSH * ç”¨äºå¤„ç†é«˜ç»´äºŒè¿›åˆ¶æ•°æ®çš„ LSH å˜ä½“ï¼Œé€šè¿‡å°†ç‰¹å¾å‘é‡æ˜ å°„åˆ°äºŒè¿›åˆ¶ç å¹¶è¿›è¡Œå“ˆå¸Œæ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;Cosine LSH * ç”¨äºå¤„ç†ä½™å¼¦ç›¸ä¼¼åº¦çš„ LSH å˜ä½“ï¼Œé€šå¸¸ç”¨äºæ–‡æœ¬æˆ–å‘é‡ç©ºé—´æ¨¡å‹ä¸­çš„ç›¸ä¼¼æ€§æœç´¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;LSH æ˜¯ä¸€ç§å¼ºå¤§çš„æŠ€æœ¯ï¼Œå¯ä»¥ç”¨äºè®¸å¤šé¢†åŸŸï¼ŒåŒ…æ‹¬ä¿¡æ¯æ£€ç´¢ã€æ¨èç³»ç»Ÿã€å›¾åƒå’ŒéŸ³é¢‘å¤„ç†ç­‰ã€‚å®ƒæä¾›äº†ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•æ¥è§£å†³å¤§è§„æ¨¡æ•°æ®é›†ä¸­çš„ç›¸ä¼¼æ€§æœç´¢é—®é¢˜ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-jaccardç›¸ä¼¼åº¦&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-jaccardç›¸ä¼¼åº¦&#34;&gt;#&lt;/a&gt; ä¸‰ã€Jaccard ç›¸ä¼¼åº¦&lt;/h1&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ªé›†åˆ A,Bï¼ŒJaccard ç³»æ•°å®šä¹‰ä¸º A ä¸ B äº¤é›†çš„å¤§å°ä¸ A ä¸ B å¹¶é›†çš„å¤§å°çš„æ¯”å€¼ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtext&gt;Jaccard&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;âˆ©&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;âˆª&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\text{Jaccard}(A,B)=\frac{A\cap B}{A\cup B}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Jaccard&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05017em;&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.04633em;vertical-align:-0.686em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.36033em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆª&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05017em;&#34;&gt;B&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ©&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05017em;&#34;&gt;B&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Jaccard ç›¸ä¼¼åº¦åœ¨å¦‚ä¸‹é—®é¢˜å–å¾—è¾ƒå¥½æ•ˆæœï¼š&lt;strong&gt;åœ¨å¤§çš„è¯­æ–™åº“ä¸­å¯»æ‰¾æ–‡æœ¬å†…å®¹ç›¸ä¼¼çš„æ–‡æ¡£ï¼Œè¿™é‡Œä¸»è¦æŒ‡å­—é¢ä¸Šçš„ç›¸ä¼¼ï¼Œè€Œéè¯­ä¹‰ä¸Šçš„ç›¸ä¼¼&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;å››-å‚è€ƒç¨‹åº&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å››-å‚è€ƒç¨‹åº&#34;&gt;#&lt;/a&gt; å››ã€å‚è€ƒç¨‹åº&lt;/h1&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; datasketch &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; MinHash&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; MinHashLSH&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# åˆ›å»ºä¸€ä¸ª MinHash å¯¹è±¡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;create_minhash&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    minhash &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; MinHash&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;num_perm&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# num_perm æ˜¯å“ˆå¸Œå‡½æ•°çš„æ•°é‡ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; d &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; data&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        minhash&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;update&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;d&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;encode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;utf8&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; minhash&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# åˆ›å»ºä¸€äº›ç¤ºä¾‹æ•°æ®ï¼ˆä¸­æ–‡é•¿å¥å­ï¼‰&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;sentences &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œé˜³å…‰æ˜åªšï¼Œé€‚åˆå‡ºé—¨æ•£æ­¥ã€‚&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;æˆ‘å–œæ¬¢è¯»ä¹¦ï¼Œå°¤å…¶æ˜¯ç§‘å¹»å°è¯´ã€‚&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;è¿™ä¸ªåŸå¸‚çš„å¤œæ™¯éå¸¸æ¼‚äº®ï¼Œå°¤å…¶æ˜¯ç¯å…‰ç’€ç’¨çš„CBDåŒºã€‚&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;æˆ‘çš„å®¶ä¹¡æ˜¯ä¸€ä¸ªç¾ä¸½çš„å°é•‡ï¼Œå››å­£åˆ†æ˜ï¼Œæ™¯è‰²å®œäººã€‚&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;å­¦ä¹ æ–°çŸ¥è¯†è®©æˆ‘æ„Ÿåˆ°å……å®å’Œå¿«ä¹ã€‚&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;æˆ‘å–œæ¬¢å¥èº«ï¼Œæ¯å¤©éƒ½ä¼šå»å¥èº«æˆ¿é”»ç‚¼ã€‚&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;è¿™å®¶é¤å…çš„èœå“éå¸¸ç¾å‘³ï¼Œå°¤å…¶æ˜¯ä»–ä»¬çš„ç‰¹è‰²èœã€‚&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;æˆ‘å–œæ¬¢æ—…è¡Œï¼Œå°¤å…¶å–œæ¬¢å»ä¸€äº›è‡ªç„¶é£å…‰ä¼˜ç¾çš„åœ°æ–¹ã€‚&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;å¬éŸ³ä¹æ˜¯æˆ‘æ”¾æ¾å¿ƒæƒ…çš„æœ€çˆ±ä¹‹ä¸€ã€‚&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;çœ‹ç”µå½±æ˜¯æˆ‘å‘¨æœ«æœ€å–œæ¬¢åšçš„äº‹æƒ…ä¹‹ä¸€ï¼Œæˆ‘å–œæ¬¢å„ç§ç±»å‹çš„ç”µå½±ã€‚&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# åˆ›å»º MinHash å¯¹è±¡å¹¶æ’å…¥åˆ° LSH ä¸­&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;lsh &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; MinHashLSH&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;threshold&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; num_perm&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# threshold æ˜¯ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; idx&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; sentence &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;sentences&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    minhash &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; create_minhash&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;sentence&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    lsh&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;insert&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;idx&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; minhash&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# æŸ¥æ‰¾ç›¸ä¼¼çš„é›†åˆ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;query_minhash &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; create_minhash&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;å¬éŸ³ä¹æ˜¯æˆ‘æ”¾æ¾å¿ƒæƒ…çš„æœ€çˆ±&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;results &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; lsh&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;query&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;query_minhash&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# è¾“å‡ºç›¸ä¼¼åº¦åˆ†æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; result &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; results&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    minhash &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; create_minhash&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;sentences&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;result&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    jaccard_similarity &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; query_minhash&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;jaccard&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;minhash&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string-interpolation&#34;&gt;&lt;span class=&#34;token string&#34;&gt;f&#34;ä¸ sentence ç›¸ä¼¼çš„å¥å­ &lt;/span&gt;&lt;span class=&#34;token interpolation&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;result&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt; çš„ç›¸ä¼¼åº¦åˆ†æ•°ä¸º: &lt;/span&gt;&lt;span class=&#34;token interpolation&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;jaccard_similarity&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# output&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;ä¸ sentence ç›¸ä¼¼çš„å¥å­ &lt;span class=&#34;token number&#34;&gt;8&lt;/span&gt; çš„ç›¸ä¼¼åº¦åˆ†æ•°ä¸º&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.8046875&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2025/01/02/AI/N-gram/</guid>
            <title>N-gram æ¨¡å‹</title>
            <link>http://qianqiu-cell.github.io/2025/01/02/AI/N-gram/</link>
            <category>AI</category>
            <pubDate>Thu, 02 Jan 2025 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;ä¸€-å¼•è¨€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-å¼•è¨€&#34;&gt;#&lt;/a&gt; ä¸€ã€å¼•è¨€&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒn-gram ç®—æ³•é€šè¿‡ç»Ÿè®¡æ–‡æœ¬ä¸­è¿ç»­ n ä¸ªè¯çš„åºåˆ—ï¼ˆæˆ–ç§°ä¸º â€œè¯ç»„â€ï¼‰å‡ºç°çš„é¢‘ç‡ï¼Œä¸ºå„ç§ NLP ä»»åŠ¡æä¾›äº†æœ‰åŠ›çš„æ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒN-gram æ¨¡å‹çš„åŸºæœ¬åŸç†æ˜¯åŸºäºé©¬å°”å¯å¤«å‡è®¾ï¼Œåœ¨è®­ç»ƒ N-gram æ¨¡å‹æ—¶ä½¿ç”¨æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ¨¡å‹å‚æ•° â€”â€” æ¡ä»¶æ¦‚ç‡.&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-ç¤ºä¾‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-ç¤ºä¾‹&#34;&gt;#&lt;/a&gt; äºŒã€ç¤ºä¾‹&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒä¾‹å¦‚ï¼Œå¯¹äº â€œThe cow jumps over the moonâ€ è¿™å¥è¯ã€‚å¦‚æœ N=2ï¼ˆç§°ä¸ºäºŒå…ƒæ¨¡å‹ï¼‰ï¼Œé‚£ä¹ˆ ngram å°†ä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;the cow
cow jumps
jumps over
over the
the moon
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨è¿™ç§æƒ…å†µä¸‹æœ‰ 5 ä¸ª n å…ƒè¯­æ³•ã€‚è¯·æ³¨æ„ï¼Œä»  &lt;code&gt;the-&amp;gt;cow&lt;/code&gt;  è½¬ç§»åˆ°  &lt;code&gt;cow-&amp;gt;jumps&lt;/code&gt;  åˆ°  &lt;code&gt;Jumps-&amp;gt;over&lt;/code&gt;  ç­‰ï¼Œæœ¬è´¨ä¸Šæ˜¯å‘å‰ç§»åŠ¨ä¸€ä¸ªå•è¯ä»¥ç”Ÿæˆä¸‹ä¸€ä¸ªäºŒå…ƒç»„ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¦‚æœ N=3ï¼Œåˆ™ n å…ƒè¯­æ³•å°†ä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;the cow jumps
cow jumps over
jumps over the
over the moon
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨è¿™ç§æƒ…å†µä¸‹æœ‰ 4 ä¸ª n å…ƒè¯­æ³•ã€‚å½“ N=1 æ—¶ï¼Œè¢«ç§°ä¸ºä¸€å…ƒè¯­æ³•ï¼Œæœ¬è´¨ä¸Šæ˜¯å¥å­ä¸­çš„å„ä¸ªå•è¯ã€‚å½“ N=2 æ—¶ï¼Œç§°ä¸ºäºŒå…ƒç»„ï¼›å½“ N=3 æ—¶ï¼Œç§°ä¸ºä¸‰å…ƒç»„ã€‚å½“ N&amp;gt;3 æ—¶ï¼Œè¿™é€šå¸¸è¢«ç§°ä¸ºå¤šå…ƒç»„ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;N_{gram}=X-(N-1)
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.969438em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15139200000000003em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.76666em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07847em;&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-n-gram-ç®—æ³•çš„ä¼˜ç¼ºç‚¹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-n-gram-ç®—æ³•çš„ä¼˜ç¼ºç‚¹&#34;&gt;#&lt;/a&gt; ä¸‰ã€n-gram ç®—æ³•çš„ä¼˜ç¼ºç‚¹&lt;/h1&gt;
&lt;p&gt;ï¼ˆ1ï¼‰ä¼˜ç‚¹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®€å•æ˜“å®ç°ï¼šn-gram ç®—æ³•åŸºäºç»Ÿè®¡åŸç†ï¼Œå®ç°èµ·æ¥ç›¸å¯¹ç®€å•ç›´è§‚ã€‚&lt;/li&gt;
&lt;li&gt;é€šç”¨æ€§å¼ºï¼šn-gram ç®—æ³•å¯ä»¥åº”ç”¨äºå¤šç§ NLP ä»»åŠ¡ï¼Œå…·æœ‰å¹¿æ³›çš„é€‚ç”¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;æ•ˆæœå¥½ï¼šåœ¨é€‚å½“çš„ n å€¼ä¸‹ï¼Œn-gram ç®—æ³•èƒ½å¤Ÿæ•æ‰åˆ°æ–‡æœ¬ä¸­çš„å±€éƒ¨ç»Ÿè®¡ä¿¡æ¯ï¼Œå¯¹äºæŸäº›ä»»åŠ¡å…·æœ‰è¾ƒå¥½çš„æ•ˆæœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ï¼ˆ2ï¼‰ç¼ºç‚¹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®ç¨€ç–æ€§ï¼šéšç€ n çš„å¢åŠ ï¼Œn-gram çš„æ•°é‡æ€¥å‰§å¢é•¿ï¼Œå¯¼è‡´å¾ˆå¤š n-gram åœ¨æ–‡æœ¬ä¸­åªå‡ºç°ä¸€æ¬¡æˆ–æ ¹æœ¬ä¸å‡ºç°ï¼Œè¿™ä½¿å¾—é¢‘ç‡ç»Ÿè®¡å˜å¾—ä¸å¯é ã€‚&lt;/li&gt;
&lt;li&gt;ä¸Šä¸‹æ–‡ä¿¡æ¯æœ‰é™ï¼šn-gram åªè€ƒè™‘äº†å›ºå®šé•¿åº¦çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ— æ³•æ•æ‰æ›´å¤æ‚çš„è¯­ä¹‰å…³ç³»ã€‚å¯¹äºè¾ƒé•¿çš„å¥å­æˆ–ç¯‡ç« ï¼Œn-gram å¯èƒ½æ— æ³•å……åˆ†è¡¨è¾¾å…¶æ•´ä½“æ„ä¹‰ã€‚&lt;/li&gt;
&lt;li&gt;è®¡ç®—å¤æ‚åº¦é«˜ï¼šå½“ n è¾ƒå¤§æˆ–æ–‡æœ¬è¾ƒé•¿æ—¶ï¼Œç”Ÿæˆå’Œç»Ÿè®¡ n-gram çš„è®¡ç®—å¤æ‚åº¦ä¼šæ˜¾è‘—å¢åŠ ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;ä¸‰-ç¨‹åºå®ç°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-ç¨‹åºå®ç°&#34;&gt;#&lt;/a&gt; ä¸‰ã€ç¨‹åºå®ç°&lt;/h1&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; re&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;generate_ngrams&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;text&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;n&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# split sentences into tokens&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    tokens&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;re&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;split&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;\\s+&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;text&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    ngrams&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token comment&#34;&gt;# collect the n-grams&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tokens&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;n&lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;       temp&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;tokens&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;j&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; j &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;i&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;i&lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;n&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;       ngrams&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;append&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34; &#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;join&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;temp&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; ngrams&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;sentence &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;_start_ this is ngram _generation_&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;my_ngrams &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; generate_ngrams&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;sentence&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;split&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;w &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; w &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; my_ngrams&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒè¾“å‡ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;_start_ this is&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;this is ngram&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;is ngram _generation_&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒæˆ–è€…ä½¿ç”¨ NLTK åŒ…&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; nltk &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; ngrams&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;sentence &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;_start_ this is ngram _generation_&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;my_ngrams &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; ngrams&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;sentence&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;split&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;w &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; w &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; my_ngrams&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒè¾“å‡ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;_start_&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;this&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;is&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;this&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;is&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;ngram&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;is&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;ngram&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;_generation_&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2025/01/02/AI/TIR/</guid>
            <title>TIR(ToRE) é›†æˆå·¥å…·æ¨ç†</title>
            <link>http://qianqiu-cell.github.io/2025/01/02/AI/TIR/</link>
            <category>AI</category>
            <pubDate>Thu, 02 Jan 2025 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;ul&gt;
&lt;li&gt;ToRA github ç½‘ç«™ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9Ub1JB&#34;&gt;https://github.com/microsoft/ToRA&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;é›†æˆå·¥å…·æ¨ç†ç›¸å…³æ•°æ®é›†ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9odWdnaW5nZmFjZS5jby9kYXRhc2V0cy9BSS1NTy9OdW1pbmFNYXRoLVRJUj9yb3c9MA==&#34;&gt;https://huggingface.co/datasets/AI-MO/NuminaMath-TIR?row=0&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/12/31/AI/Top_k/</guid>
            <title>Top_k, Top_p, Temperature å‚æ•°</title>
            <link>http://qianqiu-cell.github.io/2024/12/31/AI/Top_k/</link>
            <category>AI</category>
            <pubDate>Tue, 31 Dec 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTI4NTY4NjYvYXJ0aWNsZS9kZXRhaWxzLzE0MDMwODA4Mw==&#34;&gt;https://blog.csdn.net/u012856866/article/details/140308083&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸€-å¼•è¨€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-å¼•è¨€&#34;&gt;#&lt;/a&gt; ä¸€ã€å¼•è¨€&lt;/h1&gt;
&lt;p&gt;å¤§å¤šæ•°è¯­è¨€æ¨¡å‹éƒ½æ˜¯é€šè¿‡ç”Ÿæˆ token åºåˆ—ï¼ˆsequenceï¼‰ä¸­çš„ä¸‹ä¸€ä¸ª tokenã€‚æ¯æ¬¡æ¨¡å‹ç”Ÿæˆä¸‹ä¸€ä¸ª token æ—¶ï¼Œä¼šè¾“å…¥å®Œæ•´çš„ token åºåˆ—å¹¶é¢„æµ‹ä¸‹ä¸€ä¸ª tokenã€‚è¿™ç§ç­–ç•¥è¢«ç§°ä¸ºè‡ªå›å½’ç”Ÿæˆï¼ˆautoregressive generationï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ç”Ÿæˆè¾“å‡ºæ–‡æœ¬ï¼Œåœ¨æ¯ä¸€æ­¥é¢„æµ‹ä¸‹ä¸€ä¸ª token çš„è¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹ä¼šç»™å‡ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œè¡¨ç¤ºå®ƒå¯¹ä¸‹ä¸€ä¸ªå•è¯çš„é¢„æµ‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥çš„æ–‡æœ¬æ˜¯ â€œæˆ‘æœ€å–œæ¬¢çš„â€ï¼Œé‚£ä¹ˆæ¨¡å‹å¯èƒ½ä¼šç»™å‡ºä¸‹é¢çš„æ¦‚ç‡åˆ†å¸ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Top_k/1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;æœ‰å¦‚ä¸‹å‡ ç§å¸¸è§çš„æ–¹æ³•ï¼Œæ¥æ ¹æ®æ¦‚ç‡åˆ†å¸ƒé€‰æ‹©ä¸‹ä¸€ä¸ªå•è¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è´ªå¿ƒè§£ç ï¼ˆGreedy Decodingï¼‰ï¼šç›´æ¥é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„å•è¯ã€‚è¿™ç§æ–¹æ³•ç®€å•é«˜æ•ˆï¼Œä½†æ˜¯å¯èƒ½ä¼šå¯¼è‡´ç”Ÿæˆçš„æ–‡æœ¬è¿‡äºå•è°ƒå’Œé‡å¤ã€‚&lt;/li&gt;
&lt;li&gt;éšæœºé‡‡æ ·ï¼ˆRandom Samplingï¼‰ï¼šæŒ‰ç…§æ¦‚ç‡åˆ†å¸ƒéšæœºé€‰æ‹©ä¸€ä¸ªå•è¯ã€‚è¿™ç§æ–¹æ³•å¯ä»¥å¢åŠ ç”Ÿæˆçš„å¤šæ ·æ€§ï¼Œä½†æ˜¯å¯èƒ½ä¼šå¯¼è‡´ç”Ÿæˆçš„æ–‡æœ¬ä¸è¿è´¯å’Œæ— æ„ä¹‰ã€‚&lt;/li&gt;
&lt;li&gt;Beam Searchï¼ˆé›†æŸæœç´¢ï¼‰ï¼šç»´æŠ¤ä¸€ä¸ªå¤§å°ä¸º k çš„å€™é€‰åºåˆ—é›†åˆï¼Œæ¯ä¸€æ­¥ä»æ¯ä¸ªå€™é€‰åºåˆ—çš„æ¦‚ç‡åˆ†å¸ƒä¸­é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„ k ä¸ªå•è¯ï¼Œç„¶åä¿ç•™æ€»æ¦‚ç‡æœ€é«˜çš„ k ä¸ªå€™é€‰åºåˆ—ã€‚è¿™ç§æ–¹æ³•å¯ä»¥å¹³è¡¡ç”Ÿæˆçš„è´¨é‡å’Œå¤šæ ·æ€§ï¼Œä½†æ˜¯å¯èƒ½ä¼šå¯¼è‡´ç”Ÿæˆçš„æ–‡æœ¬è¿‡äºä¿å®ˆå’Œä¸è‡ªç„¶ã€‚&lt;strong&gt;åç»­çš„ top-kã€top-p å’Œ temperature éƒ½æ˜¯ä½œç”¨äºå•ä¸ªæŸï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªæŸï¼Œåˆ™å¯¹æ¯ä¸€ä¸ªæŸå•ç‹¬æ‰§è¡Œ top-kã€top-p å’Œ temperature æ“ä½œã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;top-k é‡‡æ ·å’Œ top-p é‡‡æ ·æ˜¯ä»‹äºè´ªå¿ƒè§£ç å’Œéšæœºé‡‡æ ·ä¹‹é—´çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯ç›®å‰å¤§æ¨¡å‹è§£ç ç­–ç•¥ä¸­å¸¸ç”¨çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-top-ké‡‡æ ·&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-top-ké‡‡æ ·&#34;&gt;#&lt;/a&gt; äºŒã€top-k é‡‡æ ·&lt;/h1&gt;
&lt;p&gt;Top-k é‡‡æ ·æ˜¯å¯¹å‰é¢ â€œè´ªå¿ƒç­–ç•¥â€ çš„ä¼˜åŒ–ï¼Œå®ƒä»æ’åå‰  &lt;code&gt;k&lt;/code&gt;  çš„ token ä¸­è¿›è¡Œ&lt;strong&gt;æŠ½æ ·&lt;/strong&gt;ï¼Œå…è®¸å…¶ä»–åˆ†æ•°æˆ–æ¦‚ç‡è¾ƒé«˜çš„ token ä¹Ÿæœ‰æœºä¼šè¢«é€‰ä¸­ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œè¿™ç§æŠ½æ ·å¸¦æ¥çš„éšæœºæ€§æœ‰åŠ©äºæé«˜ç”Ÿæˆè´¨é‡ã€‚&lt;/p&gt;
&lt;p&gt;ã€top-k é‡‡æ ·æ€è·¯ã€‘ï¼šåœ¨æ¯ä¸€æ­¥ï¼Œ&lt;strong&gt;åªä»æ¦‚ç‡æœ€é«˜çš„ k ä¸ªå•è¯ä¸­è¿›è¡Œéšæœºé‡‡æ ·&lt;/strong&gt;ï¼Œè€Œä¸è€ƒè™‘å…¶ä»–ä½æ¦‚ç‡çš„å•è¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Top_k/2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡è°ƒæ•´ k çš„å¤§å°ï¼Œå³å¯æ§åˆ¶é‡‡æ ·åˆ—è¡¨çš„å¤§å°ã€‚â€œè´ªå¿ƒç­–ç•¥â€ å…¶å®å°±æ˜¯ k = 1 çš„ top-k é‡‡æ ·ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-top-pé‡‡æ ·&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-top-pé‡‡æ ·&#34;&gt;#&lt;/a&gt; ä¸‰ã€top-p é‡‡æ ·&lt;/h1&gt;
&lt;p&gt;top-k æœ‰ä¸€ä¸ªç¼ºé™·ï¼Œé‚£å°±æ˜¯ k å€¼çš„é€‰å–éš¾ä»¥ç¡®å®šï¼Œäºæ˜¯å‡ºç°äº†åŠ¨æ€è®¾ç½® token å€™é€‰åˆ—è¡¨å¤§å°ç­–ç•¥ â€”â€” å³æ ¸é‡‡æ ·ï¼ˆNucleus Samplingï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ã€top-p é‡‡æ ·æ€è·¯ã€‘ï¼šåœ¨æ¯ä¸€æ­¥ï¼Œåªä»ç´¯ç§¯æ¦‚ç‡è¶…è¿‡æŸä¸ªé˜ˆå€¼ p çš„æœ€å°å•è¯é›†åˆä¸­è¿›è¡Œéšæœºé‡‡æ ·ï¼Œè€Œä¸è€ƒè™‘å…¶ä»–ä½æ¦‚ç‡çš„å•è¯ã€‚è¿™ç§æ–¹æ³•ä¹Ÿè¢«ç§°ä¸ºæ ¸é‡‡æ ·ï¼ˆnucleus samplingï¼‰ï¼Œå› ä¸ºå®ƒåªå…³æ³¨æ¦‚ç‡åˆ†å¸ƒçš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œè€Œå¿½ç•¥äº†å°¾éƒ¨éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Top_k/3.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;top-p å€¼é€šå¸¸è®¾ç½®ä¸ºæ¯”è¾ƒé«˜çš„å€¼ï¼ˆå¦‚ 0.75ï¼‰ï¼Œç›®çš„æ˜¯é™åˆ¶ä½æ¦‚ç‡ token çš„é•¿å°¾ã€‚å¯ä»¥åŒæ—¶ä½¿ç”¨ top-k å’Œ top-pã€‚&lt;strong&gt;å¦‚æœ k å’Œ p åŒæ—¶å¯ç”¨ï¼Œåˆ™ p åœ¨ k ä¹‹åèµ·ä½œç”¨&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;å››-temperatureé‡‡æ ·&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å››-temperatureé‡‡æ ·&#34;&gt;#&lt;/a&gt; å››ã€Temperature é‡‡æ ·&lt;/h1&gt;
&lt;p&gt;Temperature é‡‡æ ·å—ç»Ÿè®¡çƒ­åŠ›å­¦çš„å¯å‘ï¼Œé«˜æ¸©æ„å‘³ç€æ›´å¯èƒ½é‡åˆ°ä½èƒ½æ€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Temperature è¿™ä¸ªå‚æ•°å¯ä»¥å‘Šè¯‰æœºå™¨å¦‚ä½•åœ¨è´¨é‡å’Œå¤šæ ·æ€§ä¹‹é—´è¿›è¡Œæƒè¡¡ã€‚è¾ƒä½çš„ temperature æ„å‘³ç€æ›´é«˜çš„è´¨é‡ï¼Œè€Œè¾ƒé«˜çš„ temperature æ„å‘³ç€æ›´é«˜çš„å¤šæ ·æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Temperature é‡‡æ ·å…¬å¼æ—¶åœ¨ softmax ä¸ŠåŠ äº†ä¸€ä¸ªè¶…å‚æ•°ï¼Œç”¨æ¥å¹³è¡¡ diverseï¼ˆå¤šæ ·æ€§ï¼‰ï¼Œä¸€èˆ¬çš„ softmax å…¬å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;â€²&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;â€²&lt;/mo&gt;&lt;/msup&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;P_t(w)=\frac{exp(s_w)}{\sum_{w^{\prime}\in V}exp(s_{w^{\prime}})}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.44008em;vertical-align:-1.01308em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mop&#34;&gt;&lt;span class=&#34;mop op-symbol small-op&#34; style=&#34;position:relative;top:-0.0000050000000000050004em;&#34;&gt;âˆ‘&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.17862099999999992em;&#34;&gt;&lt;span style=&#34;top:-2.40029em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6828285714285715em;&#34;&gt;&lt;span style=&#34;top:-2.786em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;â€²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.22222em;&#34;&gt;V&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32708000000000004em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32797999999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6828285714285715em;&#34;&gt;&lt;span style=&#34;top:-2.786em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;â€²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.01308em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;åŠ å…¥æ¸©åº¦è¶…å‚æ•°è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mi&gt;Ï„&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;â€²&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;â€²&lt;/mo&gt;&lt;/msup&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mi&gt;Ï„&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;P_t(w)=\frac{exp(s_w/\tau)}{\sum_{w^{\prime}\in V}exp(s_{w^{\prime}}/\tau)}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.44008em;vertical-align:-1.01308em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mop&#34;&gt;&lt;span class=&#34;mop op-symbol small-op&#34; style=&#34;position:relative;top:-0.0000050000000000050004em;&#34;&gt;âˆ‘&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.17862099999999992em;&#34;&gt;&lt;span style=&#34;top:-2.40029em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6828285714285715em;&#34;&gt;&lt;span style=&#34;top:-2.786em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;â€²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.22222em;&#34;&gt;V&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32708000000000004em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32797999999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6828285714285715em;&#34;&gt;&lt;span style=&#34;top:-2.786em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;â€²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.1132em;&#34;&gt;Ï„&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.1132em;&#34;&gt;Ï„&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.01308em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ï„&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tau&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.1132em;&#34;&gt;Ï„&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; çš„å€¼è¶Šå¤§ï¼Œæ¦‚ç‡åˆ†å¸ƒå°±è¶Šæ¥è¿‘äº uniformï¼ˆå‡åŒ€åˆ†å¸ƒï¼‰ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ï„&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tau&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.1132em;&#34;&gt;Ï„&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; çš„å€¼è¶Šå°ï¼Œæ¦‚ç‡å¯†åº¦å°±è¶Šå‡ ç§åœ¨æŸå‡ ä¸ª token ä¸Šï¼Œå¯ä»¥ç”Ÿæˆå…·æœ‰æ›´å°å¤šæ ·æ€§çš„å¥å­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Top_k/4.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;äº”-è”åˆé‡‡æ ·&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äº”-è”åˆé‡‡æ ·&#34;&gt;#&lt;/a&gt; äº”ã€è”åˆé‡‡æ ·&lt;/h1&gt;
&lt;p&gt;é€šå¸¸å°† top-kã€top-pã€Temperature è”åˆèµ·æ¥ä½¿ç”¨ã€‚ä½¿ç”¨çš„å…ˆåé¡ºåºæ˜¯ top-k-&amp;gt;top-p-&amp;gt;Temperatureã€‚ä¸¾ä¾‹è¯´æ˜å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰é¦–å…ˆè®¾ç½® top-k = 3ï¼Œè¡¨ç¤ºä¿ç•™æ¦‚ç‡æœ€é«˜çš„ 3 ä¸ª tokenã€‚è¿™æ ·å°±ä¼šä¿ç•™å¥³å­©ã€é‹å­ã€å¤§è±¡è¿™ 3 ä¸ª tokenã€‚&lt;/p&gt;
&lt;p&gt;å¥³å­©ï¼š0.664&lt;br&gt;
 é‹å­ï¼š0.199&lt;br&gt;
 å¤§è±¡ï¼š0.105&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ top-p çš„æ–¹æ³•ï¼Œä¿ç•™æ¦‚ç‡çš„ç´¯è®¡å’Œè¾¾åˆ° 0.8 çš„å•è¯ï¼Œä¹Ÿå°±æ˜¯é€‰å–å¥³å­©å’Œé‹å­è¿™ä¸¤ä¸ª tokenã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ3ï¼‰æœ€åä½¿ç”¨ Temperature = 0.7 è¿›è¡Œå½’ä¸€åŒ–ï¼Œå˜æˆï¼š&lt;/p&gt;
&lt;p&gt;å¥³å­©ï¼š0.660&lt;br&gt;
 é‹å­ï¼š0.340&lt;/p&gt;
&lt;p&gt;æ¥ç€ï¼Œä»ä¸Šè¿°åˆ†å¸ƒä¸­è¿›è¡Œéšæœºé‡‡æ ·ï¼Œé€‰å–ä¸€ä¸ªå•è¯ä½œä¸ºæœ€ç»ˆçš„ç”Ÿæˆç»“æœã€‚&lt;/p&gt;
&lt;h1 id=&#34;å…­-frequency-penalty-å’Œ-presence-penalty&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å…­-frequency-penalty-å’Œ-presence-penalty&#34;&gt;#&lt;/a&gt; å…­ã€frequency penalty å’Œ presence penalty&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;é¢‘ç‡æƒ©ç½šå’Œå­˜åœ¨æƒ©ç½šï¼ˆfrequency and presence penaltiesï¼‰&lt;/strong&gt;ã€‚ è¿™äº›å‚æ•°æ˜¯å¦ä¸€ç§è®©æ¨¡å‹åœ¨è´¨é‡å’Œå¤šæ ·æ€§ä¹‹é—´è¿›è¡Œæƒè¡¡çš„æ–¹æ³•ã€‚&lt;strong&gt;temperature å‚æ•°é€šè¿‡åœ¨ token é€‰æ‹©ï¼ˆtoken samplingï¼‰è¿‡ç¨‹ä¸­æ·»åŠ éšæœºæ€§æ¥å®ç°è¾“å‡ºå†…å®¹çš„å¤šæ ·æ€§ï¼Œè€Œé¢‘ç‡æƒ©ç½šå’Œå­˜åœ¨æƒ©ç½šåˆ™é€šè¿‡å¯¹å·²åœ¨æ–‡æœ¬ä¸­å‡ºç°çš„ token æ–½åŠ æƒ©ç½šä»¥å¢åŠ è¾“å‡ºå†…å®¹çš„å¤šæ ·æ€§ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¢‘ç‡æƒ©ç½šï¼ˆfrequency penaltyï¼‰&lt;/strong&gt;ï¼šè®© token æ¯æ¬¡åœ¨æ–‡æœ¬ä¸­å‡ºç°éƒ½å—åˆ°æƒ©ç½šã€‚è¿™å¯ä»¥é˜»æ­¢é‡å¤ä½¿ç”¨ç›¸åŒçš„ token / å•è¯ / çŸ­è¯­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­˜åœ¨æƒ©ç½šï¼ˆpresence penaltyï¼‰&lt;/strong&gt;ï¼šä¸€ç§å›ºå®šçš„æƒ©ç½šï¼Œå¦‚æœä¸€ä¸ª token å·²ç»åœ¨æ–‡æœ¬ä¸­å‡ºç°è¿‡ï¼Œå°±ä¼šå—åˆ°æƒ©ç½šã€‚è¿™ä¼šå¯¼è‡´æ¨¡å‹å¼•å…¥æ›´å¤šæ–°çš„ token / å•è¯ / çŸ­è¯­ï¼Œä»è€Œä½¿å…¶è®¨è®ºçš„ä¸»é¢˜æ›´åŠ å¤šæ ·åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ä¸ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œå°†å®ƒä»¬è®¾ç½®ä¸ºé›¶æ˜¯ä¸€ä¸ªæœ€å®‰å…¨çš„é€‰æ‹©ï¼&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/12/31/AI/attention/</guid>
            <title>æ³¨æ„åŠ›æœºåˆ¶ç»¼è¿°</title>
            <link>http://qianqiu-cell.github.io/2024/12/31/AI/attention/</link>
            <category>AI</category>
            <pubDate>Tue, 31 Dec 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC82MzEzOTg1MjU=&#34;&gt;https://zhuanlan.zhihu.com/p/631398525&lt;/span&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC82NzY2NTUzNTI=&#34;&gt;https://zhuanlan.zhihu.com/p/676655352&lt;/span&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVVUNDIxazdyQS8/c3BtX2lkX2Zyb209MzMzLjEwMDcudG9wX3JpZ2h0X2Jhcl93aW5kb3dfY3VzdG9tX2NvbGxlY3Rpb24uY29udGVudC5jbGljayZhbXA7dmRfc291cmNlPWUwMTE3MmVhMjkyYzFjNjA1YjM0NjEwMWQ3MDA2YzYx&#34;&gt;https://www.bilibili.com/video/BV1UT421k7rA/?spm_id_from=333.1007.top_right_bar_window_custom_collection.content.click&amp;amp;vd_source=e01172ea292c1c605b346101d7006c61&lt;/span&gt;ã€&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC82ODc4MzIxNzI=&#34;&gt;https://zhuanlan.zhihu.com/p/687832172&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸€-æ³¨æ„åŠ›æœºåˆ¶ç®€è¿°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-æ³¨æ„åŠ›æœºåˆ¶ç®€è¿°&#34;&gt;#&lt;/a&gt; ä¸€ã€æ³¨æ„åŠ›æœºåˆ¶ç®€è¿°&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒæ³¨æ„åŠ›æœºåˆ¶ä»æœ¬è´¨ä¸Šè®²å’Œäººç±»çš„é€‰æ‹©æ€§æ³¨æ„åŠ›æœºåˆ¶ç±»ä¼¼ï¼Œæ ¸å¿ƒç›®æ ‡ä¹Ÿæ˜¯&lt;strong&gt;ä»ä¼—å¤šä¿¡æ¯ä¸­é€‰å‡ºå¯¹å½“å‰ä»»åŠ¡ç›®æ ‡æ›´åŠ å…³é”®çš„ä¿¡æ¯&lt;/strong&gt;ã€‚æœ€å…¸å‹çš„æ³¨æ„åŠ›æœºåˆ¶åŒ…æ‹¬&lt;strong&gt;è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€ç©ºé—´æ³¨æ„åŠ›æœºåˆ¶å’Œæ—¶é—´æ³¨æ„åŠ›æœºåˆ¶&lt;/strong&gt;ã€‚è¿™äº›æ³¨æ„åŠ›æœºåˆ¶å…è®¸æ¨¡å‹&lt;strong&gt;å¯¹è¾“å…¥åºåˆ—çš„ä¸åŒä½ç½®åˆ†é…ä¸åŒçš„æƒé‡&lt;/strong&gt;ï¼Œä»¥ä¾¿åœ¨å¤„ç†æ¯ä¸ªåºåˆ—å…ƒç´ æ—¶ä¸“æ³¨äºæœ€ç›¸å…³çš„éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæœ€åˆçš„æ³¨æ„åŠ›æœºåˆ¶å°†æ³¨æ„åŠ›æ±‡èšçš„è¾“å‡ºè®¡ç®—æˆä¸ºå€¼çš„åŠ æƒå’Œã€‚é€šè¿‡ Query ä¸ Key çš„æ³¨æ„åŠ›æ±‡èšï¼ˆå³ï¼Œ&lt;strong&gt;ç»™å®šä¸€ä¸ª Queryï¼Œè®¡ç®— Query ä¸ Key çš„ç›¸å…³æ€§ï¼Œç„¶åæ ¹æ® Query ä¸ Key çš„ç›¸å…³æ€§å»å’Œå¯¹åº”çš„ Value è¿›è¡Œç›¸ä¹˜&lt;/strong&gt;ï¼‰å®ç°å¯¹ Value çš„æ³¨æ„åŠ›æƒé‡åˆ†é…ï¼Œç”Ÿæˆæœ€ç»ˆçš„è¾“å‡ºç»“æœã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/attention/1.1.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ä¸Šå›¾ä¸­éœ€è¦å°†ä¸­æ–‡çš„ &amp;quot;æˆ‘&amp;quot; ç¿»è¯‘æˆè‹±æ–‡çš„ &amp;quot;me&amp;quot;ï¼Œè¿™å°±éœ€è¦ &amp;quot;æˆ‘&amp;quot; å’Œ &amp;quot;me&amp;quot; ä¹‹é—´çš„æ³¨æ„åŠ›åˆ†æ•°ç›¸å¯¹äº &amp;quot;æˆ‘&amp;quot; å’Œå…¶ä»–è‹±æ–‡å•è¯çš„è¦é«˜ã€‚Queryï¼Œ Keyï¼Œå’Œ Value çš„å«ä¹‰å¯ä»¥å¦‚ä¸‹ç†è§£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Queryï¼šå¯ä»¥å°† &amp;quot;æˆ‘&amp;quot; çœ‹ä½œæˆ Queryï¼Œå› ä¸º &amp;quot;æˆ‘&amp;quot; æ˜¯å½“å‰è¦æŸ¥è¯¢çš„ç›®æ ‡ï¼Œå³&lt;strong&gt;å½“å‰è¾“å…¥çš„ç‰¹å¾è¡¨ç¤º&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Keyï¼šé”®çŸ©é˜µé‡Œçš„æ•°æ®ç”¨æ¥è®¡ç®—è¿™äº›è¯ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå¯ä»¥å°†&lt;strong&gt;æ¯ä¸ªå•è¯çš„é‡è¦ç‰¹å¾è¡¨ç¤º&lt;/strong&gt;çœ‹ä½œæˆ Keyã€‚&lt;/li&gt;
&lt;li&gt;Valueï¼šå€¼çŸ©é˜µç”¨æ¥æ ¹æ®ç›¸ä¼¼åº¦è®¡ç®—å‡ºæœ€ç»ˆçš„è¾“å‡ºç»“æœï¼Œ&lt;strong&gt;æ¯ä¸ªå•è¯æœ¬èº«çš„ç‰¹å¾å‘é‡&lt;/strong&gt;çœ‹ä½œä¸º Valueï¼Œä¸€èˆ¬å’Œ Key æˆå¯¹å‡ºç°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ &amp;quot;é”® - å€¼&amp;quot; å¯¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äºŒ-transformerçš„æ³¨æ„åŠ›å±‚&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-transformerçš„æ³¨æ„åŠ›å±‚&#34;&gt;#&lt;/a&gt; äºŒã€Transformer çš„æ³¨æ„åŠ›å±‚&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ Transformer æ¶æ„ä¸­ï¼Œæœ‰ä¸¤å¤§çš„ç»„ä»¶ï¼Œåˆ†åˆ«æ˜¯ç¼–ç å™¨ï¼ˆEncoderï¼‰å’Œè§£ç å™¨ï¼ˆDecoderï¼‰ï¼Œ ç¼–ç å™¨ä¸»è¦æ˜¯å°†&lt;strong&gt;è¾“å…¥åºåˆ—&lt;/strong&gt;æ˜ å°„åˆ°æ½œåœ¨è¯­ä¹‰ç©ºé—´ï¼ˆ&lt;strong&gt;æ³¨æ„åŠ›å‘é‡&lt;/strong&gt;ï¼Œä¹Ÿå«ä¸Šä¸‹æ–‡å‘é‡ï¼‰ï¼Œè€Œè§£ç å™¨åˆ™æ˜¯å°†&lt;strong&gt;æ³¨æ„åŠ›å‘é‡&lt;/strong&gt;æ˜ å°„åˆ°&lt;strong&gt;è¾“å‡ºåºåˆ—&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ Transformer æ¶æ„ä¸­ï¼Œæœ‰ 3 ç§ä¸åŒçš„æ³¨æ„åŠ›å±‚ï¼š&lt;/p&gt;
&lt;p&gt;è§£ç å™¨ä¸­çš„äº¤å‰æ³¨æ„åŠ›å±‚ï¼ˆCross attention layerï¼‰&lt;br&gt;
ç¼–ç å™¨ä¸­çš„å…¨å±€è‡ªæ³¨æ„åŠ›å±‚ï¼ˆGlobal self attention layerï¼‰&lt;br&gt;
è§£ç å™¨ä¸­çš„å› æœè‡ªæ³¨æ„åŠ›å±‚ï¼ˆCausal attention layerï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/attention/2.1.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-è‡ªæ³¨æ„åŠ›æœºåˆ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-è‡ªæ³¨æ„åŠ›æœºåˆ¶&#34;&gt;#&lt;/a&gt; ä¸‰ã€è‡ªæ³¨æ„åŠ›æœºåˆ¶&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ä¸­ï¼ŒQueryï¼ŒKeyï¼ŒValue å‡é€šè¿‡è¾“å…¥åºåˆ—çš„ embedding æ˜ å°„åˆ°ã€‚å³&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Q = è¾“å…¥åºåˆ—ä¸­çš„å½“å‰ä½ç½®è¯å‘é‡&lt;/li&gt;
&lt;li&gt;K = è¾“å…¥åºåˆ—ä¸­çš„æ‰€æœ‰ä½ç½®è¯å‘é‡&lt;/li&gt;
&lt;li&gt;V = è¾“å…¥åºåˆ—ä¸­çš„æ‰€æœ‰ä½ç½®è¯å‘é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;key_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; device&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;query_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; device&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;value_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; device&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;q &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; query_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;k &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; key_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;v &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; value_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒå…·ä½“çš„æ“ä½œä¸ºï¼š&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå…ˆæ ¹æ® Queryï¼ŒKey è®¡ç®—ä¸¤è€…çš„ç›¸å…³æ€§ï¼Œç„¶åå†é€šè¿‡ softmax å‡½æ•°å¾—åˆ° æ³¨æ„åŠ›åˆ†æ•°ï¼Œä½¿ç”¨ softmax å‡½æ•°æ˜¯ä¸ºäº†ä½¿å¾—æ‰€æœ‰çš„æ³¨æ„åŠ›åˆ†æ•°åœ¨ [0,1] ä¹‹é—´ï¼Œå¹¶ä¸”å’Œä¸º 1ã€‚è¿™é‡Œçš„é‡ç‚¹åœ¨äºå¦‚ä½•è®¡ç®— Queryï¼ŒKey çš„ç›¸å…³æ€§ã€‚Queryï¼ŒKey çš„ç›¸å…³æ€§å…¬å¼ä¸€èˆ¬è¡¨ç¤ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtext&gt;score&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\text{score}(q,k_i)=\text{softmax}(\alpha(q,k_i))=\frac{\exp(\alpha(q,k_i))}{\sum_{j=1}^n\exp(\alpha(q,k_j))}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;score&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;softmax&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.55711em;vertical-align:-1.1301100000000002em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.305708em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mop&#34;&gt;&lt;span class=&#34;mop op-symbol small-op&#34; style=&#34;position:relative;top:-0.0000050000000000050004em;&#34;&gt;âˆ‘&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.804292em;&#34;&gt;&lt;span style=&#34;top:-2.40029em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2029em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.43581800000000004em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mop&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.1301100000000002em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\alpha(q,k_i)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å³è¡¨ç¤ºè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œè‡ªæ³¨æ„åŠ›æœºåˆ¶æœ‰å¾ˆå¤šå˜ä½“ï¼Œæ¯”å¦‚ï¼šåŠ æ€§æ³¨æ„åŠ›ã€ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¹‹åæ ¹æ®æ³¨æ„åŠ›åˆ†æ•°è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°å¸¦æ³¨æ„åŠ›åˆ†æ•°çš„ Valueï¼Œä»¥æ–¹ä¾¿è¿›è¡Œä¸‹æ¸¸ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtext&gt;output&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;score&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\text{output}=\text{score}(Q,K)V
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.80952em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;output&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;score&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07153em;&#34;&gt;K&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.22222em;&#34;&gt;V&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&#34;31-åŠ æ€§æ³¨æ„åŠ›æœºåˆ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#31-åŠ æ€§æ³¨æ„åŠ›æœºåˆ¶&#34;&gt;#&lt;/a&gt; 3.1 åŠ æ€§æ³¨æ„åŠ›æœºåˆ¶&lt;/h2&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/attention/3.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;åŠ æ€§æ³¨æ„åŠ›æœºåˆ¶çš„æ ¸å¿ƒæ€æƒ³æ˜¯&lt;strong&gt;é€šè¿‡ä¸€ä¸ªåŠ æ€§å‡½æ•°ç»“åˆæŸ¥è¯¢ï¼ˆQueryï¼‰ã€é”®ï¼ˆKeyï¼‰ä¿¡æ¯æ¥è®¡ç®—æ³¨æ„åŠ›æƒé‡&lt;/strong&gt;ï¼Œä¹‹åå†&lt;strong&gt;ä¾æ®è¿™äº›æƒé‡å¯¹å€¼ï¼ˆValueï¼‰è¿›è¡ŒåŠ æƒæ±‚å’Œ&lt;/strong&gt;ã€‚å…¶å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¾“å…¥æ˜ å°„ï¼šç»™å®šä¸€ä¸ªæŸ¥è¯¢å‘é‡ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œé”®å‘é‡ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;k_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œé€šè¿‡çº¿æ€§å˜æ¢å°† Query å’Œ Key æ˜ å°„åˆ°ä¸€ä¸ªå…±åŒçš„ç©ºé—´ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;W_q&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.969438em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15139200000000003em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;W_k&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åŠ æ€§èåˆä¸æ¿€æ´»ï¼šå¯¹äºæ¯ä¸ªé”® &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;k_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå°†æŸ¥è¯¢ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸å…¶è¿›è¡ŒåŠ æ€§èåˆï¼Œç„¶åé€šè¿‡ä¸€ä¸ªéçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ tanh æˆ– ReLUï¼‰æ¥å¢å¼ºè¡¨è¾¾èƒ½åŠ›ï¼Œæœ€åå°†èåˆåçš„å‘é‡é€šè¿‡ä¸€ä¸ªçº¿æ€§å±‚ï¼ˆæƒé‡çŸ©é˜µ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;W_v&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼‰ï¼Œä¸Šè¿°ä¸¤æ­¥çš„å…¬å¼å¦‚ä¸‹ï¼Œå…¶ä¸­&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\alpha(q,k_i)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤ºæ³¨æ„åŠ›å‡½æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mtext&gt;T&lt;/mtext&gt;&lt;/msubsup&gt;&lt;mtext&gt;tanh&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\alpha(q,k_i)=W_v^{\text{T}}\text{tanh}(W_q^Tq+W_kk_i)
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.274439em;vertical-align:-0.383108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8913309999999999em;&#34;&gt;&lt;span style=&#34;top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.247em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;tanh&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.891331em;&#34;&gt;&lt;span style=&#34;top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.1130000000000004em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.383108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ³¨æ„åŠ›æƒé‡è®¡ç®—ï¼šåˆ©ç”¨ softmax å‡½æ•°ï¼Œå¾—åˆ°æ³¨æ„åŠ›æƒé‡&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;a_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œç”¨äºè¡¨ç¤ºå¯¹æ¯ä¸ªå€¼&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;v_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; çš„é‡è§†ç¨‹åº¦ã€‚å…·ä½“å…¬å¼å¦‚ä¸‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mtext&gt;exp&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mtext&gt;exp&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;a_i=\text{softmax}(\alpha(q,k_i))=\frac{\text{exp}(\alpha(q,k_i))}{\sum_{j=1}^n\text{exp}(\alpha(q,k_j))}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;softmax&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.55711em;vertical-align:-1.1301100000000002em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.305708em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mop&#34;&gt;&lt;span class=&#34;mop op-symbol small-op&#34; style=&#34;position:relative;top:-0.0000050000000000050004em;&#34;&gt;âˆ‘&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.804292em;&#34;&gt;&lt;span style=&#34;top:-2.40029em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2029em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.43581800000000004em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;exp&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;exp&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.1301100000000002em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŠ æƒæ±‚å’Œï¼šæœ€åï¼Œæ ¹æ®è®¡ç®—å‡ºçš„æ³¨æ„åŠ›æƒé‡&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;a_{i}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å¯¹æ‰€æœ‰å€¼å‘é‡&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;v_{i}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°æœ€ç»ˆçš„ä¸Šä¸‹æ–‡å‘é‡&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;c&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;c=\sum_{i=1}^n a_iv_i
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.929066em;vertical-align:-1.277669em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.6513970000000002em;&#34;&gt;&lt;span style=&#34;top:-1.872331em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.050005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;âˆ‘&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.3000050000000005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.277669em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&#34;32-ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›æœºåˆ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#32-ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›æœºåˆ¶&#34;&gt;#&lt;/a&gt; 3.2 ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›æœºåˆ¶&lt;/h2&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/attention/3.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ Transformer æ–‡ç« æå‡ºçš„æ³¨æ„åŠ›è®¡ç®—æ–¹æ³•ï¼Œç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›æœºåˆ¶çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¯¹äºæŸ¥è¯¢ï¼ˆQueryï¼‰å’Œä¸€ç³»åˆ—é”®å€¼å¯¹ï¼ˆKey-Value Pairsï¼‰çš„é›†åˆï¼Œ&lt;strong&gt;é€šè¿‡è®¡ç®—æŸ¥è¯¢ä¸æ¯ä¸ªé”®çš„ç‚¹ç§¯ï¼Œå¹¶åˆ©ç”¨ softmax å‡½æ•°å°†è¿™äº›ç‚¹ç§¯è½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼Œä»¥æ­¤æ¥ç¡®å®šæ¯ä¸ªå€¼çš„é‡è¦æ€§ï¼Œæœ€ç»ˆåŠ æƒæ±‚å’Œå¾—åˆ°è¾“å‡º&lt;/strong&gt;ã€‚å…·ä½“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li T=&#34;&#34;&gt;ç‚¹ç§¯è®¡ç®—ï¼šé¦–å…ˆï¼Œå¯¹æ¯ä¸ªæŸ¥è¯¢å‘é‡ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸æ‰€æœ‰é”®å‘é‡ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;k_{i}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è®¡ç®—ç‚¹ç§¯ï¼Œç”ŸæˆåŸå§‹åŒ¹é…åˆ†æ•°çŸ©é˜µ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;S&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;S&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå³ S_{i}=q\cdot k_{i}^&lt;/li&gt;
&lt;li&gt;ç¼©æ”¾æ“ä½œï¼šç„¶åï¼Œå°†ä¸Šè¿°åŒ¹é…åˆ†æ•°é™¤ä»¥&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;â€‹&lt;/mtext&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;d_{k}â€‹&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;â€‹ï¼Œä»¥å®Œæˆç¼©æ”¾æ“ä½œï¼Œç¡®ä¿æ•°å€¼ç¨³å®šæ€§ã€‚ä¸Šè¿°ä¸¤æ­¥çš„å…¬å¼å¦‚ä¸‹ï¼Œå…¶ä¸­&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\alpha(q,k_i)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤ºæ³¨æ„åŠ›å‡½æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;â‹…&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\alpha(q,k_i)=\frac{q\cdot k_{i}^{T}}{\sqrt{d_{k}}}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.448331em;vertical-align:-0.93em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.5183309999999999em;&#34;&gt;&lt;span style=&#34;top:-2.25278em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.85722em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.81722em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.18278000000000005em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;â‹…&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8413309999999999em;&#34;&gt;&lt;span style=&#34;top:-2.441336em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.258664em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.93em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ³¨æ„åŠ›æƒå€¼è®¡ç®—ï¼šæ¥ä¸‹æ¥ï¼Œåº”ç”¨ softmax å‡½æ•°åˆ°ç¼©æ”¾åçš„åˆ†æ•°ä¸Šï¼Œå°†å…¶è½¬åŒ–ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼Œåæ˜ äº†æ¯ä¸ªå€¼ç›¸å¯¹äºæŸ¥è¯¢çš„é‡è¦æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mtext&gt;exp&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mtext&gt;exp&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;a_i=\text{softmax}(\alpha(q,k_i))=\frac{\text{exp}(\alpha(q,k_i))}{\sum_{j=1}^n\text{exp}(\alpha(q,k_j))}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;softmax&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.55711em;vertical-align:-1.1301100000000002em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.305708em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mop&#34;&gt;&lt;span class=&#34;mop op-symbol small-op&#34; style=&#34;position:relative;top:-0.0000050000000000050004em;&#34;&gt;âˆ‘&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.804292em;&#34;&gt;&lt;span style=&#34;top:-2.40029em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2029em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.43581800000000004em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;exp&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;exp&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.1301100000000002em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŠ æƒæ±‚å’Œï¼šæœ€åï¼Œä½¿ç”¨å¾—åˆ°çš„æ¦‚ç‡åˆ†å¸ƒå¯¹å€¼çŸ©é˜µ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;V&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.22222em;&#34;&gt;V&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œç”Ÿæˆæœ€ç»ˆçš„ä¸Šä¸‹æ–‡å‘é‡ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;c&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå³æ¯ä¸ªæŸ¥è¯¢ä½ç½®çš„è¾“å‡ºã€‚ä»¥ä¸Šæ­¥éª¤çš„å…¬å¼å¦‚ä¸‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;c=\sum_{i=1}^n a_{i}v_{i}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.929066em;vertical-align:-1.277669em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.6513970000000002em;&#34;&gt;&lt;span style=&#34;top:-1.872331em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.050005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;âˆ‘&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.3000050000000005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.277669em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-äº¤å‰æ³¨æ„åŠ›æœºåˆ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-äº¤å‰æ³¨æ„åŠ›æœºåˆ¶&#34;&gt;#&lt;/a&gt; ä¸‰ã€äº¤å‰æ³¨æ„åŠ›æœºåˆ¶&lt;/h1&gt;
&lt;p&gt;äº¤å‰æ³¨æ„åŠ›æœºåˆ¶è®¡ç®—æµç¨‹ç±»ä¼¼äºè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œä½†æœ‰ä¸€ä¸ªå…³é”®åŒºåˆ«ï¼š&lt;strong&gt;è‡ªæ³¨æ„åŠ›æœºåˆ¶ä¸­çš„æŸ¥è¯¢ã€é”®å’Œå€¼éƒ½æ¥è‡ªåŒä¸€ä¸ªè¾“å…¥åºåˆ—ï¼Œè€Œäº¤å‰æ³¨æ„åŠ›æœºåˆ¶çš„æŸ¥è¯¢å’Œé”® / å€¼æ¥è‡ªä¸åŒçš„è¾“å…¥åºåˆ—&lt;/strong&gt;ã€‚å³ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥è¯¢&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;Q&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{Q}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8805499999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;Q&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ¥è‡ªä¸€ä¸ªè¾“å…¥åºåˆ—ï¼ˆå¦‚é—®é¢˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é”®&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{K}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68611em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;K&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œå€¼&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{V}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68611em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34; style=&#34;margin-right:0.01597em;&#34;&gt;V&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ¥è‡ªå¦ä¸€ä¸ªè¾“å…¥åºåˆ—ï¼ˆå¦‚æ®µè½æˆ–ä¸Šä¸‹æ–‡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ Transformer ä¸­ï¼Œäº¤å‰æ³¨æ„åŠ›å±‚ä½äºå­—é¢ä¸Šçš„ä¸­å¿ƒä½ç½®ï¼›å®ƒè¿æ¥äº†ç¼–ç å™¨å’Œè§£ç å™¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Q = è§£ç å™¨ä¸­å› æœæ³¨æ„åŠ›å±‚çš„è¾“å‡ºå‘é‡&lt;/li&gt;
&lt;li&gt;K = ç¼–ç å™¨è¾“å‡ºçš„æ³¨æ„åŠ›å‘é‡&lt;/li&gt;
&lt;li&gt;V = ç¼–ç å™¨è¾“å‡ºçš„æ³¨æ„åŠ›å‘é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;å››-å› æœæ³¨æ„åŠ›å±‚&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å››-å› æœæ³¨æ„åŠ›å±‚&#34;&gt;#&lt;/a&gt; å››ã€å› æœæ³¨æ„åŠ›å±‚&lt;/h1&gt;
&lt;p&gt;å› æœæ³¨æ„åŠ›å±‚å¯¹&lt;strong&gt;è§£ç å™¨ä¸­è¾“å‡ºåºåˆ—&lt;/strong&gt;æ‰§è¡Œç±»ä¼¼äºå…¨å±€è‡ªæ³¨æ„åŠ›å±‚çš„å·¥ä½œï¼›ä½†ä¸ç¼–ç å™¨çš„å…¨å±€è‡ªæ³¨æ„åŠ›å±‚æœ‰ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;Transformer æ˜¯ä¸€ä¸ª â€œè‡ªå›å½’â€ æ¨¡å‹ï¼Œæ¯ä¸ªåºåˆ—å…ƒç´ çš„è¾“å‡ºåªä¾èµ–äºå‰é¢çš„åºåˆ—å…ƒç´ ï¼Œæ¨¡å‹å…·æœ‰ â€œå› æœâ€ æ€§ã€‚&lt;/p&gt;
&lt;p&gt;è¦æ„å»ºä¸€ä¸ªå› æœè‡ªæ³¨æ„åŠ›å±‚ï¼Œåœ¨è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°å’Œæ±‚å’Œæ³¨æ„åŠ›å€¼æ—¶éœ€è¦ä½¿ç”¨&lt;strong&gt;é€‚å½“çš„æ©ç &lt;/strong&gt;ï¼Œå› ä¸ºè¾“å‡ºåºåˆ—ä¹Ÿæ˜¯ä¸€æ¬¡æ€§è¾“å…¥çš„ï¼Œä½†åœ¨è®¡ç®—å‰é¢åˆ†è¯çš„æ—¶å€™æ˜¯ä¸å¸Œæœ›å®ƒåé¢çš„åˆ†è¯ä¹Ÿå‚ä¸è®¡ç®—çš„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Q = è¾“å‡ºåºåˆ—ä¸­çš„å½“å‰ä½ç½®è¯å‘é‡&lt;/li&gt;
&lt;li&gt;K = è¾“å‡ºåºåˆ—ä¸­çš„æ‰€æœ‰ä½ç½®è¯å‘é‡&lt;/li&gt;
&lt;li&gt;V = è¾“å‡ºåºåˆ—ä¸­çš„æ‰€æœ‰ä½ç½®è¯å‘é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/attention/4.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;äº”-å…¶ä»–æ³¨æ„åŠ›æœºåˆ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äº”-å…¶ä»–æ³¨æ„åŠ›æœºåˆ¶&#34;&gt;#&lt;/a&gt; äº”ã€å…¶ä»–æ³¨æ„åŠ›æœºåˆ¶&lt;/h1&gt;
&lt;h2 id=&#34;51-flash-attention&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#51-flash-attention&#34;&gt;#&lt;/a&gt; 5.1 Flash Attention&lt;/h2&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/attention/5.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;FlashAttention æ—¨åœ¨&lt;strong&gt;åŠ é€Ÿæ³¨æ„åŠ›è®¡ç®—å¹¶å‡å°‘å†…å­˜å ç”¨&lt;/strong&gt;ã€‚FlashAttention åˆ©ç”¨åº•å±‚ç¡¬ä»¶çš„å†…å­˜å±‚æ¬¡çŸ¥è¯†ï¼Œä¾‹å¦‚ GPU çš„å†…å­˜å±‚æ¬¡ç»“æ„ï¼Œæ¥æé«˜è®¡ç®—é€Ÿåº¦å’Œå‡å°‘å†…å­˜è®¿é—®å¼€é”€ã€‚ FlashAttention çš„æ ¸å¿ƒåŸç†æ˜¯é€šè¿‡&lt;strong&gt;å°†è¾“å…¥åˆ†å—å¹¶åœ¨æ¯ä¸ªå—ä¸Šæ‰§è¡Œæ³¨æ„åŠ›æ“ä½œ&lt;/strong&gt;ï¼Œä»è€Œå‡å°‘å¯¹é«˜å¸¦å®½å†…å­˜ï¼ˆHBMï¼‰çš„è¯»å†™æ“ä½œã€‚å…·ä½“è€Œè¨€ï¼ŒFlashAttention ä½¿ç”¨å¹³é“ºå’Œé‡è®¡ç®—ç­‰ç»å…¸æŠ€æœ¯ï¼Œå°†è¾“å…¥å—ä» HBM åŠ è½½åˆ° SRAMï¼ˆå¿«é€Ÿç¼“å­˜ï¼‰ï¼Œåœ¨ SRAM ä¸Šæ‰§è¡Œæ³¨æ„åŠ›æ“ä½œï¼Œå¹¶å°†ç»“æœæ›´æ–°å› HBMã€‚FlashAttention å‡å°‘äº†å†…å­˜è¯»å†™é‡ï¼Œä»è€Œå®ç°äº† 2-4 å€çš„æ—¶é’Ÿæ—¶é—´åŠ é€Ÿã€‚&lt;/p&gt;
&lt;p&gt;æ–‡ç« ã€ŠFlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awarenessã€‹åœ¨è®ºæ–‡ç¬¬ä¸€å¥æŒ‡å‡º â€œTransformers are slow and memory-hungry on long sequences, since the time and memory complexity of self-attention are quadratic in sequence length.â€ï¼Œå¯ä»¥çœ‹å‡º&lt;strong&gt;ç”±äº Transformer ä¸­ self-attention çš„æ—¶é—´å’Œå†…å­˜å¤æ‚åº¦æ˜¯åºåˆ—é•¿åº¦çš„äºŒæ¬¡æ–¹ï¼Œæ‰€ä»¥åºåˆ—è¿‡é•¿æ—¶ï¼Œç®—æ³•é€Ÿåº¦ä¼šå˜æ…¢ï¼Œéœ€è¦æ¶ˆè€—å¾ˆé«˜çš„å†…å­˜&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1-é¢„å¤‡çŸ¥è¯†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1-é¢„å¤‡çŸ¥è¯†&#34;&gt;#&lt;/a&gt; (1) é¢„å¤‡çŸ¥è¯†&lt;/h3&gt;
&lt;p&gt;ï¼ˆ1ï¼‰HBMï¼ˆHigh Bandwidth Memory, é«˜å¸¦å®½å†…å­˜ï¼‰å’Œ SRAMï¼ˆStatic Random-Access Memory, å¿«é€Ÿç¼“å­˜ï¼‰&lt;/p&gt;
&lt;p&gt;HBM å’Œ SRAM æ˜¯ä¸¤ç§ä¸åŒç±»å‹çš„è®¡ç®—æœºå†…å­˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HBM æ˜¯ä¸€ç§&lt;strong&gt;é«˜å¸¦å®½å†…å­˜æ¥å£&lt;/strong&gt;ï¼Œç”¨äº 3D å †å çš„ SDRAMï¼Œ&lt;strong&gt;å…·æœ‰è¾ƒé«˜çš„å¸¦å®½å’Œè¾ƒä½çš„åŠŸè€—&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;SRAM æ˜¯ä¸€ç§&lt;strong&gt;é™æ€éšæœºè®¿é—®å­˜å‚¨å™¨&lt;/strong&gt;ï¼Œç”¨äºé«˜é€Ÿç¼“å­˜ç­‰å†…éƒ¨å­˜å‚¨å™¨ï¼Œ&lt;strong&gt;å…·æœ‰æ›´å¿«çš„è®¿é—®é€Ÿåº¦å’Œæ›´ä½çš„å»¶è¿Ÿ&lt;/strong&gt;ï¼Œä½†æˆæœ¬æ›´é«˜ä¸”å ç”¨æ›´å¤šèŠ¯ç‰‡ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯ GPU A100 çš„å†…å­˜åˆ†å¸ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/attention/5.2jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰MAC (Memory Access Costï¼Œå­˜å‚¨è®¿é—®å¼€é”€)&lt;/p&gt;
&lt;p&gt;MACï¼ˆMemory Access Costï¼Œå­˜å‚¨è®¿é—®å¼€é”€ï¼‰æ˜¯æŒ‡åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œ&lt;strong&gt;è®¿é—®å†…å­˜æˆ–å­˜å‚¨å™¨æ‰€éœ€çš„æ—¶é—´å’Œèµ„æºå¼€é”€&lt;/strong&gt;ã€‚å®ƒæ˜¯è¡¡é‡è®¡ç®—æœºç¨‹åºæˆ–ç®—æ³•æ€§èƒ½çš„é‡è¦æŒ‡æ ‡ä¹‹ä¸€ã€‚ MAC çš„å€¼å–å†³äºå¤šä¸ªå› ç´ ï¼ŒåŒ…æ‹¬å†…å­˜å±‚æ¬¡ç»“æ„ã€ç¼“å­˜å‘½ä¸­ç‡ã€å†…å­˜å¸¦å®½ã€å­˜å‚¨å™¨å»¶è¿Ÿç­‰ã€‚è¾ƒä½çš„ MAC å€¼è¡¨ç¤ºè®¿é—®å†…å­˜çš„å¼€é”€è¾ƒå°ï¼Œè€Œè¾ƒé«˜çš„ MAC å€¼è¡¨ç¤ºè®¿é—®å†…å­˜çš„å¼€é”€è¾ƒå¤§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;2-flashattention-åŸç†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2-flashattention-åŸç†&#34;&gt;#&lt;/a&gt; (2) FlashAttention åŸç†&lt;/h2&gt;
&lt;p&gt;ä¼ ç»Ÿ Attention çš„è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/attention/5.3.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;FlashAttention çš„æ ¸å¿ƒæ€æƒ³æ˜¯å‡å°‘ HBM çš„è¯»å†™ï¼Œä½¿ç”¨åˆ°çš„æ ¸å¿ƒæ–¹æ³•ä¸ºåˆ†å—è®¡ç®—ï¼Œé‡æ–°è®¡ç®—&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†å—è®¡ç®—ï¼šé€šè¿‡åˆ†å—è®¡ç®—ï¼Œèåˆå¤šä¸ªæ“ä½œï¼Œå‡å°‘ä¸­é—´ç»“æœç¼“å­˜&lt;/li&gt;
&lt;li&gt;é‡æ–°è®¡ç®—ï¼šåå‘ä¼ æ’­æ—¶ï¼Œé‡æ–°è®¡ç®—ä¸­é—´ç»“æœ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› ä¸º Attention è®¡ç®—ä¸­æ¶‰åŠ softmaxï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•çš„åˆ†å—åç›´æ¥è®¡ç®—ã€‚softmax æ“ä½œæ˜¯ row-wise çš„ï¼Œå³æ¯è¡Œéƒ½ç®—ä¸€æ¬¡ softmaxï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°å¹³é“ºç®—æ³•æ¥åˆ†å—è®¡ç®— softmaxã€‚&lt;strong&gt;FlashAttention é‡‡ç”¨ safe softmaxï¼Œæ¥è¿›è¡Œåˆ†å—è®¡ç®—&lt;/strong&gt;ï¼Œå…·ä½“çš„çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/attention/5.4.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/12/30/AI/RFT/</guid>
            <title>RFTï¼ˆæ‹’ç»é‡‡æ ·ï¼‰</title>
            <link>http://qianqiu-cell.github.io/2024/12/30/AI/RFT/</link>
            <category>AI</category>
            <pubDate>Mon, 30 Dec 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒï¼šè®ºæ–‡ã€ŠScaling Relationship on Learning Mathematical Reasoning with Large Language Modelsã€‹ã€&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuemhpaHUuY29tL3RhcmRpcy9iZC9hcnQvNzAzODQ4NjI3&#34;&gt;https://www.zhihu.com/tardis/bd/art/703848627&lt;/span&gt;ã€&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC81MDc4MzA1NzY=&#34;&gt;https://zhuanlan.zhihu.com/p/507830576&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒRFTï¼ˆRejection sampling Fine-Tuningï¼Œæ‹’ç»é‡‡æ ·å¾®è°ƒï¼‰çš„æ•´ä½“æ€è·¯æ˜¯ä½¿ç”¨å¤šä¸ªæ¨¡å‹ç”Ÿæˆæ¨ç†è·¯å¾„ï¼Œç»è¿‡è´¨é‡ç­›é€‰å’Œå¤šæ ·æ€§ç­›é€‰ä¹‹åï¼Œè·å¾—å¢å¼ºçš„æ•°æ®é›†ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªé—®é¢˜éƒ½å¯¹åº”äº†å¤šç§è§£æï¼Œç”¨ä½œè®­ç»ƒé›†è®­ç»ƒæ¨¡å‹ã€‚RFT çš„æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;1ã€&lt;strong&gt;è®­ç»ƒä¸€è½®å°æ¨¡å‹å’Œå¤§æ¨¡å‹&lt;/strong&gt;ï¼šé¦–å…ˆåˆ©ç”¨æ•°æ®é›†ï¼ˆå¦‚ GSM8Kï¼‰&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;}&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;D=\{q_i,r_i,a_i\}_{i}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;mclose&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å°†é¢„è®­ç»ƒå¤§è¯­è¨€æ¨¡å‹ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ï&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\rho&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ï&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; é€šè¿‡ç›‘ç£å¾®è°ƒè·å¾— SFT æ¨¡å‹&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ï€&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\pi&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï€&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å…¶ä¸­è¡¨ç¤ºé—®é¢˜ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;r_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤ºæ¨ç†ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;a_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤ºç­”æ¡ˆï¼›&lt;/p&gt;
&lt;p&gt;2ã€&lt;strong&gt;é€‰æ‹©æ¨ç†è·¯å¾„&lt;/strong&gt;ï¼šå¯¹äºæ¯ä¸€ä¸ªé—®é¢˜&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œä½¿ç”¨ SFT æ¨¡å‹ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ï€&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\pi&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï€&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ¥ç”Ÿæˆ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;k&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ªå€™é€‰æ¨ç†è·¯å¾„&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;r&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œç­”æ¡ˆ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;a&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œè¿‡æ»¤æ‰æ¨¡å‹ç”Ÿæˆç­”æ¡ˆå’Œæ ‡å‡†ç­”æ¡ˆä¸ä¸€è‡´çš„æ¨ç†è·¯å¾„ï¼Œå¹¶åˆ é™¤å…·æœ‰ç›¸åŒæ–¹ç¨‹åˆ—è¡¨çš„å…¶ä»–æ¨ç†è·¯å¾„ä»¥é™ä½æ¨ç†è·¯å¾„çš„é‡å¤ï¼Œå¢åŠ æ•°æ®é›†çš„å¤šæ ·æ€§ï¼›&lt;/p&gt;
&lt;p&gt;3ã€&lt;strong&gt;è·å¾—å¢å¼ºæ•°æ®é›†&lt;/strong&gt;å®šä¹‰&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;â€²&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;âˆª&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;{&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;}&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;D&amp;#x27;=D\cup\{qi,r_{i,j},a_i\}_{i,j}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.751892em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.751892em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;â€²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆª&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.036108em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;mclose&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä½œä¸ºå¢å¼ºæ•°æ®é›†ã€‚ä½¿ç”¨æ•°æ®é›†&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;â€²&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;D&amp;#x27;&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.751892em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.751892em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;â€²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; åœ¨é¢„è®­ç»ƒæ¨¡å‹&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ï&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\rho&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ï&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸Šè¿›è¡Œå¾®è°ƒå¾—åˆ°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Ï€&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\pi_{RFT}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï€&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå¾—åˆ° RFT æ¨¡å‹ã€‚&lt;br&gt;
ä½¿ç”¨æ–°çš„æ•°æ®é›†å¾®è°ƒæ¨¡å‹ï¼šä½¿ç”¨æ–°çš„æ¨ç†æ•°æ®é›† R^s å¾®è°ƒä¸€è½®å°æ¨¡å‹ï¼Œå¹¶å°†å…¶ç”¨äºå¾®è°ƒå³è¾¹çš„ llama2-70Bï¼›&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä»å•ä¸ª SFT æ¨¡å‹ä¸­é‡‡æ ·çš„æ¨ç†è·¯å¾„å¯èƒ½åœ¨é€»è¾‘ä¸Šæ˜¯éå¤šæ ·åŒ–çš„ã€‚å› æ­¤ï¼Œå¯ä»¥åˆ©ç”¨ä»ä¸åŒæ¨¡å‹èšåˆçš„æ‹’ç»é‡‡æ ·æ¨ç†è·¯å¾„æ¥è¿›ä¸€æ­¥æé«˜æ•°å­¦æ¨ç†æ€§èƒ½ï¼Œå®ç°å¤šæ¨¡å‹æ‹’ç»é‡‡æ ·ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒRFT çš„å…³é”®ç‚¹æ˜¯æ­¥éª¤ 2 ä¸­é€‰æ‹©æ¨ç†è·¯å¾„ã€‚å…·ä½“åšæ³•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/RFT/1.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé¢å¯¹é‡å¤è·¯å¾„æ—¶ï¼Œåˆ©ç”¨ Levenstein Distanceï¼ˆè±æ–‡æ–¯å¦è·ç¦»ç®—æ³•ï¼‰è·å¾—ä¸æ‰€æœ‰å·²ç»ä¿å­˜è·¯å¾„æœ€ä¸ç›¸ä¼¼çš„æ¨ç†è·¯å¾„ï¼Œä»è€Œå¢åŠ å¢å¼ºæ•°æ®é›†çš„å¤šæ ·æ€§ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè±æ–‡æ–¯å¦è·ç¦»æŒ‡çš„æ˜¯å°†ä¸€ä¸ªå­—ç¬¦ä¸²å˜ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ä¸²éœ€è¦è¿›è¡Œç¼–è¾‘æ“ä½œæœ€å°‘çš„æ¬¡æ•°ã€‚å…¶ä¸­ï¼Œå…è®¸çš„ç¼–è¾‘æ“ä½œæœ‰ä»¥ä¸‹ä¸‰ç§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ã€Œæ›¿æ¢ã€ï¼šå°†ä¸€ä¸ªå­—ç¬¦æ›¿æ¢æˆå¦ä¸€ä¸ªå­—ç¬¦&lt;/li&gt;
&lt;li&gt;ã€Œæ’å…¥ã€ï¼šæ’å…¥ä¸€ä¸ªå­—ç¬¦&lt;/li&gt;
&lt;li&gt;ã€Œåˆ é™¤ã€ï¼šåˆ é™¤ä¸€ä¸ªå­—ç¬¦&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒè±æ–‡æ–¯å¦è·ç¦»ç”¨äºè¡¡é‡ä¸¤ä¸ªå­—ç¬¦ä¸²ä¹‹é—´çš„å·®å¼‚ï¼Œè¢«å¹¿æ³›åº”ç”¨äºæ‹¼å†™çº é”™æ£€æŸ¥ã€DNA åˆ†æã€è¯­éŸ³è¯†åˆ«ç­‰é¢†åŸŸã€‚&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/12/29/AI/PrecisionRecall/</guid>
            <title>å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ç­‰æŒ‡æ ‡å®šä¹‰</title>
            <link>http://qianqiu-cell.github.io/2024/12/29/AI/PrecisionRecall/</link>
            <category>AI</category>
            <pubDate>Sun, 29 Dec 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;ä¸€-æ··æ·†çŸ©é˜µ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-æ··æ·†çŸ©é˜µ&#34;&gt;#&lt;/a&gt; ä¸€ã€æ··æ·†çŸ©é˜µ&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œæ··æ·†çŸ©é˜µï¼ˆConfusion Matrixï¼‰ï¼Œåˆç§°ä¸ºå¯èƒ½æ€§çŸ©é˜µæˆ–é”™è¯¯çŸ©é˜µã€‚æ··æ·†çŸ©é˜µçš„ç»“æ„ä¸€èˆ¬å¦‚ä¸‹å›¾è¡¨ç¤ºçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/PrecisionRecall/1.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ··æ·†çŸ©é˜µè¦è¡¨è¾¾çš„å«ä¹‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ··æ·†çŸ©é˜µçš„æ¯ä¸€åˆ—ä»£è¡¨äº†&lt;strong&gt;é¢„æµ‹ç±»åˆ«&lt;/strong&gt;ï¼Œæ¯ä¸€åˆ—çš„æ€»æ•°è¡¨ç¤ºé¢„æµ‹ä¸ºè¯¥ç±»åˆ«çš„æ•°æ®çš„æ•°ç›®ï¼›&lt;/li&gt;
&lt;li&gt;æ¯ä¸€è¡Œä»£è¡¨äº†æ•°æ®çš„&lt;strong&gt;çœŸå®å½’å±ç±»åˆ«&lt;/strong&gt;ï¼Œæ¯ä¸€è¡Œçš„æ•°æ®æ€»æ•°è¡¨ç¤ºè¯¥ç±»åˆ«çš„æ•°æ®å®ä¾‹çš„æ•°ç›®ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒæ¯ä¸€ç±»çš„å…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;True Positiveï¼ˆTPï¼‰ï¼šçœŸæ­£ç±»ã€‚æ ·æœ¬çš„çœŸå®ç±»åˆ«æ˜¯æ­£ç±»ï¼Œå¹¶ä¸”æ¨¡å‹è¯†åˆ«çš„ç»“æœä¹Ÿæ˜¯æ­£ç±»ã€‚&lt;/li&gt;
&lt;li&gt;False Negativeï¼ˆFNï¼‰ï¼šå‡è´Ÿç±»ã€‚æ ·æœ¬çš„çœŸå®ç±»åˆ«æ˜¯æ­£ç±»ï¼Œä½†æ˜¯æ¨¡å‹å°†å…¶è¯†åˆ«ä¸ºè´Ÿç±»ã€‚&lt;/li&gt;
&lt;li&gt;False Positiveï¼ˆFPï¼‰ï¼šå‡æ­£ç±»ã€‚æ ·æœ¬çš„çœŸå®ç±»åˆ«æ˜¯è´Ÿç±»ï¼Œä½†æ˜¯æ¨¡å‹å°†å…¶è¯†åˆ«ä¸ºæ­£ç±»ã€‚&lt;/li&gt;
&lt;li&gt;True Negativeï¼ˆTNï¼‰ï¼šçœŸè´Ÿç±»ã€‚æ ·æœ¬çš„çœŸå®ç±»åˆ«æ˜¯è´Ÿç±»ï¼Œå¹¶ä¸”æ¨¡å‹å°†å…¶è¯†åˆ«ä¸ºè´Ÿç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒè¯¥çŸ©é˜µå¯ç”¨äºæ˜“äºç†è§£çš„äºŒç±»åˆ†ç±»é—®é¢˜ï¼Œä½†é€šè¿‡å‘æ··æ·†çŸ©é˜µæ·»åŠ æ›´å¤šè¡Œå’Œåˆ—ï¼Œå¯è½»æ¾åº”ç”¨äºå…·æœ‰ 3 ä¸ªæˆ–æ›´å¤šç±»å€¼çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè®°ä½ä»¥ä¸‹ä¸¤ä¸ªå…³é”®çš„ç†è§£æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ ¹æ®å›¾ç‰‡ï¼Œæ¨ªç€çš„æ˜¯æ•°æ®çœŸå®çš„ç±»åˆ«ï¼Œç«–ç€çš„æ˜¯æ¨¡å‹é¢„æµ‹çš„ç±»åˆ«ï¼Œå…ˆæ¨ªåç«–ï¼Œå…ˆçœŸå®ç±»åˆ«ï¼Œåæ¨¡å‹é¢„æµ‹çš„ç±»åˆ«ï¼›&lt;/li&gt;
&lt;li&gt;True è¡¨ç¤ºé¢„æµ‹æ­£ç¡®ï¼ŒFalse è¡¨ç¤ºé¢„æµ‹é”™è¯¯ï¼›Positive è¡¨ç¤ºæ¨¡å‹é¢„æµ‹ä¸ºæ­£æ ·æœ¬ï¼ŒNegative è¡¨ç¤ºæ¨¡å‹é¢„æµ‹ä¸ºè´Ÿæ ·æœ¬ï¼Œæ‰€æœ‰çš„å•è¯çš„æ„æ€éƒ½æ˜¯å’Œæ¨¡å‹é¢„æµ‹æœ‰å…³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒæ··æ·†çŸ©é˜µæ˜¯å¯¹åˆ†ç±»é—®é¢˜çš„é¢„æµ‹ç»“æœçš„æ€»ç»“ã€‚ä½¿ç”¨è®¡æ•°å€¼æ±‡æ€»æ­£ç¡®å’Œä¸æ­£ç¡®é¢„æµ‹çš„æ•°é‡ï¼Œå¹¶æŒ‰æ¯ä¸ªç±»è¿›è¡Œç»†åˆ†ï¼Œè¿™æ˜¯æ··æ·†çŸ©é˜µçš„å…³é”®æ‰€åœ¨ã€‚æ··æ·†çŸ©é˜µæ˜¾ç¤ºäº†åˆ†ç±»æ¨¡å‹çš„åœ¨è¿›è¡Œé¢„æµ‹æ—¶ä¼šå¯¹å“ªä¸€éƒ¨åˆ†äº§ç”Ÿæ··æ·†ã€‚å®ƒä¸ä»…å¯ä»¥è®©æ‚¨äº†è§£åˆ†ç±»æ¨¡å‹æ‰€çŠ¯çš„é”™è¯¯ï¼Œæ›´é‡è¦çš„æ˜¯å¯ä»¥äº†è§£å“ªäº›é”™è¯¯ç±»å‹æ­£åœ¨å‘ç”Ÿã€‚æ­£æ˜¯è¿™ç§å¯¹ç»“æœçš„åˆ†è§£å…‹æœäº†ä»…ä½¿ç”¨åˆ†ç±»å‡†ç¡®ç‡æ‰€å¸¦æ¥çš„å±€é™æ€§ã€‚&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-ä»æ··æ·†çŸ©é˜µå¾—åˆ°åˆ†ç±»æŒ‡æ ‡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-ä»æ··æ·†çŸ©é˜µå¾—åˆ°åˆ†ç±»æŒ‡æ ‡&#34;&gt;#&lt;/a&gt; äºŒã€ä»æ··æ·†çŸ©é˜µå¾—åˆ°åˆ†ç±»æŒ‡æ ‡&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒä»æ··æ·†çŸ©é˜µå½“ä¸­ï¼Œå¯ä»¥å¾—åˆ°æ›´é«˜çº§çš„åˆ†ç±»æŒ‡æ ‡ï¼šAccuracyï¼ˆç²¾ç¡®ç‡ï¼‰ï¼ŒPrecisionï¼ˆæ­£ç¡®ç‡æˆ–è€…å‡†ç¡®ç‡ï¼‰ï¼ŒRecallï¼ˆå¬å›ç‡ï¼‰ï¼ŒSpecificityï¼ˆç‰¹å¼‚æ€§ï¼‰ï¼ŒSensitivityï¼ˆçµæ•åº¦ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äºäºŒåˆ†ç±»é—®é¢˜ï¼Œæœ‰å¦‚ä¸‹å…³ç³»ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtext&gt;æ ·ä¾‹æ€»æ•°&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mtext&gt;ã€‚&lt;/mtext&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;æ ·ä¾‹æ€»æ•° = TP + FP + TN + FNã€‚
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ ·&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ä¾‹&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ€»&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ•°&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.76666em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.76666em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.76666em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&#34;21-å‡†ç¡®ç‡accuracy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-å‡†ç¡®ç‡accuracy&#34;&gt;#&lt;/a&gt; 2.1 å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒå‡†ç¡®ç‡æ˜¯æœ€å¸¸ç”¨çš„è¯„ä»·æŒ‡æ ‡ï¼Œè¡¨ç¤ºæ¨¡å‹æ­£ç¡®é¢„æµ‹çš„æ ·æœ¬å æ‰€æœ‰æ ·æœ¬çš„æ¯”ä¾‹ã€‚è®¡ç®—å…¬å¼ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;å…¬å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtext&gt;å‡†ç¡®ç‡&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mtext&gt;åˆ†ç±»æ­£ç¡®çš„æ ·æœ¬æ•°&lt;/mtext&gt;&lt;mtext&gt;æ€»æ ·æœ¬æ•°&lt;/mtext&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;å‡†ç¡®ç‡=\frac{åˆ†ç±»æ­£ç¡®çš„æ ·æœ¬æ•°}{æ€»æ ·æœ¬æ•°}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å‡†&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç¡®&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç‡&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.04633em;vertical-align:-0.686em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.36033em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ€»&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ ·&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æœ¬&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ•°&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;åˆ†&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç±»&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ­£&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç¡®&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;çš„&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ ·&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æœ¬&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ•°&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;Accuracy = \frac{TP + TN}{TP + TN + FP + FN}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8777699999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.1296600000000003em;vertical-align:-0.7693300000000001em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.36033em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7693300000000001em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¼˜ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®€å•æ˜“æ‡‚ï¼Œé€‚ç”¨äºæ•°æ®å¹³è¡¡çš„æƒ…å†µã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“æ•°æ®ä¸å¹³è¡¡æ—¶ï¼Œå‡†ç¡®ç‡å¯èƒ½ä¼šå—åˆ°æå¤§å½±å“ã€‚ä¾‹å¦‚ï¼Œåœ¨æ ·æœ¬ç±»åˆ«ä¸¥é‡ä¸å‡çš„æƒ…å†µä¸‹ï¼Œå‡†ç¡®ç‡å¯èƒ½çœ‹èµ·æ¥å¾ˆå¥½ï¼Œä½†æ¨¡å‹çš„æ€§èƒ½å´ä¸ç†æƒ³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;22-ç²¾ç¡®ç‡precision&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-ç²¾ç¡®ç‡precision&#34;&gt;#&lt;/a&gt; 2.2 ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒç²¾ç¡®ç‡åˆç§°ä¸ºæŸ¥å‡†ç‡ï¼Œè¡¨ç¤ºåœ¨æ‰€æœ‰è¢«æ¨¡å‹é¢„æµ‹ä¸ºæ­£ç±»çš„æ ·æœ¬ä¸­ï¼ŒçœŸæ­£ä¸ºæ­£ç±»çš„æ¯”ä¾‹ã€‚ç²¾ç¡®ç‡å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£æ¨¡å‹åœ¨é¢„æµ‹æ­£ç±»æ—¶çš„å‡†ç¡®åº¦ã€‚&lt;/p&gt;
&lt;p&gt;å…¬å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtext&gt;ç²¾ç¡®ç‡&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mtext&gt;çœŸæ­£ç±»&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mtext&gt;çœŸæ­£ç±»&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;å‡æ­£ç±»&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;ç²¾ç¡®ç‡=\frac{çœŸæ­£ç±»(TP)}{çœŸæ­£ç±»(TP)+å‡æ­£ç±»(FP)}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç²¾&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç¡®&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç‡&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.363em;vertical-align:-0.936em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;çœŸ&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ­£&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç±»&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å‡&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ­£&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç±»&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;çœŸ&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ­£&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç±»&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.936em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;Precision = \frac{TP}{TP + FP}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.1296600000000003em;vertical-align:-0.7693300000000001em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.36033em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7693300000000001em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¼˜ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç²¾ç¡®ç‡è¾ƒé«˜è¯´æ˜æ¨¡å‹å¯¹æ­£ç±»é¢„æµ‹çš„å¯ä¿¡åº¦é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç²¾ç¡®ç‡å¹¶ä¸å…³å¿ƒæ¨¡å‹æ˜¯å¦æ¼æ‰äº†æ­£ç±»æ ·æœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;23-å¬å›ç‡recall&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-å¬å›ç‡recall&#34;&gt;#&lt;/a&gt; 2.3 å¬å›ç‡ï¼ˆRecallï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒå¬å›ç‡åˆç§°ä¸ºæŸ¥å…¨ç‡ï¼Œè¡¨ç¤ºåœ¨æ‰€æœ‰å®é™…ä¸ºæ­£ç±»çš„æ ·æœ¬ä¸­ï¼Œæ¨¡å‹é¢„æµ‹ä¸ºæ­£ç±»çš„æ¯”ä¾‹ã€‚å¬å›ç‡è¡¡é‡æ¨¡å‹å¯¹æ­£ç±»çš„è¯†åˆ«èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;å…¬å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtext&gt;å¬å›ç‡&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mtext&gt;çœŸæ­£ç±»&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mtext&gt;çœŸæ­£ç±»&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;å‡è´Ÿç±»&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;å¬å›ç‡=\frac{çœŸæ­£ç±»(TP)}{çœŸæ­£ç±»(TP)+å‡è´Ÿç±»(FN)}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å¬&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å›&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç‡&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.363em;vertical-align:-0.936em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;çœŸ&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ­£&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç±»&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å‡&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;è´Ÿ&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç±»&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;çœŸ&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ­£&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ç±»&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.936em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;Recall = \frac{TP}{TP + FN}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.1296600000000003em;vertical-align:-0.7693300000000001em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.36033em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7693300000000001em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¼˜ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¬å›ç‡è¾ƒé«˜è¯´æ˜æ¨¡å‹èƒ½å¤Ÿè¯†åˆ«å¤§éƒ¨åˆ†çš„æ­£ç±»æ ·æœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¬å›ç‡è¾ƒé«˜å¯èƒ½æ„å‘³ç€æ›´å¤šçš„å‡æ­£ä¾‹ï¼Œå¯¼è‡´ç²¾ç¡®ç‡è¾ƒä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;24-ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„å…³ç³»&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#24-ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„å…³ç³»&#34;&gt;#&lt;/a&gt; 2.4 ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„å…³ç³»&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒç²¾ç¡®ç‡å’Œå¬å›ç‡æ˜¯ä¸€å¯¹çŸ›ç›¾çš„æŒ‡æ ‡ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç²¾ç¡®ç‡é«˜æ—¶ï¼Œå¬å›ç‡æ—ºæ—ºåä½ï¼›å¬å›ç‡é«˜æ—¶ï¼Œç²¾ç¡®ç‡å¾€å¾€åä½ã€‚ä½œä¸ºä¸¤å¤§å¸¸ç”¨çš„æŒ‡æ ‡ï¼Œæ ¹æ®ä¸åŒçš„ä»»åŠ¡ï¼Œå…·æœ‰ä¸åŒçš„é‡è¦ç¨‹åº¦ã€‚ä¸€åŠæ¥è¯´å…·æœ‰å¦‚ä¸‹è§„å¾‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç²¾ç¡®ç‡æ›´é‡è¦&lt;/strong&gt;çš„ä»»åŠ¡ï¼šé€šå¸¸æ˜¯é‚£äº›&lt;strong&gt;è¯¯æŠ¥ä»£ä»·è¾ƒé«˜&lt;/strong&gt;çš„ä»»åŠ¡ï¼Œå¦‚åƒåœ¾é‚®ä»¶è¿‡æ»¤ã€å¹¿å‘Šæ¨èå’Œä¿¡æ¯æ£€ç´¢ã€‚é€šä¿—ç†è§£ï¼š&lt;strong&gt;ä¸èƒ½å¤šé¢„æµ‹ï¼Œä¿è¯æ¨¡å‹é¢„æµ‹çš„éƒ½æ˜¯å¯¹çš„ï¼ˆé«˜äº®ä»»åŠ¡éœ€è¦ä¿è¯çš„æ˜¯ç²¾ç¡®ç‡ï¼Œå³ä¸èƒ½é«˜äº®çš„å¤ªå¤šäº†ï¼Œè¦ä¿è¯é«˜äº®çš„éƒ½æ˜¯å¯¹çš„ï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¬å›ç‡æ›´é‡è¦&lt;/strong&gt;çš„ä»»åŠ¡ï¼šé€šå¸¸æ˜¯é‚£äº›&lt;strong&gt;æ¼æ‰å…³é”®ä¿¡æ¯ä¼šæœ‰ä¸¥é‡åæœ&lt;/strong&gt;çš„ä»»åŠ¡ï¼Œå¦‚åŒ»ç–—è¯Šæ–­ã€æ¬ºè¯ˆæ£€æµ‹å’Œå®‰å…¨ç›‘æ§ã€‚é€šä¿—ç†è§£ï¼š&lt;strong&gt;å¯ä»¥å¤šé¢„æµ‹ï¼Œåªè¦ä¸æ¼æ‰å°±è¡Œ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;25-f1-åˆ†æ•°f1-score&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#25-f1-åˆ†æ•°f1-score&#34;&gt;#&lt;/a&gt; 2.5 F1 åˆ†æ•°ï¼ˆF1-Scoreï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒF1 åˆ†æ•°æ˜¯ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡æ•°ï¼Œç»“åˆäº†ç²¾ç¡®ç‡å’Œå¬å›ç‡ä¸¤ä¸ªæŒ‡æ ‡ï¼Œèƒ½å¤ŸåŒæ—¶è€ƒè™‘è¿™ä¸¤è€…çš„å¹³è¡¡æ€§ã€‚è¿™ä¸ªæŒ‡æ ‡ç‰¹åˆ«é€‚ç”¨äºé‚£äº›&lt;strong&gt;å¯¹ç²¾ç¡®ç‡å’Œå¬å›ç‡åŒç­‰é‡è§†&lt;/strong&gt;çš„æƒ…å†µï¼Œåœ¨&lt;strong&gt;ä¸å‡è¡¡æ•°æ®&lt;/strong&gt;çš„åœºæ™¯ä¸‹å°¤å…¶æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å…¬å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;F1 = 2 \times \frac{Precision \times Recall}{Precision + Recall}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.72777em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.14077em;vertical-align:-0.7693300000000001em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.37144em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7693300000000001em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒF1 åˆ†æ•°çš„å–å€¼èŒƒå›´æ˜¯ 0 åˆ° 1ï¼Œ1 è¡¨ç¤ºå®Œç¾çš„ç²¾ç¡®ç‡å’Œå¬å›ç‡ï¼Œ0 åˆ™è¡¨ç¤ºä¸¤è€…ä¸­è‡³å°‘æœ‰ä¸€ä¸ªä¸ºé›¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;F1 åˆ†æ•°èƒ½å¤Ÿå¹³è¡¡ç²¾ç¡®ç‡å’Œå¬å›ç‡ï¼Œé€‚åˆæ•°æ®ä¸å‡è¡¡çš„æƒ…å†µã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;F1 åˆ†æ•°å¯èƒ½æ— æ³•å‡†ç¡®åæ˜ ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„å•ç‹¬è¡¨ç°ï¼Œç‰¹åˆ«æ˜¯åœ¨æŸäº›åº”ç”¨åœºæ™¯ä¸‹ï¼ŒæŸä¸€æŒ‡æ ‡æ¯”å¦ä¸€ä¸ªæ›´é‡è¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;25-rocæ›²çº¿aucå¾—åˆ†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#25-rocæ›²çº¿aucå¾—åˆ†&#34;&gt;#&lt;/a&gt; 2.5 ROC æ›²çº¿ AUC å¾—åˆ†&lt;/h2&gt;
&lt;h3 id=&#34;1rocæ›²çº¿&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1rocæ›²çº¿&#34;&gt;#&lt;/a&gt; ï¼ˆ1ï¼‰ROC æ›²çº¿&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒè®¸å¤šåˆ†ç±»å™¨èƒ½å¤Ÿé€šè¿‡&lt;strong&gt;è¾“å‡ºæ¦‚ç‡å€¼&lt;/strong&gt;æ¥é‡åŒ–ä»–ä»¬å¯¹ç­”æ¡ˆçš„ä¸ç¡®å®šæ€§ã€‚è¦&lt;strong&gt;æ ¹æ®æ¦‚ç‡è®¡ç®—å‡†ç¡®æ€§&lt;/strong&gt;ï¼Œæ‚¨éœ€è¦ä¸€ä¸ªé˜ˆå€¼æ¥å†³å®šåˆ†ç±»èµ·é¢„æµ‹ç»“æœæ˜¯ 0 æˆ–è€… 1ã€‚AUC è€ƒè™‘äº†æ‰€æœ‰å¯èƒ½çš„é˜ˆå€¼ã€‚ä¸åŒçš„é˜ˆå€¼ä¼šå¯¼è‡´ä¸åŒçš„çœŸæ­£ç‡ (TPR)/ å‡æ­£ç‡ (FPR)ã€‚éšç€é˜ˆå€¼çš„é™ä½ï¼Œåˆ†ç±»å™¨ä¼šè·å¾—æ›´å¤šçš„çœŸé˜³æ€§ï¼Œä½†ä¹Ÿä¼šè·å¾—æ›´å¤šçš„å‡é˜³æ€§ã€‚å®ƒä»¬ä¹‹é—´çš„å…³ç³»å¯ä»¥ç»˜åˆ¶å‡ºæ¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/PrecisionRecall/1.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;2aucå¾—åˆ†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2aucå¾—åˆ†&#34;&gt;#&lt;/a&gt; ï¼ˆ2ï¼‰AUC å¾—åˆ†&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒAUC ä»£è¡¨ ROC æ›²çº¿ä¸‹çš„é¢ç§¯ã€‚å®ƒæ˜¯ä¸€ä¸ªä»‹äº 0 å’Œ 1 ä¹‹é—´çš„æ•°ï¼Œç”¨äºè¡¡é‡æ¨¡å‹æ•´ä½“çš„åˆ†ç±»æ€§èƒ½ã€‚AUC çš„å€¼è¶Šæ¥è¿‘ 1ï¼Œè¡¨ç¤ºæ¨¡å‹çš„æ€§èƒ½è¶Šå¥½ï¼›AUC çš„å€¼è¶Šæ¥è¿‘ 0.5ï¼Œè¡¨ç¤ºæ¨¡å‹çš„æ€§èƒ½æ²¡æœ‰æ¯”éšæœºçŒœæµ‹å¥½å¤šå°‘ï¼›å¦‚æœ AUC å°äº 0.5ï¼Œé€šå¸¸æ„å‘³ç€æ¨¡å‹åšå‡ºçš„é¢„æµ‹ä¸å®é™…æƒ…å†µç›¸åã€‚&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/12/11/AI/else/</guid>
            <title>å…¶ä»–æœªå­¦ä¹ çš„å¯ç”¨å·¥å…·</title>
            <link>http://qianqiu-cell.github.io/2024/12/11/AI/else/</link>
            <category>AI</category>
            <pubDate>Wed, 11 Dec 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2FsbGVuYWkvZG9sbWE=&#34;&gt;dolma&lt;/span&gt;: åŒ…å«ä¸‰ä¸‡äº¿ Token çš„è¯­è¨€æ¨¡å‹é¢„è®­ç»ƒç ”ç©¶å¼€æ”¾è¯­æ–™åº“&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2hwY2FpdGVjaC9Db2xvc3NhbEFJ&#34;&gt;ColossalAI&lt;/span&gt;: ä¸€ä¸ªæ—¨åœ¨ä½¿å¤§å‹ AI æ¨¡å‹æ›´ä¾¿å®œã€æ›´å¿«é€Ÿã€æ›´æ˜“è·å¾—çš„å¼€æºé¡¹ç›®&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL05WSURJQS9UZW5zb3JSVC1MTE0=&#34;&gt;TensorRT-LLM&lt;/span&gt;: ç”¨äºä¼˜åŒ–å¤§å‹è¯­è¨€æ¨¡å‹æ¨ç†çš„ TensorRT å·¥å…·ç®±&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2xhbmdjaGFpbi1haS9sYW5nY2hhaW4=&#34;&gt;langchain&lt;/span&gt;: LangChain æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘ç”±å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰é©±åŠ¨çš„åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9jbG91ZC5iYWlkdS5jb20vZG9jL0FJSEMvcy9BbHlvNDc2anI=&#34;&gt;AIAK&lt;/span&gt;: AIAK å¤§æ¨¡å‹è®­æ¨åŠ é€Ÿå¥—ä»¶æ˜¯ç™¾èˆ¸æ¨å‡ºçš„å¤§æ¨¡å‹ AI åŠ é€Ÿèƒ½åŠ›ï¼Œç”¨æ¥åŠ é€Ÿ Megatronã€Megatron-Core ç­‰è®­ç»ƒæ¡†æ¶çš„å¤§è¯­è¨€æ¨¡å‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cubGxhbWFpbmRleC5haS8=&#34;&gt;llamaindex&lt;/span&gt;: ä¸€ä¸ªå°†å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å’Œå¤–éƒ¨æ•°æ®è¿æ¥åœ¨ä¸€èµ·çš„å·¥å…·ã€‚&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/12/11/AI/deepspeed/</guid>
            <title>Deepspeed</title>
            <link>http://qianqiu-cell.github.io/2024/12/11/AI/deepspeed/</link>
            <category>AI</category>
            <pubDate>Wed, 11 Dec 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒè¿æ¥ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly96ZXJvbG92ZXNlYS5naXRodWIuaW8vMjAyNC8wNS8xMi8lRTUlODglODYlRTUlQjglODMlRTUlQkMlOEYlRTglQUUlQUQlRTclQkIlODMlRUYlQkMlOUElRTQlQkElODYlRTglQTclQTNEZWVwc3BlZWQlRTQlQjglQUQlRTclOUElODRaZVJPMS0yLTMv&#34;&gt;https://zerolovesea.github.io/2024/05/12 / åˆ†å¸ƒå¼è®­ç»ƒï¼šäº†è§£ Deepspeed ä¸­çš„ ZeRO1-2-3/&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸€-deepspeedä»‹ç»&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-deepspeedä»‹ç»&#34;&gt;#&lt;/a&gt; ä¸€ã€Deepspeed ä»‹ç»&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒDeepSpeed æ˜¯å¾®è½¯æ¨å‡ºçš„å¤§è§„æ¨¡æ¨¡å‹åˆ†å¸ƒå¼è®­ç»ƒçš„å·¥å…·ï¼Œåˆ†å¸ƒå¼è®­ç»ƒåœºæ™¯ç›®å‰ä¸»è¦åˆ†æˆä¸‰ä¸ªç­–ç•¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®å¹¶è¡Œ&lt;/li&gt;
&lt;li&gt;æ¨¡å‹å¹¶è¡Œ&lt;/li&gt;
&lt;li&gt;æµæ°´çº¿å¹¶è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æ•°æ®å¹¶è¡Œçš„ç­–ç•¥ä¸‹ï¼Œæ¯ä¸ªæ¨¡å‹éƒ½éœ€è¦è·‘ä¸€ä¸ªå®Œæ•´çš„æ¨¡å‹ï¼Œè¿™æ—¶å°±éœ€è¦è€ƒè™‘è®­ç»ƒæ¨¡å‹å ç”¨çš„å‚æ•°é‡ã€‚ZeRO å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œè¯ç”Ÿçš„ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒZeRO çš„å…¨ç§°æ˜¯ Zero Redundancy Optimizerï¼Œæ„ä¸ºå»é™¤å†—ä½™çš„ä¼˜åŒ–å™¨ã€‚åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼Œä¸»è¦å ç”¨çš„å‚æ•°ä¸»è¦åˆ†ä¸ºäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼š&lt;strong&gt;æ¨¡å‹å‚æ•°ï¼ˆParametersï¼‰&lt;/strong&gt;ï¼Œ&lt;strong&gt;ä¼˜åŒ–å™¨çŠ¶æ€ï¼ˆOptimizer Statesï¼‰&lt;/strong&gt;ï¼Œ&lt;strong&gt;æ¢¯åº¦ (Gradients)&lt;/strong&gt;ï¼Œä»–ä»¬ä¸‰ä¸ªç®€ç§°ä¸º &lt;code&gt;OPG&lt;/code&gt; ã€‚å…¶ä¸­&lt;strong&gt;ä¼˜åŒ–å™¨çŠ¶æ€&lt;/strong&gt;ä¼šå æ®å¤§çº¦ 2 å€å‚æ•°é‡çš„æ˜¾å­˜ç©ºé—´ï¼Œè¿™å–å†³äºé€‰æ‹©çš„ä¼˜åŒ–å™¨ï¼Œä¹Ÿæ˜¯æ•´ä¸ªè®­ç»ƒä¸­å æ®æœ€å¤§ç©ºé—´çš„éƒ¨åˆ†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒZeRO æä¾›äº†å¦ä¸€ç§æ€è·¯ï¼šä½¿ç”¨åˆ‡ç‰‡æ¥è¾¾åˆ°æ—¶é—´æ¢ç©ºé—´çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-zeroçš„ä¸‰ä¸ªçº§åˆ«&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-zeroçš„ä¸‰ä¸ªçº§åˆ«&#34;&gt;#&lt;/a&gt; äºŒã€ZeRO çš„ä¸‰ä¸ªçº§åˆ«&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒZeRO è¢«åˆ†ä¸ºäº†å››ä¸ªçº§åˆ«ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ZeRO-0ï¼šä¸è¿›è¡Œä»»ä½•å½¢å¼çš„çŠ¶æ€åˆ†ç‰‡ï¼ŒåªæŠŠ DeepSpeed å½“æˆæ•°æ®å¹¶è¡Œåˆ†å¸ƒå¼ï¼ˆDDP, Distributed Data Parallelï¼‰æ¥ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ZeRO-1ï¼š&lt;strong&gt;å¯¹ä¼˜åŒ–å™¨çŠ¶æ€è¿›è¡Œæ‹†åˆ†&lt;/strong&gt;ã€‚æ˜¾å­˜æ¶ˆè€—å‡å°‘ 4 å€ï¼Œé€šä¿¡é‡ä¸æ•°æ®å¹¶è¡Œç›¸åŒã€‚&lt;/li&gt;
&lt;li&gt;ZeRO-2ï¼šåœ¨ ZeRO-1 çš„åŸºç¡€ä¸Šï¼Œ&lt;strong&gt;å¯¹æ¢¯åº¦è¿›è¡Œæ‹†åˆ†&lt;/strong&gt;ã€‚æ˜¾å­˜æ¶ˆè€—å‡å°‘ 8 å€ï¼Œé€šä¿¡é‡ä¸æ•°æ®å¹¶è¡Œç›¸åŒã€‚&lt;/li&gt;
&lt;li&gt;ZeRO-3ï¼šåœ¨ ZeRO-2 çš„åŸºç¡€ä¸Šï¼Œ&lt;strong&gt;å¯¹æ¨¡å‹å‚æ•°è¿›è¡Œæ‹†åˆ†&lt;/strong&gt;ã€‚æ¨¡å‹å ç”¨çš„æ˜¾å­˜è¢«å¹³å‡åˆ†é…åˆ°æ¯ä¸ª GPU ä¸­ï¼Œæ˜¾å­˜æ¶ˆè€—é‡ä¸æ•°æ®å¹¶è¡Œçš„å¹¶è¡Œåº¦æˆçº¿æ€§åæ¯”å…³ç³»ï¼Œä½†é€šä¿¡é‡ä¼šæœ‰äº›è®¸å¢åŠ ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒè®ºæ–‡ä¸­ç»™å‡ºäº†ä¸‰ä¸ªé˜¶æ®µçš„æ˜¾å­˜æ¶ˆè€—åˆ†å¸ƒæƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/deepspeed/2.1.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;21-zero-1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-zero-1&#34;&gt;#&lt;/a&gt; 2.1 ZeRO-1&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒæ¨¡å‹è®­ç»ƒä¸­ï¼Œæ­£å‘ä¼ æ’­å’Œåå‘ä¼ æ’­å¹¶ä¸ä¼šç”¨åˆ°ä¼˜åŒ–å™¨çŠ¶æ€ï¼Œåªæœ‰åœ¨æ¢¯åº¦æ›´æ–°çš„æ—¶å€™æ‰ä¼šä½¿ç”¨æ¢¯åº¦å’Œä¼˜åŒ–å™¨çŠ¶æ€è®¡ç®—æ–°å‚æ•°ã€‚å› æ­¤æ¯ä¸ªè¿›ç¨‹å•ç‹¬ä½¿ç”¨ä¸€æ®µä¼˜åŒ–å™¨çŠ¶æ€ï¼Œå¯¹å„è‡ªè¿›ç¨‹çš„å‚æ•°æ›´æ–°å®Œä¹‹åï¼Œå†æŠŠå„ä¸ªè¿›ç¨‹çš„æ¨¡å‹å‚æ•°åˆå¹¶å½¢æˆå®Œæ•´çš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå‡è®¾æˆ‘ä»¬æœ‰ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;ğ‘&lt;/mi&gt;&lt;mi&gt;ğ‘‘&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;ğ‘_ğ‘‘&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ªå¹¶è¡Œçš„è¿›ç¨‹ï¼Œ&lt;strong&gt;ZeRO-1 ä¼šå°†å®Œæ•´ä¼˜åŒ–å™¨çš„çŠ¶æ€ç­‰åˆ†æˆ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;ğ‘&lt;/mi&gt;&lt;mi&gt;ğ‘‘&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;ğ‘_ğ‘‘&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä»½å¹¶å‚¨å­˜åœ¨å„ä¸ªè¿›ç¨‹ä¸­&lt;/strong&gt;ã€‚å½“åå‘ä¼ æ’­å®Œæˆä¹‹åï¼Œæ¯ä¸ªè¿›ç¨‹çš„ä¼˜åŒ–å™¨ä¼šå¯¹è‡ªå·±å‚¨å­˜çš„ä¼˜åŒ–å™¨çŠ¶æ€ï¼ˆåŒ…æ‹¬ Momentumã€Variance ä¸ FP32 Master Parametersï¼‰è¿›è¡Œè®¡ç®—ä¸æ›´æ–°ã€‚æ›´æ–°è¿‡åçš„ Partitioned FP32 Master Parameters ä¼šé€šè¿‡ All-gather ä¼ å›åˆ°å„ä¸ªè¿›ç¨‹ä¸­ã€‚å®Œæˆä¸€æ¬¡å®Œæ•´çš„å‚æ•°æ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé€šè¿‡ ZeRO-1 å¯¹ä¼˜åŒ–å™¨çŠ¶æ€çš„åˆ†æ®µåŒ–å‚¨å­˜ï¼Œ7.5B å‚æ•°é‡çš„æ¨¡å‹å†…å­˜å ç”¨å°†ç”±åŸå§‹æ•°æ®å¹¶è¡Œä¸‹çš„ 120GB ç¼©å‡åˆ° 31.4GBã€‚&lt;/p&gt;
&lt;h2 id=&#34;22-zero-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-zero-2&#34;&gt;#&lt;/a&gt; 2.2 ZeRO-2&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;ç¬¬äºŒé˜¶æ®µä¸­å¯¹æ¢¯åº¦è¿›è¡Œäº†æ‹†åˆ†&lt;/strong&gt;ï¼Œåœ¨ä¸€ä¸ª Layer çš„æ¢¯åº¦éƒ½è¢«è®¡ç®—å‡ºæ¥åï¼š æ¢¯åº¦é€šè¿‡ All-reduce è¿›è¡Œèšåˆï¼Œ èšåˆåçš„æ¢¯åº¦åªä¼šè¢«æŸä¸€ä¸ªè¿›ç¨‹ç”¨æ¥æ›´æ–°å‚æ•°ï¼Œå› æ­¤å…¶å®ƒè¿›ç¨‹ä¸Šçš„è¿™æ®µæ¢¯åº¦ä¸å†è¢«éœ€è¦ï¼Œå¯ä»¥ç«‹é©¬é‡Šæ”¾æ‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé€šè¿‡ ZeRO-2 å¯¹æ¢¯åº¦å’Œä¼˜åŒ–å™¨çŠ¶æ€çš„åˆ†æ®µåŒ–å‚¨å­˜ï¼Œ7.5B å‚æ•°é‡çš„æ¨¡å‹å†…å­˜å ç”¨å°†ç”± ZeRO-1 ä¸­ 31.4GB è¿›ä¸€æ­¥ä¸‹é™åˆ° 16.6GBã€‚&lt;/p&gt;
&lt;h2 id=&#34;22-zero-3&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-zero-3&#34;&gt;#&lt;/a&gt; 2.2 ZeRO-3&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;ç¬¬ä¸‰é˜¶æ®µå°±æ˜¯å¯¹æ¨¡å‹å‚æ•°è¿›è¡Œåˆ†å‰²&lt;/strong&gt;ã€‚åœ¨ ZeRO3 ä¸­ï¼Œæ¨¡å‹çš„æ¯ä¸€å±‚éƒ½è¢«åˆ‡ç‰‡ï¼Œæ¯ä¸ªè¿›ç¨‹å­˜å‚¨æƒé‡å¼ é‡çš„ä¸€éƒ¨åˆ†ã€‚åœ¨å‰å‘å’Œåå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼ˆæ¯ä¸ªè¿›ç¨‹ä»ç„¶çœ‹åˆ°ä¸åŒçš„å¾®æ‰¹æ¬¡æ•°æ®ï¼‰ï¼Œä¸åŒçš„è¿›ç¨‹äº¤æ¢å®ƒä»¬æ‰€æ‹¥æœ‰çš„éƒ¨åˆ†ï¼ˆæŒ‰éœ€è¿›è¡Œå‚æ•°é€šä¿¡ï¼‰ï¼Œå¹¶è®¡ç®—æ¿€æ´»å‡½æ•°å’Œæ¢¯åº¦ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåˆå§‹åŒ–çš„æ—¶å€™ã€‚ZeRO-3 å°†ä¸€ä¸ªæ¨¡å‹ä¸­æ¯ä¸ªå­å±‚ä¸­çš„å‚æ•°åˆ†ç‰‡æ”¾åˆ°ä¸åŒè¿›ç¨‹ä¸­ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹è¿›è¡Œæ­£å¸¸çš„æ­£å‘ / åå‘ä¼ æ’­ï¼Œç„¶åé€šè¿‡ All-gather è¿›è¡Œæ±‡æ€»ï¼Œæ„å»ºæˆå®Œæ•´çš„æ¨¡å‹ã€‚&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/11/01/AI/Qwen2.5-math/</guid>
            <title>Qwen2.5-Math</title>
            <link>http://qianqiu-cell.github.io/2024/11/01/AI/Qwen2.5-math/</link>
            <category>AI</category>
            <pubDate>Fri, 01 Nov 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI3NTkwMjc3L2FydGljbGUvZGV0YWlscy8xNDI0NjY0MTk=&#34;&gt;https://blog.csdn.net/qq_27590277/article/details/142466419&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç­‰å¾…å­¦ä¹ çš„æŠ€æœ¯ï¼šCommon Crawlã€Fasttextã€MinHash+LSHã€MuggleMathã€DotaMathã€æ‹’ç»å¾®è°ƒï¼ˆRFTï¼‰ã€GRPOã€13-gram matchingã€ChatLearn5&lt;/p&gt;
&lt;h1 id=&#34;ä¸€-å¼•è¨€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-å¼•è¨€&#34;&gt;#&lt;/a&gt; ä¸€ã€å¼•è¨€&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒä» Qwen2.5-Math çš„æŠ€æœ¯æŠ¥å‘Šå‰¯æ ‡é¢˜ï¼šâ€œToward Mathematical Expert Model via Self-Improvementâ€ï¼Œå¯ä»¥çœ‹å‡ºï¼ŒSelf-Improvement æ˜¯ä¸€ä¸ªè´¯ç©¿æ•´ä¸ª Qwen2.5-Math è®­ç»ƒæµç¨‹çš„é‡è¦æ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ Qwen2.5-Math çš„è®­ç»ƒä¸­ï¼Œä»ä¸‰ä¸ªæ–¹é¢è¿›è¡Œ Self-Improvementã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Pre-training: ç”¨ Qwen2-Math-Instruct æ¥åˆæˆæ‰©å……é¢„è®­ç»ƒæ•°æ®ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Post-training: SFT æ¨¡å‹å’Œå¥–åŠ±æ¨¡å‹ä¹‹é—´çš„äº¤äº’è¿­ä»£&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Inferenceï¼šå¥–åŠ±æ¨¡å‹ç”¨äºæŒ‡å¯¼é‡‡æ ·&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒæ•´ä½“å¼€å‘ Qwen2-Math å’Œ Qwen2.5-Math çš„æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Qwen2.5-math/1.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é¦–å…ˆï¼ŒQwen2-Math base æ¨¡å‹åœ¨ä¸€ä¸ªåä¸º &lt;em&gt;Qwen Math Corpus v1&lt;/em&gt; çš„é«˜è´¨é‡æ•°å­¦é¢„è®­ç»ƒæ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œè¯¥æ•°æ®é›†åŒ…å«å¤§çº¦ 7000 äº¿ä¸ª tokenã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œè®­ç»ƒäº†ä¸€ä¸ªç‰¹å®šäºæ•°å­¦çš„å¥–åŠ±æ¨¡å‹ Qwen2-Math-RMï¼Œè¯¥æ¨¡å‹æ¥æºäº Qwen2-Math-72Bï¼Œä»¥åˆ›å»º Qwen2-Math-Instruct æ¨¡å‹ã€‚è¯¥å¥–åŠ±æ¨¡å‹ç”¨äºé€šè¿‡æ‹’ç»æŠ½æ ·æ„å»ºç›‘ç£å¾®è°ƒ (SFT) æ•°æ®ã€‚æ­¤å¤–ï¼Œå¥–åŠ±æ¨¡å‹åœ¨å¼ºåŒ–å­¦ä¹ é˜¶æ®µèµ·ç€å…³é”®ä½œç”¨ï¼Œæˆ‘ä»¬åœ¨ SFT ä¹‹åé‡‡ç”¨äº†ç¾¤ä½“ç›¸å¯¹ç­–ç•¥ä¼˜åŒ– (GRPO) ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬ä¸‰ï¼Œåˆ©ç”¨ Qwen2-Math-72B-Instruct æ¨¡å‹ï¼Œåˆæˆäº†é¢å¤–çš„é«˜è´¨é‡æ•°å­¦é¢„è®­ç»ƒæ•°æ®ï¼Œä¸º &lt;em&gt;Qwen Math Corpus v2&lt;/em&gt; æä¾›äº†åŸºç¡€ã€‚è¿™ä¸ªæ›´æ–°çš„è¯­æ–™åº“åŒ…å«è¶…è¿‡ 1 ä¸‡äº¿ä¸ªä»¤ç‰Œï¼Œå¹¶ç”¨äºé¢„è®­ç»ƒ Qwen2.5-Math æ¨¡å‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœ€åï¼Œä¸ Qwen2-Math-Instruct æ¨¡å‹çš„è¿‡ç¨‹ç±»ä¼¼ï¼Œæ„å»ºäº† Qwen2.5-Math-RM å’Œ Qwen2.5-Math-Instruct æ¨¡å‹ã€‚è¿™ä¸ªé˜¶æ®µçš„ä¸€ä¸ªé‡è¦åŒºåˆ«æ˜¯ï¼Œåœ¨è®­ç»ƒ Qwen2.5-Math-Instruct æ¨¡å‹æ—¶ï¼ŒåŒ…å«äº†è‹±è¯­å’Œæ±‰è¯­çš„æ€ç»´é“¾ (CoT) æ¨ç†æ•°æ®ï¼Œä»¥åŠå·¥å…·é›†æˆæ¨ç† (TIR) æ•°æ®ï¼Œè€Œä¸æ˜¯åƒ Qwen2-Math-Instruct æ¨¡å‹é‚£æ ·åªä½¿ç”¨è‹±è¯­çš„æ€ç»´é“¾ (CoT) æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äºŒ-qwen25-math-é¢„è®­ç»ƒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-qwen25-math-é¢„è®­ç»ƒ&#34;&gt;#&lt;/a&gt; äºŒã€Qwen2.5-Math é¢„è®­ç»ƒ&lt;/h1&gt;
&lt;h2 id=&#34;21-qwen2-math-é¢„è®­ç»ƒæµç¨‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-qwen2-math-é¢„è®­ç»ƒæµç¨‹&#34;&gt;#&lt;/a&gt; 2.1 Qwen2-Math é¢„è®­ç»ƒæµç¨‹&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æ•°å­¦é¢„è®­ç»ƒä¸­ï¼Œä¸»è¦å…³æ³¨çš„æ˜¯æ„å»ºä¸€ä¸ªå¯Œå«æ•°å­¦å†…å®¹çš„é«˜è´¨é‡æ•°æ®é›†ã€‚è¯¥æ•°æ®é›†åŒ…å«å„ç§å„æ ·çš„æ¥æºï¼ŒåŒ…æ‹¬&lt;strong&gt;ä¸æ•°å­¦ç›¸å…³çš„ç½‘ç»œæ–‡æœ¬ã€ä»£ç ç‰‡æ®µã€ç™¾ç§‘å…¨ä¹¦ã€è€ƒè¯•é—®é¢˜å’Œ Qwen2 ç”Ÿæˆçš„åˆæˆæ•°å­¦æ•°æ®&lt;/strong&gt;ã€‚ç»„è£…è¿™ä¸ªé¢„è®­ç»ƒæ•°æ®é›†çš„è¿‡ç¨‹åŒ…æ‹¬å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š&lt;strong&gt;æ•°æ®å¬å›ã€é‡å¤æ•°æ®åˆ é™¤ã€è¿‡æ»¤ã€æ•°æ®åˆæˆçš„å’Œæ•°æ®æ··åˆçš„ä¼˜åŒ–&lt;/strong&gt;ã€‚æœ€ç»ˆæ•´ç†çš„æ•°æ®é›†æ„æˆäº†é¢„è®­ç»ƒçš„åŸºç¡€ï¼Œè¢«ç§°ä¸º&lt;em&gt; Qwen Math Corpus v1&lt;/em&gt;ã€‚ä½¿ç”¨ Qwen2-1.5B/7B/72B åˆå§‹åŒ–çš„ Qwen2-Math åŸºç¡€æ¨¡å‹ï¼Œä½¿ç”¨ Qwen2-1.5B/7B/72B è¿›è¡Œè¿ç»­é¢„è®­ç»ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;22-v1-æ•°æ®é›†çš„æ‰©å……&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-v1-æ•°æ®é›†çš„æ‰©å……&#34;&gt;#&lt;/a&gt; 2.2 v1 æ•°æ®é›†çš„æ‰©å……&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒä¸€èˆ¬è¯­è¨€æ¨¡å‹åœ¨æ•°å­¦æ¨ç†ä¸­çš„æ¬¡ä¼˜æ€§èƒ½æºäºé¢„è®­ç»ƒè¿‡ç¨‹ä¸­æ•°å­¦æ•°æ®çš„ä¸è¶³ã€‚Qwen2-Math çš„ç­–ç•¥åŒ…æ‹¬ä» web æ¥æº (å¦‚&lt;strong&gt; Common Crawl&lt;/strong&gt;) ä¸­å¬å›æ•°å­¦æ•°æ®ï¼Œä»¥å¢åŠ æ•°æ®é‡ã€‚å…·ä½“è€Œè¨€ï¼Œä½¿ç”¨é«˜è´¨é‡çš„æ•°å­¦ç§å­æ•°æ®å’Œä¸€èˆ¬æ–‡æœ¬æ•°æ®è®­ç»ƒ&lt;strong&gt; FastText åˆ†ç±»å™¨&lt;/strong&gt;ã€‚æˆ‘ä»¬åˆ©ç”¨è¿­ä»£è®­ç»ƒä¸æ›´å¤šçš„æ•°å­¦æ•°æ®ï¼Œæ¯ä¸ª epoch ä¸æ–­æé«˜åˆ†ç±»å™¨çš„æ€§èƒ½ã€‚éšåï¼Œ&lt;strong&gt;é‡å¤æ•°æ®åˆ é™¤æŠ€æœ¯ï¼ŒåŒ…æ‹¬ MinHash&lt;/strong&gt;ï¼Œè¢«ç”¨æ¥è¿‡æ»¤æ‰ç±»ä¼¼çš„æ•°å­¦æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;h2 id=&#34;23-v1-æ•°æ®è´¨é‡çš„æé«˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-v1-æ•°æ®è´¨é‡çš„æé«˜&#34;&gt;#&lt;/a&gt; 2.3 v1 æ•°æ®è´¨é‡çš„æé«˜&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æ”¶é›†å¤§é‡æ•°å­¦æ•°æ®åï¼Œé‡ç‚¹è½¬å‘æé«˜å…¶è´¨é‡ã€‚åˆ©ç”¨ Qwen2-0.5B-Instruct æ¨¡å‹ï¼Œè¾…ä»¥ prompt engineeringï¼Œæ¥è¯„ä¼°æ•°æ®çš„è´¨é‡ã€‚æ ¹æ®è¯­è¨€æ¨¡å‹ï¼Œ&lt;strong&gt;è·å¾—æ›´é«˜åˆ†æ•°çš„æ•°æ®è¡¨æ˜è´¨é‡æ›´é«˜ï¼Œå°†ä¼˜å…ˆåŒ…å«åœ¨æœ€ç»ˆæ•°æ®é›†ä¸­&lt;/strong&gt;ã€‚é™¤äº†è¿‡æ»¤æ‰ä½è´¨é‡çš„æ•°æ®ä¹‹å¤–ï¼Œä»¥å·²æœ‰çš„å‚è€ƒæ•°æ®ä¸ºåŸºç¡€ï¼Œé‡‡ç”¨ Qwen2-72B-Instruct æ¨¡å‹æ¥åˆæˆå¤§é‡çš„æ•°å­¦é¢„è®­ç»ƒè¯­æ–™åº“ï¼ŒåŒ…æ‹¬ï¼š(1) ä»è¿™äº›å‚è€ƒæ•°æ®ä¸­æå–å·²æœ‰çš„æ•°å­¦é—®ç­”æ•°æ®ï¼Œ(2) ç›´æ¥ç”Ÿæˆæ–°çš„æ•°å­¦é—®ç­”å¯¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;24-qwen25-math-é¢„è®­ç»ƒæµç¨‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#24-qwen25-math-é¢„è®­ç»ƒæµç¨‹&#34;&gt;#&lt;/a&gt; 2.4 Qwen2.5-Math é¢„è®­ç»ƒæµç¨‹&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ Qwen2-Math åŸºç¡€æ¨¡å‹è®­ç»ƒä¹‹åï¼Œé€šè¿‡ä¸‰ä¸ªä¸»è¦é€”å¾„å°†å…¶å‡çº§ä¸º Qwen2.5-Math æ¨¡å‹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;(1) åˆ©ç”¨ Qwen2-Math-72B-Instruct æ¨¡å‹ï¼Œé€šè¿‡ç¬¬ 3 èŠ‚æè¿°çš„æ­¥éª¤è¿›è¡Œè¿›ä¸€æ­¥çš„åè®­ç»ƒï¼Œåˆæˆé¢å¤–çš„é«˜è´¨é‡æ•°å­¦é¢„è®­ç»ƒæ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(2) æ”¶é›†äº†æ›´å¤šé«˜è´¨é‡çš„æ•°å­¦æ•°æ®ï¼Œç‰¹åˆ«æ˜¯ä¸­æ–‡æ•°æ®ï¼Œè¿™äº›æ•°æ®æ¥è‡ªå¤šä¸ªå¬å›å‘¨æœŸçš„ç½‘ç»œæ–‡æ¡£ã€ä¹¦ç±å’Œä»£ç åº“ã€‚é€šè¿‡è¿™äº›åŠªåŠ›ï¼Œè·å¾—äº†ç”¨äºå¯¹ Qwen2.5-Math-1.5B/7B/72B è¿›è¡Œé¢„è®­ç»ƒçš„æ•°å­¦è¯­æ–™åº“ &lt;em&gt;Qwen Math Corpus v2&lt;/em&gt;ã€‚ä¸ &lt;em&gt;Qwen Math Corpus v1&lt;/em&gt; ç›¸æ¯”ï¼Œ&lt;em&gt;Qwen Math Corpus v2&lt;/em&gt; çš„æ€»ä»¤ç‰Œè®¡æ•°ä» 700B ä¸Šå‡åˆ° 1T ä»¥ä¸Šã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(3) åˆ©ç”¨ Qwen2.5 ç³»åˆ—åŸºæœ¬æ¨¡å‹è¿›è¡Œå‚æ•°åˆå§‹åŒ–ï¼Œå› ä¸ºå®ƒä»¬åœ¨è¯­è¨€ç†è§£ã€ä»£ç ç”Ÿæˆå’Œæ–‡æœ¬æ¨ç†æ–¹é¢è¡¨ç°å‡ºå¢å¼ºçš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;3-qwen25-math-åè®­ç»ƒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3-qwen25-math-åè®­ç»ƒ&#34;&gt;#&lt;/a&gt; 3 Qwen2.5-Math åè®­ç»ƒ&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨å®Œæˆå¹¿æ³›çš„æ•°å­¦é¢„è®­ç»ƒåï¼Œéœ€è¦ç»§ç»­è¿›è¡Œåè®­ç»ƒï¼Œä»¥è¿›ä¸€æ­¥å¢å¼º Qwen-Math çš„æ•°å­¦é€»è¾‘æ¨ç†èƒ½åŠ›ï¼Œ&lt;strong&gt;ç‰¹åˆ«æ˜¯ä¸“æ³¨äºæ€ç»´é“¾ (CoT) å’Œå·¥å…·é›†æˆæ¨ç† (TIR)&lt;/strong&gt;ã€‚å…¶ä¸­åŒ…å«ä¸¤ä¸ªå…³é”®æŒ‘æˆ˜:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;(1) å¦‚ä½•è‡ªåŠ¨ç”Ÿæˆå¤§é‡é«˜è´¨é‡å’Œå¯é çš„ CoT å’Œ TIR æ•°æ®&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(2) å¦‚ä½•æœ‰æ•ˆåœ°åˆ©ç”¨è¿™äº›æ³¨é‡Šè¿›è¡Œ SFT å’Œ RL&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;31-ç›‘ç£å¾®è°ƒsft&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#31-ç›‘ç£å¾®è°ƒsft&#34;&gt;#&lt;/a&gt; 3.1 ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒQwen2.5-Math æ„å»ºäº†æ€ç»´é“¾ (CoT) å’Œå·¥å…·é›†æˆæ¨ç† (TIR) çš„ä¸“ç”¨æ•°æ®é›†ï¼Œå¹¶å°†è¿™äº›æ•°æ®é›†ç»“åˆèµ·æ¥å…±åŒå¯¹æ¨¡å‹è¿›è¡Œç›‘ç£å¾®è°ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;311-æ€ç»´é“¾cotæ•°æ®åˆæˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#311-æ€ç»´é“¾cotæ•°æ®åˆæˆ&#34;&gt;#&lt;/a&gt; 3.1.1 æ€ç»´é“¾ï¼ˆCoTï¼‰æ•°æ®åˆæˆ&lt;/h3&gt;
&lt;h4 id=&#34;1è¾“å…¥æ„é€ &#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1è¾“å…¥æ„é€ &#34;&gt;#&lt;/a&gt; ï¼ˆ1ï¼‰è¾“å…¥æ„é€ &lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒæ€ç»´é“¾æ•°æ®é›†åŒ…å«äº† 58 ä¸‡ä¸ªè‹±æ–‡å’Œ 50 ä¸‡ä¸ªä¸­æ–‡æ•°å­¦é—®é¢˜çš„å¹¿æ³›é›†åˆï¼ŒåŒ…æ‹¬æ ‡æ³¨é¡¹å’Œåˆæˆé¡¹ã€‚&lt;strong&gt;æ ‡æ³¨é—®é¢˜æºè‡ªä¸€äº›çŸ¥åæ¥æº&lt;/strong&gt;ï¼Œä¾‹å¦‚ GSM8Kã€MATH å’Œ NuminaMathã€‚åŒæ—¶å¢åŠ äº† K-12 é—®é¢˜é›†åˆçš„ä¸­æ–‡æ•°å­¦é—®é¢˜ã€‚&lt;strong&gt;åˆæˆé—®é¢˜æ˜¯é€šè¿‡ MuggleMath æ–¹æ³•ä»æ ‡æ³¨é—®é¢˜æ¼”å˜è€Œæ¥çš„&lt;/strong&gt;ã€‚ä¸ºäº†åœ¨ä¸åŒéš¾åº¦æ°´å¹³çš„é—®é¢˜å¤æ‚æ€§ä¸Šä¿æŒå‡è¡¡åˆ†å¸ƒï¼Œæˆ‘ä»¬æœ‰æ•ˆåœ°åˆ©ç”¨äº†&lt;strong&gt;éš¾åº¦è¯„åˆ†æ¨¡å‹&lt;/strong&gt;å¯¹é—®é¢˜é›†è¿›è¡Œåˆ†ç±»ã€‚&lt;/p&gt;
&lt;h4 id=&#34;2è¾“å‡ºæ„é€ &#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2è¾“å‡ºæ„é€ &#34;&gt;#&lt;/a&gt; ï¼ˆ2ï¼‰è¾“å‡ºæ„é€ &lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒé‡‡ç”¨äº†ä¸€ç§è¿­ä»£æ–¹æ³•ï¼Œåˆ©ç”¨æ‹’ç»é‡‡æ ·ï¼Œå¹¶ç»“åˆå¥–åŠ±æ¨¡å‹å’Œæ ‡æ³¨ç­”æ¡ˆï¼Œé€æ­¥æé«˜å“åº”çš„è´¨é‡ã€‚&lt;strong&gt;åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œå½“å‰æœ€ä½³æ¨¡å‹è¢«ç”¨äºä¸ºç»™å®šé—®é¢˜ç”Ÿæˆå¤šä¸ªæ¨ç†è·¯å¾„ï¼Œä»è€Œæ‰©å±•å€™é€‰è§£å†³æ–¹æ¡ˆæ± ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¯¹äºæœ‰æ ‡æ³¨ç­”æ¡ˆçš„é—®é¢˜ï¼Œä»å€™é€‰æ± ä¸­é€‰æ‹©æœ€ç»ˆç­”æ¡ˆæ­£ç¡®çš„å‰ k ä¸ªæ¨ç†è·¯å¾„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯¹äºç¼ºä¹æ˜ç¡®ç­”æ¡ˆçš„åˆæˆé—®é¢˜ï¼Œå®æ–½åŠ æƒå¤šæ•°æŠ•ç¥¨æœºåˆ¶ï¼Œä»¥æ¨å¯¼å‡ºæœ€åˆç†çš„æ­£ç¡®æ¨ç†è·¯å¾„ã€‚ä»ä¸­é€‰æ‹©è·å¾—æœ€é«˜å¥–åŠ±åˆ†æ•°çš„å‰ k ä¸ªè·¯å¾„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;312-å·¥å…·é›†æˆæ¨ç†tiræ•°æ®åˆæˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#312-å·¥å…·é›†æˆæ¨ç†tiræ•°æ®åˆæˆ&#34;&gt;#&lt;/a&gt; 3.1.2 å·¥å…·é›†æˆæ¨ç†ï¼ˆTIRï¼‰æ•°æ®åˆæˆ&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒè™½ç„¶ CoT æç¤ºåœ¨æé«˜å¤§å‹è¯­è¨€æ¨¡å‹çš„æ¨ç†æŠ€èƒ½æ–¹é¢èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ï¼Œä½†å®ƒåœ¨&lt;strong&gt;å®ç°è®¡ç®—å‡†ç¡®æ€§å’Œå¤„ç†å¤æ‚çš„æ•°å­¦æˆ–ç®—æ³•é—®é¢˜æ–¹é¢é¢ä¸´æŒ‘æˆ˜&lt;/strong&gt;ã€‚ä¾‹å¦‚æ±‚äºŒæ¬¡æ–¹ç¨‹çš„æ ¹æˆ–è®¡ç®—çŸ©é˜µçš„ç‰¹å¾å€¼ã€‚ä¸ºäº†å…‹æœè¿™äº›é™åˆ¶å¹¶æé«˜æ¨¡å‹åœ¨ç²¾ç¡®è®¡ç®—ã€ç¬¦å·æ“ä½œå’Œç®—æ³•æ¨ç†æ–¹é¢çš„ç†Ÿç»ƒç¨‹åº¦ï¼ŒQwen2.5-Math å¼€å‘äº†ä¸€ä¸ªåŒ…å«å·¥å…·é›†æˆæ¨ç†æ ¼å¼çš„æ•°æ®é›†ã€‚&lt;strong&gt;è¿™ç§æ ¼å¼çš„æ•°æ®ä½¿æ¨¡å‹èƒ½å¤Ÿåœ¨æ¨ç†ä»»åŠ¡ä¸­åˆ©ç”¨ Python è§£é‡Šå™¨ä½œä¸ºè¾…åŠ©èµ„æº&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1è¾“å…¥æ„é€ -2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1è¾“å…¥æ„é€ -2&#34;&gt;#&lt;/a&gt; ï¼ˆ1ï¼‰è¾“å…¥æ„é€ &lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒå·¥å…·é›†æˆæ¨ç†æ•°æ®é›†ç”± 19 ä¸‡ä¸ªæ ‡æ³¨é—®é¢˜å’Œ 20.5 ä¸‡ä¸ªåˆæˆé—®é¢˜ç»„æˆã€‚&lt;strong&gt;æ ‡æ³¨é—®é¢˜æ¥æºäºä¸€äº›çŸ¥ååŸºå‡†çš„è®­ç»ƒé›†ï¼ŒåŒ…æ‹¬ GSM8Kã€MATHã€CollegeMath å’Œ NuminaMath&lt;/strong&gt;ã€‚&lt;strong&gt;åˆæˆé—®é¢˜æ˜¯é€šè¿‡é‡‡ç”¨ MuggleMath å’Œ DotaMath ä¸­çš„æŠ€æœ¯ç”Ÿæˆçš„&lt;/strong&gt;ã€‚æ­¤å¤–ï¼Œé€‰æ‹©äº† 75 ä¸‡ä¸ªæ ‡æ³¨é—®é¢˜ï¼Œä½¿ç”¨ Qwen2-72B æ¨¡å‹ç¿»è¯‘æˆä¸­æ–‡ï¼Œä»¥å¢å¼ºæ¨¡å‹åœ¨ä¸­æ–‡ä¸­çš„æ¨ç†èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;h4 id=&#34;2è¾“å‡ºæ„é€ -2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2è¾“å‡ºæ„é€ -2&#34;&gt;#&lt;/a&gt; ï¼ˆ2ï¼‰è¾“å‡ºæ„é€ &lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äºæ ‡æ³¨é—®é¢˜ï¼Œ&lt;strong&gt;é‡‡ç”¨åœ¨çº¿æ‹’ç»å¾®è°ƒï¼ˆRFTï¼‰æ–¹æ³•è¿­ä»£ç”Ÿæˆå·¥å…·é›†æˆæ¨ç†è·¯å¾„ï¼Œä½¿å…¶æœ€ç»ˆç­”æ¡ˆä¸å‚è€ƒç­”æ¡ˆä¸€è‡´&lt;/strong&gt;ã€‚åœ¨æ¯æ¬¡ RFT è¿­ä»£ä¸­ï¼Œ&lt;strong&gt;ä½¿ç”¨å½“å‰æœ€ä½³æ¨¡å‹è¿›è¡Œå¤šæ¬¡æ ¸é‡‡æ ·ï¼Œå¹¶åœ¨ä¸åŒæ¸©åº¦ä¸‹å¢åŠ æ ·æœ¬æ•°é‡&lt;/strong&gt;ã€‚æ¯æ¬¡è¿­ä»£åï¼Œä¸ºäº†å¢å¼ºæ•°æ®å¤šæ ·æ€§ï¼Œæˆ‘ä»¬&lt;strong&gt;å¯¹å“åº”è¿›è¡Œå»é‡å¤„ç†&lt;/strong&gt;ï¼Œå¾—åˆ°çš„æ¸…ç†æ•°æ®é›†å°†ç”¨äºå¾®è°ƒæ¨¡å‹ä»¥è¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äºåˆæˆé—®é¢˜ï¼Œé‡‡ç”¨ä»åœ¨çº¿ RFT è¿‡ç¨‹ä¸­å¾—åˆ°çš„&lt;strong&gt;æœ€ä½³æ¨¡å‹ç”Ÿæˆæ¨ç†æ ·æœ¬&lt;/strong&gt;ã€‚æˆ‘ä»¬&lt;strong&gt;ä½¿ç”¨å¤šæ•°æŠ•ç¥¨æ³•é€‰æ‹©æœ€å¯èƒ½æ­£ç¡®çš„æ¨ç†è·¯å¾„&lt;/strong&gt;ï¼Œè¿™äº›è·¯å¾„éšåè¢«çº³å…¥æ•´ä½“æ•°æ®é›†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;32-å¥–åŠ±æ¨¡å‹è®­ç»ƒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#32-å¥–åŠ±æ¨¡å‹è®­ç»ƒ&#34;&gt;#&lt;/a&gt; 3.2 å¥–åŠ±æ¨¡å‹è®­ç»ƒ&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†åœ¨é€‰æ‹©ç›‘ç£å¾®è°ƒæ•°æ®å’Œéšåçš„å¼ºåŒ–å­¦ä¹ è®­ç»ƒé˜¶æ®µæä¾›è¶…å‡ºæœ€ç»ˆç­”æ¡ˆçš„ç›‘ç£ä¿¡å·ï¼Œä¸º Qwen2-Math å’Œ Qwen2.5-Math å¼€å‘äº†ä¸€ä¸ªæ•°å­¦å¥–åŠ±æ¨¡å‹ï¼Œåˆ†åˆ«ç§°ä¸º Qwen2-Math-RM å’Œ Qwen2.5-Math-RMã€‚&lt;strong&gt;è¿™äº›å¥–åŠ±æ¨¡å‹ä¸“é—¨è®¾è®¡ç”¨äºåœ¨æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­æŒ‡å¯¼æ¨¡å‹ï¼Œé€šè¿‡æä¾›æ›´ç»†è‡´çš„æ¨ç†è´¨é‡å’Œä¸­é—´æ­¥éª¤çš„åé¦ˆï¼Œæœ€ç»ˆä¿ƒè¿›æ›´ç¨³å¥çš„æ¨¡å‹æ”¹è¿›&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;321-æ•°æ®åˆæˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#321-æ•°æ®åˆæˆ&#34;&gt;#&lt;/a&gt; 3.2.1 æ•°æ®åˆæˆ&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ Qwen2-Math-RM çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨äº† 206K çš„è‹±æ–‡æ•°å­¦é—®é¢˜ï¼Œæ¯ä¸ªé—®é¢˜éƒ½æ­é…äº†ä» Qwen2-Math ä¸­æŠ½å–çš„ 6 ä¸ªç­”æ¡ˆã€‚å¯¹äº Qwen2.5-Math-RMï¼Œè¿›ä¸€æ­¥å¢å¼ºäº†å…¶å¯¹ä¸­æ–‡å’Œ TIR æ¨¡å¼çš„æ”¯æŒï¼Œä½¿ç”¨äº†ä¸€ä¸ªæ›´åŠ å¤šæ ·åŒ–çš„æ•°æ®é›†å¯¹å…¶è¿›è¡Œè®­ç»ƒï¼Œè¯¥æ•°æ®é›†åŒ…å« 361K çš„è‹±æ–‡æ•°å­¦é—®é¢˜å’Œ 257K çš„ä¸­æ–‡æ•°å­¦é—®é¢˜ï¼Œæ¯ä¸ªé—®é¢˜éƒ½é™„æœ‰ä» Qwen2.5-Math ä¸­æŠ½å–çš„ 6 ä¸ªç­”æ¡ˆã€‚è¿™ä¸€æ‰©å±•ç¡®ä¿äº† Qwen2.5-Math-RM èƒ½å¤Ÿå……åˆ†èƒœä»»åœ¨æ›´å¹¿æ³›çš„é—®é¢˜ç±»å‹å’Œè¯­è¨€èŒƒå›´å†…æä¾›ç›‘ç£åé¦ˆçš„ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†åœ¨ç­”æ¡ˆä¹‹é—´å»ºç«‹åå¥½ä¿¡å·ï¼Œæ£€æŸ¥äº†æ¯ä¸ªç­”æ¡ˆçš„æ­£ç¡®æ€§ã€‚æ­£ç¡®ç­”æ¡ˆçš„å›ç­”è¢«æ ‡è®°ä¸ºç§¯æçš„ï¼Œè€Œé”™è¯¯ç­”æ¡ˆçš„å›ç­”è¢«æ ‡è®°ä¸ºæ¶ˆæçš„ï¼Œä»è€Œè‡ªç„¶åœ°åœ¨ç­”æ¡ˆä¹‹é—´åˆ›å»ºäº†ä¸€ä¸ªæ’åå…³ç³»ã€‚ç„¶åï¼Œè¿‡æ»¤æ‰æ‰€æœ‰ç­”æ¡ˆè¦ä¹ˆå®Œå…¨æ­£ç¡®ï¼Œè¦ä¹ˆå®Œå…¨é”™è¯¯çš„æƒ…å†µã€‚ä¸ºäº†é¿å…åªä¿ç•™è¿‡äºç®€å•çš„æ•°æ®çš„æ½œåœ¨ç¼ºç‚¹ï¼Œä½¿ç”¨æ¥è‡ªå„ç§ä¸­é—´ç‰ˆæœ¬å’Œä¸åŒå¤§å°æ¨¡å‹çš„å“åº”æ¥ä¸°å¯Œæ•°æ®é›†ã€‚è¯¥ç­–ç•¥ç¡®ä¿äº†è¾“å…¥æ•°æ®éš¾åº¦çš„æ›´å‡è¡¡åˆ†å¸ƒï¼Œå¹¶ä¿æŒäº†æ­£å“åº”ä¸è´Ÿå“åº”çš„å‡åŒ€æ¯”ä¾‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;322-è®­ç»ƒç­–ç•¥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#322-è®­ç»ƒç­–ç•¥&#34;&gt;#&lt;/a&gt; 3.2.2 è®­ç»ƒç­–ç•¥&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒä»ç›‘ç£å¾®è°ƒæ¨¡å‹åˆå§‹åŒ–å¥–åŠ±æ¨¡å‹ã€‚åœ¨æ¶æ„æ–¹é¢ï¼Œå°†æœ€åˆç”¨äºä¸‹ä¸€ä¸ª token é¢„æµ‹çš„è¯­è¨€å»ºæ¨¡å¤´æ›¿æ¢ä¸ºç”±ä¸¤ä¸ªçº¿æ€§å±‚ç»„æˆçš„æ ‡é‡å€¼å¤´ã€‚å¥–åŠ±æ¨¡å‹è®­ç»ƒæ•°æ®é›†ä¸­çš„æ¯ä¸ªè¾“å…¥éƒ½ä¸ 6 ä¸ªè¾“å‡ºé…å¯¹ã€‚å¦‚æœæœ‰ k ä¸ªæ­£æ ·æœ¬ï¼Œåˆ™å…¶ä½™ 6 - k ä¸ªä¸ºè´Ÿæ ·æœ¬ã€‚å¥–åŠ±æ¨¡å‹çš„æŸå¤±å‡½æ•°å¯ä»¥è¡¨ç¤ºä¸º:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;script&#34;&gt;L&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Ïƒ&lt;/mi&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo fence=&#34;true&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo fence=&#34;true&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo fence=&#34;true&#34;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathcal{L}_{rm}(\theta)=-\frac1{k\times(6-k)}E_{(x,y_{pos},y_{neg})\thicksim D}\left[\log\left(\sigma\left(r_\theta(x,y_{pos})-r_\theta(x,y_{neg}))\right)\right)\right]
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34;&gt;L&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.25744em;vertical-align:-0.936em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.936em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.34479999999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5198em;margin-left:-0.05764em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.16454285714285716em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2818857142857143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.16454285714285716em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2818857142857143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mrel amsrm mtight&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3775199999999999em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;lo&lt;span style=&#34;margin-right:0.01389em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ïƒ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15139200000000003em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15139200000000003em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;r_\theta(x,y)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤ºå¥–åŠ±æ¨¡å‹çš„è¾“å‡ºï¼Œå…¶ä¸­&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤ºé—®é¢˜è¾“å…¥ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;y&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;y&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤ºç›¸åº”çš„è¾“å‡ºã€‚è¯¥æŸå¤±å‡½æ•°æ²¡æœ‰å°†å®ƒä»¬åˆ†è§£æˆå¤šä¸ªå•ç‹¬çš„å¯¹å¹¶ä»¥æˆå¯¹çš„æ–¹å¼è®¡ç®—æŸå¤±ï¼Œè€Œæ˜¯é‡‡ç”¨åˆ—è¡¨æ–¹æ³•ç›´æ¥è®¡ç®—æœ‰æ•ˆå¯¹ä¸Šçš„æ’åæŸå¤±ã€‚è¯¥æ–¹æ³•æé«˜äº†åŸ¹è®­çš„æ•ˆç‡å’Œæ•ˆæœã€‚&lt;/p&gt;
&lt;h2 id=&#34;33-å¢å¼ºå­¦ä¹ &#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#33-å¢å¼ºå­¦ä¹ &#34;&gt;#&lt;/a&gt; 3.3 å¢å¼ºå­¦ä¹ &lt;/h2&gt;
&lt;h3 id=&#34;331-è¾“å…¥é€‰æ‹©&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#331-è¾“å…¥é€‰æ‹©&#34;&gt;#&lt;/a&gt; 3.3.1 è¾“å…¥é€‰æ‹©&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒç”¨äºå¼ºåŒ–å­¦ä¹ è®­ç»ƒçš„è¾“å…¥ä»å¥–åŠ±æ¨¡å‹çš„è®­ç»ƒé›†ä¸­é€‰æ‹©ã€‚åˆ©ç”¨ä¸åŒè§„æ¨¡çš„ç›‘ç£å¾®è°ƒæ¨¡å‹ä¸ºæ¯ä¸ªæŸ¥è¯¢é‡æ–°é‡‡æ · 8 ä¸ªå“åº”ï¼Œå¹¶é€šè¿‡ä¸æ ‡å‡†ç­”æ¡ˆè¿›è¡Œæ¯”è¾ƒï¼Œå°†æ¯ä¸ªå“åº”åˆ†ç±»ä¸ºæ­£ç¡®æˆ–ä¸æ­£ç¡®ã€‚ä¿ç•™ 8 ä¸ªå“åº”ä¸­æœ‰ 2 åˆ° 5 ä¸ªæ­£ç¡®ç­”æ¡ˆçš„æŸ¥è¯¢ã€‚å°‘äº 2 ä¸ªæ­£ç¡®ç­”æ¡ˆçš„æŸ¥è¯¢ä¼šè¢«æ’é™¤ï¼Œå› ä¸ºè¿™è¡¨æ˜å½“å‰çš„æ•°å­¦æ¨¡å‹ç¼ºä¹ä»ä¸­å­¦ä¹ çš„åŸºæœ¬èƒ½åŠ›ã€‚åŒæ ·ï¼Œè¶…è¿‡ 5 ä¸ªæ­£ç¡®å“åº”çš„æŸ¥è¯¢ä¹Ÿä¼šè¢«æ’é™¤ï¼Œå› ä¸ºæ¨¡å‹åœ¨è¿™äº›æƒ…å†µä¸‹å·²ç»è¡¨ç°å‡ºèƒ½åŠ›ï¼Œæ— éœ€è¿›ä¸€æ­¥è®­ç»ƒã€‚æœ€ç»ˆï¼Œä¿ç•™äº† 66K ä¸ªæŸ¥è¯¢ç”¨äºè®­ç»ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;332-åˆ†ç»„ç›¸å¯¹ç­–ç•¥ä¼˜åŒ–grpo&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#332-åˆ†ç»„ç›¸å¯¹ç­–ç•¥ä¼˜åŒ–grpo&#34;&gt;#&lt;/a&gt; 3.3.2 åˆ†ç»„ç›¸å¯¹ç­–ç•¥ä¼˜åŒ–ï¼ˆGRPOï¼‰&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒGRPO æ˜¯ä¸€ç§ä¸“é—¨ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹è®¾è®¡çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼Œé¿å…äº†åƒ PPO é‚£æ ·&lt;strong&gt;éœ€è¦é¢å¤–çš„å€¼å‡½æ•°è¿‘ä¼¼&lt;/strong&gt;ã€‚GRPO ä½¿ç”¨ä¸€ç»„æŠ½æ ·è¾“å‡ºçš„å¹³å‡å¥–åŠ±ä½œä¸ºåŸºå‡†æ¥è®¡ç®—æ¯ä¸ªè¾“å‡ºçš„ä¼˜åŠ¿ã€‚GRPO çš„ç›®æ ‡å®šä¹‰ä¸º:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mtable rowspacing=&#34;0.24999999999999992em&#34; columnalign=&#34;right left&#34; columnspacing=&#34;0em&#34;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;script&#34;&gt;J&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;E&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;[&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo stretchy=&#34;false&#34;&gt;}&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï€&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/munderover&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mo stretchy=&#34;false&#34;&gt;{&lt;/mo&gt;&lt;mi&gt;min&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;[&lt;/mo&gt;&lt;mfrac&gt;&lt;msubsup&gt;&lt;mi&gt;Ï€&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mi&gt;Ï€&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;clip&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msubsup&gt;&lt;mi&gt;Ï€&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mi&gt;Ï€&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mfrac&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;D&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ï€&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;Ï€&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;ref&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\begin{aligned}\mathcal{J}_{GRPO}(\theta)&amp;amp;=\mathbb{E}_{[q\sim P(Q),\{o_i\}_{i=1}^G\sim\pi_{\theta_{old}}(O|q)]}\\&amp;amp;\frac1G\sum_{i=1}^G\frac1{|o_i|}\sum_{t=1}^{|o_i|}\{\min[\frac{\pi_\theta^{i,t}}{\pi_{\theta_{old}}^{i,t}}\hat{A}_{i,t},\operatorname{clip}(\frac{\pi_\theta^{i,t}}{\pi_{\theta_{old}}^{i,t}},1-\epsilon,1+\epsilon)\hat{A}_{i,t}]-\beta\mathbb{D}_{KL}[\pi_\theta||\pi_{\operatorname{ref}}]\}\end{aligned}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:5.197578999999999em;vertical-align:-2.3487894999999996em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mtable&#34;&gt;&lt;span class=&#34;col-align-r&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:2.8487894999999996em;&#34;&gt;&lt;span style=&#34;top:-5.9697945em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.961005em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.18472em;&#34;&gt;J&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;G&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;O&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.1898845000000007em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.961005em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:2.3487894999999996em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;col-align-l&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:2.8487894999999996em;&#34;&gt;&lt;span style=&#34;top:-5.9697945em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.961005em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;E&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3448em;&#34;&gt;&lt;span style=&#34;top:-2.4617750000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;Q&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mopen mtight&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3280857142857143em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;&lt;span class=&#34;mclose mtight&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8328928571428571em;&#34;&gt;&lt;span style=&#34;top:-2.177714285714286em;margin-left:0em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.8448em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;G&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3222857142857143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï€&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.34480000000000005em;&#34;&gt;&lt;span style=&#34;top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3448em;&#34;&gt;&lt;span style=&#34;top:-2.3448em;margin-left:-0.02778em;margin-right:0.1em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.69444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.34963999999999995em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.4009714285714285em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;O&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.5189049999999998em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.1898845000000007em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.961005em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;G&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8283360000000002em;&#34;&gt;&lt;span style=&#34;top:-1.872331em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.050005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;âˆ‘&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.3000050000000005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;G&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.277669em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.936em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.9610050000000003em;&#34;&gt;&lt;span style=&#34;top:-1.882887em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.050005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;âˆ‘&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.386005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3280857142857143em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;âˆ£&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.267113em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.63388em;&#34;&gt;&lt;span style=&#34;top:-2.167428em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï€&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.942572em;&#34;&gt;&lt;span style=&#34;top:-2.398692em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3448em;&#34;&gt;&lt;span style=&#34;top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15122857142857138em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.1809080000000005em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.40716799999999986em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.6913080000000003em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï€&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.942572em;&#34;&gt;&lt;span style=&#34;top:-2.3986920000000005em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.1809080000000005em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3013079999999999em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.2397399999999998em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9467699999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;A&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.25233em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.11110999999999999em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;&lt;span class=&#34;mord mathrm&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathrm&#34;&gt;p&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.63388em;&#34;&gt;&lt;span style=&#34;top:-2.167428em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï€&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.942572em;&#34;&gt;&lt;span style=&#34;top:-2.398692em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3448em;&#34;&gt;&lt;span style=&#34;top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15122857142857138em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.1809080000000005em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.40716799999999986em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.6913080000000003em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï€&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.942572em;&#34;&gt;&lt;span style=&#34;top:-2.3986920000000005em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.1809080000000005em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3013079999999999em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.2397399999999998em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9467699999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;A&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.25233em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.11110999999999999em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;D&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.07153em;&#34;&gt;K&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;L&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï€&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ï€&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mop mtight&#34;&gt;&lt;span class=&#34;mord mathrm mtight&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathrm mtight&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathrm mtight&#34; style=&#34;margin-right:0.07778em;&#34;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:2.3487894999999996em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;333-å¥–åŠ±æ„é€ &#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#333-å¥–åŠ±æ„é€ &#34;&gt;#&lt;/a&gt; 3.3.3 å¥–åŠ±æ„é€ &lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒå°†åŸºäºè§„åˆ™çš„éªŒè¯è€…å’Œå¥–åŠ±æ¨¡å‹çš„å¥–åŠ±ç»“åˆèµ·æ¥ï¼Œå½¢æˆæ•´ä½“çš„å¥–åŠ±ä¿¡å·ã€‚åŸºäºè§„åˆ™çš„éªŒè¯å™¨ä»æ¯ä¸ªå“åº”ä¸­æå–æ½œåœ¨ç­”æ¡ˆï¼Œå¹¶å°†å…¶ä¸æ ‡å‡†ç­”æ¡ˆè¿›è¡Œæ¯”è¾ƒã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå°†å¥–åŠ±æ¨¡å‹çš„è¾“å‡ºè®°ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;r_{m}âˆˆ\mathbb{R}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.6891em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68889em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼ŒåŸºäºè§„åˆ™çš„éªŒè¯å™¨çš„ç¨€ç–å¥–åŠ±è®°ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;r_{v}\in{0,1}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.6891em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8388800000000001em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œåˆ™æ€»ä½“å¥–åŠ±è®¡ç®—å¦‚ä¸‹:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mtable rowspacing=&#34;0.24999999999999992em&#34; columnalign=&#34;right&#34; columnspacing=&#34;&#34;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;Ïƒ&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;â‹…&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\begin{aligned}r=\sigma(\alpha\cdot r_m)+(r_v-1)\end{aligned}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.5000000000000002em;vertical-align:-0.5000000000000002em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mtable&#34;&gt;&lt;span class=&#34;col-align-r&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1em;&#34;&gt;&lt;span style=&#34;top:-3.16em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ïƒ&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;â‹…&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.5000000000000002em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè¿™ç§å½¢æˆæœºåˆ¶ç¡®ä¿æ­£ç¡®çš„ååº”å§‹ç»ˆæ¯”é”™è¯¯çš„ååº”è·å¾—æ›´é«˜çš„æ€»ä½“å¥–åŠ±ã€‚åœ¨æ¯ä¸ªæ­£ç¡®å’Œä¸æ­£ç¡®çš„ç»„ä¸­ï¼Œæ ¹æ®å¥–åŠ±æ¨¡å‹çš„åˆ†æ•°å¯¹å›ç­”è¿›è¡Œæ’åã€‚ç‰¹åˆ«æ˜¯åœ¨å¤æ‚é—®é¢˜ä¸­ã€‚&lt;/p&gt;
&lt;h3 id=&#34;334-å®ç°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#334-å®ç°&#34;&gt;#&lt;/a&gt; 3.3.4 å®ç°&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒå®éªŒæ˜¯åŸºäºå¼€æº RLHF æ¡†æ¶ ChatLearn5 å®ç°çš„ã€‚æ‰€æœ‰ä¸åŒå‚æ•°å¤§å°çš„ç­–ç•¥æ¨¡å‹éƒ½ä½¿ç”¨ç›¸åŒçš„å¥–åŠ±æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚ä¸ºæ¯ä¸ªæŸ¥è¯¢é‡‡æ · 32 ä¸ªå“åº”ã€‚æ‰€æœ‰æ¨¡å‹éƒ½ä½¿ç”¨ 512 å…¨å±€æ‰¹å¤§å°è¿›è¡Œè®­ç»ƒã€‚7B å’Œ 72B çš„å­¦ä¹ ç‡åˆ†åˆ«ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;1\times10^{-5}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.72777em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8141079999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;5\times10^{-6}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.72777em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8141079999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚æ‰€æœ‰è®­ç»ƒçš„ KL ç³»æ•°ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow&gt;&lt;mtext&gt;âˆ’&lt;/mtext&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;1\times10{âˆ’3}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.72777em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.72777em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚å±è”½äº† Python æ‰§è¡Œå™¨åœ¨å·¥å…·é›†æˆæ¨ç†çš„å¼ºåŒ–å­¦ä¹ ä¸­æä¾›çš„æ‰€æœ‰è¾“å‡ºä»¤ç‰Œã€‚&lt;/p&gt;
&lt;h1 id=&#34;4-å»æ±¡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4-å»æ±¡&#34;&gt;#&lt;/a&gt; 4ã€å»æ±¡&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒå»æ±¡æ˜¯ç¡®ä¿æ¨¡å‹æ€§èƒ½è¯„ä¼°æ— åçš„å…³é”®ã€‚Qwen2.5-math ä½¿ç”¨ 13-gram matching æ’é™¤äº†å¯èƒ½å—æ±¡æŸ“çš„è®­ç»ƒæ ·æœ¬ã€‚ä¸ºäº†æé«˜åŒ¹é…è¿‡ç¨‹çš„å‡†ç¡®æ€§ï¼Œæ‰§è¡Œæ–‡æœ¬è§„èŒƒåŒ–ï¼Œåˆ é™¤ä¸ç›¸å…³çš„æ ‡ç‚¹å’Œç¬¦å·ã€‚ä¸ºäº†è¿›ä¸€æ­¥å‡å°‘å‡é˜´æ€§ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¸¸è§çš„æ•°å­¦è¡¨è¾¾å¼ï¼Œå¼•å…¥äº†ä¸€ä¸ªé¢å¤–çš„æ ‡å‡†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ€é•¿å…¬å…±å­åºåˆ—çš„æ¯”ç‡å¿…é¡»è¶…è¿‡ 0.6ï¼Œæ‰èƒ½è®¤ä¸ºæ ·æœ¬è¢«æ±¡æŸ“ã€‚å¯¹äºé¢„è®­ç»ƒæ•°æ®ï¼Œé’ˆå¯¹ GSM8K å’Œ MATH ç­‰æ•°æ®é›†è¿‡æ»¤å¯èƒ½å—æ±¡æŸ“çš„æ ·æœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨å¤„ç†åè®­ç»ƒæ•°æ®æ—¶ï¼ŒåŒ…æ‹¬ SFT æ•°æ®ã€RM è®­ç»ƒæ•°æ®å’Œ RL æŸ¥è¯¢é›†ï¼Œåœ¨æ‰€æœ‰æŠ¥å‘Šçš„è¯„ä¼°æ•°æ®é›†ä¸­æ’é™¤ä»»ä½•æ½œåœ¨çš„æ±¡æŸ“é—®é¢˜æˆ–è§£å†³æ–¹æ¡ˆã€‚è¿™äº›è¯„ä¼°æ•°æ®é›†åŒ…æ‹¬ GSM8K ã€MATH ã€Minerva MATH ã€Gaokao 2023 Enã€Olympiad Benchã€College Mathã€MMLU STEM ã€Gaokaoã€CMATHã€CN Middle School 24ï¼ŒAIME 24 å’Œ AMC 23ã€‚åœ¨å¯¹æ±¡æŸ“æ ·æœ¬çš„åˆ†æè¿‡ç¨‹ä¸­ï¼Œå‘ç°ä¸€äº›ç°æœ‰çš„è®­ç»ƒæ•°æ®é›† (ä¾‹å¦‚ï¼ŒMATH è®­ç»ƒæ•°æ®é›†) åŒ…å«äº†ä¸æµ‹è¯•æ•°æ®é›†ä¸­å‘ç°çš„é—®é¢˜å…·æœ‰é«˜åº¦ç›¸ä¼¼çš„æ¦‚å¿µæˆ–ç»“æ„çš„æ˜¾è‘—æ¯”ä¾‹ã€‚è™½ç„¶è¿™äº›å˜åŒ–ä¸æ˜¯å®Œå…¨é‡å¤çš„ï¼Œä½†å®ƒä»¬å¯èƒ½ä¼šæŸå®³è¯„ä¼°çš„å®Œæ•´æ€§ã€‚å› æ­¤ï¼Œéœ€è¦ä»è®­ç»ƒè¯­æ–™åº“ä¸­æ’é™¤è¿™æ ·çš„æ ·æœ¬ã€‚&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/10/21/AI/vllm/</guid>
            <title>vLLM</title>
            <link>http://qianqiu-cell.github.io/2024/10/21/AI/vllm/</link>
            <category>AI</category>
            <pubDate>Mon, 21 Oct 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒè¿æ¥ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3ZsbG0tcHJvamVjdC92bGxt&#34;&gt;https://github.com/vllm-project/vllm&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸€-vllmä»‹ç»&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-vllmä»‹ç»&#34;&gt;#&lt;/a&gt; ä¸€ã€vLLM ä»‹ç»&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰æ‰¿è¯ºå°†å½»åº•æ”¹å˜æˆ‘ä»¬åœ¨æ‰€æœ‰è¡Œä¸šä¸­ä½¿ç”¨äººå·¥æ™ºèƒ½çš„æ–¹å¼ã€‚ç„¶è€Œï¼Œå®é™…ä¸Šéƒ¨ç½²è¿™äº›æ¨¡å‹æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ï¼Œå¹¶ä¸”å³ä½¿åœ¨æ˜‚è´µçš„ç¡¬ä»¶ä¸Šä¹Ÿå¯èƒ½å‡ºäººæ„æ–™åœ°æ…¢ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;vLLM&lt;/strong&gt; æ˜¯ä¸€ä¸ªç”¨äºå¿«é€Ÿå¤§å‹è¯­è¨€&lt;strong&gt;æ¨¡å‹æ¨ç†&lt;/strong&gt;å’ŒæœåŠ¡çš„å¼€æºåº“ã€‚vLLM åˆ©ç”¨äº†æ–°æ³¨æ„åŠ›ç®—æ³•&lt;strong&gt; PagedAttention&lt;/strong&gt;ï¼Œå®ƒæœ‰æ•ˆåœ°ç®¡ç†æ³¨æ„åŠ›é”®å’Œå€¼ï¼ˆKV cacheï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé…å¤‡ PagedAttention çš„ vLLM é‡æ–°å®šä¹‰äº†å¤§å‹è¯­è¨€æ¨¡å‹æœåŠ¡çš„æ–°æ ‡å‡†ï¼šå®ƒæä¾›çš„ååé‡æ¯” HuggingFace Transformers é«˜å‡ºå¤šè¾¾ 24 å€ï¼Œè€Œæ— éœ€å¯¹æ¨¡å‹æ¶æ„è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-pagedattentionåŸç†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-pagedattentionåŸç†&#34;&gt;#&lt;/a&gt; äºŒã€PagedAttention åŸç†&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ vLLM ä¸­ï¼ŒLLM çš„æ€§èƒ½å—åˆ°å†…å­˜çš„é™åˆ¶ã€‚åœ¨è‡ªå›å½’è§£ç è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰è¾“å…¥åˆ° LLM çš„ token éƒ½ä¼šç”Ÿæˆå®ƒä»¬çš„&lt;strong&gt;æ³¨æ„åŠ›é”® (attention key)&lt;strong&gt; å’Œ&lt;/strong&gt;å€¼å¼ é‡ (value tensors)&lt;/strong&gt;ï¼Œè€Œè¿™äº›å¼ é‡è¢«ä¿å­˜åœ¨ GPU å†…å­˜ä¸­ä»¥ç”Ÿæˆä¸‹ä¸€ä¸ª tokenã€‚è¿™äº›ç¼“å­˜çš„é”®å’Œå€¼å¼ é‡é€šå¸¸è¢«ç§°ä¸º&lt;strong&gt; KV cache&lt;/strong&gt;ã€‚KV cache çš„ç‰¹ç‚¹ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤§å‹&lt;/strong&gt;ï¼šåœ¨ LLaMA-13B ä¸­ï¼Œå•ä¸ªåºåˆ—å¯èƒ½å ç”¨é«˜è¾¾ 1.7GBã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€&lt;/strong&gt;ï¼šå…¶å¤§å°å–å†³äºåºåˆ—é•¿åº¦ï¼Œè¿™æ˜¯é«˜åº¦å¯å˜ä¸”ä¸å¯é¢„æµ‹çš„ã€‚å› æ­¤ï¼Œæœ‰æ•ˆç®¡ç† KV ç¼“å­˜æ˜¯ä¸€ä¸ªé‡å¤§æŒ‘æˆ˜ã€‚ç”±äºç¢ç‰‡åŒ–å’Œè¿‡åº¦é¢„ç•™ï¼Œç°æœ‰ç³»ç»Ÿæµªè´¹äº† 60% è‡³ 80% çš„å†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒvLLM å¼•å…¥äº†ä¸€ç§åä¸º&lt;strong&gt; PagedAttention&lt;/strong&gt; çš„æ³¨æ„åŠ›ç®—æ³•ï¼Œå®ƒå—åˆ°äº†æ“ä½œç³»ç»Ÿä¸­è™šæ‹Ÿå†…å­˜å’Œåˆ†é¡µè¿™ä¸€ç»å…¸æ€æƒ³çš„å¯å‘ã€‚ä¸ä¼ ç»Ÿçš„æ³¨æ„åŠ›ç®—æ³•ä¸åŒï¼ŒPagedAttention&lt;strong&gt; å…è®¸åœ¨éè¿ç»­çš„å†…å­˜ç©ºé—´ä¸­å­˜å‚¨è¿ç»­çš„é”®å’Œå€¼&lt;/strong&gt;ã€‚å…·ä½“æ¥è¯´ï¼ŒPagedAttention&lt;strong&gt; å°†æ¯ä¸ªåºåˆ—çš„é”®å€¼ï¼ˆKVï¼‰ç¼“å­˜åˆ’åˆ†ä¸ºå¤šä¸ªå—ï¼Œæ¯ä¸ªå—åŒ…å«å›ºå®šæ•°é‡çš„ token çš„ keys å’Œ values&lt;/strong&gt;ã€‚åœ¨æ³¨æ„åŠ›è®¡ç®—è¿‡ç¨‹ä¸­ï¼ŒPagedAttention å†…æ ¸èƒ½å¤Ÿé«˜æ•ˆåœ°è¯†åˆ«å¹¶è·å–è¿™äº›å—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/vLLM/2.1.gif&#34; alt=&#34;&#34; title=&#34;PagedAttentionï¼šKV cache è¢«åˆ’åˆ†æˆå¤šä¸ªå—ã€‚è¿™äº›å—åœ¨å†…å­˜ç©ºé—´ä¸­ä¸éœ€è¦æ˜¯è¿ç»­çš„&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå› ä¸ºå—åœ¨å†…å­˜ä¸­ä¸éœ€è¦æ˜¯è¿ç»­çš„ï¼Œå¯ä»¥åƒæ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜é‚£æ ·ä»¥æ›´çµæ´»çš„æ–¹å¼ç®¡ç† keys å’Œ valuesï¼šå¯ä»¥å°†å—çœ‹ä½œæ˜¯åˆ†é¡µï¼Œtokens çœ‹ä½œæ˜¯å­—èŠ‚ï¼Œsequences çœ‹ä½œæ˜¯è¿›ç¨‹ã€‚sequence çš„è¿ç»­é€»è¾‘å—é€šè¿‡å—è¡¨æ˜ å°„åˆ°ä¸è¿ç»­çš„ç‰©ç†å—ã€‚éšç€æ–° token çš„ç”Ÿæˆï¼Œç‰©ç†å—æŒ‰éœ€åˆ†é…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/vLLM/2.2.gif&#34; alt=&#34;&#34; title=&#34;PagedAttentionå¯¹ä¸€æ¡requestçš„ç”Ÿæˆè¿‡ç¨‹ç¤ºä¾‹&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ PagedAttention ä¸­ï¼Œ&lt;strong&gt;å†…å­˜æµªè´¹ä»…å‘ç”Ÿåœ¨åºåˆ—çš„æœ€åä¸€ä¸ªåŒºå—ä¸­&lt;/strong&gt;ã€‚åœ¨å®è·µä¸­ï¼Œè¿™å¯¼è‡´æ¥è¿‘æœ€ä¼˜çš„å†…å­˜ä½¿ç”¨ï¼Œä»…æœ‰ä¸åˆ° 4% çš„å¾®å°æµªè´¹ã€‚è¿™ç§å†…å­˜æ•ˆç‡çš„æå‡è¢«è¯æ˜æ˜¯éå¸¸æœ‰ç›Šçš„ï¼šå®ƒå…è®¸ç³»ç»Ÿå°†æ›´å¤šçš„åºåˆ—ä¸€èµ·æ‰¹å¤„ç†ï¼Œæé«˜ GPU åˆ©ç”¨ç‡ï¼Œä»è€Œæ˜¾è‘—æé«˜ååé‡ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒPagedAttention è¿˜æœ‰å¦ä¸€ä¸ªå…³é”®ä¼˜åŠ¿ï¼šé«˜æ•ˆçš„å†…å­˜å…±äº«ã€‚ä¾‹å¦‚ï¼Œåœ¨&lt;strong&gt;å¹¶è¡Œé‡‡æ ·&lt;/strong&gt;ä¸­ï¼Œå¯ä»¥ä»åŒä¸€ä¸ª prompt ç”Ÿæˆå¤šä¸ªè¾“å‡ºåºåˆ—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹è¯¥ prompt çš„è®¡ç®—å’Œå†…å­˜å¯ä»¥åœ¨è¾“å‡ºåºåˆ—ä¹‹é—´å…±äº«ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/vLLM/2.3.gif&#34; alt=&#34;&#34; title=&#34;å¹¶è¡Œè®¡ç®—ç¤ºä¾‹&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒPagedAttention é€šè¿‡å…¶å—è¡¨è‡ªç„¶åœ°å®ç°äº†å†…å­˜å…±äº«ã€‚ç±»ä¼¼äºè¿›ç¨‹å…±äº«ç‰©ç†é¡µé¢çš„æ–¹å¼ï¼Œä¸åŒåºåˆ—åœ¨ PagedAttention ä¸­å¯ä»¥é€šè¿‡å°†å®ƒä»¬çš„é€»è¾‘å—æ˜ å°„åˆ°åŒä¸€ä¸ªç‰©ç†å—æ¥å…±äº«å—ã€‚ä¸ºäº†ç¡®ä¿å®‰å…¨çš„å…±äº«ï¼ŒPagedAttention ä¼šè·Ÿè¸ªç‰©ç†å—çš„å¼•ç”¨è®¡æ•°ï¼Œå¹¶å®ç°äº†å†™æ—¶å¤åˆ¶ï¼ˆCopy-on-Writeï¼‰æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/vLLM/2.4.gif&#34; alt=&#34;&#34; title=&#34;å¯¹ä¸€æ¡requestç”Ÿæˆå¤šæ¡è¾“å‡ºçš„ç¤ºä¾‹&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒPageAttention çš„å†…å­˜å…±äº«å¤§å¤§å‡å°‘äº†å¤æ‚é‡‡æ ·ç®—æ³•çš„å†…å­˜å¼€é”€ï¼Œå¦‚å¹¶è¡Œé‡‡æ ·å’ŒæŸæœç´¢ï¼Œå°†å®ƒä»¬çš„å†…å­˜ä½¿ç”¨é‡å‡å°‘äº†é«˜è¾¾ 55%ã€‚è¿™å¯ä»¥è½¬åŒ–ä¸ºååé‡é«˜è¾¾ 2.2 å€çš„æå‡ã€‚è¿™ä½¿å¾—è¿™äº›é‡‡æ ·æ–¹æ³•åœ¨ LLM æœåŠ¡ä¸­å˜å¾—å®ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒPagedAttention æ˜¯ vLLM èƒŒåçš„æ ¸å¿ƒæŠ€æœ¯ï¼ŒvLLM æ˜¯æˆ‘ä»¬çš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ¨ç†å’ŒæœåŠ¡å¼•æ“ï¼Œå®ƒæ”¯æŒå¤šç§æ¨¡å‹ï¼Œå…·æœ‰é«˜æ€§èƒ½å’Œæ˜“äºä½¿ç”¨çš„ç•Œé¢ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-å¼€å§‹ä½¿ç”¨vllm&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-å¼€å§‹ä½¿ç”¨vllm&#34;&gt;#&lt;/a&gt; ä¸‰ã€å¼€å§‹ä½¿ç”¨ vLLM&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£… vLLMï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;pip &lt;span class=&#34;token function&#34;&gt;install&lt;/span&gt; vllm&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒvLLM å¯ä»¥ç”¨äºç¦»çº¿æ¨ç†å’Œåœ¨çº¿æœåŠ¡ã€‚è¦ä½¿ç”¨ vLLM è¿›è¡Œç¦»çº¿æ¨ç†ï¼Œå¯ä»¥åœ¨ Python è„šæœ¬ä¸­å¯¼å…¥ vLLM å¹¶ä½¿ç”¨ LLM ç±»ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; vllm &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; LLM&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; SamplingParams&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;prompts &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;Hello, my name is&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;The president of the United States is&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;The capital of France is&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;The future of AI is&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;sampling_params &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; SamplingParams&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;temperature&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; top_p&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0.95&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;llm &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; LLM&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;model&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;facebook/opt-125m&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;outputs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; llm&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;generate&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;prompts&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; sampling_params&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; output &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; outputs&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    prompt &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; output&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;prompt&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    generated_text &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; output&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;outputs&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;text&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string-interpolation&#34;&gt;&lt;span class=&#34;token string&#34;&gt;f&#34;Prompt: &lt;/span&gt;&lt;span class=&#34;token interpolation&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;prompt&lt;span class=&#34;token conversion-option punctuation&#34;&gt;!r&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;, Generated text: &lt;/span&gt;&lt;span class=&#34;token interpolation&#34;&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;generated_text&lt;span class=&#34;token conversion-option punctuation&#34;&gt;!r&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒè¿è¡Œç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sh&#34;&gt;&lt;figcaption data-lang=&#34;sh&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;vllm&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; ember@ember-Victus-by-HP-Laptop:~/project/python/1_vllm$ python main.py &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;INFO &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;-30 &lt;span class=&#34;token number&#34;&gt;17&lt;/span&gt;:14:44 llm_engine.py:237&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; Initializing an LLM engine &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;v0.6.3.post1&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; with config: &lt;span class=&#34;token assign-left variable&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;facebook/opt-125m&#39;&lt;/span&gt;, &lt;span class=&#34;token assign-left variable&#34;&gt;speculative_config&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None, &lt;span class=&#34;token assign-left variable&#34;&gt;tokenizer&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;facebook/opt-125m&#39;&lt;/span&gt;, &lt;span class=&#34;token assign-left variable&#34;&gt;skip_tokenizer_init&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;False, &lt;span class=&#34;token assign-left variable&#34;&gt;tokenizer_mode&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;auto, &lt;span class=&#34;token assign-left variable&#34;&gt;revision&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None, &lt;span class=&#34;token assign-left variable&#34;&gt;override_neuron_config&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None, &lt;span class=&#34;token assign-left variable&#34;&gt;rope_scaling&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None, &lt;span class=&#34;token assign-left variable&#34;&gt;rope_theta&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None, &lt;span class=&#34;token assign-left variable&#34;&gt;tokenizer_revision&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None, &lt;span class=&#34;token assign-left variable&#34;&gt;trust_remote_code&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;False, &lt;span class=&#34;token assign-left variable&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;torch.float16, &lt;span class=&#34;token assign-left variable&#34;&gt;max_seq_len&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2048&lt;/span&gt;, &lt;span class=&#34;token assign-left variable&#34;&gt;download_dir&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None, &lt;span class=&#34;token assign-left variable&#34;&gt;load_format&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;LoadFormat.AUTO, &lt;span class=&#34;token assign-left variable&#34;&gt;tensor_parallel_size&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;token assign-left variable&#34;&gt;pipeline_parallel_size&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;token assign-left variable&#34;&gt;disable_custom_all_reduce&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;False, &lt;span class=&#34;token assign-left variable&#34;&gt;quantization&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None, &lt;span class=&#34;token assign-left variable&#34;&gt;enforce_eager&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;False, &lt;span class=&#34;token assign-left variable&#34;&gt;kv_cache_dtype&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;auto, &lt;span class=&#34;token assign-left variable&#34;&gt;quantization_param_path&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None, &lt;span class=&#34;token assign-left variable&#34;&gt;device_config&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;cuda, &lt;span class=&#34;token assign-left variable&#34;&gt;decoding_config&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;DecodingConfig&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;guided_decoding_backend&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;outlines&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;, &lt;span class=&#34;token assign-left variable&#34;&gt;observability_config&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;ObservabilityConfig&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;otlp_traces_endpoint&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None, &lt;span class=&#34;token assign-left variable&#34;&gt;collect_model_forward_time&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;False, &lt;span class=&#34;token assign-left variable&#34;&gt;collect_model_execute_time&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;False&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;, &lt;span class=&#34;token assign-left variable&#34;&gt;seed&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;token assign-left variable&#34;&gt;served_model_name&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;facebook/opt-125m, &lt;span class=&#34;token assign-left variable&#34;&gt;num_scheduler_steps&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;token assign-left variable&#34;&gt;chunked_prefill_enabled&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;False &lt;span class=&#34;token assign-left variable&#34;&gt;multi_step_stream_outputs&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;True, &lt;span class=&#34;token assign-left variable&#34;&gt;enable_prefix_caching&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;False, &lt;span class=&#34;token assign-left variable&#34;&gt;use_async_output_proc&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;True, &lt;span class=&#34;token assign-left variable&#34;&gt;use_cached_outputs&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;False, &lt;span class=&#34;token assign-left variable&#34;&gt;mm_processor_kwargs&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;None&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;INFO &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;-30 &lt;span class=&#34;token number&#34;&gt;17&lt;/span&gt;:14:45 model_runner.py:1056&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; Starting to load model facebook/opt-125m&lt;span class=&#34;token punctuation&#34;&gt;..&lt;/span&gt;.&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;INFO &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;-30 &lt;span class=&#34;token number&#34;&gt;17&lt;/span&gt;:14:45 weight_utils.py:243&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; Using model weights &lt;span class=&#34;token function&#34;&gt;format&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;*.bin&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Loading pt checkpoint shards:   &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;% Completed &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;/1 &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;00:0&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;0&lt;/span&gt;&amp;lt;&lt;/span&gt;?, ?it/s&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;/home/ember/anaconda3/envs/vllm/lib/python3.10/site-packages/vllm/model_executor/model_loader/weight_utils.py:425: FutureWarning: You are using &lt;span class=&#34;token variable&#34;&gt;&lt;span class=&#34;token variable&#34;&gt;`&lt;/span&gt;torch.load&lt;span class=&#34;token variable&#34;&gt;`&lt;/span&gt;&lt;/span&gt; with &lt;span class=&#34;token variable&#34;&gt;&lt;span class=&#34;token variable&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;token assign-left variable&#34;&gt;weights_only&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;False&lt;span class=&#34;token variable&#34;&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;the current default value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;, &lt;span class=&#34;token function&#34;&gt;which&lt;/span&gt; uses the default pickle module implicitly. It is possible to construct malicious pickle data &lt;span class=&#34;token function&#34;&gt;which&lt;/span&gt; will execute arbitrary code during unpickling &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;See https://github.com/pytorch/pytorch/blob/main/SECURITY.md&lt;span class=&#34;token comment&#34;&gt;#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don&#39;t have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  state &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch.load&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;bin_file, &lt;span class=&#34;token assign-left variable&#34;&gt;map_location&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;cpu&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Loading pt checkpoint shards: &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;% Completed &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;/1 &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;00:0&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;0&lt;/span&gt;&amp;lt;&lt;/span&gt;00:00,  &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;.61it/s&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Loading pt checkpoint shards: &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;% Completed &lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;/1 &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;00:0&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;0&lt;/span&gt;&amp;lt;&lt;/span&gt;00:00,  &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;.61it/s&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;INFO &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;-30 &lt;span class=&#34;token number&#34;&gt;17&lt;/span&gt;:14:46 model_runner.py:1067&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; Loading model weights took &lt;span class=&#34;token number&#34;&gt;0.2389&lt;/span&gt; GB&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;INFO &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;-30 &lt;span class=&#34;token number&#34;&gt;17&lt;/span&gt;:14:46 gpu_executor.py:122&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# GPU blocks: 4774, # CPU blocks: 7281&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;INFO &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;-30 &lt;span class=&#34;token number&#34;&gt;17&lt;/span&gt;:14:46 gpu_executor.py:126&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; Maximum concurrency &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2048&lt;/span&gt; tokens per request: &lt;span class=&#34;token number&#34;&gt;37&lt;/span&gt;.30x&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;INFO &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;-30 &lt;span class=&#34;token number&#34;&gt;17&lt;/span&gt;:14:48 model_runner.py:1395&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; Capturing the model &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; CUDA graphs. This may lead to unexpected consequences &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; the model is not static. To run the model &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; eager mode, &lt;span class=&#34;token builtin class-name&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;enforce_eager=True&#39;&lt;/span&gt; or use &lt;span class=&#34;token string&#34;&gt;&#39;--enforce-eager&#39;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; the CLI.&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;INFO &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;-30 &lt;span class=&#34;token number&#34;&gt;17&lt;/span&gt;:14:48 model_runner.py:1399&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; CUDA graphs can take additional &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;~3 GiB memory per GPU. If you are running out of memory, consider decreasing &lt;span class=&#34;token variable&#34;&gt;&lt;span class=&#34;token variable&#34;&gt;`&lt;/span&gt;gpu_memory_utilization&lt;span class=&#34;token variable&#34;&gt;`&lt;/span&gt;&lt;/span&gt; or enforcing eager mode. You can also reduce the &lt;span class=&#34;token variable&#34;&gt;&lt;span class=&#34;token variable&#34;&gt;`&lt;/span&gt;max_num_seqs&lt;span class=&#34;token variable&#34;&gt;`&lt;/span&gt;&lt;/span&gt; as needed to decrease memory usage.&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;INFO &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt;-30 &lt;span class=&#34;token number&#34;&gt;17&lt;/span&gt;:14:58 model_runner.py:1523&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; Graph capturing finished &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;10&lt;/span&gt; secs.&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Processed prompts: &lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;%&lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt;â–ˆâ–ˆâ–ˆâ–ˆ&lt;span class=&#34;token operator&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;/4 &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;00:0&lt;span class=&#34;token operator&#34;&gt;&lt;span class=&#34;token file-descriptor important&#34;&gt;0&lt;/span&gt;&amp;lt;&lt;/span&gt;00:00, &lt;span class=&#34;token number&#34;&gt;29&lt;/span&gt;.75it/s, est. speed input: &lt;span class=&#34;token number&#34;&gt;193.42&lt;/span&gt; toks/s, output: &lt;span class=&#34;token number&#34;&gt;476.10&lt;/span&gt; toks/s&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Prompt: &lt;span class=&#34;token string&#34;&gt;&#39;Hello, my name is&#39;&lt;/span&gt;, Generated text: &lt;span class=&#34;token string&#34;&gt;&#34; Joel. I&#39;m a 24 year old software developer and I&#39;m looking for a&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Prompt: &lt;span class=&#34;token string&#34;&gt;&#39;The president of the United States is&#39;&lt;/span&gt;, Generated text: &lt;span class=&#34;token string&#34;&gt;&#39;, in my opinion, the worst person ever to be president.\n&gt; In&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Prompt: &lt;span class=&#34;token string&#34;&gt;&#39;The capital of France is&#39;&lt;/span&gt;, Generated text: &lt;span class=&#34;token string&#34;&gt;&#39; wrong because a country is full of self-doubts about its own future&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Prompt: &lt;span class=&#34;token string&#34;&gt;&#39;The future of AI is&#39;&lt;/span&gt;, Generated text: &lt;span class=&#34;token string&#34;&gt;&#39; in AI and a lot of it is just making sure everyone has an AI that&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/10/05/AI/MAE/</guid>
            <title>MAE</title>
            <link>http://qianqiu-cell.github.io/2024/10/05/AI/MAE/</link>
            <category>AI</category>
            <pubDate>Sat, 05 Oct 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;ä¸€-maeæ¦‚è¿°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-maeæ¦‚è¿°&#34;&gt;#&lt;/a&gt; ä¸€ã€MAE æ¦‚è¿°&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒæ·±åº¦å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸå–å¾—äº†æ˜¾è‘—è¿›å±•ï¼Œä½†éšç€æ¨¡å‹è§„æ¨¡çš„å¢é•¿ï¼Œå¯¹æ•°æ®çš„éœ€æ±‚ä¹Ÿåœ¨å¢åŠ ã€‚åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆ &lt;code&gt;NLP&lt;/code&gt; ï¼‰é¢†åŸŸï¼Œé€šè¿‡è‡ªç›‘ç£é¢„è®­ç»ƒçš„æ–¹æ³•ï¼ˆå¦‚ &lt;code&gt;BERT&lt;/code&gt;  å’Œ &lt;code&gt;GPT&lt;/code&gt; ï¼‰æˆåŠŸè§£å†³äº†æ•°æ®éœ€æ±‚é—®é¢˜ï¼Œè¿™äº›æ–¹æ³•é€šè¿‡é¢„æµ‹æ•°æ®ä¸­è¢« &lt;code&gt;masked&lt;/code&gt;  çš„éƒ¨åˆ†æ¥è®­ç»ƒæ¨¡å‹ã€‚ç„¶è€Œï¼Œåœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸï¼Œå°½ç®¡å­˜åœ¨ç›¸å…³ç ”ç©¶ï¼Œè‡ªç›‘ç£å­¦ä¹ æ–¹æ³•çš„å‘å±•ä»ç„¶æ»åäº &lt;code&gt;NLP&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè¿™ç¯‡è®ºæ–‡ä½¿ç”¨æ©ç è‡ªç¼–ç å™¨ ( &lt;code&gt;masked autoencoders (MAE)&lt;/code&gt; ) è¿›è¡Œè‡ªç›‘ç£å­¦ä¹ ã€‚è¿™ç§ç±»å‹è‡ªç›‘ç£å­¦ä¹ çš„å¦ä¸€ä¸ªè‘—åçš„ä¾‹å­å°±æ˜¯ &lt;code&gt;BERT&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äº &lt;code&gt;BERT&lt;/code&gt;  æ¨¡å‹è€Œè¨€ï¼Œä¸€ä¸ª &lt;code&gt;sentence&lt;/code&gt;  ä¸­é—´ç›–ä½ä¸€äº› &lt;code&gt;tokens&lt;/code&gt; ï¼Œè®©æ¨¡å‹å»é¢„æµ‹ï¼Œä»¤å¾—åˆ°çš„é¢„æµ‹ç»“æœä¸çœŸå®çš„ &lt;code&gt;tokens&lt;/code&gt;  ä¹‹é—´çš„è¯¯å·®ä½œä¸ºæŸå¤±ã€‚å®ƒå‘Šè¯‰äº†æˆ‘ä»¬ç›´æ¥ &lt;code&gt;reconstruct sentence&lt;/code&gt;  ä¹Ÿå¯ä»¥åšåˆ°å¾ˆ &lt;code&gt;work&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äº &lt;code&gt;MAE&lt;/code&gt;  æ¨¡å‹è€Œè¨€ï¼Œä¸€ä¸ª &lt;code&gt;image&lt;/code&gt;  ä¸­é—´ç›–ä½ä¸€äº›  &lt;code&gt;patches&lt;/code&gt; ï¼Œè®©æ¨¡å‹å»é¢„æµ‹ï¼Œä»¤å¾—åˆ°çš„é¢„æµ‹ç»“æœä¸çœŸå®çš„ &lt;code&gt;image patches&lt;/code&gt;  ä¹‹é—´çš„è¯¯å·®ä½œä¸ºæŸå¤±ã€‚å®ƒå‘Šè¯‰äº†æˆ‘ä»¬ç›´æ¥ &lt;code&gt;reconstruct image&lt;/code&gt;  åŸå›¾ä¹Ÿå¯ä»¥åšåˆ°å¾ˆ &lt;code&gt;work&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºä»€ä¹ˆ &lt;code&gt;BERT (2018)&lt;/code&gt;  æå‡ºè¿™ä¹ˆä¹…ä»¥åï¼Œç›´åˆ° &lt;code&gt;BEIT (2021.6)&lt;/code&gt;  å’Œ &lt;code&gt;MAE (2021.11)&lt;/code&gt;  ä¹‹å‰ï¼Œä¸€ç›´åœ¨ &lt;code&gt;CV&lt;/code&gt;  é¢†åŸŸéƒ½æ²¡æœ‰ä¸€ä¸ªå¾ˆç±»ä¼¼çš„ &lt;code&gt;CV BERT&lt;/code&gt;  å‡ºç°ï¼Ÿè¿™é‡Œ &lt;code&gt;Kaiming&lt;/code&gt;  æå‡ºäº† 3 æ¡çœ‹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CV å’Œ NLP ä¸»æµæ¶æ„ä¸åŒ&lt;/strong&gt;ï¼šç›´åˆ° &lt;code&gt;ViT (2020.12)&lt;/code&gt;  å‡ºç°ä¹‹å‰ï¼Œ &lt;code&gt;CV&lt;/code&gt;  çš„ä¸»æµæ¶æ„ä¸€ç›´æ˜¯ä»¥&lt;strong&gt;å·ç§¯ç¥ç»ç½‘ç»œ&lt;/strong&gt;ä¸ºä¸»ï¼Œ &lt;code&gt;NLP&lt;/code&gt;  çš„ä¸»æµæ¶æ„ä¸€ç›´æ˜¯ä»¥ &lt;code&gt;Transformer&lt;/code&gt;  ä¸ºä¸»ã€‚å·ç§¯æ ¸ä½œç”¨åœ¨ä¸€ä¸ªä¸ªçš„ &lt;code&gt;grid&lt;/code&gt;  ä¸Šé¢ï¼Œç›´è§‚æ¥è®²æ²¡æ³•äº§ç”Ÿåƒ &lt;code&gt;Transformer&lt;/code&gt;  ä¸€æ ·çš„ &lt;code&gt;token&lt;/code&gt;  çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬åªä½¿ç”¨å·ç§¯ç½‘ç»œï¼Œé‚£ä¹ˆ &lt;code&gt;image token&lt;/code&gt;  æ¦‚å¿µçš„å»ºç«‹å°±ä¸é‚£ä¹ˆç›´è§‚ã€‚æ‰€ä»¥ï¼Œåƒ &lt;code&gt;Transformer&lt;/code&gt;  é‚£æ ·åœ¨ &lt;code&gt;token&lt;/code&gt;  çš„åŸºç¡€ä¸Šè¿›è¡Œè‡ªç›‘ç£å­¦ä¹ å°±ä¸å¤ªé€‚ç”¨ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªéš¾ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯­è¨€å’Œå›¾ç‰‡ (è§†é¢‘) çš„ä¿¡æ¯å¯†åº¦ä¸åŒ&lt;/strong&gt;ï¼šè¯­è¨€æ˜¯äººç±»é€ å°±çš„ä¿¡å·ï¼Œå®ƒ &lt;code&gt;highly semantic&lt;/code&gt; ï¼Œ &lt;code&gt;information-dense&lt;/code&gt; ã€‚è€Œå›¾ç‰‡ (è§†é¢‘) æ˜¯è‡ªç„¶äº§ç”Ÿçš„ä¿¡å·ï¼Œå®ƒ &lt;code&gt;heavy spatial redundancy&lt;/code&gt; ã€‚å³æŒ¡ä½å›¾ç‰‡çš„ä¸€éƒ¨åˆ† &lt;code&gt;patches&lt;/code&gt; ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°é€šè¿‡çœ‹å®ƒå‘¨å›´çš„ &lt;code&gt;patches&lt;/code&gt;  è€Œæƒ³è±¡å‡ºå®ƒçš„æ ·å­æ¥ã€‚æ‰€ä»¥ï¼Œè¯­è¨€å’Œå›¾åƒï¼Œä¸€ä¸ªä¿¡æ¯å¯†åº¦é«˜ï¼Œä¸€ä¸ªä¿¡æ¯å¯†åº¦ä½ï¼Œè¿™æ˜¯ç¬¬äºŒä¸ªéš¾ç‚¹ã€‚è§£å†³çš„åŠæ³•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä½œè€…æå‡ºäº†ä¸€ä¸ªç®€å•çš„ç­–ç•¥ï¼š&lt;strong&gt;å³æŒ¡ä½å›¾ç‰‡çš„ patches çš„æ¯”ä¾‹é«˜ä¸€äº›&lt;/strong&gt;ã€‚æ¯”å¦‚ä¹‹å‰ä½ æŒ¡ä½ä¸€å¼ å›¾ç‰‡çš„ &lt;code&gt;30%&lt;/code&gt;  çš„ &lt;code&gt;patches&lt;/code&gt; ï¼Œèƒ½å¤Ÿè½»æ¾é€šè¿‡å‘¨å›´çš„ &lt;code&gt;patches&lt;/code&gt;  é¢„æµ‹å‡ºæ¥ï¼›é‚£ç°åœ¨å¦‚æœ&lt;strong&gt;æŒ¡ä½å›¾ç‰‡çš„ 90% çš„ patches&lt;/strong&gt;ï¼Œè¿˜èƒ½å¤Ÿè½»æ¾é€šè¿‡å‘¨å›´çš„ &lt;code&gt;patches&lt;/code&gt;  é¢„æµ‹å‡ºæ¥å—ï¼Ÿ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AutoEncoder é‡Œé¢çš„ Decoder éƒ¨åˆ†åœ¨ CV å’Œ NLP ä¸­å……å½“çš„è§’è‰²ä¸åŒ&lt;/strong&gt;ï¼šåœ¨ &lt;code&gt;CV&lt;/code&gt;  é¢†åŸŸï¼Œ &lt;code&gt;Decoder&lt;/code&gt;  çš„ä½œç”¨æ˜¯é‡å»º &lt;code&gt;image pixels&lt;/code&gt; ï¼Œæ‰€ä»¥ &lt;code&gt;Decoder&lt;/code&gt;  çš„è¾“å‡ºè¯­ä¹‰çº§åˆ«å¾ˆä½ã€‚åœ¨ &lt;code&gt;NLP&lt;/code&gt;  é¢†åŸŸï¼Œ &lt;code&gt;Decoder&lt;/code&gt;  çš„ä½œç”¨æ˜¯é‡å»º &lt;code&gt;sentence words&lt;/code&gt; ï¼Œæ‰€ä»¥ &lt;code&gt;Decoder&lt;/code&gt;  çš„è¾“å‡ºè¯­ä¹‰çº§åˆ«å¾ˆä¸°å¯Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/MAE/0.0.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåŸºäºä»¥ä¸Šåˆ†æï¼Œä½œè€…æå‡ºäº† &lt;code&gt;MAE&lt;/code&gt;  æ–¹æ³•ï¼Œå…¶æ¶æ„å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ &lt;code&gt;MAE&lt;/code&gt;  çš„æ–¹æ³•å¾ˆç®€å•ï¼š &lt;code&gt;Mask&lt;/code&gt;  æ‰è¾“å…¥å›¾åƒçš„éšæœºçš„ &lt;code&gt;patches&lt;/code&gt;  å¹¶é‡å»ºå®ƒä»¬ã€‚å®ƒåŸºäºä¸¤ä¸ªæ ¸å¿ƒç†å¿µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½œè€…å¼€å‘äº†ä¸€ä¸ªéå¯¹ç§° &lt;code&gt;Encoder-Decoder&lt;/code&gt;  æ¶æ„ï¼Œå…¶ä¸­ä¸€ä¸ª &lt;code&gt;Encoder&lt;/code&gt;  åªå¯¹å¯è§çš„ &lt;code&gt;patch&lt;/code&gt;  å­é›†è¿›è¡Œæ“ä½œ (&lt;strong&gt;å³æ²¡æœ‰è¢« mask æ‰çš„ token&lt;/strong&gt;)ï¼Œå¦ä¸€ä¸ªç®€å•è½»é‡åŒ–çš„ &lt;code&gt;Decoder&lt;/code&gt;  å¯ä»¥&lt;strong&gt;ä»æ½œåœ¨è¡¨å¾å’Œè¢« masked æ‰çš„ token é‡å»ºåŸå§‹å›¾åƒ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç ”ç©¶äººå‘˜è¿›ä¸€æ­¥å‘ç°ï¼Œ&lt;strong&gt;Mask æ‰å¤§éƒ¨åˆ†è¾“å…¥å›¾åƒ&lt;/strong&gt; (ä¾‹å¦‚ &lt;code&gt;75%&lt;/code&gt; ) ä¼šäº§ç”Ÿé‡è¦ä¸”æœ‰æ„ä¹‰çš„è‡ªç›‘ç£ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒç»“åˆè¿™ä¸¤ç§è®¾è®¡ï¼Œå°±èƒ½é«˜æ•ˆåœ°è®­ç»ƒå¤§å‹æ¨¡å‹ï¼šæå‡è®­ç»ƒé€Ÿåº¦è‡³ 3 å€æˆ–æ›´å¤šï¼Œå¹¶æé«˜å‡†ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;MAE&lt;/code&gt;  æ–¹æ³•ä¸¥æ ¼æ¥è®²å±äºä¸€ç§å»å™ªè‡ªç¼–ç å™¨ ( &lt;code&gt;Denoising Auto-Encoders (DAE)&lt;/code&gt; )ï¼Œ &lt;code&gt;DAE&lt;/code&gt;  æ˜¯ä¸€ç±»è‡ªåŠ¨ç¼–ç å™¨ï¼Œå®ƒç ´åè¾“å…¥ä¿¡å·ï¼Œå¹¶å­¦ä¼šé‡æ„åŸå§‹çš„ã€æœªè¢«ç ´åçš„ä¿¡å·ã€‚ &lt;code&gt;MAE&lt;/code&gt;  çš„  &lt;code&gt;Encoder&lt;/code&gt;  å’Œ &lt;code&gt;Decoder&lt;/code&gt;  ç»“æ„ä¸åŒï¼Œæ˜¯éå¯¹ç§°å¼çš„ã€‚ &lt;code&gt;Encoder&lt;/code&gt;  å°†è¾“å…¥ç¼–ç ä¸º &lt;code&gt;latent representation&lt;/code&gt; ï¼Œè€Œ &lt;code&gt;Decoder&lt;/code&gt;  å°†ä» &lt;code&gt;latent representation&lt;/code&gt;  é‡å»ºåŸå§‹ä¿¡å·ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;MAE&lt;/code&gt;  å’Œ &lt;code&gt;ViT&lt;/code&gt;  çš„åšæ³•ä¸€è‡´ï¼Œå°†å›¾åƒåˆ’åˆ†æˆè§„åˆ™çš„ï¼Œä¸é‡å çš„ &lt;code&gt;patches&lt;/code&gt; ã€‚ç„¶åæŒ‰ç…§å‡åŒ€åˆ†å¸ƒä¸é‡å¤åœ°é€‰æ‹©ä¸€äº› &lt;code&gt;patches&lt;/code&gt;  å¹¶ä¸” &lt;code&gt;mask&lt;/code&gt;  æ‰å‰©ä½™çš„ &lt;code&gt;patches&lt;/code&gt; ã€‚ä½œè€…é‡‡ç”¨çš„ &lt;code&gt;mask ratio&lt;/code&gt;  è¶³å¤Ÿé«˜ï¼Œå› æ­¤å¤§å¤§å‡å°äº† &lt;code&gt;patches&lt;/code&gt;  çš„å†—ä½™ä¿¡æ¯ï¼Œä½¿å¾—åœ¨è¿™ç§æƒ…å†µä¸‹é‡å»º &lt;code&gt;images&lt;/code&gt;  ä¸é‚£ä¹ˆå®¹æ˜“ã€‚&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-maeæ–¹æ³•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-maeæ–¹æ³•&#34;&gt;#&lt;/a&gt; äºŒã€MAE æ–¹æ³•&lt;/h1&gt;
&lt;h2 id=&#34;21-mask&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-mask&#34;&gt;#&lt;/a&gt; 2.1 Mask&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒæ ¹æ® &lt;code&gt;ViT&lt;/code&gt; ï¼Œ &lt;code&gt;MAE&lt;/code&gt;  å°†å›¾åƒåˆ’åˆ†ä¸ºè§„åˆ™çš„ä¸é‡å çš„ &lt;code&gt;patch&lt;/code&gt; ã€‚ç„¶åå¯¹ &lt;code&gt;patch&lt;/code&gt;  çš„å­é›†è¿›è¡Œé‡‡æ ·ï¼Œå¹¶ &lt;code&gt;mask&lt;/code&gt;  (å³åˆ é™¤) å‰©ä½™çš„ &lt;code&gt;patch&lt;/code&gt; ã€‚ &lt;code&gt;MAE&lt;/code&gt;  çš„é‡‡æ ·ç­–ç•¥å¾ˆç®€å•ï¼šå¯¹éšæœº &lt;code&gt;patch&lt;/code&gt;  è¿›è¡Œé‡‡æ ·ï¼Œéµå¾ªå‡åŒ€åˆ†å¸ƒã€‚ç®€å•åœ°ç§°ä¹‹ä¸º â€œéšæœºæŠ½æ ·â€ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;å…·æœ‰é«˜&lt;/code&gt;  mask ratio`(å³å»é™¤æ–‘å—çš„æ¯”ä¾‹) çš„éšæœºé‡‡æ ·åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ¶ˆé™¤äº†å†—ä½™ï¼Œä»è€Œåˆ›å»ºäº†ä¸€ä¸ªä¸èƒ½é€šè¿‡ä»å¯è§çš„é‚»è¿‘æ–‘å—å¤–æ¨è½»æ¾è§£å†³çš„ä»»åŠ¡ã€‚å‡åŒ€åˆ†å¸ƒé˜²æ­¢äº†æ½œåœ¨çš„ä¸­å¿ƒåå·® (å³åœ¨å›¾åƒä¸­å¿ƒé™„è¿‘æœ‰æ›´å¤šçš„æ©è”½æ–‘å—)ã€‚æœ€åï¼Œé«˜åº¦ç¨€ç–çš„è¾“å…¥ä¸ºè®¾è®¡é«˜æ•ˆçš„ç¼–ç å™¨åˆ›é€ äº†æœºä¼šã€‚&lt;/p&gt;
&lt;h2 id=&#34;22-mae-encoder&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-mae-encoder&#34;&gt;#&lt;/a&gt; 2.2 MAE encoder&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;MAE&lt;/code&gt;  çš„ç¼–ç å™¨æ˜¯ &lt;code&gt;ViT&lt;/code&gt; ï¼Œä½†åªåº”ç”¨äºå¯è§çš„ï¼Œæœª &lt;code&gt;mask&lt;/code&gt;  çš„ &lt;code&gt;patches&lt;/code&gt; ã€‚å°±åƒåœ¨æ ‡å‡† &lt;code&gt;ViT&lt;/code&gt;  ä¸­ä¸€æ ·ï¼Œ &lt;code&gt;MAE&lt;/code&gt;  çš„ç¼–ç å™¨é€šè¿‡æ·»åŠ  &lt;code&gt;positional embedding&lt;/code&gt;  çš„çº¿æ€§æŠ•å½±è·å¾—æ¯ä¸ª &lt;code&gt;patch&lt;/code&gt;  çš„ &lt;code&gt;embedding&lt;/code&gt; ï¼Œç„¶åé€šè¿‡ä¸€ç³»åˆ— &lt;code&gt;transformer&lt;/code&gt;  å—å¤„ç†ç»“æœé›†ã€‚ &lt;code&gt;MAE&lt;/code&gt;  çš„ç¼–ç å™¨åªåœ¨å®Œæ•´ &lt;code&gt;patches&lt;/code&gt;  çš„ä¸€å°éƒ¨åˆ† (ä¾‹å¦‚ï¼Œ25%) ä¸Šè¿è¡Œã€‚ &lt;code&gt;masked patches&lt;/code&gt;  è¢«ç§»é™¤ï¼›ä¸”ä¸ä½¿ç”¨æ©ç ä»¤ç‰Œã€‚è¿™å…è®¸ &lt;code&gt;MAE&lt;/code&gt;  åªç”¨ä¸€å°éƒ¨åˆ†çš„è®¡ç®—å’Œå†…å­˜&lt;strong&gt;è®­ç»ƒéå¸¸å¤§çš„ç¼–ç å™¨&lt;/strong&gt;ã€‚å®Œæ•´çš„ &lt;code&gt;patches&lt;/code&gt;  ç”±ä¸€ä¸ªè½»é‡çº§è§£ç å™¨å¤„ç†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;23-mae-decoder&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-mae-decoder&#34;&gt;#&lt;/a&gt; 2.3 MAE decoder&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;MAE&lt;/code&gt;  è§£ç å™¨çš„è¾“å…¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„ &lt;code&gt;tokens&lt;/code&gt; ï¼Œç”± (i) ç¼–ç çš„ &lt;code&gt;visible patches&lt;/code&gt;  å’Œ (ii) &lt;code&gt;masked tokens&lt;/code&gt;  ç»„æˆã€‚æ¯ä¸ª &lt;code&gt;masked tokens&lt;/code&gt;  æ˜¯ä¸€ä¸ªå…±äº«çš„ã€å¯å­¦ä¹ çš„å‘é‡ï¼Œè¡¨ç¤ºå¾…é¢„æµ‹çš„ &lt;code&gt;missing patch&lt;/code&gt; ã€‚ä¸ºè¿™ä¸ªå®Œæ•´ &lt;code&gt;tokens&lt;/code&gt;  ä¸­çš„æ‰€æœ‰ &lt;code&gt;token&lt;/code&gt;  æ·»åŠ  &lt;code&gt;position embedding&lt;/code&gt; ï¼›è§£ç å™¨æœ‰å¦ä¸€ç³»åˆ—çš„ &lt;code&gt;transformer&lt;/code&gt;  å—ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;MAE&lt;/code&gt;  è§£ç å™¨&lt;strong&gt;ä»…åœ¨é¢„è®­ç»ƒæœŸé—´ç”¨äºæ‰§è¡Œå›¾åƒé‡å»ºä»»åŠ¡ (ä»…ç¼–ç å™¨ç”¨äºç”Ÿæˆç”¨äºè¯†åˆ«çš„å›¾åƒè¡¨ç¤º)&lt;/strong&gt;ã€‚å› æ­¤ï¼Œ&lt;strong&gt;è§£ç å™¨æ¶æ„å¯ä»¥ä»¥ä¸€ç§ç‹¬ç«‹äºç¼–ç å™¨è®¾è®¡çš„æ–¹å¼çµæ´»è®¾è®¡&lt;/strong&gt;ã€‚ &lt;code&gt;MAE&lt;/code&gt;  ç”¨éå¸¸å°çš„è§£ç å™¨åšå®éªŒï¼Œæ¯”ç¼–ç å™¨æ›´çª„æ›´æµ…ã€‚ä¾‹å¦‚ï¼Œä¸ç¼–ç å™¨ç›¸æ¯”ï¼Œæˆ‘ä»¬çš„é»˜è®¤è§£ç å™¨æ¯ä¸ªä»¤ç‰Œçš„è®¡ç®—é‡ &amp;lt; 10%ã€‚é€šè¿‡è¿™ç§ä¸å¯¹ç§°è®¾è®¡ï¼Œæ•´ä¸ªæ ‡è®°é›†åªç”±è½»é‡çº§è§£ç å™¨å¤„ç†ï¼Œ&lt;strong&gt;è¿™å¤§å¤§å‡å°‘äº†é¢„è®­ç»ƒæ—¶é—´&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;24-reconstruction-target&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#24-reconstruction-target&#34;&gt;#&lt;/a&gt; 2.4 Reconstruction target&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;MAE&lt;/code&gt;  é€šè¿‡é¢„æµ‹æ¯ä¸ª &lt;code&gt;masked patch&lt;/code&gt;  çš„åƒç´ å€¼æ¥é‡æ„è¾“å…¥ã€‚è§£ç å™¨è¾“å‡ºä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯è¡¨ç¤ºä¸€ä¸ª &lt;code&gt;patch&lt;/code&gt;  çš„åƒç´ å€¼å‘é‡ã€‚è§£ç å™¨çš„æœ€åä¸€å±‚æ˜¯çº¿æ€§æŠ•å½±ï¼Œ&lt;strong&gt;å…¶è¾“å‡ºé€šé“çš„æ•°é‡ç­‰äº &lt;code&gt;patch&lt;/code&gt;  ä¸­çš„åƒç´ å€¼çš„æ•°é‡&lt;/strong&gt;ã€‚ &lt;code&gt;MAE&lt;/code&gt;  çš„&lt;strong&gt;æŸå¤±å‡½æ•°åœ¨åƒç´ ç©ºé—´ä¸­è®¡ç®—é‡å»ºå›¾åƒå’ŒåŸå§‹å›¾åƒä¹‹é—´çš„å‡æ–¹è¯¯å·®&lt;/strong&gt;ï¼ˆ &lt;code&gt;MSE&lt;/code&gt; ï¼‰ã€‚ &lt;code&gt;MAE&lt;/code&gt;  åªè®¡ç®— &lt;code&gt;masked patches&lt;/code&gt;  ä¸Šçš„æŸå¤±ï¼Œç±»ä¼¼äº &lt;code&gt;BERT&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;MAE&lt;/code&gt;  è¿˜ç ”ç©¶äº†ä¸€ç§å˜ä½“ï¼Œå…¶é‡å»ºç›®æ ‡æ˜¯æ¯ä¸ª &lt;code&gt;masked patch&lt;/code&gt;  çš„å½’ä¸€åŒ–åƒç´ å€¼ã€‚å…·ä½“åœ°è¯´ï¼Œ &lt;code&gt;MAE&lt;/code&gt;  è®¡ç®—ä¸€ä¸ª &lt;code&gt;patch&lt;/code&gt;  ä¸­æ‰€æœ‰åƒç´ çš„å¹³å‡å€¼å’Œæ ‡å‡†å·®ï¼Œå¹¶ä½¿ç”¨å®ƒä»¬æ¥å½’ä¸€åŒ–è¯¥ &lt;code&gt;patch&lt;/code&gt; ã€‚åœ¨ &lt;code&gt;MAE&lt;/code&gt;  çš„å®éªŒä¸­ï¼Œä½¿ç”¨å½’ä¸€åŒ–åƒç´ ä½œä¸ºé‡å»ºç›®æ ‡æ”¹å–„äº†è¡¨ç¤ºè´¨é‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;25-simple-implementation&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#25-simple-implementation&#34;&gt;#&lt;/a&gt; 2.5 Simple implementation&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;MAE&lt;/code&gt;  çš„é¢„è®­ç»ƒå¯ä»¥æœ‰æ•ˆåœ°å®ç°ï¼Œå¹¶ä¸”é‡è¦çš„æ˜¯ï¼Œä¸éœ€è¦ä»»ä½•ä¸“é—¨çš„ç¨€ç–æ“ä½œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªè¾“å…¥ &lt;code&gt;patch&lt;/code&gt;  ç”Ÿæˆä¸€ä¸ª &lt;code&gt;token&lt;/code&gt; ï¼ˆé€šè¿‡æ·»åŠ  &lt;code&gt;position embedding&lt;/code&gt;  çš„çº¿æ€§æŠ•å½±ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éšæœºæ‰“ä¹± &lt;code&gt;token&lt;/code&gt;  åˆ—è¡¨ï¼Œå¹¶æ ¹æ® &lt;code&gt;mask ratio&lt;/code&gt;  åˆ é™¤åˆ—è¡¨çš„æœ€åä¸€éƒ¨åˆ†ã€‚æ­¤è¿‡ç¨‹ä¸ºç¼–ç å™¨ç”Ÿæˆä¸€ä¸ªå°çš„ &lt;code&gt;token&lt;/code&gt;  å­é›†ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ç¼–ç ä¹‹åï¼Œæˆ‘ä»¬å°† &lt;code&gt;mask token&lt;/code&gt;  çš„åˆ—è¡¨æ·»åŠ è‡³ç¼–ç çš„ &lt;code&gt;token&lt;/code&gt;  åˆ—è¡¨ï¼Œå¹¶è¿˜åŸæ­¤å®Œæ•´çš„åˆ—è¡¨ï¼ˆåè½¬éšæœºæ‰“ä¹±æ“ä½œï¼‰ï¼Œä»¥å°†æ‰€æœ‰ &lt;code&gt;token&lt;/code&gt;  ä¸å…¶ç›®çš„å¯¹é½ã€‚&lt;/li&gt;
&lt;li&gt;è§£ç å™¨åº”ç”¨äºè¯¥å®Œæ•´åˆ—è¡¨ï¼ˆæ·»åŠ äº†ä½ç½®åµŒå…¥ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒå¦‚ä¸Šæ‰€è¿°ï¼Œä¸éœ€è¦ç¨€ç–æ“ä½œã€‚ç”±äºæ‰“ä¹±å’Œè¿˜åŸæ“ä½œæ˜¯å¿«é€Ÿçš„ï¼Œå› æ­¤è¿™ç§ç®€å•çš„å®ç°å¼•å…¥äº†å¯å¿½ç•¥çš„å¼€é”€ã€‚&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/09/21/AI/ViT/</guid>
            <title>ViT</title>
            <link>http://qianqiu-cell.github.io/2024/09/21/AI/ViT/</link>
            <category>AI</category>
            <pubDate>Sat, 21 Sep 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;ä¸€-å¼•è¨€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-å¼•è¨€&#34;&gt;#&lt;/a&gt; ä¸€ã€å¼•è¨€&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒè™½ç„¶  &lt;code&gt;Transformer&lt;/code&gt;  æ¶æ„å·²æˆä¸º  &lt;code&gt;NLP&lt;/code&gt;  ä»»åŠ¡çš„é¦–é€‰æ¨¡å‹ï¼Œä½†å®ƒåœ¨  &lt;code&gt;CV&lt;/code&gt;  ä¸­çš„åº”ç”¨ä»ç„¶æœ‰é™ã€‚åœ¨è§†è§‰ä¸Šï¼Œæ³¨æ„åŠ›è¦ä¹ˆä¸å·ç§¯ç½‘ç»œç»“åˆä½¿ç”¨ï¼Œè¦ä¹ˆç”¨äºæ›¿æ¢å·ç§¯ç½‘ç»œçš„æŸäº›ç»„ä»¶ï¼ŒåŒæ—¶ä¿æŒå…¶æ•´ä½“ç»“æ„ã€‚è€Œè¿™ç§å¯¹  &lt;code&gt;CNNs&lt;/code&gt;  çš„ä¾èµ–æ˜¯ä¸å¿…è¦çš„ï¼Œç›´æ¥åº”ç”¨äºå›¾åƒå—åºåˆ—  ( &lt;code&gt;sequences of image patches&lt;/code&gt; ) çš„çº¯  &lt;code&gt;Transformer&lt;/code&gt;  å¯ä»¥å¾ˆå¥½åœ°æ‰§è¡Œå›¾åƒåˆ†ç±»ä»»åŠ¡ã€‚å½“å¯¹å¤§é‡æ•°æ®è¿›è¡Œé¢„è®­ç»ƒå¹¶è¿ç§»åˆ°å¤šä¸ªä¸­å°å‹å›¾åƒè¯†åˆ«åŸºå‡†æ—¶ ( &lt;code&gt;ImageNet&lt;/code&gt; ã€ &lt;code&gt;CIFAR-100&lt;/code&gt; ã€ &lt;code&gt;VTAB&lt;/code&gt;  ç­‰)ï¼Œä¸  &lt;code&gt;SOTA&lt;/code&gt;  çš„  &lt;code&gt;CNN&lt;/code&gt;  ç›¸æ¯”ï¼Œ &lt;code&gt;Vision Transformer (ViT)&lt;/code&gt;  å¯è·å¾—æ›´ä¼˜å¼‚çš„ç»“æœï¼ŒåŒæ—¶ä»…éœ€æ›´å°‘çš„è®­ç»ƒèµ„æºã€‚&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-æ–¹æ³•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-æ–¹æ³•&#34;&gt;#&lt;/a&gt; äºŒã€æ–¹æ³•&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æ¨¡å‹è®¾è®¡ä¸­ï¼Œ &lt;code&gt;ViT&lt;/code&gt;  å°½å¯èƒ½åœ°éµå¾ªåŸå§‹  &lt;code&gt;Transformer&lt;/code&gt; ã€‚ è¿™ç§æœ‰æ„ç®€å•è®¾ç½®çš„ä¼˜åŠ¿åœ¨äºï¼Œå¯æ‰©å±•çš„ &lt;code&gt;NLP Transformer&lt;/code&gt;  æ¶æ„åŠå…¶é«˜æ•ˆå®ç°å‡ ä¹å¯ä»¥å¼€ç®±å³ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/ViT/2.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;21-å›¾åƒå—åµŒå…¥patch-embeddings&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-å›¾åƒå—åµŒå…¥patch-embeddings&#34;&gt;#&lt;/a&gt; 2.1 å›¾åƒå—åµŒå…¥ (Patch Embeddings)&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒæ¨¡å‹æ¦‚è¿°å¦‚å›¾ 1 æ‰€ç¤ºã€‚æ ‡å‡† &lt;code&gt;Transformer&lt;/code&gt;  ä½¿ç”¨ä¸€ç»´æ ‡è®°åµŒå…¥åºåˆ— ( &lt;code&gt;Sequence of token embeddings&lt;/code&gt; ) ä½œä¸ºè¾“å…¥ã€‚ä¸ºäº†å¤„ç† &lt;code&gt;2D&lt;/code&gt;  å›¾åƒï¼Œå°†å›¾åƒ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x\in \mathbb{R}^{H\times W\times C}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.5782em;vertical-align:-0.0391em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8413309999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8413309999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.08125em;&#34;&gt;H&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;  &lt;code&gt;reshape&lt;/code&gt;  ä¸ºä¸€ä¸ªå±•å¹³çš„ &lt;code&gt;2D patches&lt;/code&gt;  åºåˆ—&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo separator=&#34;true&#34;&gt;â‹…&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_p \in \mathbb{R}^{N\times (P^2Â·C)}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8252079999999999em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15139200000000003em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;p&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0369199999999998em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0369199999999998em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8913142857142857em;&#34;&gt;&lt;span style=&#34;top:-2.931em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;â‹…&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå…¶ä¸­ (Hï¼ŒW) æ˜¯åŸå§‹å›¾åƒçš„åˆ†è¾¨ç‡ï¼ŒC æ˜¯é€šé“çš„æ•°ç›®ï¼Œï¼ˆPï¼ŒPï¼‰æ˜¯æ¯ä¸ªå›¾åƒç‰‡çš„åˆ†è¾¨ç‡ï¼Œå¹¶ä¸”&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;N = HW/P^2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.064108em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.08125em;&#34;&gt;H&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ˜¯å¾—åˆ°å›¾åƒ patch çš„æ•°ï¼Œä¹Ÿæ˜¯ &lt;code&gt;Transformer&lt;/code&gt;  çš„æœ‰æ•ˆè¾“å…¥åºåˆ—é•¿åº¦ã€‚ &lt;code&gt;Transformer&lt;/code&gt;  åœ¨å…¶æ‰€æœ‰å±‚ä¸­ä½¿ç”¨æ’å®šçš„æ½œåœ¨å‘é‡å¤§å° &lt;code&gt;D&lt;/code&gt; ï¼Œå› æ­¤ &lt;code&gt;ViT&lt;/code&gt;  å°† pathches å±•å¹³ï¼Œå¹¶ä½¿ç”¨ ** å¯è®­ç»ƒçš„çº¿æ€§æŠ•å½± (FC å±‚)** å°†&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo separator=&#34;true&#34;&gt;â‹…&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;P^2Â·C&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8141079999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;â‹…&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ˜ å°„åˆ° &lt;code&gt;D&lt;/code&gt;  ç»´ï¼ŒåŒæ—¶ä¿æŒå›¾åƒ &lt;code&gt;patches&lt;/code&gt;  æ•° &lt;code&gt;N&lt;/code&gt;  ä¸å˜ã€‚è¯¥æŠ•å½±çš„è¾“å‡ºè¢«ç§°ä¸º &lt;code&gt;patch embeddings&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸Šè¿°æŠ•å½±è¾“å‡ºå³ä¸ºå›¾åƒå—åµŒå…¥ (Patch Embeddings)ï¼Œæœ¬è´¨å°±æ˜¯å¯¹æ¯ä¸€ä¸ªå±•å¹³åçš„ &lt;code&gt;patch vector&lt;/code&gt;  &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo separator=&#34;true&#34;&gt;â‹…&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_p\in \mathbb{R}^{N\times (P^2Â·C)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8252079999999999em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15139200000000003em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;p&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9869199999999998em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9869199999999998em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8913142857142857em;&#34;&gt;&lt;span style=&#34;top:-2.931em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;â‹…&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; åšä¸€ä¸ªçº¿æ€§å˜æ¢ / å…¨è¿æ¥å±‚ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo separator=&#34;true&#34;&gt;â‹…&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;E\in \mathbb{R}^{(P^2Â·C)\times D}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.72243em;vertical-align:-0.0391em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9869199999999998em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9869199999999998em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8913142857142857em;&#34;&gt;&lt;span style=&#34;top:-2.931em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;â‹…&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œç”±&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;P^2\times C&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.897438em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; é™ç»´è‡³&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;D&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ç»´ï¼Œå¾—åˆ°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_pE\in \mathbb{R}^{N\times N}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.969438em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15139200000000003em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;p&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8413309999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8413309999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚ç±»ä¼¼äº NLP ä¸­çš„è¯åµŒå…¥ï¼ˆWord Embeddingsï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å›¾åƒå—åµŒå…¥çš„å‚è€ƒç¨‹åºä¸ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;PatchEmbed&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Module&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token triple-quoted-string string&#34;&gt;&#34;&#34;&#34; Image to Patch Embedding &#34;&#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; img_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;224&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; patch_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; in_chans&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; embed_dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;768&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token builtin&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__init__&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# (H, W)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        img_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; to_2tuple&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;img_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# (P, P)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        patch_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; to_2tuple&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;patch_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# N = (H // P) * (W // P)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        num_patches &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;img_size&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;//&lt;/span&gt; patch_size&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;img_size&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;//&lt;/span&gt; patch_size&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;img_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; img_size&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;patch_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; patch_size&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;num_patches &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; num_patches&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# å¯è®­ç»ƒçš„çº¿æ€§æŠ•å½± - è·å–è¾“å…¥åµŒå…¥&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;proj &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Conv2d&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_chans&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; embed_dim&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; kernel_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;patch_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; stride&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;patch_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        B&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; C&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; H&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; W &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# (B, C, H, W) -&gt; (B, D, (H//P), (W//P)) -&gt; (B, D, N) -&gt; (B, N, D)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;#   D=embed_dim=768, N=num_patches=(H//P)*(W//P)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;#   torch.flatten (input, start_dim=0, end_dim=-1)  # å½¢å‚ï¼šå±•å¹³çš„èµ·å§‹ç»´åº¦å’Œç»“æŸç»´åº¦    &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# å¯è§ Patch Embedding æ“ä½œ 1 è¡Œä»£ç  3 æ­¥åˆ°ä½&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;proj&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;flatten&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transpose&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; x&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;22-å¯å­¦ä¹ çš„åµŒå…¥learnable-embedding&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-å¯å­¦ä¹ çš„åµŒå…¥learnable-embedding&#34;&gt;#&lt;/a&gt; 2.2 å¯å­¦ä¹ çš„åµŒå…¥ï¼ˆLearnable Embeddingï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒç±»ä¼¼äº BERT çš„ [class] tokenï¼Œ &lt;code&gt;ViT&lt;/code&gt;  ä¸ºå›¾åƒ patch åµŒå…¥åºåˆ—é¢„è®¾ä¸€ä¸ªå¯å­¦ä¹ çš„åµŒå…¥&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;z_0=x_{class}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.04398em;&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå…¶åœ¨ Transformer ç¼–ç å™¨è¾“å‡ºçš„çŠ¶æ€ / ç‰¹å¾&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;z^0_L&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.089439em;vertical-align:-0.275331em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.04398em;&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-2.424669em;margin-left:-0.04398em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;L&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.275331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ç”¨ä½œå›¾åƒè¡¨ç¤ºã€‚åœ¨é¢„è®­ç»ƒå’Œå¾®è°ƒæœŸé—´ï¼Œå°†åˆ†ç±»å¤´é™„åŠ åˆ°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;z^0_L&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.089439em;vertical-align:-0.275331em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.04398em;&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-2.424669em;margin-left:-0.04398em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;L&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.275331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¹‹åï¼Œä»è€Œç”¨äºå›¾åƒåˆ†ç±»ã€‚åˆ†ç±»å¤´åœ¨é¢„è®­ç»ƒæ—¶ç”±å…·æœ‰ä¸€ä¸ªéšè—å±‚çš„ &lt;code&gt;MLP&lt;/code&gt;  å®ç°ï¼Œåœ¨å¾®è°ƒæ—¶ç”±å•ä¸ªçº¿æ€§å±‚å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ›´æ˜ç¡®åœ°ï¼Œå‡è®¾å°†å›¾åƒåˆ†ä¸º N ä¸ªå›¾åƒå—ï¼Œè¾“å…¥åˆ° Transformer ç¼–ç å™¨ä¸­å°±æœ‰ N ä¸ªå‘é‡ï¼Œä½†æ˜¯è¿™äº›å‘é‡éƒ½ä¸é€‚åˆç”¨æ¥ä½œä¸ºåˆ†ç±»é¢„æµ‹ã€‚ä¸€ä¸ªåˆç†çš„åšæ³•æ˜¯æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªå¯å­¦ä¹ çš„åµŒå…¥å‘é‡ä½œä¸ºç”¨äºåˆ†ç±»çš„ç±»åˆ«å‘é‡åŒæ—¶ä¸å…¶ä»–å›¾åƒå—åµŒå…¥å‘é‡ä¸€èµ·è¾“å…¥åˆ° Transformer ç¼–ç å™¨ä¸­ï¼Œæœ€åå–è¿½åŠ çš„é¦–ä¸ªå¯å­¦ä¹ çš„åµŒå…¥å‘é‡ä½œä¸ºç±»åˆ«é¢„æµ‹ç»“æœã€‚æ‰€ä»¥ï¼Œè¿½åŠ çš„é¦–ä¸ªç±»åˆ«å‘é‡å¯ç†è§£ä¸ºå…¶ä»– N ä¸ªå›¾åƒå—å¯»æ‰¾çš„ç±»åˆ«ä¿¡æ¯ã€‚ä»è€Œï¼Œæœ€ç»ˆè¾“å…¥ Transformer çš„åµŒå…¥å‘é‡æ€»é•¿åº¦ä¸º N+1ã€‚å¯å­¦ä¹ åµŒå…¥ åœ¨è®­ç»ƒæ—¶éšæœºåˆå§‹åŒ–ï¼Œç„¶åé€šè¿‡è®­ç»ƒå¾—åˆ°ï¼Œå…¶å…·ä½“å®ç°ä¸ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;### éšæœºåˆå§‹åŒ–&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cls_token &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Parameter&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;zeros&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; embed_dim&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# shape = (1, 1, D)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# æŒ‰é€šé“æ‹¼æ¥ è·å– N+1 ç»´ Embeddings&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cat&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;cls_tokens&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# shape = (B, N+1, D)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;23-ä½ç½®åµŒå…¥-position-embeddings&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-ä½ç½®åµŒå…¥-position-embeddings&#34;&gt;#&lt;/a&gt; 2.3 ä½ç½®åµŒå…¥ (Position Embeddings)&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒä½ç½®åµŒå…¥&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;Ã—&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;E_{pos}\in \mathbb{R}^{(N+1)\times D}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.969438em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15139200000000003em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8879999999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8879999999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;Ã—&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¹Ÿè¢«åŠ å…¥å›¾åƒå—åµŒå…¥ï¼Œä»¥ä¿ç•™è¾“å…¥å›¾åƒå—ä¹‹é—´çš„ç©ºé—´ä½ç½®ä¿¡æ¯ã€‚è‹¥ä¸ç»™æ¨¡å‹æä¾›å›¾åƒå—çš„ä½ç½®ä¿¡æ¯ï¼Œé‚£ä¹ˆæ¨¡å‹å°±éœ€è¦é€šè¿‡å›¾åƒå—çš„è¯­ä¹‰æ¥å­¦ä¹ æ‹¼å›¾ï¼Œè¿™å°±é¢å¤–å¢åŠ äº†å­¦ä¹ æˆæœ¬ã€‚ViT è®ºæ–‡ä¸­å¯¹æ¯”äº†å‡ ç§ä¸åŒçš„ä½ç½®ç¼–ç æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½ç½®åµŒå…¥&lt;/li&gt;
&lt;li&gt;1-D ä½ç½®åµŒå…¥ (1D-PE)ï¼šè€ƒè™‘æŠŠ 2-D å›¾åƒå—è§†ä¸º 1-D åºåˆ—&lt;/li&gt;
&lt;li&gt;2-D ä½ç½®åµŒå…¥ (2D-PE)ï¼šè€ƒè™‘å›¾åƒå—çš„ 2-D ä½ç½® (x, y)&lt;/li&gt;
&lt;li&gt;ç›¸å¯¹ä½ç½®åµŒå…¥ (RPE)ï¼šè€ƒè™‘å›¾åƒå—çš„ç›¸å¯¹ä½ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒæœ€åå‘ç°å¦‚æœ ä¸æä¾›ä½ç½®ç¼–ç æ•ˆæœä¼šå·®ï¼Œä½†å…¶å®ƒå„ç§ç±»å‹çš„ç¼–ç æ•ˆæœæ•ˆæœéƒ½æ¥è¿‘ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸º ViT çš„è¾“å…¥æ˜¯ç›¸å¯¹è¾ƒå¤§çš„å›¾åƒå—è€Œéåƒç´ ï¼Œæ‰€ä»¥å­¦ä¹ ä½ç½®ä¿¡æ¯ç›¸å¯¹å®¹æ˜“å¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒTransformer åŸæ–‡ä¸­é»˜è®¤é‡‡ç”¨ å›ºå®šä½ç½®ç¼–ç ï¼ŒViT åˆ™é‡‡ç”¨ æ ‡å‡†å¯å­¦ä¹  / è®­ç»ƒçš„ 1-D ä½ç½®ç¼–ç åµŒå…¥ï¼Œå› ä¸ºå°šæœªè§‚å¯Ÿåˆ°ä½¿ç”¨æ›´é«˜çº§çš„ 2-D-aware ä½ç½®åµŒå…¥ (é™„å½• D.4) èƒ½å¤Ÿå¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½æå‡ (å½“ç„¶ï¼Œåç»­çš„å¾ˆå¤š ViT å˜ä½“ä¹Ÿä½¿ç”¨äº† 2-D ä½ç½®åµŒå…¥)ã€‚åœ¨è¾“å…¥ Transformer ç¼–ç å™¨ä¹‹å‰ç›´æ¥ å°†å›¾åƒå—åµŒå…¥å’Œä½ç½®åµŒå…¥æŒ‰å…ƒç´ ç›¸åŠ ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å¤š +1 æ˜¯ä¸ºäº†åŠ å…¥ä¸Šè¿°çš„ class token&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# embed_dim å³ patch embed_dim&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;pos_embed &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Parameter&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;zeros&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; num_patches &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; embed_dim&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# patch emded + pos_embed ï¼šå›¾åƒå—åµŒå…¥ + ä½ç½®åµŒå…¥&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; x &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;pos_embed&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/09/19/AI/SimCLR/</guid>
            <title>SimCLR</title>
            <link>http://qianqiu-cell.github.io/2024/09/19/AI/SimCLR/</link>
            <category>AI</category>
            <pubDate>Thu, 19 Sep 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;ä¸€-å¼•è¨€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-å¼•è¨€&#34;&gt;#&lt;/a&gt; ä¸€ã€å¼•è¨€&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æ²¡æœ‰äººç±»ç›‘ç£çš„æƒ…å†µä¸‹å­¦ä¹ æœ‰æ•ˆçš„è§†è§‰è¡¨å¾æ˜¯ä¸€ä¸ªé•¿æœŸå­˜åœ¨çš„é—®é¢˜ã€‚å¤§å¤šæ•°ä¸»æµæ–¹æ³•å¯åˆ†ä¸ºä¸¤ç±»ï¼šç”Ÿæˆå¼æˆ–åˆ¤åˆ«å¼ã€‚ç”Ÿæˆå¼æ–¹æ³•å­¦ä¹ åœ¨è¾“å…¥ç©ºé—´ä¸­ç”Ÿæˆæˆ–ä»¥å…¶ä»–æ–¹å¼å»ºæ¨¡åƒç´ ã€‚ç„¶è€Œï¼Œåƒç´ çº§ç”Ÿæˆåœ¨è®¡ç®—ä¸Šæ˜¯æ˜‚è´µçš„ï¼Œå¹¶ä¸”å¯¹äºè¡¨ç¤ºå­¦ä¹ å¯èƒ½ä¸æ˜¯å¿…éœ€çš„ã€‚åˆ¤åˆ«æ–¹æ³•ä½¿ç”¨ç±»ä¼¼äºç”¨äºç›‘ç£å­¦ä¹ çš„ç›®æ ‡å‡½æ•°æ¥å­¦ä¹ è¡¨å¾ï¼Œä½†è®­ç»ƒç½‘ç»œæ‰§è¡Œå€Ÿå£ä»»åŠ¡ï¼Œå…¶ä¸­è¾“å…¥å’Œæ ‡ç­¾éƒ½æ¥è‡ªæœªæ ‡è®°çš„æ•°æ®é›†ã€‚è®¸å¤šè¿™æ ·çš„æ–¹æ³•éƒ½ä¾èµ–äºå¯å‘å¼æ¥è®¾è®¡å€Ÿå£ä»»åŠ¡ï¼Œè¿™å¯èƒ½ä¼šé™åˆ¶å­¦ä¹ è¡¨å¾çš„ä¸€èˆ¬æ€§ã€‚åŸºäºæ½œåœ¨ç©ºé—´ä¸­å¯¹æ¯”å­¦ä¹ çš„åˆ¤åˆ«æ–¹æ³•æœ€è¿‘æ˜¾ç¤ºå‡ºå¾ˆå¤§çš„å‰æ™¯ï¼Œå–å¾—äº†æœ€å…ˆè¿›çš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå…¶ä¸­ &lt;code&gt;SimCLR&lt;/code&gt;  ä¸ºè§†è§‰è¡¨å¾çš„å¯¹æ¯”å­¦ä¹ å¼•å…¥äº†ä¸€ä¸ªç®€å•çš„æ¡†æ¶ã€‚ &lt;code&gt;SimCLR&lt;/code&gt;  ä¸ä»…ä¼˜äºä»¥å‰çš„å·¥ä½œï¼Œè€Œä¸”æ›´ç®€å•ï¼Œä¸éœ€è¦ä¸“é—¨çš„æ¶æ„ï¼Œä¹Ÿä¸æ˜¯è®°å¿†åº“ã€‚é€šè¿‡ç³»ç»Ÿåœ°ç ”ç©¶ &lt;code&gt;SimCLR&lt;/code&gt;  æ¡†æ¶ï¼Œè¡¨æ˜äº†ä»¥ä¸‹ä¿ƒæˆäº†è‰¯å¥½å¯¹æ¯”è¡¨å¾å­¦ä¹ çš„ä¸»è¦åŸå› :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šä¸ªæ•°æ®å¢å¼ºæ“ä½œçš„ç»„åˆ&lt;/strong&gt;å¯¹äºå®šä¹‰äº§ç”Ÿ&lt;strong&gt;æœ‰æ•ˆè¡¨ç¤ºçš„å¯¹æ¯”é¢„æµ‹ä»»åŠ¡&lt;/strong&gt;è‡³å…³é‡è¦ã€‚æ­¤å¤–ï¼Œä¸æœ‰ç›‘ç£å­¦ä¹ ç›¸æ¯”ï¼Œ&lt;strong&gt;æ— ç›‘ç£å¯¹æ¯”å­¦ä¹ å—ç›Šäºæ›´å¼ºçš„æ•°æ®å¢å¼º&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åœ¨è¡¨ç¤ºå’Œå¯¹æ¯”æŸå¤±ä¹‹é—´å¼•å…¥å¯å­¦ä¹ çš„éçº¿æ€§å˜æ¢&lt;/strong&gt;ï¼Œå¤§å¤§æé«˜äº†å­¦ä¹ åˆ°çš„è¡¨ç¤ºçš„è´¨é‡ã€‚&lt;/li&gt;
&lt;li&gt;å…·æœ‰&lt;strong&gt;å¯¹æ¯”äº¤å‰ç†µæŸå¤±çš„è¡¨å¾å­¦ä¹ &lt;/strong&gt;å¾—ç›Šäº&lt;strong&gt;å½’ä¸€åŒ–åµŒå…¥å’Œé€‚å½“è°ƒæ•´çš„æ¸©åº¦å‚æ•°&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹æ¯”å­¦ä¹ ä¸ç›‘ç£å­¦ä¹ ç›¸æ¯”ï¼Œ&lt;strong&gt;å¾—ç›Šäºæ›´å¤§çš„æ‰¹å¤„ç†è§„æ¨¡å’Œæ›´é•¿çš„è®­ç»ƒæ—¶é—´&lt;/strong&gt;ã€‚ä¸ç›‘ç£å¼å­¦ä¹ ä¸€æ ·ï¼Œ&lt;strong&gt;å¯¹æ¯”å¼å­¦ä¹ ä¹Ÿå—ç›Šäºæ›´æ·±å…¥ã€æ›´å¹¿æ³›çš„ç½‘ç»œ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äºŒ-å¯¹æ¯”å­¦ä¹ æ¡†æ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-å¯¹æ¯”å­¦ä¹ æ¡†æ¶&#34;&gt;#&lt;/a&gt; äºŒã€å¯¹æ¯”å­¦ä¹ æ¡†æ¶&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒå—æœ€è¿‘çš„å¯¹æ¯”å­¦ä¹ ç®—æ³•çš„å¯å‘ï¼Œ &lt;code&gt;SimCLR&lt;/code&gt;  é€šè¿‡æ½œåœ¨ç©ºé—´ä¸­çš„å¯¹æ¯”æŸå¤±æ¥æœ€å¤§åŒ–ç›¸åŒæ•°æ®ç¤ºä¾‹çš„ä¸åŒå¢å¼ºè§†å›¾ä¹‹é—´çš„ä¸€è‡´æ€§æ¥å­¦ä¹ è¡¨ç¤ºã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯¥æ¡†æ¶ç”±ä»¥ä¸‹å››ä¸ªä¸»è¦ç»„ä»¶ç»„æˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/SimCLR/2.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸€ç§éšæœºæ•°æ®å¢å¼ºæ¨¡å—&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;â€²&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi&gt;Ï„&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;t(t&amp;#x27;)\sim \tau&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.001892em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.751892em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;â€²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.1132em;&#34;&gt;Ï„&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;ï¼Œ&lt;strong&gt;å®ƒå°†ä»»æ„ç»™å®šçš„æ•°æ®ç¤ºä¾‹&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; é€šè¿‡æ•°æ®å¢å¼ºéšæœºè½¬æ¢ä¸ºåŒä¸€ç¤ºä¾‹çš„ä¸¤ä¸ªç›¸å…³è§†å›¾&lt;/strong&gt;ï¼Œè¡¨ç¤ºä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tilde{x}_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8178599999999999em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tilde{x}_j&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9539679999999999em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œæˆ‘ä»¬å°†å…¶è§†ä¸ºæ­£æ ·æœ¬å¯¹ã€‚åœ¨ &lt;code&gt;SimCLR&lt;/code&gt;  ä¸­ï¼Œä¾æ¬¡åº”ç”¨ä¸‰ç§ç®€å•çš„å¢å¼ºï¼šéšæœºè£å‰ªï¼Œç„¶åå°†å¤§å°è°ƒæ•´å›åŸå§‹å¤§å°ï¼Œéšæœºé¢œè‰²å¤±çœŸå’Œéšæœºé«˜æ–¯æ¨¡ç³Šã€‚éšæœºè£å‰ªå’Œé¢œè‰²å¤±çœŸçš„ç»“åˆå¯¹äºè·å¾—è‰¯å¥½çš„æ€§èƒ½è‡³å…³é‡è¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€ç§ç¥ç»ç½‘ç»œåŸºç¡€ç¼–ç å™¨&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;â‹…&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;f(Â·)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;â‹…&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;ï¼Œ&lt;strong&gt;ä»å¢å¼ºçš„æ•°æ®ç¤ºä¾‹ä¸­æå–è¡¨ç¤ºå‘é‡&lt;/strong&gt;ã€‚ &lt;code&gt;SimCLR&lt;/code&gt;  å…è®¸åœ¨æ²¡æœ‰ä»»ä½•é™åˆ¶çš„æƒ…å†µä¸‹é€‰æ‹©å„ç§ç½‘ç»œæ¶æ„ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œé‡‡ç”¨å¸¸ç”¨çš„ ResNet å¾—åˆ°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;ResNet&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;h_i=f(\tilde{x}_i)=\text{ResNet}(\tilde{x}_i)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;ResNet&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå…¶ä¸­&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;h_i\in \mathbb{R}_d&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83889em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ˜¯å¹³å‡æ± åŒ–å±‚åçš„è¾“å‡ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€ä¸ªå°çš„ç¥ç»ç½‘ç»œæŠ•å½±å¤´&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;â‹…&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;g(Â·)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;â‹…&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;ï¼Œ&lt;strong&gt;å®ƒè¡¨ç¤ºæ˜ å°„åˆ°åº”ç”¨å¯¹æ¯”æŸå¤±çš„ç©ºé—´&lt;/strong&gt;ã€‚ &lt;code&gt;SimCLR&lt;/code&gt;  ä½¿ç”¨å…·æœ‰ä¸€ä¸ªéšè—å±‚çš„ &lt;code&gt;MLP&lt;/code&gt;  å¾—åˆ°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;Ïƒ&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;z_i = g(h_i) = W^{(2)}\sigma(W^{(1)}h_i)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.04398em;&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.138em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8879999999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ïƒ&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8879999999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå…¶ä¸­&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ïƒ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\sigma&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ïƒ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ˜¯ä¸€ä¸ª &lt;code&gt;ReLU&lt;/code&gt;  éçº¿æ€§ã€‚å°†å¯¹æ¯”æŸå¤±å®šä¹‰åœ¨&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;z_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.04398em;&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸Šè€Œä¸æ˜¯&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;h_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.84444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸Šæ˜¯æœ‰ç›Šçš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ºå¯¹æ¯”é¢„æµ‹ä»»åŠ¡å®šä¹‰çš„å¯¹æ¯”æŸå¤±å‡½æ•°&lt;/strong&gt;ã€‚ç»™å®šä¸€ä¸ªé›†åˆ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tilde{x}_k&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8178599999999999em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå…¶ä¸­åŒ…å«ä¸€å¯¹æ­£çš„ä¾‹å­&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tilde{x}_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8178599999999999em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tilde{x}_j&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9539679999999999em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå¯¹æ¯”é¢„æµ‹ä»»åŠ¡æ—¨åœ¨è¯†åˆ«ç»™å®š&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tilde{x}_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8178599999999999em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œåœ¨&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&#34;true&#34;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34;&gt;â‰ &lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\left \{ \tilde{x}_k \right \} _{k\ne i}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.185808em;vertical-align:-0.435808em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1864079999999999em;&#34;&gt;&lt;span style=&#34;top:-2.4003000000000005em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;&lt;span class=&#34;mrel mtight&#34;&gt;&lt;span class=&#34;mord vbox mtight&#34;&gt;&lt;span class=&#34;thinbox mtight&#34;&gt;&lt;span class=&#34;rlap mtight&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;inner&#34;&gt;&lt;span class=&#34;mrel mtight&#34;&gt;î€ &lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;fix&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.435808em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸­çš„&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tilde{x}_j&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9539679999999999em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒé€šè¿‡éšæœºæŠ½å–ä¸€ä¸ªç”± &lt;code&gt;n&lt;/code&gt;  ä¸ªæ ·æœ¬ç»„æˆçš„å°æ‰¹é‡æ ·æœ¬ï¼Œå¯¹è¯¥å°æ‰¹é‡æ ·æœ¬è¿›è¡Œæ•°æ®å¢å¼ºï¼Œå¾—åˆ° &lt;code&gt;2N&lt;/code&gt;  ä¸ªæ•°æ®ç‚¹ã€‚å¯¹äºæ¯ä¸€ä¸ªå¢å¼ºåçš„æ•°æ®ï¼Œéƒ½å¯¹åº”ä¸€ä¸ªæ­£æ ·æœ¬ï¼Œå°†å¢å¼ºåæ•°æ®ä¸­çš„å…¶ä»– 2 (Nâˆ’1) ä¸ªå¢å¼ºç¤ºä¾‹è§†ä¸ºè´Ÿç¤ºä¾‹ã€‚è®¾&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtext&gt;sim&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mtext&gt;T&lt;/mtext&gt;&lt;/msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\text{sim}(u, v)=u^{\textrm{T}}v/||u||||v||&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;sim&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0913309999999998em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8413309999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord textrm mtight&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤ºå½’ä¸€åŒ–&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;u&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;v&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¹‹é—´çš„ç‚¹ç§¯ (å³ä½™å¼¦ç›¸ä¼¼åº¦)ã€‚åˆ™ä¸€å¯¹æ­£æ ·æœ¬&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;(i, j)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; çš„æŸå¤±å‡½æ•°å®šä¹‰ä¸º&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;â„“&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold-italic&#34;&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold-italic&#34;&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mi&gt;Ï„&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;âˆ‘&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mn mathvariant=&#34;double-struck&#34;&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;[&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34;&gt;â‰ &lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold-italic&#34;&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold-italic&#34;&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mi&gt;Ï„&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\ell_{i,j}=-\log\frac{\exp(\sin(\boldsymbol{z}_i,\boldsymbol{z}_j)/\tau)}{\sum_{k=1}^{2N}\mathbb{1}_{[k\neq i]}\exp(\sin(\boldsymbol{z}_i,\boldsymbol{z}_k)/\tau)}
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.980548em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;â„“&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.653431em;vertical-align:-1.2264309999999998em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;lo&lt;span style=&#34;margin-right:0.01389em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.128769em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mop&#34;&gt;&lt;span class=&#34;mop op-symbol small-op&#34; style=&#34;position:relative;top:-0.0000050000000000050004em;&#34;&gt;âˆ‘&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.981231em;&#34;&gt;&lt;span style=&#34;top:-2.40029em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2029em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.10903em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.29971000000000003em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.34480000000000005em;&#34;&gt;&lt;span style=&#34;top:-2.5198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;&lt;span class=&#34;mrel mtight&#34;&gt;&lt;span class=&#34;mord vbox mtight&#34;&gt;&lt;span class=&#34;thinbox mtight&#34;&gt;&lt;span class=&#34;rlap mtight&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;inner&#34;&gt;&lt;span class=&#34;mrel mtight&#34;&gt;î€ &lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;fix&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3551999999999999em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;sin&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord boldsymbol&#34; style=&#34;margin-right:0.04213em;&#34;&gt;z&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord boldsymbol&#34; style=&#34;margin-right:0.04213em;&#34;&gt;z&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.1132em;&#34;&gt;Ï„&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mop&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;sin&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord boldsymbol&#34; style=&#34;margin-right:0.04213em;&#34;&gt;z&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord boldsymbol&#34; style=&#34;margin-right:0.04213em;&#34;&gt;z&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.311664em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.1132em;&#34;&gt;Ï„&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.2264309999999998em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå…¶ä¸­&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mn mathvariant=&#34;double-struck&#34;&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;[&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34;&gt;â‰ &lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbb{1}_{[k\neq i]}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9996399999999999em;vertical-align:-0.3551999999999999em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.34480000000000005em;&#34;&gt;&lt;span style=&#34;top:-2.5198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;&lt;span class=&#34;mrel mtight&#34;&gt;&lt;span class=&#34;mord vbox mtight&#34;&gt;&lt;span class=&#34;thinbox mtight&#34;&gt;&lt;span class=&#34;rlap mtight&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;inner&#34;&gt;&lt;span class=&#34;mrel mtight&#34;&gt;î€ &lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;fix&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3551999999999999em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ˜¯å½“&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34;&gt;â‰ &lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;k\ne i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&lt;span class=&#34;mrel&#34;&gt;&lt;span class=&#34;mord vbox&#34;&gt;&lt;span class=&#34;thinbox&#34;&gt;&lt;span class=&#34;rlap&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;inner&#34;&gt;&lt;span class=&#34;mrel&#34;&gt;î€ &lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;fix&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.65952em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ—¶å–å€¼ä¸º 1 çš„æŒ‡æ ‡å‡½æ•°ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ï„&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tau&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.1132em;&#34;&gt;Ï„&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤ºæ¸©åº¦å‚æ•°ã€‚ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œç§°å…¶ä¸º &lt;code&gt;NT-Xent&lt;/code&gt; ï¼ˆthe normalized temperature-scaled cross entropy lossï¼Œå½’ä¸€åŒ–æ¸©åº¦æ ‡åº¦äº¤å‰ç†µæŸå¤±ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¦‚ä¸‹çš„æµç¨‹å›¾æ€»ç»“äº† SimCLR çš„ç®—æ³•æµç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/SimCLR/2.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-å¯¹æ¯”è¡¨å¾å­¦ä¹ çš„æ•°æ®å¢å¼º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-å¯¹æ¯”è¡¨å¾å­¦ä¹ çš„æ•°æ®å¢å¼º&#34;&gt;#&lt;/a&gt; ä¸‰ã€å¯¹æ¯”è¡¨å¾å­¦ä¹ çš„æ•°æ®å¢å¼º&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†ç³»ç»Ÿåœ°ç ”ç©¶æ•°æ®æ‰©å……çš„å½±å“ï¼Œ &lt;code&gt;SimCLR&lt;/code&gt;  è¿™é‡Œè€ƒè™‘å‡ ä¸ªå¸¸è§çš„æ‰©å……ã€‚ä¸€ç§ç±»å‹çš„å¢å¼ºæ¶‰åŠæ•°æ®çš„ç©ºé—´ / å‡ ä½•å˜æ¢ï¼Œä¾‹å¦‚è£å‰ªå’Œè°ƒæ•´å¤§å° (æ°´å¹³ç¿»è½¬)ï¼Œæ—‹è½¬å’Œåˆ‡å‡ºã€‚å¦ä¸€ç§ç±»å‹çš„å¢å¼ºæ¶‰åŠå¤–è§‚è½¬æ¢ï¼Œå¦‚é¢œè‰²å¤±çœŸ (åŒ…æ‹¬é¢œè‰²ä¸‹é™ï¼Œäº®åº¦ï¼Œå¯¹æ¯”åº¦ï¼Œé¥±å’Œåº¦ï¼Œè‰²è°ƒ)ï¼Œé«˜æ–¯æ¨¡ç³Šå’Œç´¢è´å°”æ»¤æ³¢ã€‚ä¸‹å›¾æ˜¾ç¤ºäº† &lt;code&gt;SimCLR&lt;/code&gt;  ä¸­å­¦ä¹ çš„å¢å¼ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/SimCLR/3.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸‹å›¾æ˜¾ç¤ºäº†å•ç‹¬å’Œç»„åˆè½¬æ¢ä¸‹çš„çº¿æ€§è¯„ä¼°ç»“æœã€‚å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œå³ä½¿æ¨¡å‹å‡ ä¹å¯ä»¥å®Œç¾åœ°è¯†åˆ«å¯¹æ¯”ä»»åŠ¡ä¸­çš„æ­£å¯¹ï¼Œä¹Ÿæ²¡æœ‰ä¸€ä¸ªå•ä¸€çš„å˜æ¢è¶³ä»¥å­¦ä¹ åˆ°è‰¯å¥½çš„è¡¨ç¤ºã€‚åœ¨ç»„åˆå¢å¼ºæ—¶ï¼Œå¯¹æ¯”é¢„æµ‹ä»»åŠ¡å˜å¾—æ›´åŠ å›°éš¾ï¼Œä½†è¡¨ç¤ºè´¨é‡æ˜¾è‘—æé«˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/SimCLR/3.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¢å¼ºçš„ä¸€ä¸ªç»„æˆçªå‡ºï¼š&lt;strong&gt;éšæœºè£å‰ªå’Œéšæœºé¢œè‰²å¤±çœŸ&lt;/strong&gt;ã€‚å¯ä»¥æ¨æµ‹ï¼Œå½“åªä½¿ç”¨éšæœºè£å‰ªä½œä¸ºæ•°æ®å¢å¼ºæ—¶ï¼Œä¸€ä¸ªä¸¥é‡çš„é—®é¢˜æ˜¯æ¥è‡ªå›¾åƒçš„å¤§å¤šæ•°è¡¥ä¸å…±äº«ç›¸ä¼¼çš„é¢œè‰²åˆ†å¸ƒã€‚ä¸‹å›¾æ˜¾ç¤ºï¼Œé¢œè‰²ç›´æ–¹å›¾æœ¬èº«å°±è¶³ä»¥åŒºåˆ†å›¾åƒã€‚ç¥ç»ç½‘ç»œå¯ä»¥åˆ©ç”¨è¿™ä¸€æ·å¾„æ¥è§£å†³é¢„æµ‹ä»»åŠ¡ã€‚å› æ­¤ï¼Œä¸ºäº†å­¦ä¹ å¯æ¨å¹¿çš„ç‰¹å¾ï¼Œå°†è£å‰ªä¸é¢œè‰²å¤±çœŸç»„åˆæ˜¯è‡³å…³é‡è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/SimCLR/3.3.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;å››-ç¼–ç å™¨å’ŒæŠ•å½±å¤´çš„æ¶æ„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å››-ç¼–ç å™¨å’ŒæŠ•å½±å¤´çš„æ¶æ„&#34;&gt;#&lt;/a&gt; å››ã€ç¼–ç å™¨å’ŒæŠ•å½±å¤´çš„æ¶æ„&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒä¸‹å›¾æ˜¾ç¤ºï¼Œ&lt;strong&gt;å¢åŠ æ·±åº¦å’Œå®½åº¦éƒ½ä¼šæé«˜æ€§èƒ½&lt;/strong&gt;ï¼Œè¿™ä¹Ÿè®¸å¹¶ä¸ä»¤äººæƒŠè®¶ã€‚è™½ç„¶ç±»ä¼¼çš„å‘ç°é€‚ç”¨äºç›‘ç£å­¦ä¹ ï¼Œæˆ‘ä»¬å‘ç°ç›‘ç£æ¨¡å‹å’Œåœ¨æ— ç›‘ç£æ¨¡å‹ä¸Šè®­ç»ƒçš„çº¿æ€§åˆ†ç±»å™¨ä¹‹é—´çš„å·®è·éšç€æ¨¡å‹å¤§å°çš„å¢åŠ è€Œç¼©å°ï¼Œè¿™è¡¨æ˜æ— ç›‘ç£å­¦ä¹ æ¯”ç›‘ç£å­¦ä¹ æ›´å—ç›Šäºæ›´å¤§çš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/SimCLR/4.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç„¶åï¼Œ &lt;code&gt;SimCLR&lt;/code&gt;  ç ”ç©¶åŒ…æ‹¬æŠ•å½±å¤´çš„é‡è¦æ€§ï¼Œå³&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;g(h)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚ä¸‹å›¾ç¤ºå‡ºäº†ä½¿ç”¨å¤´éƒ¨çš„ä¸‰ç§ä¸åŒæ¶æ„çš„çº¿æ€§è¯„ä¼°ç»“æœï¼šï¼ˆ1ï¼‰æ— æŠ•å½±ï¼›ï¼ˆ2ï¼‰çº¿æ€§æŠ•å½±ï¼›ï¼ˆ3ï¼‰é»˜è®¤çš„éçº¿æ€§æŠ•å½±ä¸ä¸€ä¸ªé¢å¤–çš„éšè—å±‚ï¼ˆReLU æ¿€æ´»ï¼‰ã€‚å¯ä»¥è§‚å¯Ÿåˆ°&lt;strong&gt;éçº¿æ€§æŠ•å½±&lt;/strong&gt;æ¯”çº¿æ€§æŠ•å½±å¥½ï¼ˆ+3%ï¼‰ï¼Œå¹¶ä¸”æ¯”æ²¡æœ‰æŠ•å½±å¥½å¾—å¤šï¼ˆ&amp;gt;10%ï¼‰ã€‚å½“ä½¿ç”¨æŠ•å½±å¤´æ—¶ï¼Œ&lt;strong&gt;æ— è®ºè¾“å‡ºå°ºå¯¸å¦‚ä½•ï¼Œéƒ½è§‚å¯Ÿåˆ°ç±»ä¼¼çš„ç»“æœ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/SimCLR/4.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/09/14/AI/BERT/</guid>
            <title>BERT</title>
            <link>http://qianqiu-cell.github.io/2024/09/14/AI/BERT/</link>
            <category>AI</category>
            <pubDate>Sat, 14 Sep 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;ä¸€-å¼•è¨€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-å¼•è¨€&#34;&gt;#&lt;/a&gt; ä¸€ã€å¼•è¨€&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;BERT&lt;/code&gt; ï¼ˆ &lt;code&gt;Bidirectional Encoder Representations from Transformers&lt;/code&gt; ï¼‰æ˜¯ä¸€ç§åŸºäºæ·±åº¦å­¦ä¹ çš„è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆ &lt;code&gt;NLP&lt;/code&gt; ï¼‰æ¨¡å‹ã€‚å®ƒæ˜¯ç”± &lt;code&gt;Google&lt;/code&gt;  åœ¨ &lt;code&gt;2018&lt;/code&gt;  å¹´æå‡ºçš„ï¼Œé‡‡ç”¨äº† &lt;code&gt;Transformer&lt;/code&gt;  æ¶æ„ï¼Œå¹¶åœ¨å¤§è§„æ¨¡è¯­æ–™åº“ä¸Šè¿›è¡Œäº†é¢„è®­ç»ƒã€‚ &lt;code&gt;BERT&lt;/code&gt;  çš„ç‰¹ç‚¹ä¹‹ä¸€æ˜¯å…¶åŒå‘ï¼ˆ &lt;code&gt;Bidirectional&lt;/code&gt; ï¼‰å¤„ç†èƒ½åŠ›ï¼Œå®ƒèƒ½å¤ŸåŒæ—¶è€ƒè™‘åˆ°å¥å­ä¸­æ‰€æœ‰å•è¯çš„ä¸Šä¸‹æ–‡ï¼Œè€Œä¸ä»…ä»…æ˜¯å•è¯ä¹‹å‰æˆ–ä¹‹åçš„éƒ¨åˆ†ã€‚è¿™ç§åŒå‘æ€§ä½¿å¾— &lt;code&gt;BERT&lt;/code&gt;  åœ¨è®¸å¤š &lt;code&gt;NLP&lt;/code&gt;  ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ï¼Œä¾‹å¦‚æ–‡æœ¬åˆ†ç±»ã€é—®ç­”å’Œå‘½åå®ä½“è¯†åˆ«ç­‰ã€‚&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-bert&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-bert&#34;&gt;#&lt;/a&gt; äºŒã€BERT&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;BERT&lt;/code&gt;  çš„æ¡†æ¶ä¸­æœ‰ä¸¤ä¸ªæ­¥éª¤ï¼šé¢„è®­ç»ƒå’Œå¾®è°ƒã€‚åœ¨é¢„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹åœ¨&lt;strong&gt;ä¸åŒçš„é¢„è®­ç»ƒä»»åŠ¡ä¸Šå¯¹æœªæ ‡è®°æ•°æ®&lt;/strong&gt;è¿›è¡Œè®­ç»ƒã€‚å¯¹äºå¾®è°ƒï¼Œé¦–å…ˆä½¿ç”¨é¢„è®­ç»ƒçš„å‚æ•°åˆå§‹åŒ– &lt;code&gt;BERT&lt;/code&gt;  æ¨¡å‹ï¼Œç„¶åä½¿ç”¨&lt;strong&gt;æ¥è‡ªä¸‹æ¸¸ä»»åŠ¡çš„æ ‡è®°æ•°æ®&lt;/strong&gt;å¯¹&lt;strong&gt;æ‰€æœ‰å‚æ•°&lt;/strong&gt;è¿›è¡Œ&lt;strong&gt;å¾®è°ƒ&lt;/strong&gt;ã€‚æ¯ä¸ªä¸‹æ¸¸ä»»åŠ¡éƒ½æœ‰å•ç‹¬çš„å¾®è°ƒæ¨¡å‹ï¼Œå³ä½¿å®ƒä»¬æ˜¯ç”¨ç›¸åŒçš„é¢„è®­ç»ƒå‚æ•°åˆå§‹åŒ–çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/BERT/2.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;BERT&lt;/code&gt;  çš„ä¸€ä¸ªæ˜¾è‘—ç‰¹å¾æ˜¯å…¶è·¨ä¸åŒä»»åŠ¡çš„ç»Ÿä¸€æ¶æ„ã€‚é¢„è®­ç»ƒçš„ä½“ç³»ç»“æ„å’Œæœ€ç»ˆçš„ä¸‹æ¸¸ä½“ç³»ç»“æ„ä¹‹é—´çš„å·®åˆ«å¾ˆå°ã€‚é™¤äº†è¾“å‡ºå±‚ï¼Œåœ¨é¢„è®­ç»ƒå’Œå¾®è°ƒä¸­ä½¿ç”¨äº†ç›¸åŒçš„æ¶æ„ã€‚ä½¿ç”¨ç›¸åŒçš„é¢„è®­ç»ƒæ¨¡å‹å‚æ•°æ¥åˆå§‹åŒ–ä¸åŒä¸‹æ¸¸ä»»åŠ¡çš„æ¨¡å‹ã€‚åœ¨å¾®è°ƒæœŸé—´ï¼Œå¯¹æ‰€æœ‰å‚æ•°è¿›è¡Œå¾®è°ƒã€‚[CLS] æ˜¯æ·»åŠ åœ¨æ¯ä¸ªè¾“å…¥ç¤ºä¾‹å‰é¢çš„ç‰¹æ®Šç¬¦å·ï¼Œ[SEP] æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„åˆ†éš”ç¬¦å· (ä¾‹å¦‚ï¼Œåˆ†éš”é—®é¢˜ / ç­”æ¡ˆ)ã€‚&lt;/p&gt;
&lt;h2 id=&#34;21-æ¨¡å‹ç»“æ„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-æ¨¡å‹ç»“æ„&#34;&gt;#&lt;/a&gt; 2.1 æ¨¡å‹ç»“æ„&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;BERT&lt;/code&gt;  çš„æ¨¡å‹æ¶æ„æ˜¯ä¸€ä¸ªå¤šå±‚åŒå‘ &lt;code&gt;transformer&lt;/code&gt;  ç¼–ç å™¨ï¼Œä½¿ç”¨&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;L&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;L&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤ºå±‚æ•° (å³ &lt;code&gt;transformer&lt;/code&gt;  å—)ï¼Œéšè—å¤§å°ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;H&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.08125em;&#34;&gt;H&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œè‡ªæ³¨æ„å¤´çš„æ•°é‡ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;A&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;A&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚ &lt;code&gt;BERT&lt;/code&gt;  ä¸»è¦æœ‰ä¸¤ç§æ¨¡å‹å¤§å°ï¼š &lt;code&gt;BERT BASE&lt;/code&gt;  (L=12, H=768, A=12, Total Parameters=110M) å’Œ &lt;code&gt;BERT LARGE&lt;/code&gt; (L=24, H=1024, A=16, Total Parameters=340M)ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†è¿›è¡Œæ¯”è¾ƒï¼Œé€‰æ‹© &lt;code&gt;BERT BASE&lt;/code&gt;  ä¸ &lt;code&gt;OpenAI GPT&lt;/code&gt;  å…·æœ‰ç›¸åŒçš„æ¨¡å‹å¤§å°ã€‚ç„¶è€Œï¼Œå…³é”®çš„æ˜¯ï¼Œ &lt;code&gt;BERT Transformer&lt;/code&gt;  ä½¿ç”¨åŒå‘è‡ªå…³æ³¨ï¼Œè€Œ &lt;code&gt;GPT Transformer&lt;/code&gt;  ä½¿ç”¨çº¦æŸè‡ªå…³æ³¨ï¼Œå…¶ä¸­æ¯ä¸ª &lt;code&gt;token&lt;/code&gt;  åªèƒ½å…³æ³¨å…¶å·¦ä¾§çš„ä¸Šä¸‹æ–‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;22-è¾“å…¥è¾“å‡ºè¡¨ç¤º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-è¾“å…¥è¾“å‡ºè¡¨ç¤º&#34;&gt;#&lt;/a&gt; 2.2 è¾“å…¥ / è¾“å‡ºè¡¨ç¤º&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†ä½¿ &lt;code&gt;BERT&lt;/code&gt;  å¤„ç†å„ç§ä¸‹æ¸¸ä»»åŠ¡ï¼Œæˆ‘ä»¬çš„è¾“å…¥è¡¨ç¤ºèƒ½å¤Ÿåœ¨ä¸€ä¸ª &lt;code&gt;token&lt;/code&gt;  åºåˆ—ä¸­æ˜ç¡®åœ°è¡¨ç¤ºå•ä¸ªå¥å­å’Œä¸€å¯¹å¥å­ (ä¾‹å¦‚ï¼Œ&amp;lt;Question, Answer&amp;gt;)ã€‚åœ¨æ•´ä¸ªå·¥ä½œä¸­ï¼Œä¸€ä¸ª â€œå¥å­â€ å¯ä»¥æ˜¯ä¸€ä¸ªè¿ç»­æ–‡æœ¬çš„ä»»æ„è·¨åº¦ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå®é™…çš„è¯­è¨€å¥å­ã€‚â€œåºåˆ—â€ æŒ‡çš„æ˜¯ &lt;code&gt;BERT&lt;/code&gt;  çš„è¾“å…¥ &lt;code&gt;token&lt;/code&gt;  åºåˆ—ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå¥å­æˆ–ä¸¤ä¸ªå¥å­ç»„åˆåœ¨ä¸€èµ·ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;BERT&lt;/code&gt;  ä½¿ç”¨å…·æœ‰ &lt;code&gt;30,000&lt;/code&gt;  ä¸ªè¯æ±‡çš„ &lt;code&gt;WordPiece embeddings&lt;/code&gt; ã€‚æ¯ä¸ªåºåˆ—çš„ç¬¬ä¸€ä¸ªæ ‡è®°æ€»æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„åˆ†ç±»æ ‡è®° ([CLS])ã€‚ &lt;code&gt;BERT&lt;/code&gt;  ç”¨ä¸¤ç§æ–¹æ³•åŒºåˆ†å¥å­ã€‚é¦–å…ˆï¼Œç”¨ä¸€ä¸ªç‰¹æ®Šçš„ &lt;code&gt;token&lt;/code&gt;  ([SEP]) å°†å®ƒä»¬åˆ†å¼€ã€‚å…¶æ¬¡ï¼Œä¸ºæ¯ä¸€ä¸ª &lt;code&gt;token&lt;/code&gt;  æ·»åŠ ä¸€ä¸ªå¯å­¦ä¹  &lt;code&gt;embedding&lt;/code&gt; ï¼Œè¡¨æ˜å®ƒå±äºå¥å­ &lt;code&gt;A&lt;/code&gt;  è¿˜æ˜¯å¥å­ &lt;code&gt;B&lt;/code&gt; ã€‚å¦‚å›¾ 1 æ‰€ç¤ºï¼Œå°†è¾“å…¥ &lt;code&gt;embedding&lt;/code&gt;  è¡¨ç¤ºä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;E&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œç‰¹æ®Š [CLS] æ ‡è®°çš„æœ€ç»ˆéšè—å‘é‡è¡¨ç¤ºä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;C\in \mathbb{R}^H&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.72243em;vertical-align:-0.0391em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8413309999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8413309999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.08125em;&#34;&gt;H&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œç¬¬ i ä¸ªè¾“å…¥æ ‡è®°çš„æœ€ç»ˆéšè—å‘é‡è¡¨ç¤ºä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;T_i\in \mathbb{R}^H&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8413309999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8413309999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.08125em;&#34;&gt;H&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äºç»™å®šçš„ &lt;code&gt;token&lt;/code&gt; ï¼Œ &lt;code&gt;BERT&lt;/code&gt;  è¾“å…¥è¡¨ç¤ºæ˜¯é€šè¿‡å°†ç›¸åº”çš„ &lt;code&gt;token&lt;/code&gt; ã€ &lt;code&gt;segment&lt;/code&gt;  (æ®µ) å’Œ &lt;code&gt;position&lt;/code&gt;  (ä½ç½®) &lt;code&gt;embedding&lt;/code&gt;  ç›¸åŠ æ¥æ„å»ºçš„ã€‚å›¾ 2 æ˜¾ç¤ºäº†è¯¥ç»“æ„çš„å¯è§†åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/BERT/2.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;23-é¢„è®­ç»ƒbert&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-é¢„è®­ç»ƒbert&#34;&gt;#&lt;/a&gt; 2.3 é¢„è®­ç»ƒ BERT&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒä½¿ç”¨ä¸¤ä¸ªæ— ç›‘ç£ä»»åŠ¡å¯¹ &lt;code&gt;BERT&lt;/code&gt;  è¿›è¡Œé¢„è®­ç»ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;1-ä»»åŠ¡-1æ©ç è¯­è¨€æ¨¡å‹masked-lm-mlm&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1-ä»»åŠ¡-1æ©ç è¯­è¨€æ¨¡å‹masked-lm-mlm&#34;&gt;#&lt;/a&gt; (1) ä»»åŠ¡ 1ï¼šæ©ç è¯­è¨€æ¨¡å‹ï¼ˆMasked LM, MLMï¼‰&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†è®­ç»ƒæ·±åº¦åŒå‘è¡¨ç¤ºï¼Œ &lt;code&gt;BERT&lt;/code&gt;  éšæœºå±è”½ä¸€å®šæ¯”ä¾‹çš„è¾“å…¥ &lt;code&gt;token&lt;/code&gt; ï¼Œç„¶åé¢„æµ‹è¿™äº›è¢«å±è”½çš„ &lt;code&gt;token&lt;/code&gt; ã€‚è¿™ä¸€è¿‡ç¨‹ç§°ä¸º &lt;code&gt;Masked LM&lt;/code&gt; ( &lt;code&gt;MLM&lt;/code&gt; )ï¼Œåœ¨æ–‡çŒ®ä¸­å®ƒé€šå¸¸è¢«ç§°ä¸ºå®Œå½¢å¡«ç©ºä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè®­ç»ƒæ•°æ®ç”Ÿæˆå™¨éšæœºé€‰æ‹© 15% çš„ &lt;code&gt;token&lt;/code&gt;  ä½ç½®è¿›è¡Œé¢„æµ‹ã€‚å¦‚æœé€‰æ‹©äº†ç¬¬&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.65952em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ª &lt;code&gt;token&lt;/code&gt; ï¼Œé‚£ä¹ˆ 80% çš„æ¦‚ç‡ä½¿ç”¨ [MASK] &lt;code&gt;token&lt;/code&gt; ï¼Œ10% çš„æ¦‚ç‡ä½¿ç”¨éšæœº &lt;code&gt;token&lt;/code&gt; ï¼Œ10% çš„æ¦‚ç‡ä½¿ç”¨æœªæ›´æ”¹çš„ç¬¬&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.65952em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ª &lt;code&gt;token&lt;/code&gt;  æ¥æ›¿æ¢ç¬¬&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.65952em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ª &lt;code&gt;token&lt;/code&gt; ã€‚ç„¶åï¼Œåˆ©ç”¨&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;T_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ¥é¢„æµ‹å…·æœ‰äº¤å‰ç†µæŸå¤±çš„åŸå§‹ &lt;code&gt;token&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;h3 id=&#34;2ä»»åŠ¡-2ä¸‹ä¸€ä¸ªå¥å­é¢„æµ‹next-sentence-prediction-nsp&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2ä»»åŠ¡-2ä¸‹ä¸€ä¸ªå¥å­é¢„æµ‹next-sentence-prediction-nsp&#34;&gt;#&lt;/a&gt; ï¼ˆ2ï¼‰ä»»åŠ¡ 2ï¼šä¸‹ä¸€ä¸ªå¥å­é¢„æµ‹ï¼ˆNext Sentence Prediction, NSPï¼‰&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒè®¸å¤šé‡è¦çš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œå¦‚é—®ç­” ( &lt;code&gt;QA&lt;/code&gt; ) å’Œè‡ªç„¶è¯­è¨€æ¨ç† ( &lt;code&gt;NLI&lt;/code&gt; )ï¼Œéƒ½æ˜¯åŸºäºç†è§£ä¸¤ä¸ªå¥å­ä¹‹é—´çš„å…³ç³»ï¼Œè¿™æ˜¯è¯­è¨€å»ºæ¨¡æ— æ³•ç›´æ¥æ•è·çš„ã€‚ä¸ºäº†è®­ç»ƒä¸€ä¸ªç†è§£å¥å­å…³ç³»çš„æ¨¡å‹ï¼Œ &lt;code&gt;BERT&lt;/code&gt;  å¯¹ä¸€ä¸‹ä¸€ä¸ªå¥å­é¢„æµ‹ä»»åŠ¡è¿›è¡Œäº†é¢„è®­ç»ƒï¼Œè¯¥ä»»åŠ¡å¯ä»¥ä»ä»»ä½•å•è¯­è¯­æ–™åº“ä¸­è½»æ¾ç”Ÿæˆã€‚å…·ä½“æ¥è¯´ï¼Œå½“ä¸ºæ¯ä¸ªé¢„è®­ç»ƒç¤ºä¾‹é€‰æ‹©å¥å­ &lt;code&gt;A&lt;/code&gt;  å’Œ &lt;code&gt;Bæ—¶&lt;/code&gt; ï¼Œ &lt;code&gt;50%&lt;/code&gt;  çš„æ—¶é—´ &lt;code&gt;B&lt;/code&gt;  æ˜¯ &lt;code&gt;A&lt;/code&gt;  ä¹‹åçš„ä¸‹ä¸€ä¸ªå¥å­ (æ ‡è®°ä¸º &lt;code&gt;IsNext&lt;/code&gt; )ï¼Œ  &lt;code&gt;50%&lt;/code&gt;  çš„æ—¶é—´ &lt;code&gt;B&lt;/code&gt;  æ˜¯è¯­æ–™åº“ä¸­çš„éšæœºå¥å­ (æ ‡è®°ä¸º &lt;code&gt;NotNext&lt;/code&gt; )ã€‚å¦‚å›¾ 1 æ‰€ç¤ºï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;C&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ç”¨äºä¸‹ä¸€ä¸ªå¥å­é¢„æµ‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é¢„è®­ç»ƒçš„æ•°æ®&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#é¢„è®­ç»ƒçš„æ•°æ®&#34;&gt;#&lt;/a&gt; é¢„è®­ç»ƒçš„æ•°æ®&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒé¢„è®­ç»ƒè¿‡ç¨‹åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šéµå¾ªç°æœ‰çš„æ–‡çŒ®è¯­è¨€æ¨¡å‹é¢„è®­ç»ƒã€‚å¯¹äºé¢„è®­ç»ƒè¯­æ–™åº“ï¼Œ &lt;code&gt;BERT&lt;/code&gt;  ä½¿ç”¨ &lt;code&gt;BooksCorpus&lt;/code&gt; ï¼ˆ8 äº¿å•è¯ï¼‰å’Œè‹±è¯­ç»´åŸºç™¾ç§‘ï¼ˆ2,500 ä¸‡å­—ï¼‰ã€‚å¯¹äºç»´åŸºç™¾ç§‘ï¼Œ &lt;code&gt;BERT&lt;/code&gt;  åªæå–æ–‡æœ¬æ®µè½ï¼Œå¿½ç•¥åˆ—è¡¨ï¼Œè¡¨æ ¼å’Œæ ‡é¢˜ã€‚ä½¿ç”¨æ–‡æ¡£çº§è¯­æ–™åº“è€Œä¸æ˜¯è¯¸å¦‚åäº¿å­—åŸºå‡†ï¼Œä»¥ä¾¿æå–é•¿çš„è¿ç»­åºåˆ—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;23-å¾®è°ƒbert&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-å¾®è°ƒbert&#34;&gt;#&lt;/a&gt; 2.3 å¾®è°ƒ BERT&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æµ·é‡çš„è¯­æ–™ä¸Šè®­ç»ƒå®Œ BERT ä¹‹åï¼Œä¾¿å¯ä»¥å°†å…¶åº”ç”¨åˆ° NLP çš„å„ä¸ªä»»åŠ¡ä¸­äº†ã€‚ å¾®è°ƒ (Fine-Tuning) çš„ä»»åŠ¡åŒ…æ‹¬ï¼šåŸºäºå¥å­å¯¹çš„åˆ†ç±»ä»»åŠ¡ï¼ŒåŸºäºå•ä¸ªå¥å­çš„åˆ†ç±»ä»»åŠ¡ï¼Œé—®ç­”ä»»åŠ¡ï¼Œå‘½åå®ä½“è¯†åˆ«ç­‰ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-å‚è€ƒç¨‹åº&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-å‚è€ƒç¨‹åº&#34;&gt;#&lt;/a&gt; ä¸‰ã€å‚è€ƒç¨‹åº&lt;/h1&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2NvZGVydGltby9CRVJULXB5dG9yY2g=&#34;&gt;https://github.com/codertimo/BERT-pytorch&lt;/span&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/09/14/AI/BLIP/</guid>
            <title>BLIP</title>
            <link>http://qianqiu-cell.github.io/2024/09/14/AI/BLIP/</link>
            <category>AI</category>
            <pubDate>Sat, 14 Sep 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;ä¸€-å¼•è¨€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-å¼•è¨€&#34;&gt;#&lt;/a&gt; ä¸€ã€å¼•è¨€&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒè‡ªä» &lt;code&gt;CLIP&lt;/code&gt;  æ¨ªç©ºå‡ºä¸–ï¼Œå„ç§ è§†è§‰è¯­è¨€é¢„è®­ç»ƒ ( &lt;code&gt;Vision-Language Pre-training, VLP&lt;/code&gt; ) æ¨¡å‹é€æ¸æ¶Œç°ï¼Œæ˜¾è‘—æé«˜äº†å„ç§è§†è§‰è¯­è¨€ä»»åŠ¡çš„æ€§èƒ½ã€‚ç„¶è€Œï¼Œç°æœ‰çš„ &lt;code&gt;VLP&lt;/code&gt;  æ–¹æ³•ä¸»è¦å­˜åœ¨ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¨¡å‹è§’åº¦&lt;/strong&gt;ï¼šå¤§å¤šæ•°æ–¹æ³•éƒ½æ˜¯åŸºäº ç¼–ç å™¨æ¨¡å‹ ( &lt;code&gt;encoder-based model&lt;/code&gt; ) æˆ–ç¼–ç å™¨ - è§£ç å™¨æ¨¡å‹ ( &lt;code&gt;encoder-decoder models&lt;/code&gt; )ï¼Œå‰è€…éš¾ä»¥å®Œæˆæ–‡æœ¬ç”Ÿæˆä»»åŠ¡ï¼Œåè€…æ— æ³•å®Œæˆå›¾åƒæ–‡æœ¬æ£€ç´¢ä»»åŠ¡ï¼Œè¿™ä¸¤é¡¹ä»»åŠ¡æ— æ³•å…¼é¡¾ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ•°æ®è§’åº¦&lt;/strong&gt;ï¼šä»¥ &lt;code&gt;CLIP&lt;/code&gt;  ä¸ºä»£è¡¨çš„æ–¹æ³•éƒ½æ˜¯ä»äº’è”ç½‘ä¸Šæ”¶é›†æµ·é‡å›¾åƒ - æ–‡æœ¬å¯¹ä½œä¸ºæ ·æœ¬è¿›è¡Œé¢„è®­ç»ƒï¼Œè¿™äº›å¸¦å™ªå£°çš„æ–‡æœ¬ä½œä¸ºè§†è§‰è¯­è¨€å­¦ä¹ çš„ç›‘ç£ä¿¡å·æ˜¾ç„¶ä¸æ˜¯æœ€ä¼˜è§£ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºæ­¤ï¼Œ &lt;code&gt;Salesforce&lt;/code&gt;  çš„ç ”ç©¶è€…ä»¬æå‡ºäº† &lt;code&gt;BLIP (Bootstrapping language - image Pre-training)&lt;/code&gt; ï¼Œç”¨äºç»Ÿä¸€çš„è§†è§‰è¯­è¨€ç†è§£å’Œç”Ÿæˆã€‚ &lt;code&gt;BLIP&lt;/code&gt;  æ˜¯ä¸€ç§æ–°çš„ &lt;code&gt;VLP&lt;/code&gt;  æ¡†æ¶ï¼Œæ¯”ç°æœ‰æ–¹æ³•èƒ½å¤Ÿå®ç°æ›´å¹¿æ³›çš„ä¸‹æ¸¸ä»»åŠ¡ã€‚å®ƒåˆ†åˆ«ä»æ¨¡å‹å’Œæ•°æ®çš„è§’åº¦ä»‹ç»äº†ä¸¤ä¸ªè´¡çŒ®:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¼–ç å™¨ - è§£ç å™¨çš„å¤šæ¨¡æ€æ··åˆ&lt;/strong&gt; ( &lt;code&gt;MED, Multimodal mixture of Encoder-Decoder&lt;/code&gt; ): ä¸€ç§æœ‰æ•ˆçš„å¤šä»»åŠ¡é¢„è®­ç»ƒå’Œçµæ´»è¿ç§»å­¦ä¹ çš„æ–°æ¨¡å‹æ¶æ„ã€‚ &lt;code&gt;MED&lt;/code&gt;  å¯ä»¥ä½œä¸ºå•æ¨¡ç¼–ç å™¨ã€åŸºäºå›¾åƒçš„æ–‡æœ¬ç¼–ç å™¨æˆ–åŸºäºå›¾åƒçš„æ–‡æœ¬è§£ç å™¨æ“ä½œã€‚è¯¥æ¨¡å‹é‡‡ç”¨å›¾åƒæ–‡æœ¬å¯¹æ¯”å­¦ä¹ ã€å›¾åƒæ–‡æœ¬åŒ¹é…å’Œå›¾åƒæ¡ä»¶åŒ–è¯­è¨€å»ºæ¨¡ä¸‰ä¸ªè§†è§‰è¯­è¨€ç›®æ ‡è¿›è¡Œè”åˆé¢„è®­ç»ƒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å­—å¹•å’Œè¿‡æ»¤&lt;/strong&gt; ( &lt;code&gt;CapFilt, Captioning and Filtering&lt;/code&gt; ): ä¸€ç§æ–°çš„æ•°æ®é›† &lt;code&gt;bootstrap&lt;/code&gt;  æ–¹æ³•ï¼Œç”¨äºä»å™ªå£°å›¾åƒ - æ–‡æœ¬å¯¹ä¸­å­¦ä¹ ã€‚ &lt;code&gt;BLIP&lt;/code&gt;  å°†é¢„è®­ç»ƒçš„ &lt;code&gt;MED&lt;/code&gt;  è°ƒæ•´ä¸ºä¸¤ä¸ªæ¨¡å—ï¼šä¸€ä¸ª &lt;code&gt;captioner&lt;/code&gt;  ç”¨äºç”Ÿæˆç»™å®š web å›¾åƒçš„åˆæˆå­—å¹•ï¼Œä¸€ä¸ª &lt;code&gt;filter&lt;/code&gt;  ç”¨äºä»åŸå§‹ &lt;code&gt;web&lt;/code&gt;  æ–‡æœ¬å’Œåˆæˆæ–‡æœ¬ä¸­å»é™¤å˜ˆæ‚çš„å­—å¹•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äºŒ-ç›¸å…³å·¥ä½œ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-ç›¸å…³å·¥ä½œ&#34;&gt;#&lt;/a&gt; äºŒã€ç›¸å…³å·¥ä½œ&lt;/h1&gt;
&lt;h2 id=&#34;21-è§†è§‰è¯­è¨€é¢„è®­ç»ƒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-è§†è§‰è¯­è¨€é¢„è®­ç»ƒ&#34;&gt;#&lt;/a&gt; 2.1 è§†è§‰è¯­è¨€é¢„è®­ç»ƒ&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒè§†è§‰è¯­è¨€é¢„è®­ç»ƒ ( &lt;code&gt;VLP&lt;/code&gt; ) æ—¨åœ¨é€šè¿‡å¯¹å¤§è§„æ¨¡å›¾åƒ - æ–‡æœ¬å¯¹æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒæ¥æé«˜ä¸‹æ¸¸è§†è§‰å’Œè¯­è¨€ä»»åŠ¡çš„æ€§èƒ½ã€‚ç”±äºè·å–äººå·¥æ³¨é‡Šæ–‡æœ¬çš„è´¹ç”¨è¿‡é«˜ï¼Œå¤§å¤šæ•°æ–¹æ³•ä½¿ç”¨ä»ç½‘ç»œæŠ“å–çš„å›¾åƒå’Œæ›¿ä»£æ–‡æœ¬å¯¹ã€‚å°½ç®¡ä½¿ç”¨äº†ç®€å•çš„åŸºäºè§„åˆ™çš„è¿‡æ»¤å™¨ï¼Œå™ªå£°åœ¨ç½‘ç»œæ–‡æœ¬ä¸­ä»ç„¶æ™®éå­˜åœ¨ã€‚ç„¶è€Œï¼Œå™ªå£°çš„è´Ÿé¢å½±å“åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè¢«å¿½ç•¥äº†ï¼Œè¢«é€šè¿‡æ‰©å¤§æ•°æ®é›†è·å¾—çš„æ€§èƒ½å¢ç›Šæ‰€æ©ç›–ã€‚ &lt;code&gt;BLIP&lt;/code&gt;  çš„è®ºæ–‡è¡¨æ˜ï¼Œå™ªå£°ç½‘ç»œæ–‡æœ¬å¯¹äºè§†è§‰è¯­è¨€å­¦ä¹ æ˜¯æ¬¡ä¼˜çš„ï¼Œå¹¶æå‡º &lt;code&gt;CapFilt&lt;/code&gt;  ä»¥æ›´æœ‰æ•ˆçš„æ–¹å¼åˆ©ç”¨ç½‘ç»œæ•°æ®é›†çš„ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå·²ç»æœ‰å¾ˆå¤šå°è¯•å°†å„ç§è§†è§‰å’Œè¯­è¨€ä»»åŠ¡ç»Ÿä¸€åˆ°ä¸€ä¸ªæ¡†æ¶ä¸­ã€‚æœ€å¤§çš„æŒ‘æˆ˜æ˜¯è®¾è®¡æ—¢èƒ½æ‰§è¡ŒåŸºäºç†è§£çš„ä»»åŠ¡ (å¦‚å›¾åƒæ–‡æœ¬æ£€ç´¢) åˆèƒ½æ‰§è¡ŒåŸºäºç”Ÿæˆçš„ä»»åŠ¡ (å¦‚å›¾åƒå­—å¹•) çš„æ¨¡å‹æ¶æ„ã€‚ä¸¤è€…éƒ½ä¸æ˜¯åŸºäºç¼–ç å™¨çš„æ¨¡å‹å’Œç¼–ç å™¨ - è§£ç å™¨æ¨¡å‹å¯ä»¥åœ¨è¿™ä¸¤ç§ç±»å‹çš„ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ï¼Œè€Œå•ä¸€çš„ç»Ÿä¸€ç¼–ç å™¨ - è§£ç å™¨ä¹Ÿé™åˆ¶äº†æ¨¡å‹çš„èƒ½åŠ›ã€‚ &lt;code&gt;BLIP&lt;/code&gt;  æå‡ºçš„å¤šæ¨¡æ€ç¼–ç å™¨ - è§£ç å™¨æ··åˆæ¨¡å‹åœ¨å¹¿æ³›çš„ä¸‹æ¸¸ä»»åŠ¡ä¸Šæä¾›äº†æ›´å¤§çš„çµæ´»æ€§å’Œæ›´å¥½çš„æ€§èƒ½ï¼ŒåŒæ—¶ä¿æŒäº†é¢„è®­ç»ƒçš„ç®€å•å’Œé«˜æ•ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;22-çŸ¥è¯†è’¸é¦&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-çŸ¥è¯†è’¸é¦&#34;&gt;#&lt;/a&gt; 2.2 çŸ¥è¯†è’¸é¦&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒçŸ¥è¯†è’¸é¦ï¼ˆ &lt;code&gt;KD, Knowledge Distillation&lt;/code&gt; ï¼‰æ—¨åœ¨é€šè¿‡ä»æ•™å¸ˆæ¨¡å‹ä¸­æå–çŸ¥è¯†æ¥æé«˜å­¦ç”Ÿæ¨¡å‹çš„æ€§èƒ½ã€‚è‡ªæˆ‘è’¸é¦æ˜¯ &lt;code&gt;KD&lt;/code&gt;  çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œå…¶ä¸­æ•™å¸ˆå’Œå­¦ç”Ÿçš„è§„æ¨¡ç›¸ç­‰ã€‚å·²ç»è¯æ˜åªæ˜¯è’¸é¦å¯¹äºå›¾åƒåˆ†ç±»ï¼Œä»¥åŠ &lt;code&gt;VLP&lt;/code&gt;  æ˜¯æœ‰æ•ˆçš„ã€‚ä¸å¤§å¤šæ•°ç°æœ‰çš„ &lt;code&gt;KD&lt;/code&gt;  æ–¹æ³•åªæ˜¯ç®€å•åœ°å¼ºåˆ¶å­¦ç”Ÿå…·æœ‰ä¸æ•™å¸ˆç›¸åŒçš„ç±»é¢„æµ‹ä¸åŒï¼Œ &lt;code&gt;BLIP&lt;/code&gt;  æå‡ºçš„ &lt;code&gt;CapFilt&lt;/code&gt;  å¯ä»¥è¢«è§£é‡Šä¸ºåœ¨ &lt;code&gt;VLP&lt;/code&gt;  ç¯å¢ƒä¸‹æ‰§è¡Œ &lt;code&gt;KD&lt;/code&gt;  çš„ä¸€ç§æ›´æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå…¶ä¸­å­—å¹•å™¨é€šè¿‡è¯­ä¹‰ä¸°å¯Œçš„åˆæˆå­—å¹•æå–å…¶çŸ¥è¯†ï¼Œè€Œè¿‡æ»¤å™¨é€šè¿‡å»é™¤å™ªå£°å­—å¹•æå–å…¶çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;23-æ•°æ®å¢å¼º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-æ•°æ®å¢å¼º&#34;&gt;#&lt;/a&gt; 2.3 æ•°æ®å¢å¼º&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒè™½ç„¶æ•°æ®å¢å¼ºï¼ˆ &lt;code&gt;DA, Data Augmentation&lt;/code&gt; ï¼‰å·²è¢«å¹¿æ³›åº”ç”¨äºè®¡ç®—æœºè§†è§‰ï¼Œä½†ç”¨äºè¯­è¨€ä»»åŠ¡çš„ &lt;code&gt;DA&lt;/code&gt;  å¹¶ä¸é‚£ä¹ˆç›´æ¥ã€‚è¿‘å¹´æ¥ï¼Œç”Ÿæˆè¯­è¨€æ¨¡å‹å·²è¢«ç”¨äºåˆæˆå„ç§ &lt;code&gt;NLP&lt;/code&gt;  ä»»åŠ¡çš„ç¤ºä¾‹ã€‚ä¸åŒäºè¿™äº›æ–¹æ³•åªå…³æ³¨ä½èµ„æºçš„è¯­è¨€ä»»åŠ¡ï¼Œ &lt;code&gt;BLIP&lt;/code&gt;  çš„æ–¹æ³•å±•ç¤ºäº†åˆæˆå­—å¹•åœ¨å¤§è§„æ¨¡è§†è§‰è¯­è¨€é¢„è®­ç»ƒä¸­çš„ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-æ–¹æ³•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-æ–¹æ³•&#34;&gt;#&lt;/a&gt; ä¸‰ã€æ–¹æ³•&lt;/h1&gt;
&lt;h2 id=&#34;31-æ¨¡å‹æ¶æ„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#31-æ¨¡å‹æ¶æ„&#34;&gt;#&lt;/a&gt; 3.1 æ¨¡å‹æ¶æ„&lt;/h2&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/BLIP/3.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;BLIP&lt;/code&gt;  é‡‡ç”¨äº†ç¼–ç å™¨ - è§£ç å™¨çš„å¤šæ¨¡æ€æ··åˆç»“æ„ ( &lt;code&gt;MED&lt;/code&gt; )ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªå•æ¨¡æ€ç¼–ç å™¨ã€ä¸€ä¸ªä»¥å›¾åƒä¸ºåŸºç¡€çš„æ–‡æœ¬ç¼–ç å™¨å’Œä¸€ä¸ªä»¥å›¾åƒä¸ºåŸºç¡€çš„æ–‡æœ¬è§£ç å™¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å•æ¨¡æ€ç¼–ç å™¨&lt;/strong&gt;  &lt;code&gt;lmage Encoder&lt;/code&gt; ï¼šåŸºäº &lt;code&gt;transformer&lt;/code&gt;  çš„ &lt;code&gt;ViT&lt;/code&gt;  çš„æ¶æ„ï¼Œå°†è¾“å…¥å›¾åƒåˆ†å‰²ä¸ºå¤šä¸ªçš„ &lt;code&gt;patch&lt;/code&gt;  å¹¶å°†å®ƒä»¬ç¼–ç ä¸ºä¸€ç³»åˆ— &lt;code&gt;Image Embedding&lt;/code&gt; ï¼Œå¹¶ä½¿ç”¨ [CLS] token æ¥è¡¨ç¤ºå…¨å±€çš„å›¾åƒç‰¹å¾ã€‚ &lt;code&gt;lmage Encoder&lt;/code&gt;  ç”¨æ¥æå–å›¾åƒç‰¹å¾åšå¯¹æ¯”å­¦ä¹ ï¼Œç›¸å½“äº &lt;code&gt;CLIP&lt;/code&gt;  ä¸­çš„  &lt;code&gt;Image Encoder&lt;/code&gt; ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å•æ¨¡æ€ç¼–ç å™¨&lt;/strong&gt;  &lt;code&gt;Text Encoder&lt;/code&gt; ï¼šåŸºäº &lt;code&gt;BERT&lt;/code&gt;  çš„æ¶æ„ï¼Œå°† [CLS] token åŠ åˆ°è¾“å…¥æ–‡æœ¬çš„å¼€å¤´ä»¥æ€»ç»“å¥å­ã€‚ &lt;code&gt;Text Encoder&lt;/code&gt;  ç”¨æ¥æå–æ–‡æœ¬ç‰¹å¾åšå¯¹æ¯”å­¦ä¹ ï¼Œç›¸å½“äº &lt;code&gt;CLIP&lt;/code&gt;  ä¸­çš„ &lt;code&gt;Text Encoder&lt;/code&gt; ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä»¥å›¾åƒä¸ºåŸºç¡€çš„ç¼–ç å™¨&lt;/strong&gt;  &lt;code&gt;Image-grounded text encoder&lt;/code&gt; ï¼šå¯¹ &lt;code&gt;Text Encoder&lt;/code&gt;  çš„æ¯ä¸€ä¸ª &lt;code&gt;transformer&lt;/code&gt;  å—ï¼Œåœ¨ è‡ªæ³¨æ„åŠ› ( &lt;code&gt;self-attention, SA&lt;/code&gt; ) å±‚å’Œå‰é¦ˆç½‘ç»œä¹‹é—´æ·»åŠ ä¸€ä¸ªäº¤å‰æ³¨æ„ ( &lt;code&gt;cross-attention, CA&lt;/code&gt; ) å±‚ç”¨æ¥æ³¨å…¥è§†è§‰ä¿¡æ¯ï¼Œè¿˜å°† [Encode] token åŠ åˆ°è¾“å…¥æ–‡æœ¬çš„å¼€å¤´ä»¥æ ‡è¯†ç‰¹å®šä»»åŠ¡ã€‚ &lt;code&gt;Image-grounded text encoder&lt;/code&gt;  ç”¨æ¥æå–æ–‡æœ¬ç‰¹å¾å¹¶å°†å…¶å’Œå›¾åƒç‰¹å¾å¯¹é½ï¼Œç›¸å½“äº &lt;code&gt;CLIP&lt;/code&gt;  ä¸­æ›´ç²¾ç»†åŒ–çš„ &lt;code&gt;Text-Image&lt;/code&gt;  å¯¹é½ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä»¥å›¾åƒä¸ºåŸºç¡€çš„è§£ç å™¨&lt;/strong&gt;  &lt;code&gt;Image-grounded text decoder&lt;/code&gt; ï¼šå°† &lt;code&gt;Image-grounded text encoder&lt;/code&gt;  çš„ &lt;code&gt;self-attention&lt;/code&gt;  å±‚æ¢æˆ &lt;code&gt;causal self-attention&lt;/code&gt;  å±‚ï¼Œè¿˜å°† [Decode] token å’Œ [EOS] token åŠ åˆ°è¾“å…¥æ–‡æœ¬çš„å¼€å¤´å’Œç»“å°¾ä»¥æ ‡è¯†åºåˆ—çš„å¼€å§‹å’Œç»“æŸã€‚ &lt;code&gt;Image-grounded text decoder&lt;/code&gt;  ç”¨æ¥ç”Ÿæˆç¬¦åˆå›¾åƒå’Œæ–‡æœ¬ç‰¹å¾çš„æ–‡æœ¬æè¿°ï¼Œè¿™æ˜¯ &lt;code&gt;CLIP&lt;/code&gt;  ä¸­æ‰€æ²¡æœ‰çš„ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;note primary no-icon&#34;&gt;
&lt;p&gt;â€ƒâ€ƒæ³¨æ„ï¼Œ &lt;code&gt;Image-grounded text decoder&lt;/code&gt;  ç”Ÿæˆçš„æ–‡æœ¬æè¿°ä¸åŒäºè¾“å…¥çš„å›¾åƒ - æ–‡æœ¬å¯¹ä¸­çš„æ–‡æœ¬ï¼Œå›¾åƒ - æ–‡æœ¬å¯¹ä¸­çš„æ–‡æœ¬æ˜¯äº’è”ç½‘ä¸Šæ‰¾åˆ°çš„å›¾ç‰‡çš„ä¸Šä¸‹æ–‡ï¼Œæ‹¥æœ‰å¤§é‡çš„å™ªéŸ³ï¼›è€Œ &lt;code&gt;Image-grounded text decoder&lt;/code&gt;  ç”Ÿæˆçš„æ–‡æœ¬æè¿°æ˜¯é’ˆå¯¹å›¾åƒç‰¹å¾å’Œæ–‡æœ¬ç‰¹å¾çš„ç‰¹å®šæè¿°ï¼Œæ›´åŠ ç²¾ç‚¼ã€‚è¿™é‡Œå…¶å®å°±å·²ç»æ˜¯ &lt;code&gt;Captioner&lt;/code&gt;  çš„é›å½¢äº†ï¼Œä¸‹æ–‡çš„ &lt;code&gt;Captioner&lt;/code&gt;  ä¹Ÿæ˜¯åŸºäºè®­ç»ƒå®Œæˆçš„ &lt;code&gt;Image-grounded text decoder&lt;/code&gt;  å†è¿›è¡Œçš„ä¼˜åŒ–å’Œå¾®è°ƒã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;32-é¢„è®­ç»ƒç›®æ ‡&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#32-é¢„è®­ç»ƒç›®æ ‡&#34;&gt;#&lt;/a&gt; 3.2 é¢„è®­ç»ƒç›®æ ‡&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;BLIP&lt;/code&gt;  åœ¨é¢„è®­ç»ƒæœŸé—´è”åˆä¼˜åŒ–ä¸‰ä¸ªç›®æ ‡ï¼Œå…¶ä¸­ä¸¤ä¸ªåŸºäºç†è§£çš„ç›®æ ‡å’Œä¸€ä¸ªåŸºäºç”Ÿæˆçš„ç›®æ ‡ã€‚æ¯ä¸ªå›¾åƒ - æ–‡æœ¬å¯¹ä»…éœ€è¦é€šè¿‡è®¡ç®—é‡è¾ƒå¤§çš„è§†è§‰ &lt;code&gt;Transformer&lt;/code&gt;  çš„ä¸€æ¬¡æ­£å‘ä¼ é€’ï¼Œä»¥åŠé€šè¿‡æ–‡æœ¬ &lt;code&gt;Transformer&lt;/code&gt;  çš„ä¸‰æ¬¡æ­£å‘ä¼ é€’ï¼Œå…¶ä¸­ä¸åŒçš„åŠŸèƒ½è¢«æ¿€æ´»ä»¥è®¡ç®—å¦‚ä¸‹æ‰€è¿°çš„ä¸‰ä¸ªæŸå¤±ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å›¾æ–‡å¯¹æ¯”æŸå¤±&lt;/strong&gt; ( &lt;code&gt;Image-Text Contrastive Loss, ITC&lt;/code&gt; )ï¼š &lt;code&gt;ITC&lt;/code&gt;  ç”¨äºè®­ç»ƒ &lt;code&gt;lmage Encoder&lt;/code&gt;  å’Œ &lt;code&gt;Text Encoder&lt;/code&gt; ï¼Œé€šè¿‡å¯¹æ¯”å­¦ä¹ å¯¹é½å›¾åƒå’Œæ–‡æœ¬çš„ç‰¹å¾ç©ºé—´ã€‚å…·ä½“æ–¹æ³•æ˜¯æœ€å¤§åŒ–æ­£æ ·æœ¬å›¾åƒ - æ–‡æœ¬å¯¹çš„ç›¸ä¼¼åº¦ä¸”æœ€å°åŒ–è´Ÿæ ·æœ¬å›¾åƒ - æ–‡æœ¬å¯¹çš„ç›¸ä¼¼åº¦ã€‚ &lt;code&gt;BLIP&lt;/code&gt;  è¿˜ä½¿ç”¨äº† &lt;code&gt;ALBEF&lt;/code&gt;  ä¸­çš„åŠ¨é‡ç¼–ç å™¨æ¥ç”Ÿæˆç‰¹å¾ï¼Œå¹¶ä»åŠ¨é‡ç¼–ç å™¨åˆ›å»ºè½¯æ ‡ç­¾ä½œä¸ºè®­ç»ƒç›®æ ‡ï¼Œä»¥è§£é‡Šè´Ÿæ ·æœ¬å¯¹ä¸­çš„æ½œåœ¨æ­£æ ·æœ¬ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å›¾æ–‡åŒ¹é…æŸå¤±&lt;/strong&gt; ( &lt;code&gt;Image-Text Matching Loss, ITM&lt;/code&gt; )ï¼š &lt;code&gt;ITM&lt;/code&gt;  ç”¨äºè®­ç»ƒ &lt;code&gt;Image-grounded text encoder&lt;/code&gt; ï¼Œé€šè¿‡å­¦ä¹ å›¾åƒ - æ–‡æœ¬å¯¹çš„è”åˆè¡¨å¾å®ç°è§†è§‰å’Œè¯­è¨€ä¹‹é—´çš„ç»†ç²’åº¦å¯¹é½ã€‚å…·ä½“æ–¹æ³•æ˜¯é€šè¿‡ä¸€ä¸ªäºŒåˆ†ç±»ä»»åŠ¡ï¼Œé¢„æµ‹å›¾åƒæ–‡æœ¬å¯¹æ˜¯æ­£æ ·æœ¬è¿˜æ˜¯è´Ÿæ ·æœ¬ã€‚è¿™é‡Œè¿˜ä½¿ç”¨äº† &lt;code&gt;ALBEF&lt;/code&gt;  ä¸­çš„ &lt;code&gt;hard negative mining&lt;/code&gt;  æŠ€æœ¯ä»¥æ›´å¥½åœ°æ•æ‰è´Ÿæ ·æœ¬ä¿¡æ¯ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;note primary no-icon&#34;&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;ITM&lt;/code&gt;  ä¸ &lt;code&gt;ITC&lt;/code&gt;  å¹¶ä¸ä¸€æ ·ï¼Œ &lt;code&gt;ITC&lt;/code&gt;  è™½ç„¶ä¹Ÿå¯¹é½äº†å›¾åƒå’Œæ–‡æœ¬çš„ç‰¹å¾ç©ºé—´ï¼Œä½†å¹¶æ²¡æœ‰æ˜¾å¼åœ°åŒºåˆ†æ­£è´Ÿæ ·æœ¬ï¼Œä¸»è¦æ˜¯ç”¨äºè¯„ä»·å›¾åƒå’Œæ–‡æœ¬çš„åŒ¹é…æƒ…å†µï¼Œç»™å‡ºä»»æ„è¾“å…¥å›¾åƒ - æ–‡æœ¬å¯¹çš„ç›¸ä¼¼åº¦ã€‚è€Œ &lt;code&gt;ITM&lt;/code&gt;  åˆ™æ˜¯é€šè¿‡è®¡ç®—æ ·æœ¬çš„æŸå¤±è¾¾åˆ°åŒºåˆ†æ­£è´Ÿæ ·æœ¬çš„ç›®çš„ï¼Œæ¿€åŠ±æ­£æ ·æœ¬çš„å›¾åƒå’Œæ–‡æœ¬ä½¿å…¶æ›´åŠ åŒ¹é…ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯­è¨€å»ºæ¨¡æŸå¤±&lt;/strong&gt; ( &lt;code&gt;Language Modeling Loss, LM&lt;/code&gt; )ï¼š &lt;code&gt;LM&lt;/code&gt;  ç”¨äºè®­ç»ƒ &lt;code&gt;Image-grounded text decoder&lt;/code&gt; ï¼Œå®ç°ç”Ÿæˆå›¾åƒçš„æ–‡æœ¬æè¿°ä»»åŠ¡ã€‚å…·ä½“æ–¹æ³•æ˜¯é€šè¿‡ä¼˜åŒ–äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œè®­ç»ƒæ¨¡å‹ä»¥è‡ªå›å½’çš„æ–¹å¼æœ€å¤§åŒ–æ–‡æœ¬çš„æ¦‚ç‡ã€‚åœ¨è®¡ç®—æŸå¤±æ—¶ï¼Œ &lt;code&gt;BLIP&lt;/code&gt;  åº”ç”¨ 0.1 çš„æ ‡ç­¾å¹³æ»‘ã€‚ä¸ &lt;code&gt;VLP&lt;/code&gt;  ä¸­å¹¿æ³›ä½¿ç”¨çš„ &lt;code&gt;MLM&lt;/code&gt;  æŸå¤±ç›¸æ¯”ï¼Œ &lt;code&gt;LM&lt;/code&gt;  ä½¿è¯¥æ¨¡å‹å…·æœ‰æ³›åŒ–èƒ½åŠ›ï¼Œèƒ½å¤Ÿå°†è§†è§‰ä¿¡æ¯è½¬æ¢ä¸ºè¿è´¯çš„å­—å¹•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;note primary no-icon&#34;&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†åœ¨åˆ©ç”¨å¤šä»»åŠ¡å­¦ä¹ çš„åŒæ—¶æ‰§è¡Œæœ‰æ•ˆçš„é¢„è®­ç»ƒï¼Œæ–‡æœ¬ç¼–ç å™¨å’Œæ–‡æœ¬è§£ç å™¨å…±äº«é™¤äº† &lt;code&gt;SA&lt;/code&gt;  å±‚ä¹‹å¤–çš„æ‰€æœ‰å‚æ•°ã€‚åŸå› æ˜¯ç¼–ç å’Œè§£ç ä»»åŠ¡ä¹‹é—´çš„å·®å¼‚æœ€å¥½ç”± &lt;code&gt;SA&lt;/code&gt;  å±‚æ¥æ•è·ã€‚å…·ä½“åœ°ï¼Œç¼–ç å™¨é‡‡ç”¨åŒå‘è‡ªæ³¨æ„æ¥æ„å»ºå½“å‰è¾“å…¥æ ‡è®°çš„è¡¨ç¤ºï¼Œè€Œè§£ç å™¨é‡‡ç”¨å› æœè‡ªæ³¨æ„æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªæ ‡è®°ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨ç¼–ç å’Œè§£ç ä»»åŠ¡ä¹‹é—´ï¼ŒåµŒå…¥å±‚ã€ &lt;code&gt;CA&lt;/code&gt;  å±‚å’Œ &lt;code&gt;FFN&lt;/code&gt;  çš„åŠŸèƒ½ç±»ä¼¼ï¼Œå› æ­¤å…±äº«è¿™äº›å±‚å¯ä»¥æé«˜è®­ç»ƒæ•ˆç‡ï¼ŒåŒæ—¶å—ç›Šäºå¤šä»»åŠ¡å­¦ä¹ ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;33-capfiltæœºåˆ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#33-capfiltæœºåˆ¶&#34;&gt;#&lt;/a&gt; 3.3 CapFilt æœºåˆ¶&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;COCO&lt;/code&gt;  æ•°æ®é›†çš„é«˜è´¨é‡äººå·¥æ³¨é‡Šå›¾åƒ - æ–‡æœ¬å¯¹&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;{(I_h,T_h)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07847em;&#34;&gt;I&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;h&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;h&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ•°é‡æœ‰é™ï¼Œå› æ­¤ &lt;code&gt;CLIP&lt;/code&gt; ã€ &lt;code&gt;BLIP&lt;/code&gt;  ç­‰ &lt;code&gt;VLP&lt;/code&gt;  éƒ½æ˜¯ä»ç½‘ç»œä¸­æ”¶é›†å¤§é‡å›¾åƒ - æ–‡æœ¬å¯¹&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;{(I_w,T_w)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07847em;&#34;&gt;I&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä½œä¸ºè®­ç»ƒé›†ã€‚ä½†è¿™äº›ç½‘ç»œå›¾åƒ - æ–‡æœ¬å¯¹çš„æ–‡æœ¬æ¥è‡ªå›¾åƒä¸Šä¸‹æ–‡ï¼Œéš¾ä»¥ç²¾å‡†åœ°æè¿°å›¾åƒå†…å®¹ï¼Œå­˜åœ¨å¤§é‡å™ªå£°ã€‚äºæ˜¯ï¼Œ &lt;code&gt;BLIP&lt;/code&gt;  æå‡ºäº†å­—å¹•å’Œè¿‡æ»¤ ( &lt;code&gt;Captioning and Filtering, CapFilt&lt;/code&gt; ) æœºåˆ¶ï¼Œä¸‹å›¾ç»™å‡ºäº† &lt;code&gt;CapFilt&lt;/code&gt;  çš„è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/BLIP/3.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸Šå›¾ç»™å‡ºäº† &lt;code&gt;CapFilt&lt;/code&gt;  çš„å›¾ç¤ºï¼ŒåŒ…å«å­—å¹•å™¨å’Œè¿‡æ»¤å™¨ä¸¤ä¸ªæ¨¡å—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­—å¹•å™¨&lt;/strong&gt;  &lt;code&gt;Captioner&lt;/code&gt; ï¼šä¸€ä¸ªè§†è§‰æ–‡æœ¬è§£ç å™¨ï¼ŒåŸºäº &lt;code&gt;Image-grounded text decoder&lt;/code&gt; ï¼Œç”¨äºç”Ÿæˆç»™å®šå›¾åƒçš„å­—å¹•ï¼Œä½¿ç”¨ &lt;code&gt;LM&lt;/code&gt;  æŸå¤±å‡½æ•°åœ¨ &lt;code&gt;COCO&lt;/code&gt;  æ•°æ®é›†ä¸Šè¿›è¡Œå¾®è°ƒã€‚ç»™å®šç½‘ç»œå›¾ç‰‡&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;I_w&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07847em;&#34;&gt;I&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼ŒCaptioner ç”Ÿæˆå­—å¹•&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;T_w&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚&lt;br&gt;
â€‹&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿‡æ»¤å™¨&lt;/strong&gt;  &lt;code&gt;Filter&lt;/code&gt; ï¼šä¸€ä¸ªè§†è§‰æ–‡æœ¬ç¼–ç å™¨ï¼ŒåŸºäº &lt;code&gt;Image-grounded text encoder&lt;/code&gt; ï¼Œç”¨äºå»é™¤æ–‡æœ¬å™ªå£°ï¼Œä½¿ç”¨ &lt;code&gt;ITC&lt;/code&gt;  å’Œ &lt;code&gt;ITM&lt;/code&gt;  æŸå¤±å‡½æ•°åœ¨ &lt;code&gt;COCO&lt;/code&gt;  æ•°æ®é›†ä¸Šè¿›è¡Œå¾®è°ƒã€‚ &lt;code&gt;Filter&lt;/code&gt;  é€šè¿‡æ¯”å¯¹æ–‡æœ¬å’Œå›¾åƒçš„åŒ¹é…æƒ…å†µï¼Œåˆ é™¤åŸå§‹ &lt;code&gt;Web&lt;/code&gt;  æ–‡æœ¬&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;T_w&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œåˆæˆæ–‡æœ¬&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;T_s&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.83333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.151392em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸­çš„å™ªå£°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;note primary no-icon&#34;&gt;
&lt;p&gt;&lt;code&gt;Captioner&lt;/code&gt;  å’Œ &lt;code&gt;Filter&lt;/code&gt;  éƒ½æ˜¯åœ¨é¢„è®­ç»ƒå®Œæˆåçš„ &lt;code&gt;MED&lt;/code&gt;  æ¨¡å‹ä¸Šåˆå§‹åŒ–çš„ï¼Œå¹¶å„è‡ªåœ¨äººå·¥æ³¨é‡Šçš„å›¾åƒ - æ–‡æœ¬å¯¹æ•°æ®é›† &lt;code&gt;COCO&lt;/code&gt;  ä¸Šè¿›è¡Œå¾®è°ƒ ( &lt;code&gt;finetune&lt;/code&gt; )ã€‚æœ€åï¼Œå°†è¿‡æ»¤åçš„å›¾åƒ - æ–‡æœ¬å¯¹ä¸äººå·¥æ³¨é‡Šå¯¹ç›¸ç»“åˆï¼Œå½¢æˆä¸€ä¸ªæ–°çš„æ•°æ®é›†ï¼ˆè¿™ä¹Ÿæ˜¯ &lt;code&gt;Bootstrapping&lt;/code&gt;  çš„ç”±æ¥ï¼‰ï¼Œæœ€åå†ç”¨å®ƒæ¥è®­ç»ƒä¸€éæ¨¡å‹ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;34-æ•´ä½“æ€è·¯æ•´ç†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#34-æ•´ä½“æ€è·¯æ•´ç†&#34;&gt;#&lt;/a&gt; 3.4 æ•´ä½“æ€è·¯æ•´ç†&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆä½¿ç”¨å«æœ‰å™ªå£°çš„ç½‘ç»œæ•°æ®è®­ç»ƒä¸€é &lt;code&gt;BLIP&lt;/code&gt; ï¼›&lt;/li&gt;
&lt;li&gt;å†åœ¨ &lt;code&gt;COCO&lt;/code&gt;  æ•°æ®é›†ä¸Šè¿›è¡Œå¾®è°ƒä»¥è®­ç»ƒ &lt;code&gt;Captioner&lt;/code&gt;  å’Œ &lt;code&gt;Filter&lt;/code&gt; ï¼›&lt;/li&gt;
&lt;li&gt;ç„¶åä½¿ç”¨ &lt;code&gt;Filter&lt;/code&gt;  ä»åŸå§‹ç½‘ç»œæ–‡æœ¬å’Œ &lt;code&gt;Captioner&lt;/code&gt;  åˆæˆçš„æ–‡æœ¬ä¸­åˆ é™¤å˜ˆæ‚çš„å­—å¹•ï¼Œå¾—åˆ°å¹²å‡€çš„æ•°æ®ï¼›&lt;/li&gt;
&lt;li&gt;æœ€åå†ä½¿ç”¨å¹²å‡€çš„æ•°æ®è®­ç»ƒä¸€éå¾—åˆ°é«˜æ€§èƒ½çš„ &lt;code&gt;BLIP&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;å››-å‚è€ƒç¨‹åº&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å››-å‚è€ƒç¨‹åº&#34;&gt;#&lt;/a&gt; å››ã€å‚è€ƒç¨‹åº&lt;/h1&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9odWdnaW5nZmFjZS5jby9TYWxlc2ZvcmNlL2JsaXAtaW1hZ2UtY2FwdGlvbmluZy1sYXJnZQ==&#34;&gt;https://huggingface.co/Salesforce/blip-image-captioning-large&lt;/span&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; PIL &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; Image&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; transformers &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; BlipProcessor&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; BlipForConditionalGeneration&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;processor &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; BlipProcessor&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;from_pretrained&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;E:/python/else/LLM_learn/5_BLIP/model&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; BlipForConditionalGeneration&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;from_pretrained&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;E:/python/else/LLM_learn/5_BLIP/model&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;cuda&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;raw_image &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Image&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;1.jpg&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;convert&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;RGB&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# conditional image captioning&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;text &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;a photography of&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;inputs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; processor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;raw_image&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; text&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; return_tensors&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;pt&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;cuda&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;out &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;generate&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;**&lt;/span&gt;inputs&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;processor&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;decode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; skip_special_tokens&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# unconditional image captioning&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;inputs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; processor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;raw_image&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; return_tensors&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;pt&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;cuda&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;out &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;generate&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;**&lt;/span&gt;inputs&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;processor&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;decode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; skip_special_tokens&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/09/12/AI/CLIP/</guid>
            <title>CLIP</title>
            <link>http://qianqiu-cell.github.io/2024/09/12/AI/CLIP/</link>
            <category>AI</category>
            <pubDate>Thu, 12 Sep 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;ä¸€-ç®€ä»‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-ç®€ä»‹&#34;&gt;#&lt;/a&gt; ä¸€ã€ç®€ä»‹&lt;/h1&gt;
&lt;h2 id=&#34;11-å‰è¨€&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#11-å‰è¨€&#34;&gt;#&lt;/a&gt; 1.1 å‰è¨€&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;CLIP&lt;/code&gt;  æ˜¯ &lt;code&gt;OpenAI&lt;/code&gt;  åœ¨ &lt;code&gt;2021&lt;/code&gt;  å¹´ &lt;code&gt;2&lt;/code&gt;  æœˆå‘è¡¨çš„ä¸€ç¯‡æ–‡ç« ï¼Œå…¶å…¨ç§°ä¸º &lt;code&gt;Contrastive Language-Image Pre-training&lt;/code&gt; ï¼Œå³ä¸€ç§åŸºäºå¯¹æ¯”æ–‡æœ¬ - å›¾åƒå¯¹çš„é¢„è®­ç»ƒæ–¹æ³•ã€‚ &lt;code&gt;CLIP&lt;/code&gt;  ç”¨æ–‡æœ¬ä½œä¸ºç›‘ç£ä¿¡å·æ¥è®­ç»ƒå¯è¿ç§»çš„è§†è§‰æ¨¡å‹ï¼Œä½¿å¾—æœ€ç»ˆæ¨¡å‹çš„ &lt;code&gt;zero-shot&lt;/code&gt;  æ•ˆæœå ªæ¯” &lt;code&gt;ResNet50&lt;/code&gt; ï¼Œæ³›åŒ–æ€§éå¸¸å¥½ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;zero-shot&lt;/code&gt;  å°±æ˜¯ç›´æ¥æ¨ç†ï¼Œç”¨è§è¿‡çš„å›¾ç‰‡ç‰¹å¾å»åˆ¤æ–­æ²¡è§è¿‡çš„å›¾ç‰‡çš„ç±»åˆ«ï¼Œè€Œå®Œå…¨ä¸ç”¨ä¸‹æ¸¸ä»»åŠ¡è®­ç»ƒé›†è¿›è¡Œå¾®è°ƒã€‚ï¼ˆç›¸å½“äºæŠŠæ¨¡å‹ç”¨ä½œç‰¹å¾æå–ï¼Œä½†æ˜¯æ²¡æœ‰åˆ†ç±»å¤´ï¼‰&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä½œè€…åœ¨ 30 å¤šä¸ªä¸åŒçš„è®¡ç®—æœºè§†è§‰æ•°æ®é›†ä¸Šè¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼Œï¼ˆè¿™äº›æ•°æ®é›†æ¶µç›–äº† &lt;code&gt;OCR&lt;/code&gt; ( &lt;code&gt;Optical Character Recognition&lt;/code&gt; , å…‰å­¦å­—ç¬¦è¯†åˆ«)ã€è§†é¢‘ä¸­çš„åŠ¨ä½œè¯†åˆ«ã€åœ°ç†å®šä½å’Œè®¸å¤šç±»å‹çš„ç»†ç²’åº¦å¯¹è±¡åˆ†ç±»ç­‰ä»»åŠ¡ï¼‰ï¼Œ &lt;code&gt;CLIP&lt;/code&gt;  é€šå¸¸éƒ½èƒ½å¤Ÿä¸ç›‘ç£æ¨¡å‹çš„ &lt;code&gt;baseline&lt;/code&gt;  æ•ˆæœç›¸åª²ç¾ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¾‹å¦‚åœ¨ &lt;code&gt;ImageNet&lt;/code&gt;  æ•°æ®é›†ä¸Šï¼Œ &lt;code&gt;CLIP&lt;/code&gt;  æ¨¡å‹åœ¨ä¸ä½¿ç”¨ &lt;code&gt;ImageNet&lt;/code&gt;  æ•°æ®é›†çš„ä»»ä½•ä¸€å¼ å›¾ç‰‡è¿›è¡Œè®­ç»ƒçš„çš„æƒ…å†µä¸‹ï¼Œæœ€ç»ˆæ¨¡å‹ç²¾åº¦èƒ½è·Ÿä¸€ä¸ªæœ‰ç›‘ç£çš„è®­ç»ƒå¥½çš„ &lt;code&gt;ResNet-50&lt;/code&gt;  æ‰“æˆå¹³æ‰‹ï¼ˆåœ¨ &lt;code&gt;ImageNet&lt;/code&gt;  ä¸Š &lt;code&gt;zero-shot&lt;/code&gt;  ç²¾åº¦ä¸º &lt;code&gt;76.2%&lt;/code&gt; ï¼Œè¿™åœ¨ä¹‹å‰ä¸€åº¦è¢«è®¤ä¸ºæ˜¯ä¸å¯èƒ½çš„ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;12-è‡ªç„¶è¯­è¨€ç›‘ç£çš„ä¼˜åŠ¿&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#12-è‡ªç„¶è¯­è¨€ç›‘ç£çš„ä¼˜åŠ¿&#34;&gt;#&lt;/a&gt; 1.2 è‡ªç„¶è¯­è¨€ç›‘ç£çš„ä¼˜åŠ¿&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒä½¿ç”¨è‡ªç„¶è¯­è¨€ç›‘ç£ä¿¡å·æ¥è®­ç»ƒè§†è§‰æ¨¡å‹ï¼Œæœ‰ä¸¤ä¸ªæœ€é‡è¦çš„ä¼˜åŠ¿ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸éœ€è¦é‡‡ç”¨ç‰¹åˆ«çš„æ ‡æ³¨æ•°æ®&lt;/strong&gt;ï¼Œæ‰©å±•æ€§æ›´å¼ºã€‚æ¯”å¦‚ &lt;code&gt;ImageNet&lt;/code&gt;  éœ€è¦å…ˆå®šä¹‰å¥½ &lt;code&gt;1000&lt;/code&gt;  ä¸ªç±»ï¼Œç„¶åæ ¹æ®è¿™äº›ç±»å»ä¸‹è½½å›¾ç‰‡ï¼Œæ¸…ç†æ•°æ®é›†ï¼Œå†å»æ ‡æ³¨æ‰€æœ‰å›¾ç‰‡ï¼Œè¿‡ç¨‹å¾ˆå¤æ‚ã€‚è€Œ CLIP ä¸è¦æ±‚è¿™ç§ç»å…¸çš„ &amp;quot;æœºå™¨å­¦ä¹ å…¼å®¹&amp;quot; çš„æ ‡æ³¨æ ¼å¼ï¼Œåªéœ€è¦ä¸‹è½½æ–‡å­— - å›¾ç‰‡å¯¹ï¼›ä¸”æ²¡æœ‰ n é€‰ 1 çš„æ ‡ç­¾ä¹‹åï¼Œæ¨¡å‹çš„è¾“å…¥è¾“å‡ºè‡ªç”±åº¦å¤§äº†å¾ˆå¤šã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;CLIP&lt;/code&gt;  å­¦ä¹ åˆ°çš„æ˜¯å›¾åƒç»“åˆæ–‡å­—çš„å¤šæ¨¡æ€ç‰¹å¾ï¼Œä»è€Œ&lt;strong&gt;å®ç°çµæ´»çš„ zero-shot è¿ç§»&lt;/strong&gt;ã€‚å¦‚æœåªæ˜¯å•æ¨¡æ€çš„ç‰¹å¾ï¼Œæ— è®ºæ˜¯ç±»ä¼¼ &lt;code&gt;MOCO&lt;/code&gt;  è¿˜æ˜¯ &lt;code&gt;MAE&lt;/code&gt; ï¼Œéƒ½å¾ˆéš¾åšåˆ°è¿™ä¸€ç‚¹ï¼ˆ &lt;code&gt;zero-shot&lt;/code&gt;  å¿…é¡»è¦åŠ å…¥æ–‡å­—ç‰¹å¾æ‰èƒ½åšåˆ°ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;13-æ€»ç»“&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#13-æ€»ç»“&#34;&gt;#&lt;/a&gt; 1.3 æ€»ç»“&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒç°æœ‰çš„ &lt;code&gt;CV&lt;/code&gt;  æ¨¡å‹åŸºæœ¬éƒ½æ˜¯åŸºäºäººå·¥æ ‡æ³¨çš„æ•°æ®é›†è¿›è¡Œè®­ç»ƒçš„ï¼Œç„¶åç”¨æ¥é¢„æµ‹ä¸€ç»„æå‰å®šä¹‰å¥½çš„ç‰©ä½“ç±»åˆ«ã€‚è¿™ç§æå‰å®šä¹‰å¥½çš„æ ‡ç­¾é›†åˆï¼Œä¼šå¤§å¤§ç®€åŒ–é—®é¢˜æœ¬èº«ï¼ˆæ¯”å¦‚ &lt;code&gt;ImageNet&lt;/code&gt;  å›ºå®šçš„ &lt;code&gt;1000&lt;/code&gt;  ä¸ªç±»ï¼Œ &lt;code&gt;COCO&lt;/code&gt;  æ•°æ®é›†å›ºå®š &lt;code&gt;80&lt;/code&gt;  ä¸ªç±»ç­‰ç­‰ï¼‰ã€‚ä½†æ­£å› å¦‚æ­¤ï¼Œè¿™ç§å—é™çš„ç›‘ç£ä¿¡å·é™åˆ¶äº†æ¨¡å‹çš„æ³›åŒ–æ€§å’Œå¯ç”¨æ€§ã€‚æ¯”å¦‚å¤§å¤šæ•°æ¨¡å‹éƒ½åªèƒ½é¢„æµ‹å·²çŸ¥çš„å›¾åƒç±»åˆ«ã€‚å¯¹äºæ²¡æœ‰è§è¿‡çš„å›¾åƒç±»åˆ«ï¼Œéœ€è¦é¢å¤–çš„ä¿¡æ¯æ‰èƒ½è¯†åˆ«ã€‚è¿™æ ·&lt;strong&gt;æ¯æ¬¡æ–°å¢ä¸€äº›ç±»åˆ«ï¼Œéƒ½éœ€è¦é‡æ–°æ”¶é›†æ•°æ®ï¼Œè®­ç»ƒä¸€ä¸ªæ–°çš„æ¨¡å‹&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä½œè€…è®¤ä¸ºï¼Œç›´æ¥ä»è‡ªç„¶è¯­è¨€ä¸­å¾—åˆ°ç›‘ç£ä¿¡æ¯æ˜¯ä¸€ä¸ªå¾ˆæœ‰å‰é€”çš„é€‰æ‹©ï¼Œå› ä¸ºå…¶æ¶µç›–çš„èŒƒå›´æ›´å¹¿ï¼ˆåªè¦æ˜¯è¯­è¨€æè¿°è¿‡çš„ç‰©ä½“ï¼Œéƒ½æœ‰å¯èƒ½è®©è§†è§‰æ¨¡å‹å»è¯†åˆ«ï¼‰ã€‚ &lt;code&gt;CLIP&lt;/code&gt;  åˆ©ç”¨å¤šæ¨¡æ€çš„å¯¹æ¯”å­¦ä¹ ï¼Œä½¿å¾—è‡ªç„¶è¯­è¨€å¯ä»¥å¼•å¯¼æ¨¡å‹å­¦ä¹ åˆ°è§†è§‰æ¦‚å¿µï¼Œä»è€Œå®ç°éå¸¸çµæ´»çš„ &lt;code&gt;zero-shot&lt;/code&gt;  è¿ç§»ï¼ˆæŠŠåˆ†ç±»é—®é¢˜è½¬åŒ–ä¸ºäº†è·¨æ¨¡æ€æ£€ç´¢é—®é¢˜ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¹‹å‰ä½¿ç”¨è‡ªç„¶è¯­è¨€ç›‘ç£è¿›è¡Œå›¾åƒè¡¨ç¤ºå­¦ä¹ çš„å·¥ä½œå¾ˆå°‘ï¼Œå¹¶ä¸”æ•ˆæœå¾€å¾€ä¸å¦‚æœ‰ç›‘ç£æ¨¡å‹ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ—©æœŸ nlp æ¨¡å‹ä¸å¤ªå¥½å­¦&lt;/strong&gt;ã€‚æ¯”å¦‚æ—©æœŸçš„ &lt;code&gt;n-gram&lt;/code&gt;  æ¨¡å‹éå¸¸å¤æ‚ï¼Œä¸å¥½è·¨æ¨¡æ€è®­ç»ƒã€‚ä½†æ˜¯éšç€ &lt;code&gt;transformer&lt;/code&gt;  çš„å…´èµ·ï¼Œåƒ &lt;code&gt;BERT&lt;/code&gt;  å’Œ &lt;code&gt;GPT&lt;/code&gt;  è¿™ç§å…·æœ‰ä¸Šä¸‹æ–‡è¡¨ç¤ºçš„è‡ªç›‘ç£è®­ç»ƒæ¨¡å‹åšçš„è¶Šæ¥è¶Šå¥½ï¼Œ &lt;code&gt;nlp&lt;/code&gt;  æ¨¡å‹ä¹Ÿç»ˆäºæœ‰äº†å–ä¹‹ä¸å°½çš„æ–‡æœ¬ç›‘ç£ä¿¡å·ï¼Œè€Œä¸”ä½¿ç”¨ç®€å•ï¼Œæ³›åŒ–æ€§å¥½ï¼Œä¸ºå¤šæ¨¡æ€è®­ç»ƒé“ºå¹³äº†é“è·¯ã€‚&lt;/li&gt;
&lt;li&gt;æ•°æ®é›†æˆ–æ¨¡å‹çš„è§„æ¨¡ä¸å¤Ÿã€‚æ¯”å¦‚ &lt;code&gt;VirTex&lt;/code&gt;  å’Œ &lt;code&gt;ICMLM&lt;/code&gt;  éƒ½åªè®­ç»ƒäº†&lt;strong&gt;åå‡ ä¸‡çš„å›¾ç‰‡&lt;/strong&gt;ï¼› &lt;code&gt;ConVIRT&lt;/code&gt;  éå¸¸ç±»ä¼¼ &lt;code&gt;CLIP&lt;/code&gt; ï¼Œä½†&lt;strong&gt;åªåœ¨åŒ»ç–—å›¾åƒä¸Šåšäº†é¢„è®­ç»ƒ&lt;/strong&gt;ã€‚ä»æœ¬è´¨ä¸Šæ¥è®²ï¼Œ &lt;code&gt;CLIP&lt;/code&gt;  å…¶å®å¹¶æ²¡æœ‰å¤ªå¤§çš„åˆ›æ–°ï¼Œå®ƒåªæ˜¯&lt;strong&gt;å°† ConVIRT æ–¹æ³•è¿›è¡Œç®€åŒ–ï¼Œå¹¶é‡‡ç”¨æ›´å¤§è§„æ¨¡çš„æ–‡æœ¬ - å›¾åƒå¯¹æ•°æ®é›†æ¥è®­ç»ƒ&lt;/strong&gt;ã€‚ä¹Ÿå¯ä»¥è¯´ï¼Œç›¸å¯¹äºä¹‹å‰çš„å¯¹æ¯”å­¦ä¹ ï¼Œ &lt;code&gt;CLIP&lt;/code&gt;  åªæ˜¯å°†å•æ¨¡æ€çš„æ ·æœ¬ï¼Œæ¢æˆäº†å¤šæ¨¡æ€çš„æ ·æœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äºŒ-æ–¹æ³•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-æ–¹æ³•&#34;&gt;#&lt;/a&gt; äºŒã€æ–¹æ³•&lt;/h1&gt;
&lt;h2 id=&#34;21-æ¨¡å‹ç»“æ„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-æ¨¡å‹ç»“æ„&#34;&gt;#&lt;/a&gt; 2.1 æ¨¡å‹ç»“æ„&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ &lt;code&gt;CLIP&lt;/code&gt;  çš„è¾“å…¥æ˜¯ä¸€å¯¹å¯¹é…å¯¹å¥½çš„çš„&lt;strong&gt;å›¾ç‰‡ - æ–‡æœ¬å¯¹&lt;/strong&gt;ï¼ˆæ¯”å¦‚è¾“å…¥æ˜¯ä¸€å¼ ç‹—çš„å›¾ç‰‡ï¼Œå¯¹åº”æ–‡æœ¬ä¹Ÿè¡¨ç¤ºè¿™æ˜¯ä¸€åªç‹—ï¼‰ã€‚è¿™äº›æ–‡æœ¬å’Œå›¾ç‰‡åˆ†åˆ«é€šè¿‡ &lt;code&gt;Text Encoder&lt;/code&gt;  å’Œ &lt;code&gt;Image Encoder&lt;/code&gt;  è¾“å‡ºå¯¹åº”çš„ç‰¹å¾ã€‚ç„¶ååœ¨è¿™äº›è¾“å‡ºçš„æ–‡å­—ç‰¹å¾å’Œå›¾ç‰‡ç‰¹å¾ä¸Šè¿›è¡Œ&lt;strong&gt;å¯¹æ¯”å­¦ä¹ &lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/CLIP/2.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå‡å¦‚æ¨¡å‹è¾“å…¥çš„æ˜¯&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å¯¹å›¾ç‰‡ - æ–‡æœ¬å¯¹ï¼Œé‚£ä¹ˆè¿™&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å¯¹äº’ç›¸é…å¯¹çš„å›¾åƒâ€“æ–‡æœ¬å¯¹æ˜¯&lt;strong&gt;æ­£æ ·æœ¬&lt;/strong&gt;ï¼ˆä¸‹å›¾è¾“å‡ºç‰¹å¾çŸ©é˜µå¯¹è§’çº¿ä¸Šæ ‡è¯†è“è‰²çš„éƒ¨ä½ï¼‰ï¼Œå…¶å®ƒ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n^2 - n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.897438em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å¯¹æ ·æœ¬éƒ½æ˜¯&lt;strong&gt;è´Ÿæ ·æœ¬&lt;/strong&gt;ã€‚è¿™æ ·æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹å°±æ˜¯æœ€å¤§åŒ–&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ªæ­£æ ·æœ¬çš„ç›¸ä¼¼åº¦ï¼ŒåŒæ—¶æœ€å°åŒ–&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n^2 - n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.897438em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ªè´Ÿæ ·æœ¬çš„ç›¸ä¼¼åº¦ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Text Encoder&lt;/code&gt;  å¯ä»¥é‡‡ç”¨ &lt;code&gt;NLP&lt;/code&gt;  ä¸­å¸¸ç”¨çš„ &lt;code&gt;text transformer&lt;/code&gt;  æ¨¡å‹ï¼›è€Œ &lt;code&gt;Image Encoder&lt;/code&gt;  å¯ä»¥é‡‡ç”¨å¸¸ç”¨ &lt;code&gt;CNN&lt;/code&gt;  æ¨¡å‹æˆ–è€… &lt;code&gt;vision transformer&lt;/code&gt;  ç­‰æ¨¡å‹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›¸ä¼¼åº¦æ˜¯è®¡ç®—æ–‡æœ¬ç‰¹å¾å’Œå›¾åƒç‰¹å¾çš„ä½™å¼¦ç›¸ä¼¼æ€§ &lt;code&gt;cosine similarity&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸ºäº†è®­ç»ƒ &lt;code&gt;CLIP&lt;/code&gt; ï¼Œ &lt;code&gt;OpenAI&lt;/code&gt;  ä»äº’è”ç½‘æ”¶é›†äº†å…±&lt;strong&gt; 4 ä¸ªäº¿çš„æ–‡æœ¬ - å›¾åƒå¯¹&lt;/strong&gt;ï¼Œè®ºæ–‡ç§°ä¹‹ä¸º &lt;code&gt;WIT(Web Image Text)&lt;/code&gt; ã€‚ &lt;code&gt;WIT&lt;/code&gt;  è´¨é‡å¾ˆé«˜ï¼Œè€Œä¸”æ¸…ç†çš„éå¸¸å¥½ï¼Œå…¶è§„æ¨¡ç›¸å½“äº &lt;code&gt;JFT-300M&lt;/code&gt; ï¼Œè¿™ä¹Ÿæ˜¯ &lt;code&gt;CLIP&lt;/code&gt;  å¦‚æ­¤å¼ºå¤§çš„åŸå› ä¹‹ä¸€ï¼ˆåç»­åœ¨ &lt;code&gt;WIT&lt;/code&gt;  ä¸Šè¿˜å­•è‚²å‡ºäº† &lt;code&gt;DALL-E&lt;/code&gt;  æ¨¡å‹ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;åˆ†ç±»&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;CLIP&lt;/code&gt;  å¯ä»¥ç›´æ¥å®ç° &lt;code&gt;zero-shot&lt;/code&gt;  çš„å›¾åƒåˆ†ç±»ï¼Œå³ä¸éœ€è¦ä»»ä½•è®­ç»ƒå’Œå¾®è°ƒï¼Œè¿™ä¹Ÿæ˜¯ &lt;code&gt;CLIP&lt;/code&gt;  äº®ç‚¹å’Œå¼ºå¤§ä¹‹å¤„ã€‚ç”¨ &lt;code&gt;CLIP&lt;/code&gt;  å®ç° &lt;code&gt;zero-shot&lt;/code&gt;  åˆ†ç±»åªéœ€è¦ç®€å•çš„ä¸¤æ­¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ¹æ®ä»»åŠ¡çš„åˆ†ç±»æ ‡ç­¾æ„å»ºæ¯ä¸ªç±»åˆ«çš„æè¿°æ–‡æœ¬&lt;/strong&gt;ï¼š &lt;code&gt;A photo of &amp;#123;label&amp;#125;&lt;/code&gt; ï¼Œç„¶åå°†è¿™äº›æ–‡æœ¬é€å…¥ &lt;code&gt;Text Encoder&lt;/code&gt;  å¾—åˆ°å¯¹åº”çš„æ–‡æœ¬ç‰¹å¾ã€‚å¦‚æœç±»åˆ«æ•°ç›®ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œé‚£ä¹ˆå°†å¾—åˆ°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ªæ–‡æœ¬ç‰¹å¾ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å°†è¦é¢„æµ‹çš„å›¾åƒé€å…¥ &lt;code&gt;Image Encoder&lt;/code&gt;  å¾—åˆ°å›¾åƒç‰¹å¾ï¼Œç„¶åä¸&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;n&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¸ªæ–‡æœ¬ç‰¹å¾è®¡ç®—ç¼©æ”¾çš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆå’Œè®­ç»ƒè¿‡ç¨‹ä¿æŒä¸€è‡´ï¼‰ï¼Œç„¶å&lt;strong&gt;é€‰æ‹©ç›¸ä¼¼åº¦æœ€å¤§çš„æ–‡æœ¬å¯¹åº”çš„ç±»åˆ«ä½œä¸ºå›¾åƒåˆ†ç±»é¢„æµ‹ç»“æœ&lt;/strong&gt;ã€‚è¿›ä¸€æ­¥åœ°ï¼Œå¯ä»¥å°†è¿™äº›ç›¸ä¼¼åº¦çœ‹æˆ &lt;code&gt;logits&lt;/code&gt; ï¼Œé€å…¥ &lt;code&gt;softmax&lt;/code&gt;  åå¯ä»¥åˆ°æ¯ä¸ªç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒæˆ‘ä»¬ä¸å†éœ€è¦é¢„å…ˆå®šä¹‰å¥½çš„æ ‡ç­¾ï¼ˆç±»åˆ«ï¼‰åˆ—è¡¨ï¼Œç›´æ¥å°†å›¾ç‰‡å–‚ç»™ä¸åŒçš„æ–‡æœ¬å¥å­ï¼Œå°±å¯ä»¥çŸ¥é“å›¾ç‰‡ä¸­æ˜¯å¦æœ‰æˆ‘ä»¬æ„Ÿå…´è¶£çš„ç‰©ä½“ã€‚å³ï¼Œ &lt;code&gt;CLIP&lt;/code&gt;  çš„å¤šæ¨¡æ€ç‰¹æ€§ï¼ˆåˆ©ç”¨æ–‡æœ¬ç›‘ç£ä¿¡å·ï¼‰ä¸ºå…·ä½“çš„ä»»åŠ¡æ„å»ºäº†åŠ¨æ€çš„åˆ†ç±»å™¨ï¼Œ&lt;strong&gt;ä½¿å¾—æ¨¡å‹ä¸å†å—é™äºé¢„å…ˆå®šä¹‰å¥½çš„ç±»åˆ«ï¼Œæ›´åŠ å…·æœ‰é€šç”¨æ€§å’Œå¯ç”¨æ€§&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;22-é¢„è®­ç»ƒæ–¹æ³•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-é¢„è®­ç»ƒæ–¹æ³•&#34;&gt;#&lt;/a&gt; 2.2 é¢„è®­ç»ƒæ–¹æ³•&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;CV&lt;/code&gt;  é¢†åŸŸçš„æ¨¡å‹éƒ½å¾ˆå¤§ï¼Œè®­ç»ƒèµ·æ¥ä¹Ÿå¾ˆè´µã€‚æ¯”å¦‚ &lt;code&gt;noise student&lt;/code&gt;  ä¹‹å‰åœ¨ &lt;code&gt;ImageNet&lt;/code&gt;  ä¸€ç›´éœ¸æ¦œï¼Œä½†æ˜¯è¿™ä¸ªæ¨¡å‹éœ€è¦åœ¨ä¸€ä¸ª &lt;code&gt;TPUv3&lt;/code&gt;  ä¸Šè®­ç»ƒ &lt;code&gt;33&lt;/code&gt;  å¹´ï¼Œè¿™è¿˜åªæ˜¯åœ¨åŒ…å« &lt;code&gt;1000&lt;/code&gt;  ç±»çš„ &lt;code&gt;ImageNet&lt;/code&gt;  ä¸Šé¢„è®­ç»ƒçš„ï¼Œè€Œä¸”åªè®­ç»ƒè§†è§‰ç‰¹å¾ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç”±äºè®­ç»ƒæ•°æ®é‡å’Œæ¨¡å‹è®¡ç®—é‡éƒ½å¾ˆå¤§ï¼Œè®­ç»ƒæ•ˆç‡æˆä¸ºä¸€ä¸ªè‡³å…³é‡è¦çš„å› ç´ ã€‚ä½œè€…åšäº†å¾ˆå¤šå°è¯•ï¼Œæœ€ç»ˆé€‰æ‹©äº†å¯¹æ¯”å­¦ä¹ ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;VirTex&lt;/code&gt;  æ¨¡å‹ï¼šé¢„æµ‹æ–‡æœ¬ï¼Œå¯¹åº”ä¸‹å›¾è“è‰²çº¿ &lt;code&gt;Transformer Language Model&lt;/code&gt; ï¼š &lt;code&gt;Image Encoder&lt;/code&gt;  ä½¿ç”¨ &lt;code&gt;CNN&lt;/code&gt;  æ¨¡å‹ï¼Œ &lt;code&gt;Text Encoder&lt;/code&gt;  ä½¿ç”¨ &lt;code&gt;transformer&lt;/code&gt;  æ¨¡å‹ï¼Œä¸¤ä¸ªæ¨¡å‹ä¸€èµ·ä»å¤´è®­ç»ƒï¼Œä»»åŠ¡æ˜¯é¢„æµ‹å›¾ç‰‡å¯¹åº”çš„æ–‡æœ¬ï¼ˆ &lt;code&gt;image caption&lt;/code&gt; ï¼‰ã€‚è¿™ç§æ–¹æ³•çš„è®­ç»ƒæ•ˆç‡å¤ªæ…¢ï¼Œå› ä¸ºæ ¹æ®å›¾ç‰‡è¿›è¡Œæ–‡æœ¬æè¿°ï¼Œå¯èƒ½æ€§å¤ªå¤šäº†ï¼Œä½ å¯ä»¥ä»å„ä¸ªè§’åº¦å»æè¿°ä¸€å¼ å›¾ç‰‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Bag of Words Prediction&lt;/code&gt; ï¼ˆæ©˜è‰²çº¿ï¼‰ï¼šä¸è¦æ±‚æ¯ä¸ªè¯éƒ½æ˜¯æŒ‰é¡ºåºçš„è¿›è¡Œé¢„æµ‹ï¼Œæ‰€æœ‰è¯éƒ½é¢„æµ‹å‡ºæ¥å°±è¡Œã€‚è¿™æ ·æ”¾å®½äº†çº¦æŸï¼Œè®­ç»ƒé€Ÿåº¦æé«˜äº†ä¸‰å€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;CLIP&lt;/code&gt; ï¼šç®€åŒ–ç‰ˆçš„ &lt;code&gt;ConVIRT&lt;/code&gt; ï¼ŒåŸºäºå¯¹æ¯”å­¦ä¹ ã€‚åªéœ€è¦åˆ¤æ–­å›¾æ–‡æ˜¯å¦é…å¯¹ï¼Œè¿›ä¸€æ­¥ç®€åŒ–äº†è®­ç»ƒä»»åŠ¡ï¼Œè®­ç»ƒæ•ˆç‡ä¸€ä¸‹å­æå‡ &lt;code&gt;4&lt;/code&gt;  å€ï¼ˆç»¿è‰²çº¿ï¼‰è®­ç»ƒä»»åŠ¡æ›´åŠ åˆç†ã€‚å› ä¸ºè®­ç»ƒæ•°æ®æ‰€åŒ…å«çš„æ–‡æœ¬ - å›¾åƒå¯¹æ˜¯ä»äº’è”ç½‘æ”¶é›†æ¥çš„ï¼Œå®ƒä»¬å­˜åœ¨ä¸€å®šçš„å™ªéŸ³ï¼ŒäºŒè€…å¹¶ä¸å®Œå…¨åŒ¹é…ã€‚é€‚å½“çš„é™ä½è®­ç»ƒç›®æ ‡ï¼Œåè€Œèƒ½å–å¾—æ›´å¥½çš„æ”¶æ•›ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/CLIP/2.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;(1)  &lt;code&gt;Text Encoder&lt;/code&gt;  æ¶æ„&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆ &lt;code&gt;Text Encoder&lt;/code&gt;  å›ºå®šé€‰æ‹©ä¸€ä¸ªåŒ…å« &lt;code&gt;63M&lt;/code&gt;  å‚æ•°çš„ &lt;code&gt;text transformer&lt;/code&gt;  æ¨¡å‹ï¼Œ&lt;/p&gt;
&lt;p&gt;(2)  &lt;code&gt;Image Encoder&lt;/code&gt;  æ¶æ„&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;ResNet&lt;/code&gt; ï¼š &lt;code&gt;ResNet50&lt;/code&gt; ï¼Œ &lt;code&gt;ResNet101&lt;/code&gt; ï¼Œ &lt;code&gt;RN50x4&lt;/code&gt; ï¼Œ &lt;code&gt;RN50x16&lt;/code&gt;  å’Œ &lt;code&gt;RNx64&lt;/code&gt; ï¼ˆåé¢ä¸‰ä¸ªæ¨¡å‹æ˜¯æŒ‰ç…§ &lt;code&gt;EfficientNet&lt;/code&gt;  ç¼©æ”¾è§„åˆ™å¯¹ &lt;code&gt;ResNet&lt;/code&gt;  åˆ†åˆ«å¢å¤§ &lt;code&gt;4x&lt;/code&gt; ï¼Œ &lt;code&gt;16x&lt;/code&gt;  å’Œ &lt;code&gt;64x&lt;/code&gt;  å¾—åˆ°ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;ViT&lt;/code&gt; ï¼š &lt;code&gt;ViT-B/32&lt;/code&gt; ï¼Œ &lt;code&gt;ViT-B/16&lt;/code&gt;  å’Œ &lt;code&gt;ViT-L/14&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(3) æ‰€æœ‰çš„æ¨¡å‹éƒ½è®­ç»ƒ 32 ä¸ª epochsï¼Œé‡‡ç”¨ AdamW ä¼˜åŒ–å™¨ï¼Œbatch size=32768&lt;/p&gt;
&lt;p&gt;(4) åªåœ¨ ResNet50 ä¸Šè®­ç»ƒä¸€ä¸ª epoch è¿›è¡Œè¶…å‚æœç´¢ï¼Œæ²¡æœ‰è¿›è¡Œè¿›ä¸€æ­¥çš„è°ƒå‚&lt;/p&gt;
&lt;p&gt;(5) &lt;strong&gt;æ•°æ®é›†éå¸¸å¤§ï¼Œå‡ ä¹ä¸ä¼šå‡ºç°è¿‡æ‹Ÿåˆï¼Œæ‰€ä»¥ Image Encoder å’Œ Text Encoder ä¸éœ€è¦æå‰è¿›è¡Œé¢„è®­ç»ƒ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;(6) åªä½¿ç”¨çº¿æ€§æŠ•å°„å±‚ï¼ˆçº¿æ€§éçº¿æ€§å½±å“ä¸å¤§ï¼‰&lt;/p&gt;
&lt;p&gt;(7) æ•°æ®å¢å¼ºåªä½¿ç”¨å›¾ç‰‡çš„éšæœºå‰ªè£ï¼Œè¿™æ˜¯å› ä¸ºæ•°æ®é›†éå¸¸å¤§&lt;/p&gt;
&lt;p&gt;(8) å¯¹æ¯”å­¦ä¹ ç›®æ ‡å‡½æ•°ä¸­çš„è¶…å‚æ•° Ï„ï¼Œè®¾ç½®æˆå¯å­¦ä¹ çš„æ ‡é‡ï¼Œåœ¨è®­ç»ƒä¸­è‡ªåŠ¨ä¼˜åŒ–ï¼Œè€Œä¸ç”¨æ…¢æ…¢è°ƒå‚ï¼ˆè¿˜æ˜¯å› ä¸ºæ•°æ®é›†å¤ªå¤§ï¼Œè®­ç»ƒå¾ˆè´µï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;23-ä¼ªä»£ç &#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-ä¼ªä»£ç &#34;&gt;#&lt;/a&gt; 2.3 ä¼ªä»£ç &lt;/h2&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# image_encoder - ResNet or Vision Transformer&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# text_encoder - CBOW or Text Transformer&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# I [n, h, w, c] - è¾“å…¥å›¾ç‰‡ç»´åº¦&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# T [n, l] - è¾“å…¥æ–‡æœ¬ç»´åº¦ï¼Œl è¡¨ç¤ºåºåˆ—é•¿åº¦&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# W_i[d_i, d_e] - learned proj of image to embed&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# W_t[d_t, d_e] - learned proj of text to embed&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# t - learned temperature parameter&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#  åˆ†åˆ«æå–å›¾åƒç‰¹å¾å’Œæ–‡æœ¬ç‰¹å¾&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;I_f &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; image_encoder&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;I&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;#[n, d_i]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;T_f &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; text_encoder&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;T&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;#[n, d_t]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å¯¹ä¸¤ä¸ªç‰¹å¾è¿›è¡Œçº¿æ€§æŠ•å°„ï¼Œå¾—åˆ°ç›¸åŒç»´åº¦çš„ç‰¹å¾ d_eï¼Œå¹¶è¿›è¡Œ l2 å½’ä¸€åŒ–ï¼Œä¿æŒæ•°æ®å°ºåº¦çš„ä¸€è‡´æ€§&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å¤šæ¨¡æ€ embedding [n, d_e]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;I_e &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; l2_normalize&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dot&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;I_f&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; W_i&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;T_e &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; l2_normalize&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dot&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;T_f&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; W_t&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# è®¡ç®—ç¼©æ”¾çš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼š[n, n]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;logits &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dot&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;I_e&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; T_e&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;T&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;exp&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;t&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# symmetric loss function&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;labels &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; np&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;arange&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;n&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;#  å¯¹è§’çº¿å…ƒç´ çš„ labels&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;loss_i &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cross_entropy_loss&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;logits&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; labels&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# image loss&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;loss_t &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; cross_entropy_loss&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;logits&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; labels&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; axis&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# text loss&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;loss &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;loss_i &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; loss_t&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;# å¯¹ç§°å¼çš„ç›®æ ‡å‡½æ•°&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒåœ¨ &lt;code&gt;MOCO&lt;/code&gt;  ä¸­ï¼ŒçœŸå®æ ‡ç­¾éƒ½æ˜¯ &lt;code&gt;0&lt;/code&gt; ï¼Œå› ä¸ºå…¶æ­£æ ·æœ¬éƒ½æ˜¯æ”¾åœ¨ç¬¬ä¸€ä½ï¼Œæ‰€ä»¥æ­£æ ·æœ¬å¯¹åº”çš„ç´¢å¼•æ°¸è¿œæ˜¯ &lt;code&gt;0&lt;/code&gt; ï¼›ä½†æ˜¯åœ¨ &lt;code&gt;CLIP&lt;/code&gt;  ä¸­ï¼Œæ­£æ ·æœ¬éƒ½æ˜¯åœ¨å¯¹è§’çº¿ä¸Šï¼Œå³&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mo&gt;â€¦&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;I_1,T_1,I_2,T_2,\dots&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8777699999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07847em;&#34;&gt;I&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07847em;&#34;&gt;I&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;â€¦&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œæ‰€ä»¥çœŸå®æ ‡ç­¾ä¸º &lt;code&gt;np.arange(n)&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-å‚è€ƒç¨‹åº&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-å‚è€ƒç¨‹åº&#34;&gt;#&lt;/a&gt; ä¸‰ã€å‚è€ƒç¨‹åº&lt;/h1&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9odWdnaW5nZmFjZS5jby9vcGVuYWkvY2xpcC12aXQtbGFyZ2UtcGF0Y2gxNA==&#34;&gt;https://huggingface.co/openai/clip-vit-large-patch14&lt;/span&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; PIL &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; Image&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; transformers &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; CLIPProcessor&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; CLIPModel&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; CLIPModel&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;from_pretrained&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;E:/python/else/LLM_learn/4_CLIP/model&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;processor &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; CLIPProcessor&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;from_pretrained&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;E:/python/else/LLM_learn/4_CLIP/model&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;image &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Image&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;1.jpg&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;inputs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; processor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;text&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;a photo of a cat&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;a photo of a dog&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; images&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;image&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; return_tensors&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;pt&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; padding&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;outputs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; model&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;**&lt;/span&gt;inputs&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;logits_per_image &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; outputs&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;logits_per_image  &lt;span class=&#34;token comment&#34;&gt;# this is the image-text similarity score&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;logits_per_image&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;probs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; logits_per_image&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;softmax&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# we can take the softmax to get the label probabilities&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;probs&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/08/26/AI/DiffusionModel/</guid>
            <title>æ‰©æ•£æ¨¡å‹</title>
            <link>http://qianqiu-cell.github.io/2024/08/26/AI/DiffusionModel/</link>
            <category>AI</category>
            <pubDate>Mon, 26 Aug 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RGQ0VEL2FydGljbGUvZGV0YWlscy8xMzIzOTQ4OTU=&#34;&gt;https://blog.csdn.net/DFCED/article/details/132394895&lt;/span&gt;ã€&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVFBZXhlaUVaSz9wPTImYW1wO3ZkX3NvdXJjZT1lMDExNzJlYTI5MmMxYzYwNWIzNDYxMDFkNzAwNmM2MQ==&#34;&gt;https://www.bilibili.com/video/BV1QAexeiEZK?p=2&amp;amp;vd_source=e01172ea292c1c605b346101d7006c61&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ‰©æ•£æ¦‚ç‡æ¨¡å‹ï¼ˆä¸ºç®€æ´èµ·è§ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º â€œæ‰©æ•£æ¨¡å‹â€ï¼‰æ˜¯ä¸€ç§é€šè¿‡å‚æ•°åŒ–çš„é©¬å°”ç§‘å¤«é“¾ï¼Œå¹¶ä½¿ç”¨å˜åˆ†æ¨æ–­è¿›è¡Œè®­ç»ƒï¼Œä»¥åœ¨æœ‰é™æ—¶é—´åç”Ÿæˆä¸æ•°æ®ç›¸åŒ¹é…çš„æ ·æœ¬ã€‚è¯¥é“¾çš„è½¬æ¢è¿‡ç¨‹æ—¨åœ¨å­¦ä¹ é€†å‘æ‰©æ•£è¿‡ç¨‹ï¼Œå³ä¸€ä¸ªé©¬å°”ç§‘å¤«é“¾ï¼Œè¯¥é“¾é€æ­¥å‘æ•°æ®ä¸­æ·»åŠ å™ªå£°ï¼Œæ–¹å‘ä¸é‡‡æ ·ç›¸åï¼Œç›´åˆ°ä¿¡å·å®Œå…¨è¢«ç ´åã€‚&lt;/p&gt;
&lt;h1 id=&#34;ä¸€-ç›´è§‚ç†è§£&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-ç›´è§‚ç†è§£&#34;&gt;#&lt;/a&gt; ä¸€ã€ç›´è§‚ç†è§£&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒä»æ¦‚ç‡åˆ†å¸ƒè§’åº¦æ¥çœ‹ï¼Œè€ƒè™‘ä¸‹å›¾ç‘å£«å·å½¢çŠ¶çš„äºŒç»´è”åˆæ¦‚ç‡åˆ†å¸ƒ P (x,y)ï¼Œæ‰©æ•£è¿‡ç¨‹ q éå¸¸ç›´è§‚ï¼Œæœ¬æ¥é›†ä¸­æœ‰åºçš„æ ·æœ¬ç‚¹ï¼Œå—åˆ°å™ªå£°çš„æ‰°åŠ¨ï¼Œå‘å¤–æ‰©æ•£ï¼Œæœ€ç»ˆå˜æˆä¸€ä¸ªå®Œå…¨æ— åºçš„å™ªå£°åˆ†å¸ƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/DiffusionModel/1.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè€Œ diffusion model è¡¨ç¤ºä¸Šå›¾çš„é€†è¿‡ç¨‹ pï¼Œå°†ä¸€ä¸ªå™ªå£°åˆ†å¸ƒ N (0,1) é€æ­¥çš„å»å™ªä»¥æ˜ å°„åˆ°åŸå§‹å›¾åƒã€‚æœ‰äº†è¿™æ ·çš„æ˜ å°„ï¼Œå°±å¯ä»¥ä»å™ªå£°åˆ†å¸ƒä¸­é‡‡æ ·ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€å¼ æƒ³è¦çš„å›¾åƒï¼Œä¹Ÿå°±æ˜¯å®Œæˆäº†ç”Ÿæˆçš„ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒDiffusion Models ç”±æ­£å‘è¿‡ç¨‹ï¼ˆæˆ–æ‰©æ•£è¿‡ç¨‹ï¼‰å’Œåå‘è¿‡ç¨‹ï¼ˆæˆ–é€†æ‰©æ•£è¿‡ç¨‹ï¼‰ç»„æˆï¼Œå…¶ä¸­è¾“å…¥æ•°æ®é€æ¸è¢«å™ªå£°åŒ–ï¼Œç„¶åå™ªå£°è¢«è½¬æ¢å›æºç›®æ ‡åˆ†å¸ƒçš„æ ·æœ¬ã€‚ä»å•ä¸ªå›¾åƒæ ·æœ¬æ¥çœ‹è¿™ä¸ªè¿‡ç¨‹ï¼Œæ‰©æ•£è¿‡ç¨‹ q å°±æ˜¯ä¸æ–­å‘å›¾åƒä¸ŠåŠ å™ªå£°ï¼Œç›´åˆ°å›¾åƒå˜æˆä¸€ä¸ªçº¯å™ªå£°ï¼Œé€†æ‰©æ•£è¿‡ç¨‹ p å°±æ˜¯ä»çº¯å™ªå£°ç”Ÿæˆä¸€å¼ å›¾åƒçš„è¿‡ç¨‹ã€‚ä¸‹å›¾è¡¨ç¤ºäº†å•ä¸ªæ ·æœ¬å›¾åƒçš„å˜åŒ–ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/DiffusionModel/1.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸€äº›ç›¸å…³çš„æ¦‚å¿µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åéªŒæ¦‚ç‡ï¼šåœ¨è´å¶æ–¯ç»Ÿè®¡ä¸­ï¼Œä¸€ä¸ªéšæœºäº‹ä»¶æˆ–è€…ä¸€ä¸ªä¸ç¡®å®šäº‹ä»¶çš„åéªŒæ¦‚ç‡ï¼ˆPosterior probabilityï¼‰æ˜¯åœ¨è€ƒè™‘å’Œç»™å‡ºç›¸å…³è¯æ®æˆ–æ•°æ®åæ‰€å¾—åˆ°çš„æ¡ä»¶æ¦‚ç‡ã€‚&lt;/li&gt;
&lt;li&gt;é©¬å°”å¯å¤«é“¾ï¼šä¸ºçŠ¶æ€ç©ºé—´ä¸­ç»è¿‡ä»ä¸€ä¸ªçŠ¶æ€åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„è½¬æ¢çš„éšæœºè¿‡ç¨‹ã€‚è¯¥è¿‡ç¨‹è¦æ±‚å…·å¤‡ â€œæ— è®°å¿†â€ çš„æ€§è´¨ï¼šä¸‹ä¸€çŠ¶æ€çš„æ¦‚ç‡åˆ†å¸ƒåªèƒ½ç”±å½“å‰çŠ¶æ€å†³å®šï¼Œåœ¨æ—¶é—´åºåˆ—ä¸­å®ƒå‰é¢çš„äº‹ä»¶å‡ä¸ä¹‹æ— å…³ã€‚è¿™ç§ç‰¹å®šç±»å‹çš„ â€œæ— è®°å¿†æ€§ â€œç§°ä½œé©¬å¯å¤«æ€§è´¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äºŒ-å‰å‘è¿‡ç¨‹æ‰©æ•£è¿‡ç¨‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-å‰å‘è¿‡ç¨‹æ‰©æ•£è¿‡ç¨‹&#34;&gt;#&lt;/a&gt; äºŒã€å‰å‘è¿‡ç¨‹ï¼ˆæ‰©æ•£è¿‡ç¨‹ï¼‰&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒæ‰€è°“å‰å‘è¿‡ç¨‹ï¼Œå³å¾€å›¾ç‰‡ä¸ŠåŠ å™ªå£°çš„è¿‡ç¨‹ã€‚è™½ç„¶è¿™ä¸ªæ­¥éª¤æ— æ³•åšåˆ°å›¾ç‰‡ç”Ÿæˆï¼Œä½†æ˜¯è¿™æ˜¯ç†è§£ diffusion model ä»¥åŠæ„å»ºè®­ç»ƒæ ·æœ¬è‡³å…³é‡è¦çš„ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç»™å®šçœŸå®å›¾ç‰‡æ ·æœ¬ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_{0}\sim q(x)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œdiffusion å‰å‘è¿‡ç¨‹é€šè¿‡&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;T&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ¬¡ç´¯è®¡å¯¹å…¶æ·»åŠ é«˜æ–¯å™ªå£°ï¼Œå¾—åˆ°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;ï¼Œ&lt;/mtext&gt;&lt;mo&gt;â€¦&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_1, x_2ï¼Œ\dots, x_T&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8777699999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ï¼Œ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;â€¦&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå¦‚ä¸‹å›¾çš„ q è¿‡ç¨‹ã€‚æ¯ä¸€æ­¥çš„å¤§å°æ˜¯ç”±ä¸€ç³»åˆ—çš„é«˜æ–¯åˆ†å¸ƒæ–¹å·®çš„è¶…å‚æ•°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆˆ&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mo stretchy=&#34;false&#34;&gt;}&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\{\beta_t\in(0,1)\}_{t=1}^T&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆˆ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0913309999999998em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;mclose&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8413309999999999em;&#34;&gt;&lt;span style=&#34;top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.24810799999999997em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ¥æ§åˆ¶çš„ã€‚å‰å‘è¿‡ç¨‹ç”±äºæ¯ä¸ªæ—¶åˆ»&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.61508em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; åªä¸&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;t-1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69841em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ—¶åˆ»æœ‰å…³ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥çœ‹åšé©¬å°”ç§‘å¤«è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;;&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;I&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q(x_t|x_{t-1})=\mathcal{N}(x_t;\sqrt{1-\beta_t}x_{t-1},\beta_t\mathbf{I})
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.24em;vertical-align:-0.25612499999999994em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.983875em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3.2em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.2em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:1em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.9438750000000002em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.2em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:1.02em;height:1.28em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.28em&#39; viewBox=&#39;0 0 400000 1296&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.25612499999999994em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;I&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;âˆ&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q(x_{1:T}|x_0)=\prod_{t=1}^Tq(x_t|x_{t-1})
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.0954490000000003em;vertical-align:-1.267113em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8283360000000002em;&#34;&gt;&lt;span style=&#34;top:-1.882887em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.050005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;âˆ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.3000050000000005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.267113em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œéšç€&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.61508em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; çš„å¢å¤§ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¶Šæ¥è¶Šæ¥è¿‘çº¯å™ªå£°ã€‚å½“&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;â‡’&lt;/mo&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;T\Rightarrow \infty&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;â‡’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_T&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ˜¯å®Œå…¨çš„é«˜æ–¯å™ªå£°ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå‰å‘è¿‡ç¨‹ä»‹ç»ç»“æŸå‰ï¼Œéœ€è¦è®²è¿°ä¸€ä¸‹ diffusion åœ¨å®ç°å’Œæ¨å¯¼è¿‡ç¨‹ä¸­è¦ç”¨åˆ°çš„ä¸¤ä¸ªé‡è¦ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç‰¹æ€§ 1ï¼šé‡å‚æ•° ï¼ˆreparameterization trickï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒé‡å‚æ•°æŠ€å·§åœ¨å¾ˆå¤šå·¥ä½œï¼ˆgumbel softmax, VAEï¼‰ä¸­æœ‰æ‰€å¼•ç”¨ã€‚å¦‚æœæˆ‘ä»¬è¦ä»æŸä¸ªåˆ†å¸ƒä¸­éšæœºé‡‡æ ·ï¼ˆé«˜æ–¯åˆ†å¸ƒï¼‰ä¸€ä¸ªæ ·æœ¬ï¼Œ&lt;mark&gt;è¿™ä¸ªè¿‡ç¨‹æ˜¯æ— æ³•åä¼ æ¢¯åº¦çš„&lt;/mark&gt;ã€‚è€Œè¿™ä¸ªé€šè¿‡é«˜æ–¯å™ªå£°é‡‡æ ·å¾—åˆ°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; çš„è¿‡ç¨‹åœ¨ diffusion ä¸­åˆ°å¤„éƒ½æ˜¯ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é€šè¿‡é‡å‚æ•°æŠ€å·§æ¥ä½¿å¾—ä»–å¯å¾®ã€‚æœ€é€šå¸¸çš„åšæ³•æ˜¯æŠŠéšæœºæ€§é€šè¿‡ä¸€ä¸ªç‹¬ç«‹çš„éšæœºå˜é‡ï¼ˆ$\epsilon &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtext&gt;ï¼‰å¼•å¯¼è¿‡å»ã€‚å³å¦‚æœè¦ä»é«˜æ–¯åˆ†å¸ƒ&lt;/mtext&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;ï¼‰å¼•å¯¼è¿‡å»ã€‚å³å¦‚æœè¦ä»é«˜æ–¯åˆ†å¸ƒ&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ï¼‰&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å¼•&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å¯¼&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;è¿‡&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å»&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ã€‚&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å³&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å¦‚&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æœ&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;è¦&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ä»&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;é«˜&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ–¯&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;åˆ†&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å¸ƒ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; z\sim\mathcal&lt;ruby&gt;N}(z;\mu_\theta,\sigma_\theta&lt;rp&gt;ã€&lt;/rp&gt;&lt;rt&gt;2\mathbf{I&lt;/rt&gt;&lt;rp&gt;ã€‘&lt;/rp&gt;&lt;/ruby&gt;)&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtext&gt;é‡‡æ ·ä¸€ä¸ª&lt;/mtext&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;é‡‡æ ·ä¸€ä¸ª&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;é‡‡&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;æ ·&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ä¸€&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ä¸ª&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; z$ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Î¼&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ïƒ&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âŠ™&lt;/mo&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;I&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;z=\mu_\theta+\sigma_\theta\odot\epsilon,\epsilon\sim\mathcal{N}(0,\mathbf{I})
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.04398em;&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.7777700000000001em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Î¼&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.73333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ïƒ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âŠ™&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;I&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸Šå¼çš„&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;z&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.04398em;&#34;&gt;z&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä¾æ—§æ˜¯æœ‰éšæœºæ€§çš„ï¼Œä¸”æ»¡è¶³å‡å€¼ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Î¼&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mu_\theta&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Î¼&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ–¹å·®ä¸º&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Ïƒ&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\sigma_\theta&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ïƒ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; çš„é«˜æ–¯åˆ†å¸ƒã€‚è¿™é‡Œçš„&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Î¼&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mu_\theta&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Î¼&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Ïƒ&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\sigma_\theta&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;Ïƒ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å¯ä»¥æ˜¯ç”±ç¥ç»ç½‘ç»œæ¨æ–­å¾—åˆ°çš„ã€‚æ•´ä¸ª â€œé‡‡æ ·â€ è¿‡ç¨‹ä¾æ—§æ¢¯åº¦å¯å¯¼ï¼Œéšæœºæ€§è¢«è½¬å«åˆ°äº† $\epsilon $ ä¸Šã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç‰¹å¾ 2ï¼šä»»æ„æ—¶åˆ»çš„&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å¯ç”±&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_0&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\beta_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¡¨ç¤º&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨å‰å‘è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªæ€§è´¨éå¸¸æ£’ï¼Œå°±æ˜¯æˆ‘ä»¬å…¶å®å¯ä»¥é€šè¿‡&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_0&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\beta_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ç›´æ¥å¾—åˆ°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚é¦–å…ˆæˆ‘ä»¬ä»¤&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\alpha_t=1-\beta_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.72777em;vertical-align:-0.08333em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå¹¶ä¸”&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;true&#34;&gt;â€¾&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;âˆ&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\overline{\alpha}_t=\prod_{i=1}^t\alpha_i&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.78056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord overline&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.63056em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.55056em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;overline-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.233166em;vertical-align:-0.29971000000000003em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;&lt;span class=&#34;mop op-symbol small-op&#34; style=&#34;position:relative;top:-0.0000050000000000050004em;&#34;&gt;âˆ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.933456em;&#34;&gt;&lt;span style=&#34;top:-2.40029em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2029em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.29971000000000003em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31166399999999994em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå±•å¼€&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å¯ä»¥å¾—åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mtable rowspacing=&#34;0.24999999999999992em&#34; columnalign=&#34;right left&#34; columnspacing=&#34;0em&#34;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold-italic&#34;&gt;Ïµ&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi mathvariant=&#34;bold-italic&#34;&gt;Ïµ&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;â€¦&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mi mathvariant=&#34;bold-italic&#34;&gt;Ïµ&lt;/mi&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\begin{aligned}
\mathbf{x}_{t}&amp;amp; =\sqrt{\alpha_t}\mathbf{x}_{t-1}+\sqrt{1-\alpha_t}\boldsymbol{\epsilon}_{t-1} \\
&amp;amp;=\sqrt{\alpha_t\alpha_{t-1}}\mathbf{x}_{t-2}+\sqrt{1-\alpha_t\alpha_{t-1}}\bar{\boldsymbol{\epsilon}}_{t-2} \\
&amp;amp;=\ldots \\
&amp;amp;=\sqrt{\bar{\alpha}_t}\mathbf{x}_0+\sqrt{1-\bar{\alpha}_t}\boldsymbol{\epsilon}
\end{aligned}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:6.194119500000001em;vertical-align:-2.8470597500000006em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mtable&#34;&gt;&lt;span class=&#34;col-align-r&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:3.3470597500000006em;&#34;&gt;&lt;span style=&#34;top:-5.46596475em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.8540352500000004em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.35403525em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-0.8129402499999996em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:2.8470597500000006em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;col-align-l&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:3.3470597500000006em;&#34;&gt;&lt;span style=&#34;top:-5.46596475em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.774155em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.734155em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.265845em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8810950000000001em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.841095em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15890499999999996em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord boldsymbol&#34;&gt;Ïµ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.8540352500000004em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7449895em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.7049895em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2950105em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9519294999999999em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3.2em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.2em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:1em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.9119295000000003em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.2em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:1.02em;height:1.28em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.28em&#39; viewBox=&#39;0 0 400000 1296&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2880705000000001em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.58122em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord boldsymbol&#34;&gt;Ïµ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.01344em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.25em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.35403525em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;â€¦&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-0.8129402499999996em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.842765em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.56778em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.802765em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.19723500000000005em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8810950000000001em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.56778em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.841095em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15890499999999996em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord boldsymbol&#34;&gt;Ïµ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:2.8470597500000006em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå› æ­¤ï¼Œä»»æ„æ—¶åˆ»çš„&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ»¡è¶³ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;;&lt;/mo&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;I&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q(\mathbf{x}_t|\mathbf{x}_0)=\mathcal{N}(\mathbf{x}_t;\sqrt{\bar{\alpha}_t}\mathbf{x}_0,(1-\bar{\alpha}_t)\mathbf{I})
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.092765em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.842765em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.56778em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.802765em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.19723500000000005em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.56778em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;I&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-åå‘è¿‡ç¨‹é€†æ‰©æ•£è¿‡ç¨‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-åå‘è¿‡ç¨‹é€†æ‰©æ•£è¿‡ç¨‹&#34;&gt;#&lt;/a&gt; ä¸‰ã€åå‘è¿‡ç¨‹ï¼ˆé€†æ‰©æ•£è¿‡ç¨‹ï¼‰&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒå¦‚æœè¯´å‰å‘è¿‡ç¨‹ï¼ˆforwardï¼‰æ˜¯åŠ å™ªçš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆé€†å‘è¿‡ç¨‹ï¼ˆreverseï¼‰ å°±æ˜¯ diffusion çš„å»å™ªæ¨æ–­è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿé€†è½¬ä¸Šè¿°è¿‡ç¨‹å¹¶ä»&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;âˆ£&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q(x_{t-1}\mid x_t)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; é‡‡æ ·ï¼Œå°±å¯ä»¥ä»é«˜æ–¯å™ªå£°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;I&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_{T}\sim\mathcal{N}(0,\mathbf{I})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;I&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¿˜åŸå‡ºåŸå›¾åˆ†å¸ƒ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_0 \sim q(x)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ã€‚åœ¨æ–‡çŒ® 7 ä¸­è¯æ˜äº†å¦‚æœ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆ£&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q(x_{t}\mid x_{t-1})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æ»¡è¶³é«˜æ–¯åˆ†å¸ƒä¸”&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\beta_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; è¶³å¤Ÿå°ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;âˆ£&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q(x_{t-1}\mid x_t)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; ä»ç„¶æ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒã€‚ç„¶è€Œæˆ‘ä»¬æ— æ³•ç®€å•æ¨æ–­&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;âˆ£&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q(x_{t-1}\mid x_t)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆå‚æ•°åŠ›&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\theta&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œç›®å‰ä¸»æµæ˜¯ U-Net + attention çš„ç»“æ„ï¼‰å»é¢„æµ‹è¿™æ ·çš„ä¸€ä¸ªé€†å‘çš„åˆ†å¸ƒ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;p_{\theta}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼ˆç±»ä¼¼ VAEï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;âˆ&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;;&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;p_\theta(x_{0:T})=p(x_T)\prod_{t=1}^Tp_\theta(x_{t-1}|x_t);
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.0954490000000003em;vertical-align:-1.267113em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8283360000000002em;&#34;&gt;&lt;span style=&#34;top:-1.882887em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.050005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;âˆ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.3000050000000005em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.267113em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Î¼&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;Î£&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;.&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;p_\theta(x_{t-1}|x_t)=\mathcal{N}(x_{t-1};\mu_\theta(x_t,t),\Sigma_\theta(x_t,t)).
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Î¼&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Î£&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç”±æ­¤å¯ä»¥å‘ç°å…¶å®æ­£å‘æ‰©æ•£å’Œé€†æ‰©æ•£è¿‡ç¨‹éƒ½æ˜¯é©¬å°”å¯å¤«ï¼Œç„¶åæ­£æ€åˆ†å¸ƒï¼Œç„¶åä¸€æ­¥ä¸€æ­¥æ¡ä»¶æ¦‚ç‡çš„æ¡†æ¶ã€‚å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æ­£å‘æ‰©æ•£é‡Œæ¯ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡çš„é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®éƒ½æ˜¯&lt;br&gt;
å·²ç»ç¡®å®šçš„ï¼ˆä¾èµ–äº&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\beta_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_0&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼‰ï¼Œè€Œé€†æ‰©æ•£è¿‡ç¨‹é‡Œé¢çš„å‡å€¼å’Œæ–¹å·®æ˜¯æˆ‘ä»¬ç½‘ç»œè¦å­¦å‡ºæ¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é€†æ‰©æ•£æ¡ä»¶æ¦‚ç‡æ¨å¯¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#é€†æ‰©æ•£æ¡ä»¶æ¦‚ç‡æ¨å¯¼&#34;&gt;#&lt;/a&gt; é€†æ‰©æ•£æ¡ä»¶æ¦‚ç‡æ¨å¯¼&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒè™½ç„¶æˆ‘ä»¬æ— æ³•å¾—åˆ°é€†è½¬è¿‡ç¨‹çš„æ¦‚ç‡åˆ†å¸ƒ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;âˆ£&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q(x_{t-1}\mid x_t)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œä½†æ˜¯å¦‚æœçŸ¥é“&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_0&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;âˆ£&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q(x_{t-1}\mid x_t,x_0)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å°±å¯ä»¥ç›´æ¥å†™å‡ºï¼Œå¤§æ¦‚å½¢å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;;&lt;/mo&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î¼&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;I&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;q(x_{t-1}|x_t,x_0)=\mathcal{N}(x_{t-1};\tilde{\mu}(x_t,x_0),\tilde{\beta}_t\mathbf{I})
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.1812999999999998em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Î¼&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.19444em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9312999999999998em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.61344em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.16666em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.19444em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;I&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé€šè¿‡ä¸€å®šçš„è®¡ç®—å¯ä»¥å¾—åˆ°ä¸Šå¼ä¸­çš„å‡å€¼å’Œæ–¹å·®ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;â‹…&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tilde{\beta}_t=\frac{1-\bar{\alpha}_{t-1}}{1-\bar{\alpha}_t}\cdot\beta_t
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.1257399999999997em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9312999999999998em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.61344em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.16666em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.19444em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.1574400000000002em;vertical-align:-0.8360000000000001em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.3139999999999996em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.56778em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.56778em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.301108em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.208331em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8360000000000001em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;â‹…&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8888799999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î¼&lt;/mi&gt;&lt;mo&gt;~&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;true&#34;&gt;â€¾&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\tilde{\mu}_t=\frac1{\sqrt{\alpha_t}}(x_t-\frac{1-\alpha_t}{\sqrt{1-\overline{\alpha}_t}}\epsilon_t)
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8622999999999998em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6678599999999999em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Î¼&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.35em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;~&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.19444em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.3221600000000002em;vertical-align:-1.00072em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.72528em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.68528em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31472em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.00072em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.25144em;vertical-align:-0.93em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.27778em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8322200000000001em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord overline&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.63056em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.55056em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;overline-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.79222em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.20777999999999996em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.93em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¯ä»¥çœ‹å‡ºï¼Œåœ¨ç»™å®š&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_0&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; çš„æ¡ä»¶ä¸‹ï¼ŒåéªŒæ¡ä»¶é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼åªå’Œè¶…å‚æ•°ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œ&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\epsilon&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; æœ‰å…³ï¼Œæ–¹å·®åªä¸è¶…å‚æ•°æœ‰å…³ã€‚&lt;/p&gt;
&lt;h1 id=&#34;å››-è®­ç»ƒæŸå¤±&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å››-è®­ç»ƒæŸå¤±&#34;&gt;#&lt;/a&gt; å››ã€è®­ç»ƒæŸå¤±&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒäº†è§£äº†ä¸Šè¿°é€†æ‰©æ•£è¿‡ç¨‹ä¹‹åï¼Œå¦‚ä½•è®­ç»ƒ Diffusion Models ä»¥æ±‚å¾—åéªŒæ¡ä»¶é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Î¼&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mu_{\theta}(x_t,t)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Î¼&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å’Œæ–¹å·®&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;Î£&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\Sigma_{\theta}(x_t,t)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Î£&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äºçœŸå®çš„è®­ç»ƒæ ·æœ¬æ•°æ®å·²çŸ¥ï¼Œè¦æ±‚æ¨¡å‹çš„å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚Diffusion Models é€šè¿‡æå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæ¥æ‰¾åˆ°é€†æ‰©æ•£è¿‡ç¨‹ä¸­é©¬å°”å¯å¤«é“¾è½¬æ¢çš„æ¦‚ç‡åˆ†å¸ƒï¼Œè¿™å°±æ˜¯ Diffusion Models çš„è®­ç»ƒç›®çš„ã€‚å³æœ€å¤§åŒ–æ¨¡å‹é¢„æµ‹åˆ†å¸ƒçš„å¯¹æ•°ä¼¼ç„¶ï¼Œä» Loss ä¸‹é™çš„è§’åº¦å°±æ˜¯æœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;script&#34;&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;E&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;[&lt;/mo&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;â¡&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathcal{L}=\mathbb{E}_q[-\log p_\theta(x_0)]
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34;&gt;L&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.036108em;vertical-align:-0.286108em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;E&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15139200000000003em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;q&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;lo&lt;span style=&#34;margin-right:0.01389em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé€šè¿‡ä¸€å®šçš„æ¨å¯¼å¯ä»¥å¾—åˆ°å¦‚ä¸‹æŸå¤±å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mtable rowspacing=&#34;0.24999999999999992em&#34; columnalign=&#34;right left&#34; columnspacing=&#34;0em&#34;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;E&lt;/mi&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;âˆ¥&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo fence=&#34;true&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;Î²&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo fence=&#34;true&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo fence=&#34;true&#34;&gt;âˆ¥&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo fence=&#34;true&#34;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&#34;1em&#34;/&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;E&lt;/mi&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;âˆ¥&lt;/mo&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo fence=&#34;true&#34;&gt;âˆ¥&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo fence=&#34;true&#34;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&#34;1em&#34;/&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&#34;0&#34; displaystyle=&#34;true&#34;&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;E&lt;/mi&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;âˆ¥&lt;/mo&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;true&#34;&gt;â€¾&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;true&#34;&gt;â€¾&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo fence=&#34;true&#34;&gt;âˆ¥&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo fence=&#34;true&#34;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mspace width=&#34;1em&#34;/&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\begin{aligned}
L_{t}&amp;amp; =\mathbb{E}_{\mathbf{x}_{0},\epsilon}\left[\left\|\frac{1}{\sqrt{\alpha_{t}}}\left(\mathbf{x}_{t}-\frac{\beta_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\epsilon\right)-\frac{1}{\sqrt{\alpha_{t}}}\left(\mathbf{x}_{t}-\frac{\beta_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\epsilon_{\theta}(\mathbf{x}_{t},t)\right)\right\|^{2}\right]\quad\epsilon\sim\mathcal{N}(0,1) \\
&amp;amp;=\mathbb{E}_{\mathbf{x}_0,\epsilon}\left[\left\|\epsilon-\epsilon_\theta(\mathbf{x}_t,t)\right\|^2\right]\quad\epsilon\sim\mathcal{N}(0,1) \\
&amp;amp;=\mathbb{E}_{\mathbf{x}_0,\epsilon}\left[\left\|\epsilon-\epsilon_\theta(\sqrt{\overline{\alpha}_t}\mathbf{x}_0+\sqrt{1-\overline{\alpha}_t}\epsilon,t)\right\|^2\right],\quad\epsilon\sim\mathcal{N}(0,1)
\end{aligned}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:7.500070000000001em;vertical-align:-3.5000350000000005em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mtable&#34;&gt;&lt;span class=&#34;col-align-r&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:4.0000350000000005em;&#34;&gt;&lt;span style=&#34;top:-6.0000350000000005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.75em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.3000050000000005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.75em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-1.1999849999999996em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.75em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:3.5000350000000005em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;col-align-l&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:4.0000350000000005em;&#34;&gt;&lt;span style=&#34;top:-6.0000350000000005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.75em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;E&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.16110799999999997em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathbf mtight&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31731428571428577em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;Ïµ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size4&#34;&gt;[&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen&#34;&gt;&lt;span class=&#34;delimsizing mult&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.4799700000000002em;&#34;&gt;&lt;span style=&#34;top:-1.65598em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.25698em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.85798em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.87897em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.47997em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9500199999999999em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.72528em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.68528em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31472em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.00072em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size3&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3714399999999998em;&#34;&gt;&lt;span style=&#34;top:-2.27778em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8322200000000001em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.56778em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.79222em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.20777999999999996em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.93em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size3&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.32144em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.72528em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.68528em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31472em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.00072em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size3&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3714399999999998em;&#34;&gt;&lt;span style=&#34;top:-2.27778em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8322200000000001em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.56778em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.79222em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.20777999999999996em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;Î²&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.93em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size3&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;delimsizing mult&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.4799700000000002em;&#34;&gt;&lt;span style=&#34;top:-1.65598em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.25698em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.85798em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.87897em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.47997em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9500199999999999em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.6839780000000002em;&#34;&gt;&lt;span style=&#34;top:-3.9328700000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size4&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:1em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.3000050000000005em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.75em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;E&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.16110799999999997em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathbf mtight&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31731428571428577em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;Ïµ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size2&#34;&gt;[&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;âˆ¥&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.954008em;&#34;&gt;&lt;span style=&#34;top:-3.2029em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size2&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:1em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-1.1999849999999996em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.75em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;E&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.16110799999999997em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathbf mtight&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.31731428571428577em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-right:0.07142857142857144em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;Ïµ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.286108em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size2&#34;&gt;[&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen&#34;&gt;&lt;span class=&#34;delimsizing mult&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8679800000000001em;&#34;&gt;&lt;span style=&#34;top:-2.2559899999999997em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.26698em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.86798em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.35000999999999993em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.874155em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord overline&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.63056em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.55056em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;overline-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.834155em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.16584500000000002em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8810950000000001em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord overline&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.63056em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.55056em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;overline-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.841095em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15890499999999996em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;delimsizing mult&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8679800000000001em;&#34;&gt;&lt;span style=&#34;top:-2.2559899999999997em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.26698em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.86798em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.606em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;delimsizinginner delim-size1&#34;&gt;&lt;span&gt;âˆ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.35000999999999993em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0851030000000002em;&#34;&gt;&lt;span style=&#34;top:-3.3339950000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size2&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:1em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:3.5000350000000005em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç»è¿‡è¿™æ ·ä¸€ç•ªæ¨å¯¼ä¹‹åå°±æ˜¯ä¸ª L2-lossã€‚ç½‘ç»œçš„è¾“å…¥æ˜¯ä¸€å¼ å’Œå™ªå£°çº¿æ€§ç»„åˆçš„å›¾ç‰‡ï¼Œç„¶åè¦ä¼°è®¡å‡ºæ¥è¿™ä¸ªå™ªå£°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;true&#34;&gt;â€¾&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo stretchy=&#34;true&#34;&gt;â€¾&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\epsilon_\theta(\sqrt{\overline{\alpha}_t}\mathbf{x}_0+\sqrt{1-\overline{\alpha}_t}\epsilon,t)
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.124155em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.874155em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord overline&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.63056em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.55056em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;overline-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.834155em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.16584500000000002em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.1310950000000002em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8810950000000001em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord overline&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.63056em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.55056em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;overline-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.841095em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15890499999999996em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;äº”-è®­ç»ƒè¿‡ç¨‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äº”-è®­ç»ƒè¿‡ç¨‹&#34;&gt;#&lt;/a&gt; äº”ã€è®­ç»ƒè¿‡ç¨‹&lt;/h1&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/DiffusionModel/5.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;è®­ç»ƒè¿‡ç¨‹å¦‚ä¸Šå›¾å·¦è¾¹ Algorithm 1 Training éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒé‡‡æ ·ä¸€ä¸ªå™ªå£°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;Ïµ&lt;/mi&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;I&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\epsilon\sim\mathcal{N}(0,\mathbf{I})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Ïµ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;I&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;é€šè¿‡æ¢¯åº¦ä¸‹é™æœ€å°åŒ–æŸå¤±&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ‡&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mi mathvariant=&#34;bold-italic&#34;&gt;Ïµ&lt;/mi&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;z&lt;/mi&gt;&lt;mi&gt;Î¸&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;âˆ’&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi&gt;Î±&lt;/mi&gt;&lt;mo&gt;Ë‰&lt;/mo&gt;&lt;/mover&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;mi mathvariant=&#34;bold-italic&#34;&gt;Ïµ&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;âˆ£&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\nabla_\theta|\boldsymbol{\epsilon}-\mathbf{z}\theta(\sqrt{\bar{\alpha}t}x_0+\sqrt{1-\bar{\alpha}_t}\boldsymbol{\epsilon},t)|^2&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;âˆ‡&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.33610799999999996em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord boldsymbol&#34;&gt;Ïµ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.14254em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;z&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;Î¸&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.89254em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.56778em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.85254em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.14746000000000004em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.30110799999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.08222em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8322200000000001em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;âˆ’&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.56778em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;Î±&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.22222em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Ë‰&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2805559999999999em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.79222em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg width=&#39;400em&#39; height=&#39;1.08em&#39; viewBox=&#39;0 0 400000 1080&#39; preserveAspectRatio=&#39;xMinYMin slice&#39;&gt;&lt;path d=&#39;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#39;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.20777999999999996em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord boldsymbol&#34;&gt;Ïµ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;âˆ£&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;è®­ç»ƒåˆ°æ”¶æ•›ä¸ºæ­¢ï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æµ‹è¯•ï¼ˆé‡‡æ ·ï¼‰å¦‚ä¸Šå›¾å³è¾¹ Algorithm 2 Sampling éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒé‡‡æ ·ä¸€ä¸ªå™ªå£°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;I&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;x_T\sim\mathcal{N}(0,\mathbf{I})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.58056em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.32833099999999993em;&#34;&gt;&lt;span style=&#34;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;I&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;ä»æ—¶é—´æ­¥ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;T&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68333em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; å¼€å§‹æ­£å‘æ‰©æ•£è¿­ä»£åˆ°æ—¶é—´æ­¥ &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;å¦‚æœæ—¶é—´æ­¥ä¸ä¸º &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œåˆ™ä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒé‡‡æ ·ä¸€ä¸ªå™ªå£°&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;âˆ¼&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;I&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;z\sim\mathcal{N}(0,\mathbf{I})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.04398em;&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;âˆ¼&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathcal&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;I&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œå¦åˆ™&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;z=0&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.04398em;&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;æ ¹æ®é«˜æ–¯åˆ†å¸ƒè®¡ç®—æ¯ä¸ªæ—¶é—´æ­¥&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;t&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.61508em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; çš„å™ªå£°å›¾ï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;å…­-ä»£ç å®ç°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å…­-ä»£ç å®ç°&#34;&gt;#&lt;/a&gt; å…­ã€ä»£ç å®ç°&lt;/h1&gt;
&lt;p&gt;å‚è€ƒæ–‡ç« ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuYXNzZW1ibHlhaS5jb20vYmxvZy9kaWZmdXNpb24tbW9kZWxzLWZvci1tYWNoaW5lLWxlYXJuaW5nLWludHJvZHVjdGlvbi8=&#34;&gt;https://www.assemblyai.com/blog/diffusion-models-for-machine-learning-introduction/&lt;/span&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; torch&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; denoising_diffusion_pytorch &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; Unet&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; GaussianDiffusion&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Unet&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    dim &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    dim_mults &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cuda&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;diffusion &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; GaussianDiffusion&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    image_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    timesteps &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;   &lt;span class=&#34;token comment&#34;&gt;# number of steps&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    loss_type &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;l1&#39;&lt;/span&gt;    &lt;span class=&#34;token comment&#34;&gt;# L1 or L2&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cuda&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# éšæœºæ ·æœ¬&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;training_images &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;randn&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;loss &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; diffusion&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;training_images&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;loss&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;backward&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;sampled_images &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; diffusion&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sample&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;batch_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# è‡ªå®šä¹‰æ ·æœ¬&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# trainer = Trainer(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#     diffusion,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#     &#39;path/to/your/images&#39;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#     train_batch_size = 32,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#     train_lr = 2e-5,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#     train_num_steps = 700000,         # total training steps&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#     gradient_accumulate_every = 2,    # gradient accumulation steps&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#     ema_decay = 0.995,                # exponential moving average decay&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#     amp = True                        # turn on mixed precision&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# )&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# trainer.train()&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/07/29/AI/LLM_finetune/</guid>
            <title>å¤§æ¨¡å‹å¾®è°ƒ</title>
            <link>http://qianqiu-cell.github.io/2024/07/29/AI/LLM_finetune/</link>
            <category>AI</category>
            <pubDate>Mon, 29 Jul 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzU2NTkxODE0L2FydGljbGUvZGV0YWlscy8xMzEyOTM5NDA=&#34;&gt;https://blog.csdn.net/qq_56591814/article/details/131293940&lt;/span&gt;ã€&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVdrYnplVUVWRC8/c3BtX2lkX2Zyb209MzMzLjg4MC5teV9oaXN0b3J5LnBhZ2UuY2xpY2smYW1wO3ZkX3NvdXJjZT1lMDExNzJlYTI5MmMxYzYwNWIzNDYxMDFkNzAwNmM2MQ==&#34;&gt;https://www.bilibili.com/video/BV1WkbzeUEVD/?spm_id_from=333.880.my_history.page.click&amp;amp;vd_source=e01172ea292c1c605b346101d7006c61&lt;/span&gt;ã€&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC82MzUxNTI4MTM=&#34;&gt;https://zhuanlan.zhihu.com/p/635152813&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2h1Z2dpbmdmYWNlL3BlZnQ=&#34;&gt;peft åº“&lt;/span&gt;å¯ä»¥å®ç°å‡ ä¹æ‰€æœ‰çš„å¾®è°ƒ&lt;/p&gt;
&lt;h1 id=&#34;ä¸€-ä¸ºä»€ä¹ˆè¦å¯¹å¤§æ¨¡å‹è¿›è¡Œå¾®è°ƒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-ä¸ºä»€ä¹ˆè¦å¯¹å¤§æ¨¡å‹è¿›è¡Œå¾®è°ƒ&#34;&gt;#&lt;/a&gt; ä¸€ã€ä¸ºä»€ä¹ˆè¦å¯¹å¤§æ¨¡å‹è¿›è¡Œå¾®è°ƒ&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒé€šå¸¸ï¼Œè¦å¯¹å¤§æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œæœ‰ä»¥ä¸‹ä¸€äº›åŸå› ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªåŸå› æ˜¯ï¼Œå› ä¸ºå¤§æ¨¡å‹çš„å‚æ•°é‡éå¸¸å¤§ï¼Œè®­ç»ƒæˆæœ¬éå¸¸é«˜ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬äºŒä¸ªåŸå› æ˜¯ï¼Œ &lt;code&gt;Prompt Engineering&lt;/code&gt;  çš„æ–¹å¼æ˜¯ä¸€ç§ç›¸å¯¹æ¥è¯´å®¹æ˜“ä¸Šæ‰‹çš„ä½¿ç”¨å¤§æ¨¡å‹çš„æ–¹å¼ï¼Œä½†æ˜¯å®ƒçš„ç¼ºç‚¹ä¹Ÿéå¸¸æ˜æ˜¾ã€‚å› ä¸ºé€šå¸¸å¤§æ¨¡å‹éƒ½ä¼šå¯¹è¾“å…¥åºåˆ—çš„é•¿åº¦æœ‰é™åˆ¶ï¼Œ &lt;code&gt;Prompt Engineering&lt;/code&gt;  çš„ &lt;code&gt;Prompt&lt;/code&gt;  å¾ˆé•¿ã€‚è¶Šé•¿çš„ &lt;code&gt;Prompt&lt;/code&gt; ï¼Œå¤§æ¨¡å‹çš„æ¨ç†æˆæœ¬è¶Šé«˜ï¼Œå› ä¸ºæ¨ç†æˆæœ¬æ˜¯è·Ÿ &lt;code&gt;Prompt&lt;/code&gt;  é•¿åº¦çš„å¹³æ–¹æ­£å‘ç›¸å…³çš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬ä¸‰ä¸ªåŸå› æ˜¯ï¼Œ &lt;code&gt;Prompt Engineering&lt;/code&gt;  çš„æ•ˆæœè¾¾ä¸åˆ°è¦æ±‚ï¼Œä¼ä¸šåˆæœ‰æ¯”è¾ƒå¥½çš„è‡ªæœ‰æ•°æ®ï¼Œèƒ½å¤Ÿé€šè¿‡è‡ªæœ‰æ•°æ®ï¼Œæ›´å¥½çš„æå‡å¤§æ¨¡å‹åœ¨ç‰¹å®šé¢†åŸŸçš„èƒ½åŠ›ã€‚è¿™æ—¶å€™å¾®è°ƒå°±éå¸¸é€‚ç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬å››ä¸ªåŸå› æ˜¯ï¼Œè¦åœ¨ä¸ªæ€§åŒ–çš„æœåŠ¡ä¸­ä½¿ç”¨å¤§æ¨¡å‹çš„èƒ½åŠ›ï¼Œè¿™æ—¶å€™é’ˆå¯¹æ¯ä¸ªç”¨æˆ·çš„æ•°æ®ï¼Œè®­ç»ƒä¸€ä¸ªè½»é‡çº§çš„å¾®è°ƒæ¨¡å‹ï¼Œå°±æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¬¬äº”ä¸ªåŸå› æ˜¯ï¼Œæ•°æ®å®‰å…¨çš„é—®é¢˜ã€‚å¦‚æœæ•°æ®æ˜¯ä¸èƒ½ä¼ é€’ç»™ç¬¬ä¸‰æ–¹å¤§æ¨¡å‹æœåŠ¡çš„ï¼Œé‚£ä¹ˆæ­å»ºè‡ªå·±çš„å¤§æ¨¡å‹å°±éå¸¸å¿…è¦ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äºŒ-å¤§æ¨¡å‹å¾®è°ƒçš„æŠ€æœ¯æ‰‹æ®µ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-å¤§æ¨¡å‹å¾®è°ƒçš„æŠ€æœ¯æ‰‹æ®µ&#34;&gt;#&lt;/a&gt; äºŒã€å¤§æ¨¡å‹å¾®è°ƒçš„æŠ€æœ¯æ‰‹æ®µ&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒæ ¹æ®å¾®è°ƒå¯¹æ•´ä¸ªé¢„è®­ç»ƒæ¨¡å‹çš„è°ƒæ•´ç¨‹åº¦ï¼Œå¾®è°ƒå¯ä»¥åˆ†ä¸ºå…¨å¾®è°ƒå’Œéƒ¨åˆ†å¾®è°ƒä¸¤ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å…¨å¾®è°ƒï¼ˆ &lt;code&gt;Full Fine-tuning, FFT&lt;/code&gt; ï¼‰ï¼š &lt;code&gt;FFT&lt;/code&gt;  æ˜¯æŒ‡å¯¹æ•´ä¸ªé¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œå¾®è°ƒï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„æ¨¡å‹å‚æ•°ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œé¢„è®­ç»ƒæ¨¡å‹çš„æ‰€æœ‰å±‚å’Œå‚æ•°éƒ½ä¼šè¢«æ›´æ–°å’Œä¼˜åŒ–ï¼Œä»¥é€‚åº”ç›®æ ‡ä»»åŠ¡çš„éœ€æ±‚ã€‚è¿™ç§å¾®è°ƒæ–¹æ³•é€šå¸¸é€‚ç”¨äºä»»åŠ¡å’Œé¢„è®­ç»ƒæ¨¡å‹ä¹‹é—´å­˜åœ¨è¾ƒå¤§å·®å¼‚çš„æƒ…å†µï¼Œæˆ–è€…ä»»åŠ¡éœ€è¦æ¨¡å‹å…·æœ‰é«˜åº¦çµæ´»æ€§å’Œè‡ªé€‚åº”èƒ½åŠ›çš„æƒ…å†µã€‚ &lt;code&gt;FFT&lt;/code&gt;  éœ€è¦è¾ƒå¤§çš„è®¡ç®—èµ„æºå’Œæ—¶é—´ï¼Œä½†å¯ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å‚æ•°é«˜æ•ˆå¾®è°ƒï¼ˆ &lt;code&gt;Parameter-Efficient Fine-Tuning, PEFT&lt;/code&gt; ï¼‰ï¼š &lt;code&gt;PEFT&lt;/code&gt;  æ—¨åœ¨é€šè¿‡æœ€å°åŒ–å¾®è°ƒå‚æ•°æ•°é‡å’Œè®¡ç®—å¤æ‚åº¦ï¼Œæå‡é¢„è®­ç»ƒæ¨¡å‹åœ¨æ–°ä»»åŠ¡ä¸Šçš„è¡¨ç°ï¼Œä»è€Œå‡è½»å¤§å‹é¢„è®­ç»ƒæ¨¡å‹çš„è®­ç»ƒè´Ÿæ‹…ã€‚ &lt;code&gt;PEFT&lt;/code&gt;  å¯ä»¥ç²—ç•¥åˆ†ä¸ºä»¥ä¸‹ä¸‰å¤§ç±»ï¼šå¢åŠ é¢å¤–å‚æ•°ï¼ˆ &lt;code&gt;A&lt;/code&gt; ï¼‰ã€é€‰å–ä¸€éƒ¨åˆ†å‚æ•°æ›´æ–°ï¼ˆ &lt;code&gt;S&lt;/code&gt; ï¼‰ã€å¼•å…¥é‡å‚æ•°åŒ–ï¼ˆ &lt;code&gt;R&lt;/code&gt; ï¼‰ã€‚è€Œåœ¨å¢åŠ é¢å¤–å‚æ•°è¿™ç±»æ–¹æ³•ä¸­ï¼Œåˆä¸»è¦åˆ†ä¸ºç±»é€‚é…å™¨ï¼ˆ &lt;code&gt;Adapter-like&lt;/code&gt; ï¼‰æ–¹æ³•å’Œè½¯æç¤ºï¼ˆ &lt;code&gt;Soft prompts&lt;/code&gt; ï¼‰ä¸¤ä¸ªå°ç±»ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/2.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;21-additive-methods&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-additive-methods&#34;&gt;#&lt;/a&gt; 2.1 Additive methods&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒä¸»è¦æ€æƒ³æ˜¯é€šè¿‡&lt;mark&gt;æ·»åŠ é¢å¤–çš„å‚æ•°æˆ–å±‚æ¥æ‰©å……ç°æœ‰çš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œå¹¶ä»…è®­ç»ƒæ–°æ·»åŠ çš„å‚æ•°&lt;/mark&gt;ã€‚è¿™ç§æ–¹æ³•åˆåˆ†ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Adapters&lt;/code&gt; ï¼ˆç±»é€‚é…å™¨ï¼‰ï¼šå³åœ¨ &lt;code&gt;Transformer&lt;/code&gt;  å­å±‚åå¼•å…¥å°å‹å…¨è¿æ¥ç½‘ç»œã€‚ &lt;code&gt;Adapters&lt;/code&gt;  æœ‰å¤šç§å˜ä½“ï¼Œä¾‹å¦‚ä¿®æ”¹é€‚é…å™¨çš„ä½ç½®ã€å‰ªæä»¥åŠä½¿ç”¨é‡å‚æ•°åŒ–æ¥å‡å°‘å¯è®­ç»ƒå‚æ•°çš„æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Soft Prompts&lt;/code&gt; ï¼ˆè½¯æç¤ºï¼‰ï¼š&lt;strong&gt;äººå·¥è®¾è®¡çš„æ˜¯ hard promptï¼Œæ¨¡å‹è®­ç»ƒå‡ºæ¥çš„æ˜¯ soft prompt&lt;/strong&gt;ã€‚ &lt;code&gt;Soft Prompts&lt;/code&gt; &lt;mark&gt; å°†æ¨¡å‹çš„ä¸€éƒ¨åˆ†è¾“å…¥åµŒå…¥é€šè¿‡æ¢¯åº¦ä¸‹é™è¿›è¡Œå¾®è°ƒ&lt;/mark&gt;ï¼Œå°†åœ¨ç¦»æ•£ç©ºé—´ä¸­å¯»æ‰¾æç¤ºçš„é—®é¢˜è½¬åŒ–ä¸ºè¿ç»­ä¼˜åŒ–é—®é¢˜ã€‚ &lt;code&gt;Soft Prompts&lt;/code&gt;  å¯ä»¥ä»…å¯¹è¾“å…¥å±‚è¿›è¡Œè®­ç»ƒ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9wYXBlcnN3aXRoY29kZS5jb20vcGFwZXIvdGhlLXBvd2VyLW9mLXNjYWxlLWZvci1wYXJhbWV0ZXItZWZmaWNpZW50&#34;&gt; Prompt Tuning&lt;/span&gt;ï¼‰ï¼Œä¹Ÿå¯ä»¥å¯¹æ‰€æœ‰å±‚è¿›è¡Œè®­ç»ƒï¼ˆ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9wYXBlcnN3aXRoY29kZS5jb20vcGFwZXIvcHJlZml4LXR1bmluZy1vcHRpbWl6aW5nLWNvbnRpbnVvdXMtcHJvbXB0cw==&#34;&gt;Prefix-Tuning&lt;/span&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;others&lt;/code&gt; ï¼šä¾‹å¦‚ &lt;code&gt;LeTS&lt;/code&gt; ,  &lt;code&gt;LST&lt;/code&gt;  å’Œ &lt;code&gt;(IA)^3&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒå°½ç®¡è¿™äº›æ–¹æ³•å¼•å…¥äº†é¢å¤–çš„å‚æ•°åˆ°ç½‘ç»œä¸­ï¼Œä½†å®ƒä»¬é€šè¿‡å‡å°‘æ¢¯åº¦å’Œä¼˜åŒ–å™¨çŠ¶æ€çš„å¤§å°ï¼Œå‡å°‘äº†è®­ç»ƒæ—¶é—´ï¼Œæå‡äº†å†…å­˜æ•ˆç‡ã€‚æ­¤å¤–å¯ä»¥å¯¹å†»ç»“çš„æ¨¡å‹å‚æ•°è¿›è¡Œé‡åŒ–ï¼ˆ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzU2NTkxODE0L2FydGljbGUvZGV0YWlscy8xMzEyOTM5NDA=&#34;&gt;å‚è€ƒè®ºæ–‡&lt;/span&gt;ï¼‰ï¼Œ &lt;code&gt;additive PEFT&lt;/code&gt;  æ–¹æ³•èƒ½å¤Ÿå¾®è°ƒæ›´å¤§çš„ç½‘ç»œæˆ–ä½¿ç”¨æ›´å¤§çš„æ‰¹æ¬¡å¤§å°ï¼Œè¿™æé«˜äº†åœ¨ &lt;code&gt;GPU&lt;/code&gt;  ä¸Šçš„è®­ç»ƒååé‡ã€‚æ­¤å¤–ï¼Œåœ¨åˆ†å¸ƒå¼è®¾ç½®ä¸­ä¼˜åŒ–è¾ƒå°‘çš„å‚æ•°å¤§å¤§å‡å°‘äº†é€šä¿¡é‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1-prefix-tuning&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1-prefix-tuning&#34;&gt;#&lt;/a&gt; (1) Prefix Tuning&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9wYXBlcnN3aXRoY29kZS5jb20vcGFwZXIvcHJlZml4LXR1bmluZy1vcHRpbWl6aW5nLWNvbnRpbnVvdXMtcHJvbXB0cw==&#34;&gt;Prefix-Tuning&lt;/span&gt;&lt;strong&gt; åœ¨è¾“å…¥ token ä¹‹å‰æ„é€ ä¸€æ®µä»»åŠ¡ç›¸å…³çš„ virtual tokens ä½œä¸º Prefixï¼Œç„¶åè®­ç»ƒçš„æ—¶å€™åªæ›´æ–° Prefix éƒ¨åˆ†çš„å‚æ•°&lt;/strong&gt;ï¼Œè€Œ PLM ä¸­çš„å…¶ä»–éƒ¨åˆ†å‚æ•°å›ºå®šã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé’ˆå¯¹ä¸åŒçš„æ¨¡å‹ç»“æ„ï¼Œéœ€è¦æ„é€ ä¸åŒçš„ Prefixã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é’ˆå¯¹ä»…ç¼–ç å™¨æ¶æ„æ¨¡å‹ï¼šåœ¨å¥å­å‰é¢æ·»åŠ å‰ç¼€ï¼Œå¾—åˆ° &lt;strong&gt;z = [PREFIX; x; y]&lt;/strong&gt;ï¼Œåˆé€‚çš„ä¸Šæ–‡èƒ½å¤Ÿåœ¨å›ºå®š LM çš„æƒ…å†µä¸‹å»å¼•å¯¼ç”Ÿæˆä¸‹æ–‡ï¼ˆæ¯”å¦‚ï¼šGPT3 çš„ä¸Šä¸‹æ–‡å­¦ä¹ ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é’ˆå¯¹ç¼–ç å™¨ - è§£ç å™¨æ¶æ„æ¨¡å‹ï¼šEncoder å’Œ Decoder éƒ½å¢åŠ äº†å‰ç¼€ï¼Œå¾—åˆ° &lt;strong&gt;z = [PREFIX; x; PREFIX0; y]&lt;/strong&gt;ã€‚Encoder ç«¯å¢åŠ å‰ç¼€æ˜¯ä¸ºäº†å¼•å¯¼è¾“å…¥éƒ¨åˆ†çš„ç¼–ç ï¼ŒDecoder ç«¯å¢åŠ å‰ç¼€æ˜¯ä¸ºäº†å¼•å¯¼åç»­ token çš„ç”Ÿæˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/2.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;Prefix Tuning å’Œæ„é€  Prompt ç±»ä¼¼ï¼Œåªæ˜¯ Prompt æ˜¯äººä¸ºæ„é€ çš„ â€œæ˜¾å¼â€ çš„æç¤ºï¼Œå¹¶ä¸”æ— æ³•æ›´æ–°å‚æ•°ï¼Œè€Œ Prefix åˆ™æ˜¯å¯ä»¥å­¦ä¹ çš„ â€œéšå¼â€ çš„æç¤º&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢ç›´æ¥æ›´æ–° Prefix çš„å‚æ•°å¯¼è‡´è®­ç»ƒä¸ç¨³å®šå’Œæ€§èƒ½ä¸‹é™çš„æƒ…å†µï¼Œ&lt;strong&gt;åœ¨ Prefix å±‚å‰é¢åŠ äº† MLP ç»“æ„ï¼Œè®­ç»ƒå®Œæˆåï¼Œåªä¿ç•™ Prefix çš„å‚æ•°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé€šè¿‡æ¶ˆèå®éªŒè¯å®ï¼Œåªè°ƒæ•´ embedding å±‚çš„è¡¨ç°åŠ›ä¸å¤Ÿï¼Œå°†å¯¼è‡´æ€§èƒ½æ˜¾è‘—ä¸‹é™ï¼Œå› æ­¤ï¼Œ&lt;strong&gt;åœ¨æ¯å±‚éƒ½åŠ äº† prompt çš„å‚æ•°ï¼Œæ”¹åŠ¨è¾ƒå¤§&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¦å¤–ï¼Œå®éªŒè¿˜å¯¹æ¯”äº†ä½ç½®å¯¹äºç”Ÿæˆæ•ˆæœçš„å½±å“ï¼ŒPrefix-tuning ä¹Ÿæ˜¯è¦ç•¥ä¼˜äº Infix-tuning çš„ã€‚å…¶ä¸­ï¼ŒPrefix-tuning å½¢å¼ä¸º [PREFIX; x; y]ï¼ŒInfix-tuning å½¢å¼ä¸º [x; INFIX; y]ã€‚&lt;/p&gt;
&lt;h3 id=&#34;2-prompt-tuning&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2-prompt-tuning&#34;&gt;#&lt;/a&gt; (2) Prompt Tuning&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒäººå·¥è®¾è®¡ prompts æç¤ºè¯­ï¼Œæˆæœ¬æ¯”è¾ƒé«˜ï¼Œå¹¶ä¸”æ•ˆæœä¸å¤ªå¥½ã€‚&lt;strong&gt;Prompt Tuning é€šè¿‡åå‘ä¼ æ’­æ›´æ–°å‚æ•°æ¥å­¦ä¹  promptsï¼Œè€Œä¸æ˜¯äººå·¥è®¾è®¡ promptsï¼›åŒæ—¶å†»ç»“æ¨¡å‹åŸå§‹æƒé‡ï¼Œåªè®­ç»ƒ prompts å‚æ•°&lt;/strong&gt;ï¼Œè®­ç»ƒå®Œä»¥åï¼Œç”¨åŒä¸€ä¸ªæ¨¡å‹å¯ä»¥åšå¤šä»»åŠ¡æ¨ç†ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9wYXBlcnN3aXRoY29kZS5jb20vcGFwZXIvdGhlLXBvd2VyLW9mLXNjYWxlLWZvci1wYXJhbWV0ZXItZWZmaWNpZW50&#34;&gt;Prompt Tuning&lt;/span&gt; å¯ä»¥çœ‹ä½œæ˜¯ Prefix Tuning çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œå®ƒç»™æ¯ä¸ªä»»åŠ¡å®šä¹‰äº†è‡ªå·±çš„ Promptï¼Œç„¶åæ‹¼æ¥åˆ°æ•°æ®ä¸Šä½œä¸ºè¾“å…¥ï¼Œä½†åªåœ¨è¾“å…¥å±‚åŠ å…¥ prompt tokensï¼Œå¹¶ä¸”ä¸éœ€è¦åŠ å…¥ MLP è¿›è¡Œè°ƒæ•´æ¥è§£å†³éš¾è®­ç»ƒçš„é—®é¢˜&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/2.3.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé€šè¿‡å®éªŒå‘ç°ï¼Œ&lt;strong&gt;éšç€é¢„è®­ç»ƒæ¨¡å‹å‚æ•°é‡çš„å¢åŠ ï¼ŒPrompt Tuning çš„æ–¹æ³•ä¼šé€¼è¿‘å…¨å‚æ•°å¾®è°ƒçš„ç»“æœ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/2.4.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåŒæ—¶ï¼ŒPrompt Tuning è¿˜æå‡ºäº† Prompt Ensemblingï¼Œä¹Ÿå°±æ˜¯åœ¨ä¸€ä¸ªæ‰¹æ¬¡ï¼ˆBatchï¼‰é‡ŒåŒæ—¶è®­ç»ƒåŒä¸€ä¸ªä»»åŠ¡çš„ä¸åŒ promptï¼ˆå³é‡‡ç”¨å¤šç§ä¸åŒæ–¹å¼è¯¢é—®åŒä¸€ä¸ªé—®é¢˜ï¼‰ï¼Œè¿™æ ·ç›¸å½“äºè®­ç»ƒäº†ä¸åŒæ¨¡å‹ï¼Œæ¯”æ¨¡å‹é›†æˆçš„æˆæœ¬å°å¤šäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/2.5.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé€šè¿‡æ¶ˆèå®éªŒç»“æœå‘ç°ï¼Œ&lt;strong&gt;Prompt Tuning é‡‡ç”¨ç±»æ ‡ç­¾åˆå§‹åŒ–æ¨¡å‹çš„æ•ˆæœæ›´å¥½&lt;/strong&gt;ã€‚ä¸è¿‡éšç€æ¨¡å‹å‚æ•°è§„æ¨¡çš„æå‡ï¼Œè¿™ç§ gap æœ€ç»ˆä¼šæ¶ˆå¤±ã€‚&lt;strong&gt;Prompt token çš„é•¿åº¦åœ¨ 20 å·¦å³æ—¶çš„è¡¨ç°å·²ç»ä¸é”™&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;3-p-tuning&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3-p-tuning&#34;&gt;#&lt;/a&gt; (3) P-Tuning&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒå¤§æ¨¡å‹çš„ Prompt æ„é€ æ–¹å¼ä¸¥é‡å½±å“ä¸‹æ¸¸ä»»åŠ¡çš„æ•ˆæœã€‚äººå·¥è®¾è®¡çš„æ¨¡ç‰ˆçš„å˜åŒ–ç‰¹åˆ«æ•æ„Ÿï¼ŒåŠ ä¸€ä¸ªè¯æˆ–è€…å°‘ä¸€ä¸ªè¯ï¼Œæˆ–è€…å˜åŠ¨ä½ç½®éƒ½ä¼šé€ æˆæ¯”è¾ƒå¤§çš„å˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåŒæ—¶ï¼Œè‡ªåŠ¨åŒ–æœç´¢ Prompt æ¨¡ç‰ˆæˆæœ¬æ¯”è¾ƒé«˜ï¼Œç¦»æ•£åŒ–çš„ token çš„æœç´¢å‡ºæ¥çš„ç»“æœå¯èƒ½å¹¶ä¸æ˜¯æœ€ä¼˜çš„ï¼Œå¯¼è‡´æ€§èƒ½ä¸ç¨³å®šã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9hcnhpdi5vcmcvYWJzLzIxMDMuMTAzODU=&#34;&gt;P-Tuning&lt;/span&gt;ï¼Œè®¾è®¡äº†ä¸€ç§è¿ç»­å¯å¾®çš„ virtual tokenï¼ˆåŒ Prefix-Tuning ç±»ä¼¼ï¼‰ã€‚P-Tuning å°† Prompt è½¬æ¢ä¸ºå¯ä»¥å­¦ä¹ çš„ Embedding å±‚ï¼Œå¹¶ç”¨ MLP+LSTM çš„æ–¹å¼æ¥å¯¹ Prompt Embedding è¿›è¡Œä¸€å±‚å¤„ç†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç›¸æ¯” Prefix Tuningï¼ŒP-Tuning åŠ å…¥çš„å¯å¾®çš„ virtual tokenï¼Œä½†&lt;strong&gt;ä»…é™äºè¾“å…¥å±‚&lt;/strong&gt;ï¼Œæ²¡æœ‰åœ¨æ¯ä¸€å±‚éƒ½åŠ ï¼›å¦å¤–ï¼Œ&lt;strong&gt;virtual token çš„ä½ç½®ä¹Ÿä¸ä¸€å®šæ˜¯å‰ç¼€ï¼Œæ’å…¥çš„ä½ç½®æ˜¯å¯é€‰çš„&lt;/strong&gt;ã€‚è¿™é‡Œçš„å‡ºå‘ç‚¹å®é™…æ˜¯æŠŠä¼ ç»Ÿäººå·¥è®¾è®¡æ¨¡ç‰ˆä¸­çš„çœŸå® token æ›¿æ¢æˆå¯å¾®çš„ virtual tokenã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/2.6.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç»è¿‡é¢„è®­ç»ƒçš„ LM çš„è¯åµŒå…¥å·²ç»å˜å¾—é«˜åº¦ç¦»æ•£ï¼Œå¦‚æœéšæœºåˆå§‹åŒ– virtual tokenï¼Œå®¹æ˜“ä¼˜åŒ–åˆ°å±€éƒ¨æœ€ä¼˜å€¼ï¼Œè€Œè¿™äº› virtual token ç†è®ºæ˜¯åº”è¯¥æœ‰ç›¸å…³å…³è”çš„ã€‚å› æ­¤ï¼Œä½œè€…é€šè¿‡å®éªŒå‘ç°&lt;strong&gt;ç”¨ä¸€ä¸ª prompt encoder æ¥ç¼–ç ä¼šæ”¶æ•›æ›´å¿«ï¼Œæ•ˆæœæ›´å¥½ã€‚å³ç”¨ä¸€ä¸ª LSTM+MLP å»ç¼–ç è¿™äº› virtual token ä»¥åï¼Œå†è¾“å…¥åˆ°æ¨¡å‹&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;4-p-tuning-v2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4-p-tuning-v2&#34;&gt;#&lt;/a&gt; (4) P-Tuning v2&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒPrompt Tuning å’Œ P-Tuning ç­‰æ–¹æ³•å­˜åœ¨ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç¬¬ä¸€ï¼Œç¼ºä¹æ¨¡å‹å‚æ•°è§„æ¨¡å’Œä»»åŠ¡é€šç”¨æ€§ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¼ºä¹è§„æ¨¡é€šç”¨æ€§ï¼šPrompt Tuning è®ºæ–‡ä¸­è¡¨æ˜å½“æ¨¡å‹è§„æ¨¡è¶…è¿‡ 100 äº¿ä¸ªå‚æ•°æ—¶ï¼Œæç¤ºä¼˜åŒ–å¯ä»¥ä¸å…¨é‡å¾®è°ƒç›¸åª²ç¾ã€‚&lt;strong&gt;ä½†æ˜¯å¯¹äºé‚£äº›è¾ƒå°çš„æ¨¡å‹ï¼ˆä» 100M åˆ° 1Bï¼‰ï¼Œæç¤ºä¼˜åŒ–å’Œå…¨é‡å¾®è°ƒçš„è¡¨ç°æœ‰å¾ˆå¤§å·®å¼‚&lt;/strong&gt;ï¼Œè¿™å¤§å¤§é™åˆ¶äº†æç¤ºä¼˜åŒ–çš„é€‚ç”¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ç¼ºä¹ä»»åŠ¡æ™®éæ€§ï¼šå°½ç®¡ Prompt Tuning å’Œ P-tuning åœ¨ä¸€äº› NLU åŸºå‡†æµ‹è¯•ä¸­è¡¨ç°å‡ºä¼˜åŠ¿ï¼Œ&lt;strong&gt;ä½†æç¤ºè°ƒä¼˜å¯¹ç¡¬åºåˆ—æ ‡è®°ä»»åŠ¡ï¼ˆå³åºåˆ—æ ‡æ³¨ï¼‰çš„æœ‰æ•ˆæ€§å°šæœªå¾—åˆ°éªŒè¯&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒç¬¬äºŒï¼Œç¼ºå°‘æ·±åº¦æç¤ºä¼˜åŒ–ï¼Œåœ¨ Prompt Tuning å’Œ P-tuning ä¸­ï¼Œ&lt;strong&gt;è¿ç»­æç¤ºåªè¢«æ’å…¥ transformer ç¬¬ä¸€å±‚çš„è¾“å…¥ embedding åºåˆ—ä¸­ï¼Œåœ¨æ¥ä¸‹æ¥çš„ transformer å±‚ä¸­ï¼Œæ’å…¥è¿ç»­æç¤ºçš„ä½ç½®çš„ embedding æ˜¯ç”±ä¹‹å‰çš„ transformer å±‚è®¡ç®—å‡ºæ¥çš„ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¸¤ä¸ªå¯èƒ½çš„ä¼˜åŒ–æŒ‘æˆ˜&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”±äºåºåˆ—é•¿åº¦çš„é™åˆ¶ï¼Œå¯è°ƒå‚æ•°çš„æ•°é‡æ˜¯æœ‰é™çš„ã€‚&lt;/li&gt;
&lt;li&gt;è¾“å…¥ embedding å¯¹æ¨¡å‹é¢„æµ‹åªæœ‰ç›¸å¯¹é—´æ¥çš„å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒè€ƒè™‘åˆ°è¿™äº›é—®é¢˜ï¼Œ&lt;strong&gt;P-tuning v2 åˆ©ç”¨æ·±åº¦æç¤ºä¼˜åŒ–ï¼ˆå¦‚ï¼šPrefix Tuningï¼‰ï¼Œå¯¹ Prompt Tuning å’Œ P-Tuning è¿›è¡Œæ”¹è¿›ï¼Œä½œä¸ºä¸€ä¸ªè·¨è§„æ¨¡å’Œ NLU ä»»åŠ¡çš„é€šç”¨è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9hcnhpdi5vcmcvYWJzLzIxMTAuMDc2MDI=&#34;&gt;P-Tuning v2&lt;/span&gt; åœ¨æ¯ä¸€å±‚éƒ½åŠ å…¥äº† Prompts tokens ä½œä¸ºè¾“å…¥ï¼Œè€Œä¸æ˜¯ä»…ä»…åŠ åœ¨è¾“å…¥å±‚&lt;/strong&gt;ï¼Œè¿™å¸¦æ¥ä¸¤ä¸ªæ–¹é¢çš„å¥½å¤„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ›´å¤šå¯å­¦ä¹ çš„å‚æ•°&lt;/strong&gt;ï¼ˆä» P-tuning å’Œ Prompt Tuning çš„ 0.01% å¢åŠ åˆ° 0.1%-3%ï¼‰ï¼ŒåŒæ—¶ä¹Ÿè¶³å¤Ÿå‚æ•°é«˜æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŠ å…¥åˆ°æ›´æ·±å±‚ç»“æ„ä¸­çš„ Prompt èƒ½ç»™æ¨¡å‹é¢„æµ‹å¸¦æ¥æ›´ç›´æ¥çš„å½±å“&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/2.7.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;strong&gt;å…·ä½“åšæ³•åŸºæœ¬åŒ Prefix Tuning&lt;/strong&gt;ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å°†æ–‡æœ¬ç”Ÿæˆçš„ Prefix Tuning æŠ€æœ¯é€‚é…åˆ° NLU ä»»åŠ¡ä¸­ï¼Œç„¶ååšäº†ä¸€äº›æ”¹è¿›ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç§»é™¤é‡å‚æ•°åŒ–çš„ç¼–ç å™¨&lt;/strong&gt;ã€‚ä»¥å‰çš„æ–¹æ³•åˆ©ç”¨é‡å‚æ•°åŒ–åŠŸèƒ½æ¥æé«˜è®­ç»ƒé€Ÿåº¦å’Œé²æ£’æ€§ï¼ˆå¦‚ï¼šPrefix Tuning ä¸­çš„ MLPã€P-Tuning ä¸­çš„ LSTMï¼‰ï¼‰ã€‚åœ¨ P-tuning v2 ä¸­å‘ç°é‡å‚æ•°åŒ–çš„æ”¹è¿›å¾ˆå°ï¼Œå°¤å…¶æ˜¯å¯¹äºè¾ƒå°çš„æ¨¡å‹ï¼ŒåŒæ—¶è¿˜ä¼šå½±å“æ¨¡å‹çš„è¡¨ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é’ˆå¯¹ä¸åŒä»»åŠ¡é‡‡ç”¨ä¸åŒçš„æç¤ºé•¿åº¦&lt;/strong&gt;ã€‚ä¸åŒçš„æ–‡æœ¬ç”Ÿæˆä»»åŠ¡å¯èƒ½æœ‰ä¸åŒçš„æœ€ä½³æç¤ºé•¿åº¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼•å…¥å¤šä»»åŠ¡å­¦ä¹ &lt;/strong&gt;ã€‚å…ˆåœ¨å¤šä»»åŠ¡çš„ Prompt ä¸Šè¿›è¡Œé¢„è®­ç»ƒï¼Œç„¶åå†é€‚é…ä¸‹æ¸¸ä»»åŠ¡ã€‚å¤šä»»åŠ¡å­¦ä¹ å¯¹ P-tuning v2 æ¥è¯´æ˜¯å¯é€‰çš„ï¼Œä½†å¯èƒ½æ˜¯ç›¸å½“æœ‰å¸®åŠ©çš„ã€‚ä¸€æ–¹é¢ï¼Œè¿ç»­æç¤ºçš„éšæœºæƒ¯æ€§ç»™ä¼˜åŒ–å¸¦æ¥äº†å›°éš¾ï¼Œè¿™å¯ä»¥é€šè¿‡æ›´å¤šçš„è®­ç»ƒæ•°æ®æˆ–ä¸ä»»åŠ¡ç›¸å…³çš„æ— ç›‘ç£é¢„è®­ç»ƒæ¥ç¼“è§£ï¼›å¦ä¸€æ–¹é¢ï¼Œè¿ç»­æç¤ºæ˜¯è·¨ä»»åŠ¡å’Œæ•°æ®é›†çš„ç‰¹å®šä»»åŠ¡çŸ¥è¯†çš„å®Œç¾è½½ä½“ã€‚å®éªŒè¡¨æ˜ï¼Œåœ¨ä¸€äº›å›°éš¾çš„åºåˆ—ä»»åŠ¡ä¸­ï¼Œå¤šä»»åŠ¡å­¦ä¹ å¯ä»¥ä½œä¸º P-tuning v2 çš„æœ‰ç›Šè¡¥å……ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›å½’ä¼ ç»Ÿçš„åˆ†ç±»æ ‡ç­¾èŒƒå¼ï¼Œè€Œä¸æ˜¯æ˜ å°„å™¨&lt;/strong&gt;ã€‚æ ‡ç­¾è¯æ˜ å°„å™¨ï¼ˆLabel Word Verbalizerï¼‰ä¸€ç›´æ˜¯æç¤ºä¼˜åŒ–çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œå®ƒå°† one-hot ç±»æ ‡ç­¾å˜æˆæœ‰æ„ä¹‰çš„è¯ï¼Œä»¥åˆ©ç”¨é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹å¤´ã€‚å°½ç®¡å®ƒåœ¨ few-shot è®¾ç½®ä¸­å…·æœ‰æ½œåœ¨çš„å¿…è¦æ€§ï¼Œä½†åœ¨å…¨æ•°æ®ç›‘ç£è®¾ç½®ä¸­ï¼ŒVerbalizer å¹¶ä¸æ˜¯å¿…é¡»çš„ã€‚å®ƒé˜»ç¢äº†æç¤ºè°ƒä¼˜åœ¨æˆ‘ä»¬éœ€è¦æ— å®é™…æ„ä¹‰çš„æ ‡ç­¾å’Œå¥å­åµŒå…¥çš„åœºæ™¯ä¸­çš„åº”ç”¨ã€‚å› æ­¤ï¼Œ&lt;strong&gt;P-Tuning v2 å›å½’ä¼ ç»Ÿçš„ CLS æ ‡ç­¾åˆ†ç±»èŒƒå¼&lt;/strong&gt;ï¼Œé‡‡ç”¨éšæœºåˆå§‹åŒ–çš„åˆ†ç±»å¤´ï¼ˆClassification Headï¼‰åº”ç”¨äº tokens ä¹‹ä¸Šï¼Œä»¥å¢å¼ºé€šç”¨æ€§ï¼Œå¯ä»¥é€‚é…åˆ°åºåˆ—æ ‡æ³¨ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒè®ºæ–‡ä¸­å±•ç¤ºäº† P-tuning v2 åœ¨ä¸åŒæ¨¡å‹è§„æ¨¡ä¸‹çš„è¡¨ç°ã€‚å¯¹äºç®€å•çš„ NLU ä»»åŠ¡ï¼Œå¦‚ SST-2ï¼ˆå•å¥åˆ†ç±»ï¼‰ï¼ŒPrompt Tuning å’Œ P-Tuning åœ¨è¾ƒå°çš„è§„æ¨¡ä¸‹æ²¡æœ‰æ˜¾ç¤ºå‡ºæ˜æ˜¾çš„åŠ£åŠ¿ã€‚ä½†æ˜¯å½“æ¶‰åŠåˆ°å¤æ‚çš„æŒ‘æˆ˜æ—¶ï¼Œå¦‚ï¼šè‡ªç„¶è¯­è¨€æ¨ç†ï¼ˆRTEï¼‰å’Œå¤šé€‰é¢˜å›ç­”ï¼ˆBoolQï¼‰ï¼Œå®ƒä»¬çš„æ€§èƒ½ä¼šéå¸¸å·®ã€‚ç›¸åï¼ŒP-Tuning v2 åœ¨è¾ƒå°è§„æ¨¡çš„æ‰€æœ‰ä»»åŠ¡ä¸­éƒ½ä¸å¾®è°ƒçš„æ€§èƒ½ç›¸åŒ¹é…ã€‚å¹¶ä¸”ï¼ŒP-tuning v2 åœ¨ RTE ä¸­çš„è¡¨ç°æ˜æ˜¾ä¼˜äºå¾®è°ƒï¼Œç‰¹åˆ«æ˜¯åœ¨ BERT ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸ºäº†è¯„ä¼° P-Tuning v2 åœ¨ä¸€äº›å›°éš¾çš„ NLU æŒ‘æˆ˜ä¸­çš„èƒ½åŠ›ï¼Œä½œè€…é€‰æ‹©äº†ä¸‰ä¸ªå…¸å‹çš„åºåˆ—æ ‡æ³¨ä»»åŠ¡ï¼ˆåç§°å®ä½“è¯†åˆ«ã€æŠ½å–å¼é—®ç­”ï¼ˆQAï¼‰å’Œè¯­ä¹‰è§’è‰²æ ‡ç­¾ï¼ˆSRLï¼‰ï¼‰ï¼Œå…±å…«ä¸ªæ•°æ®é›†ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ° P-Tuning v2 åœ¨æ‰€æœ‰ä»»åŠ¡ä¸Šéƒ½èƒ½ä¸å…¨é‡å¾®è°ƒç›¸åª²ç¾ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè®ºæ–‡è¿˜é€šè¿‡æ¶ˆèå®éªŒç ”ç©¶äº†ä¸åŒä»»åŠ¡ä¸Š Prompt Length çš„å½±å“ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é’ˆå¯¹ç®€å•ä»»åŠ¡ï¼šå¦‚æƒ…æ„Ÿåˆ†æï¼Œè¾ƒçŸ­çš„ Promptï¼ˆ~20ï¼‰å³å¯å–å¾—ä¸é”™çš„æ•ˆæœã€‚&lt;/li&gt;
&lt;li&gt;é’ˆå¯¹å¤æ‚ä»»åŠ¡ï¼šå¦‚é˜…è¯»ç†è§£ï¼Œéœ€è¦æ›´é•¿çš„ Promptï¼ˆ~100ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒæ€»ä¹‹ï¼Œ&lt;strong&gt;P-Tuning v2 æ˜¯ä¸€ç§åœ¨ä¸åŒè§„æ¨¡å’Œä»»åŠ¡ä¸­éƒ½å¯ä¸å¾®è°ƒç›¸åª²ç¾çš„æç¤ºæ–¹æ³•&lt;/strong&gt;ã€‚P-Tuning v2 å¯¹ä» 330M åˆ° 10B çš„æ¨¡å‹æ˜¾ç¤ºå‡ºä¸€è‡´çš„æ”¹è¿›ï¼Œå¹¶åœ¨åºåˆ—æ ‡æ³¨ç­‰å›°éš¾çš„åºåˆ—ä»»åŠ¡ä¸Šä»¥å¾ˆå¤§çš„å¹…åº¦è¶…è¿‡äº† Prompt Tuning å’Œ P-Tuningã€‚P-Tuning v2 å¯ä»¥æˆä¸ºå¾®è°ƒçš„ç»¼åˆæ›¿ä»£æ–¹æ¡ˆå’Œæœªæ¥å·¥ä½œçš„åŸºçº¿ï¼ˆBaselineï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;5-adapter-tuning&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5-adapter-tuning&#34;&gt;#&lt;/a&gt; (5) Adapter Tuning&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9hcnhpdi5vcmcvYWJzLzE5MDIuMDA3NTE=&#34;&gt;Adapter Tuning&lt;/span&gt; è®¾è®¡äº† Adapter ç»“æ„ï¼Œå¹¶å°†å…¶åµŒå…¥ Transformer çš„ç»“æ„é‡Œé¢ï¼Œ&lt;strong&gt;é’ˆå¯¹æ¯ä¸€ä¸ª Transformer å±‚ï¼Œå¢åŠ äº†ä¸¤ä¸ª Adapter ç»“æ„&lt;/strong&gt; (åˆ†åˆ«æ˜¯å¤šå¤´æ³¨æ„åŠ›çš„æŠ•å½±ä¹‹åå’Œç¬¬äºŒä¸ª feed-forward å±‚ä¹‹å)ï¼Œåœ¨è®­ç»ƒæ—¶ï¼Œå›ºå®šä½åŸæ¥é¢„è®­ç»ƒæ¨¡å‹çš„å‚æ•°ä¸å˜ï¼Œåªå¯¹æ–°å¢çš„ Adapter ç»“æ„å’Œ Layer Norm å±‚è¿›è¡Œå¾®è°ƒï¼Œä»è€Œä¿è¯äº†è®­ç»ƒçš„é«˜æ•ˆæ€§ã€‚&lt;/p&gt;
&lt;p&gt;æ¯å½“å‡ºç°æ–°çš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œé€šè¿‡æ·»åŠ  Adapter æ¨¡å—æ¥äº§ç”Ÿä¸€ä¸ªæ˜“äºæ‰©å±•çš„ä¸‹æ¸¸æ¨¡å‹ï¼Œä»è€Œé¿å…å…¨é‡å¾®è°ƒä¸ç¾éš¾æ€§é—å¿˜çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/2.8.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;22-selective-methods&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-selective-methods&#34;&gt;#&lt;/a&gt; 2.2 Selective methods&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒæœ€æ—©çš„ &lt;code&gt;selective PEFT&lt;/code&gt;  æ–¹æ³•æ˜¯ä»…å¾®è°ƒç½‘ç»œçš„å‡ ä¸ªé¡¶å±‚ï¼ˆå†»ç»“å‰å±‚ï¼‰ï¼Œç°ä»£æ–¹æ³•é€šå¸¸åŸºäºå±‚çš„ç±»å‹ï¼ˆ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9wYXBlcnN3aXRoY29kZS5jb20vcGFwZXIvb24tdGhlLXN0cmVuZ3Rocy1vZi1jcm9zcy1hdHRlbnRpb24taW4=&#34;&gt;Cross-Attention is All You Need&lt;/span&gt;ï¼‰æˆ–å†…éƒ¨ç»“æ„ï¼Œä¾‹å¦‚ä»…å¾®è°ƒæ¨¡å‹çš„åç½®ï¼ˆ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9wYXBlcnN3aXRoY29kZS5jb20vcGFwZXIvYml0Zml0LXNpbXBsZS1wYXJhbWV0ZXItZWZmaWNpZW50LWZpbmUtdHVuaW5n&#34;&gt;BitFit&lt;/span&gt;ï¼‰æˆ–ä»…ç‰¹å®šçš„è¡Œï¼ˆ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9wYXBlcnN3aXRoY29kZS5jb20vcGFwZXIvZWZmaWNpZW50LWZpbmUtdHVuaW5nLW9mLWJlcnQtbW9kZWxzLW9uLXRoZQ==&#34;&gt;Efficient Fine-Tuning of BERT Models on the Edge&lt;/span&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1-bitfit&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1-bitfit&#34;&gt;#&lt;/a&gt; (1) BitFit&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9wYXBlcnN3aXRoY29kZS5jb20vcGFwZXIvYml0Zml0LXNpbXBsZS1wYXJhbWV0ZXItZWZmaWNpZW50LWZpbmUtdHVuaW5n&#34;&gt;BitFit&lt;/span&gt; æ˜¯ä¸€ç§ç¨€ç–çš„å¾®è°ƒæ–¹æ³•ï¼Œå®ƒè®­ç»ƒæ—¶&lt;strong&gt;åªæ›´æ–° bias çš„å‚æ•°æˆ–è€…éƒ¨åˆ† bias å‚æ•°&lt;/strong&gt;ã€‚æ¶‰åŠåˆ°çš„ bias å‚æ•°æœ‰ attention æ¨¡å—ä¸­è®¡ç®— query,key,value è·Ÿåˆå¹¶å¤šä¸ª attention ç»“æœæ—¶æ¶‰åŠåˆ°çš„ biasï¼ŒMLP å±‚ä¸­çš„ biasï¼ŒLayernormalization å±‚çš„ bias å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ Bert-Base/Bert-Large è¿™ç§æ¨¡å‹é‡Œï¼Œ&lt;strong&gt;bias å‚æ•°ä»…å æ¨¡å‹å…¨éƒ¨å‚æ•°é‡çš„ 0.08%ï½0.09%&lt;/strong&gt;ã€‚ä½†æ˜¯é€šè¿‡åœ¨ Bert-Large æ¨¡å‹ä¸ŠåŸºäº GLUE æ•°æ®é›†è¿›è¡Œäº† BitFitã€Adapter å’Œ Diff-Pruning çš„æ•ˆæœå¯¹æ¯”å‘ç°ï¼ŒBitFit åœ¨å‚æ•°é‡è¿œå°äº Adapterã€Diff-Pruning çš„æƒ…å†µä¸‹ï¼Œæ•ˆæœä¸ Adapterã€Diff-Pruning æƒ³å½“ï¼Œç”šè‡³åœ¨æŸäº›ä»»åŠ¡ä¸Šç•¥ä¼˜äº Adapterã€Diff-Pruningã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåŒæ—¶ï¼Œé€šè¿‡å®éªŒç»“æœè¿˜å¯ä»¥çœ‹å‡ºï¼ŒBitFit å¾®è°ƒç»“æœç›¸å¯¹å…¨é‡å‚æ•°å¾®è°ƒè€Œè¨€ï¼Œåªæ›´æ–°æå°‘é‡å‚æ•°çš„æƒ…å†µä¸‹ï¼Œåœ¨å¤šä¸ªæ•°æ®é›†ä¸Šéƒ½è¾¾åˆ°äº†ä¸é”™çš„æ•ˆæœï¼Œ&lt;strong&gt;è™½ä¸åŠå…¨é‡å‚æ•°å¾®è°ƒ&lt;/strong&gt;ï¼Œä½†æ˜¯è¿œè¶…å›ºå®šå…¨éƒ¨æ¨¡å‹å‚æ•°çš„ Frozen æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåŒæ—¶ï¼Œé€šè¿‡å¯¹æ¯” BitFit è®­ç»ƒå‰åçš„å‚æ•°ï¼Œå‘ç°å¾ˆå¤š bias å‚æ•°å¹¶æ²¡æœ‰å¤ªå¤šå˜åŒ–ï¼ˆä¾‹å¦‚ï¼šè·Ÿè®¡ç®— key æ‰€æ¶‰åŠåˆ°çš„ bias å‚æ•°ï¼‰ã€‚å‘ç°&lt;strong&gt;è®¡ç®— query å’Œå°†ç‰¹å¾ç»´åº¦ä» N æ”¾å¤§åˆ° 4N çš„ FFN å±‚ï¼ˆintermediateï¼‰çš„ bias å‚æ•°å˜åŒ–æœ€ä¸ºæ˜æ˜¾&lt;/strong&gt;ï¼Œåªæ›´æ–°è¿™ä¸¤ç±» bias å‚æ•°ä¹Ÿèƒ½è¾¾åˆ°ä¸é”™çš„æ•ˆæœï¼Œåä¹‹ï¼Œå›ºå®šå…¶ä¸­ä»»ä½•ä¸€è€…ï¼Œæ¨¡å‹çš„æ•ˆæœéƒ½æœ‰è¾ƒå¤§æŸå¤±ã€‚&lt;/p&gt;
&lt;h2 id=&#34;23-reparametrization-based-pefté‡å‚æ•°åŒ–&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-reparametrization-based-pefté‡å‚æ•°åŒ–&#34;&gt;#&lt;/a&gt; 2.3 Reparametrization-based PEFTï¼ˆé‡å‚æ•°åŒ–ï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåˆ©ç”¨ä½ç§©è¡¨ç¤ºæ¥æœ€å°åŒ–å¯è®­ç»ƒå‚æ•°çš„æ•°é‡ã€‚Aghajanyan ç­‰äººï¼ˆ2020ï¼‰è¯æ˜äº†åœ¨ä½ç§©å­ç©ºé—´ä¸­å¯ä»¥æœ‰æ•ˆåœ°è¿›è¡Œå¾®è°ƒï¼Œå¯¹äºæ›´å¤§çš„æ¨¡å‹æˆ–ç»è¿‡æ›´é•¿æ—¶é—´é¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œéœ€è¦è¿›è¡Œè°ƒæ•´çš„å­ç©ºé—´æ›´å°ã€‚æœ€çŸ¥åçš„åŸºäºé‡å‚æ•°åŒ–çš„æ–¹æ³• &lt;code&gt;LoRa&lt;/code&gt; ï¼Œå®ƒå°†å‚æ•°çŸ©é˜µè¿›è¡Œç®€å•çš„ä½ç§©åˆ†è§£æ¥æ›´æ–°æƒé‡ã€‚æœ€è¿‘çš„ç ”ç©¶ï¼ˆKarimi Mahabadi ç­‰ï¼Œ2021ï¼›Edalati ç­‰ï¼Œ2022ï¼‰è¿˜æ¢ç´¢äº† &lt;code&gt;Kronecker product reparametrization&lt;/code&gt;  çš„ä½¿ç”¨ï¼Œå®ƒåœ¨ç§©å’Œå‚æ•°æ•°é‡ä¹‹é—´å–å¾—äº†æ›´æœ‰åˆ©çš„æƒè¡¡ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;LoRA&lt;/code&gt;  èƒŒåæœ‰ä¸€ä¸ªå‡è®¾ï¼šæˆ‘ä»¬ç°åœ¨çœ‹åˆ°çš„è¿™äº›å¤§è¯­è¨€æ¨¡å‹ï¼Œå®ƒä»¬éƒ½æ˜¯è¢«è¿‡åº¦å‚æ•°åŒ–çš„ã€‚è€Œè¿‡åº¦å‚æ•°åŒ–çš„å¤§æ¨¡å‹èƒŒåï¼Œéƒ½æœ‰ä¸€ä¸ªä½ç»´çš„æœ¬è´¨æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¤§ç™½è¯è¯´ï¼šå¤§æ¨¡å‹å‚æ•°å¾ˆå¤šï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„å‚æ•°éƒ½æ˜¯å‘æŒ¥åŒæ ·ä½œç”¨çš„ï¼›å¤§æ¨¡å‹ä¸­æœ‰å…¶ä¸­ä¸€éƒ¨åˆ†å‚æ•°ï¼Œæ˜¯éå¸¸é‡è¦çš„ï¼Œæ˜¯å½±å“å¤§æ¨¡å‹ç”Ÿæˆç»“æœçš„å…³é”®å‚æ•°ï¼Œè¿™éƒ¨åˆ†å…³é”®å‚æ•°å°±æ˜¯ä¸Šé¢æåˆ°çš„ä½ç»´çš„æœ¬è´¨æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;LoRA&lt;/code&gt;  çš„åŸºæœ¬æ€è·¯ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å‡ æ­¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é¦–å…ˆï¼Œè¦é€‚é…ç‰¹å®šçš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œè¦è®­ç»ƒä¸€ä¸ªç‰¹å®šçš„æ¨¡å‹ï¼Œå°† &lt;code&gt;Y=WX&lt;/code&gt;  å˜æˆ &lt;code&gt;Y=(W+âˆ†W)X&lt;/code&gt; ï¼Œè¿™é‡Œé¢ &lt;code&gt;âˆ†W&lt;/code&gt;  ä¸»æ˜¯æˆ‘ä»¬è¦å¾®è°ƒå¾—åˆ°çš„ç»“æœï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œå°† &lt;code&gt;âˆ†W&lt;/code&gt;  è¿›è¡Œä½ç»´åˆ†è§£ &lt;code&gt;âˆ†W=AB&lt;/code&gt;  ( &lt;code&gt;âˆ†W&lt;/code&gt;  ä¸º &lt;code&gt;m*n&lt;/code&gt;  ç»´ï¼Œ &lt;code&gt;A&lt;/code&gt;  ä¸º &lt;code&gt;m*r&lt;/code&gt;  ç»´ï¼Œ &lt;code&gt;B&lt;/code&gt;  ä¸º &lt;code&gt;r*n&lt;/code&gt;  ç»´ï¼Œ &lt;code&gt;r&lt;/code&gt;  å°±æ˜¯ä¸Šè¿°å‡è®¾ä¸­çš„ä½ç»´)ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œç”¨ç‰¹å®šçš„è®­ç»ƒæ•°æ®ï¼Œè®­ç»ƒå‡º &lt;code&gt;A&lt;/code&gt;  å’Œ &lt;code&gt;B&lt;/code&gt;  å³å¯å¾—åˆ° &lt;code&gt;âˆ†W&lt;/code&gt; ï¼Œåœ¨æ¨ç†çš„è¿‡ç¨‹ä¸­ç›´æ¥å°† &lt;code&gt;âˆ†W&lt;/code&gt;  åŠ åˆ° &lt;code&gt;W&lt;/code&gt;  ä¸Šå»ï¼Œå†æ²¡æœ‰é¢å¤–çš„æˆæœ¬ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦å¤–ï¼Œå¦‚æœè¦ç”¨ &lt;code&gt;LoRA&lt;/code&gt;  é€‚é…ä¸åŒçš„åœºæ™¯ï¼Œåˆ‡æ¢ä¹Ÿéå¸¸æ–¹ä¾¿ï¼Œåšç®€å•çš„çŸ©é˜µåŠ æ³•å³å¯ï¼š &lt;code&gt;(W+âˆ†W)-âˆ†W+âˆ†W&#39;&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒè¯¥æ–¹æ³•è®¤ä¸ºæ¨¡å‹æƒé‡çŸ©é˜µåœ¨ç‰¹å®šå¾®è°ƒåå…·æœ‰è¾ƒä½çš„æœ¬å¾ç§©ï¼Œæ•…åŸºäºç§©åˆ†è§£çš„æ¦‚å¿µï¼Œå°†é¢„è®­ç»ƒæ¨¡å‹çš„ç°æœ‰æƒé‡çŸ©é˜µåˆ†æˆä¸¤ä¸ªè¾ƒå°çš„çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/2.10.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;24-hybrid-methods&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#24-hybrid-methods&#34;&gt;#&lt;/a&gt; 2.4 Hybrid methods&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒæ··åˆå¤šç§ &lt;code&gt;PEFT&lt;/code&gt;  æ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œ &lt;code&gt;MAM Adapter&lt;/code&gt;  ç»“åˆäº† &lt;code&gt;Adapters&lt;/code&gt;  å’Œ &lt;code&gt;Prompt tuning&lt;/code&gt; ï¼› &lt;code&gt;UniPELT&lt;/code&gt;  åŠ å…¥äº† &lt;code&gt;LoRa&lt;/code&gt; ,  &lt;code&gt;Compacter&lt;/code&gt;  å’Œ &lt;code&gt;KronAB&lt;/code&gt;  å¯¹é€‚é…å™¨è¿›è¡Œäº†é‡å‚æ•°åŒ–ä»¥å‡å°‘å…¶å‚æ•°æ•°é‡ï¼›æœ€åï¼Œ &lt;code&gt;S4&lt;/code&gt;  æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–ç®—æ³•æœç´¢çš„ç»“æœï¼Œå®ƒç»“åˆäº†æ‰€æœ‰çš„ &lt;code&gt;PEFT&lt;/code&gt;  ç±»åˆ«ï¼Œé¢å¤–å‚æ•°æ•°é‡å¢åŠ  0.5% çš„æƒ…å†µä¸‹æœ€å¤§åŒ–å‡†ç¡®æ€§ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-ä½¿ç”¨llama-factoryå¾®è°ƒqwen2æ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-ä½¿ç”¨llama-factoryå¾®è°ƒqwen2æ¨¡å‹&#34;&gt;#&lt;/a&gt; ä¸‰ã€ä½¿ç”¨ LLaMA-Factory å¾®è°ƒ Qwen2 æ¨¡å‹&lt;/h1&gt;
&lt;h2 id=&#34;31-è¿è¡Œqwen2æ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#31-è¿è¡Œqwen2æ¨¡å‹&#34;&gt;#&lt;/a&gt; 3.1 è¿è¡Œ Qwen2 æ¨¡å‹&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒé¦–å…ˆè¿›å…¥ä¸‹è½½ Qwen2 çš„&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1F3ZW5MTS9Rd2VuMg==&#34;&gt; github ç½‘é¡µ&lt;/span&gt;çš„è¿è¡Œæ–‡ä»¶ã€‚è¿è¡Œ &lt;code&gt;Qwen2/examples/demo/web_demo.py&lt;/code&gt;  å³å¯åœ¨ç½‘é¡µç«¯è¿è¡Œ &lt;code&gt;Qwen2&lt;/code&gt;  æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè‹¥æœ¬åœ°æ²¡æœ‰å¤§æ¨¡å‹å‚æ•°æ–‡ä»¶ï¼Œåˆ™ä¼šä¸‹è½½ &lt;code&gt;hugging face&lt;/code&gt;  ä¸­çš„å‚æ•°æ–‡ä»¶ã€‚ä½†æ˜¯ &lt;code&gt;hugging face&lt;/code&gt;  ç”±äºç½‘ç»œåŸå› ä¼šå¯¼è‡´æ¨¡å‹ä¸‹è½½å¤±è´¥ã€‚å› æ­¤é€‰æ‹©å›½å†…çš„&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cubW9kZWxzY29wZS5jbi9teS9vdmVydmlldw==&#34;&gt; ModelScope&lt;/span&gt; ç½‘ç«™ä¸‹è½½æ‰€éœ€è¦çš„ &lt;code&gt;Qwen2&lt;/code&gt;  å¤§æ¨¡å‹å‚æ•°æ–‡ä»¶ã€‚æ‰¾åˆ°å¯¹åº”çš„æ¨¡å‹å‚æ•°æ–‡ä»¶ï¼Œä¾æ¬¡ç‚¹å‡»æ¨¡å‹æ–‡ä»¶ - ä¸‹è½½æ¨¡å‹ - SDK ä¸‹è½½ï¼Œå³å¯è·å¾—æ¨¡å‹å‚æ•°æ–‡ä»¶çš„ä¸‹è½½æ–¹å¼ï¼Œä¸€ä¸ªç¤ºä¾‹ä¸‹è½½çš„ &lt;code&gt;python&lt;/code&gt;  ç¨‹åºå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;#æ¨¡å‹ä¸‹è½½&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; modelscope &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; snapshot_download&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;model_dir &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; snapshot_download&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;qwen/Qwen2-1.5B-Instruct&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒå¾…ä¸‹è½½å®Œæˆæ¨¡å‹æ–‡ä»¶åï¼Œæ›´æ”¹ &lt;code&gt;web_demo.py&lt;/code&gt;  æ–‡ä»¶çš„ &lt;code&gt;DEFAULT_CKPT_PATH&lt;/code&gt;  å‚æ•°ä¸ºæ‰€ä¸‹è½½æ¨¡å‹å‚æ•°æ–‡ä»¶çš„è·¯å¾„ï¼Œä¸€ä¸ªç¤ºä¾‹çš„è·¯å¾„ä¸ºï¼š &lt;code&gt;DEFAULT_CKPT_PATH = &#39;E:/python/9_LLM/2_FineTuning/4_Qwen/qwen/Qwen2-1___5B-Instruct&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¹‹åå³å¯æˆåŠŸè¿è¡Œ &lt;code&gt;web_demo.py&lt;/code&gt; ï¼Œå¹¶ä¸æ‰€ä¸‹è½½çš„å¤§æ¨¡å‹å‚æ•°æ–‡ä»¶å¯¹åº”çš„å¤§æ¨¡å‹è¿›è¡Œå¯¹è¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/3.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;32-ä¸‹è½½å¹¶è¿è¡Œllama-factory&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#32-ä¸‹è½½å¹¶è¿è¡Œllama-factory&#34;&gt;#&lt;/a&gt; 3.2 ä¸‹è½½å¹¶è¿è¡Œ LLaMA-Factory&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒé¦–å…ˆè¿›å…¥ &lt;code&gt;github&lt;/code&gt;  çš„&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2hpeW91Z2EvTExhTUEtRmFjdG9yeQ==&#34;&gt; LLaMA-Factory ç½‘é¡µ&lt;/span&gt;ï¼Œä¸‹è½½ &lt;code&gt;LLaMA-Factory&lt;/code&gt;  å·¥å…·ç®±ã€‚è¿è¡Œ &lt;code&gt;LLaMA-Factory-main/src/webui.py&lt;/code&gt;  å³å¯è¿è¡Œ &lt;code&gt;LLaMA-Factory&lt;/code&gt;  çš„ç½‘é¡µå¯è§†åŒ–ç•Œé¢ã€‚å¯è§†åŒ–ç•Œé¢å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/3.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;33-å‡†å¤‡æ•°æ®é›†&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#33-å‡†å¤‡æ•°æ®é›†&#34;&gt;#&lt;/a&gt; 3.3 å‡†å¤‡æ•°æ®é›†&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ &lt;code&gt;LLaMA-Factory-main/data&lt;/code&gt;  æ–‡ä»¶å¤¹ä¸‹ä¿å­˜äº†å‡ ç»„ç¤ºä¾‹æ•°æ®é›†çš„ &lt;code&gt;json&lt;/code&gt;  æ–‡ä»¶ã€‚å…¶ä¸­ &lt;code&gt;dataset_info.json&lt;/code&gt;  åŒ…å«äº†æ‰€æœ‰å¯ç”¨çš„æ•°æ®é›†ã€‚å‚è€ƒ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2hpeW91Z2EvTExhTUEtRmFjdG9yeS9ibG9iL21haW4vZGF0YS9SRUFETUVfemgubWQ=&#34;&gt; LLaMA-Factory çš„è¯´æ˜æ–‡ä»¶&lt;/span&gt;ï¼Œå¦‚æœå¸Œæœ›ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®é›†ï¼Œéœ€è¦åœ¨ &lt;code&gt;dataset_info.json&lt;/code&gt;  æ–‡ä»¶ä¸­æ·»åŠ æ•°æ®é›†æè¿°ï¼Œç›®å‰ &lt;code&gt;LLaMA-Factory&lt;/code&gt;  ä»…æ”¯æŒ &lt;code&gt;alpaca&lt;/code&gt;  æ ¼å¼å’Œ &lt;code&gt;sharegpt&lt;/code&gt;  æ ¼å¼çš„æ•°æ®é›†ã€‚å®Œæ•´çš„æ•°æ®é›†æè¿°å¦‚ä¸‹ï¼Œå…·ä½“çš„ç¤ºä¾‹å¯ä»¥å‚è€ƒåˆå§‹ &lt;code&gt;dataset_info.json&lt;/code&gt;  æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight markdown&#34;&gt;&lt;figcaption data-lang=&#34;markdown&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&#34;æ•°æ®é›†åç§°&#34;: &amp;#123;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;hf_hub_url&#34;: &#34;Hugging Face çš„æ•°æ®é›†ä»“åº“åœ°å€ï¼ˆè‹¥æŒ‡å®šï¼Œåˆ™å¿½ç•¥ script_url å’Œ file_nameï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;ms_hub_url&#34;: &#34;ModelScope çš„æ•°æ®é›†ä»“åº“åœ°å€ï¼ˆè‹¥æŒ‡å®šï¼Œåˆ™å¿½ç•¥ script_url å’Œ file_nameï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;script_url&#34;: &#34;åŒ…å«æ•°æ®åŠ è½½è„šæœ¬çš„æœ¬åœ°æ–‡ä»¶å¤¹åç§°ï¼ˆè‹¥æŒ‡å®šï¼Œåˆ™å¿½ç•¥ file_nameï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;file_name&#34;: &#34;è¯¥ç›®å½•ä¸‹æ•°æ®é›†æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶çš„åç§°ï¼ˆè‹¥ä¸Šè¿°å‚æ•°æœªæŒ‡å®šï¼Œåˆ™æ­¤é¡¹å¿…éœ€ï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;formatting&#34;: &#34;æ•°æ®é›†æ ¼å¼ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼šalpacaï¼Œå¯ä»¥ä¸º alpaca æˆ– sharegptï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;ranking&#34;: &#34;æ˜¯å¦ä¸ºåå¥½æ•°æ®é›†ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼šFalseï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;subset&#34;: &#34;æ•°æ®é›†å­é›†çš„åç§°ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼šNoneï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;split&#34;: &#34;æ‰€ä½¿ç”¨çš„æ•°æ®é›†åˆ‡åˆ†ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼štrainï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;folder&#34;: &#34;Hugging Face ä»“åº“çš„æ–‡ä»¶å¤¹åç§°ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼šNoneï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;num_samples&#34;: &#34;è¯¥æ•°æ®é›†æ‰€ä½¿ç”¨çš„æ ·æœ¬æ•°é‡ã€‚ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼šNoneï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;columnsï¼ˆå¯é€‰ï¼‰&#34;: &amp;#123;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;prompt&#34;: &#34;æ•°æ®é›†ä»£è¡¨æç¤ºè¯çš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šinstructionï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;query&#34;: &#34;æ•°æ®é›†ä»£è¡¨è¯·æ±‚çš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šinputï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;response&#34;: &#34;æ•°æ®é›†ä»£è¡¨å›ç­”çš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šoutputï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;history&#34;: &#34;æ•°æ®é›†ä»£è¡¨å†å²å¯¹è¯çš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šNoneï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;messages&#34;: &#34;æ•°æ®é›†ä»£è¡¨æ¶ˆæ¯åˆ—è¡¨çš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šconversationsï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;system&#34;: &#34;æ•°æ®é›†ä»£è¡¨ç³»ç»Ÿæç¤ºçš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šNoneï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;tools&#34;: &#34;æ•°æ®é›†ä»£è¡¨å·¥å…·æè¿°çš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šNoneï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;images&#34;: &#34;æ•°æ®é›†ä»£è¡¨å›¾åƒè¾“å…¥çš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šNoneï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;chosen&#34;: &#34;æ•°æ®é›†ä»£è¡¨æ›´ä¼˜å›ç­”çš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šNoneï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;rejected&#34;: &#34;æ•°æ®é›†ä»£è¡¨æ›´å·®å›ç­”çš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šNoneï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;kto_tag&#34;: &#34;æ•°æ®é›†ä»£è¡¨ KTO æ ‡ç­¾çš„è¡¨å¤´åç§°ï¼ˆé»˜è®¤ï¼šNoneï¼‰&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &amp;#125;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &#34;tagsï¼ˆå¯é€‰ï¼Œç”¨äº sharegpt æ ¼å¼ï¼‰&#34;: &amp;#123;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;role_tag&#34;: &#34;æ¶ˆæ¯ä¸­ä»£è¡¨å‘é€è€…èº«ä»½çš„é”®åï¼ˆé»˜è®¤ï¼šfromï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;content_tag&#34;: &#34;æ¶ˆæ¯ä¸­ä»£è¡¨æ–‡æœ¬å†…å®¹çš„é”®åï¼ˆé»˜è®¤ï¼švalueï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;user_tag&#34;: &#34;æ¶ˆæ¯ä¸­ä»£è¡¨ç”¨æˆ·çš„ role_tagï¼ˆé»˜è®¤ï¼šhumanï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;assistant_tag&#34;: &#34;æ¶ˆæ¯ä¸­ä»£è¡¨åŠ©æ‰‹çš„ role_tagï¼ˆé»˜è®¤ï¼šgptï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;observation_tag&#34;: &#34;æ¶ˆæ¯ä¸­ä»£è¡¨å·¥å…·è¿”å›ç»“æœçš„ role_tagï¼ˆé»˜è®¤ï¼šobservationï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;function_tag&#34;: &#34;æ¶ˆæ¯ä¸­ä»£è¡¨å·¥å…·è°ƒç”¨çš„ role_tagï¼ˆé»˜è®¤ï¼šfunction_callï¼‰&#34;,&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &#34;system_tag&#34;: &#34;æ¶ˆæ¯ä¸­ä»£è¡¨ç³»ç»Ÿæç¤ºçš„ role_tagï¼ˆé»˜è®¤ï¼šsystemï¼Œä¼šè¦†ç›– system columnï¼‰&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &amp;#125;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&amp;#125;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒæ·»åŠ å®Œæˆæ•°æ®é›†æè¿°åï¼Œå³å¯åœ¨åœ¨ &lt;code&gt;LLaMA-Factory-main/data&lt;/code&gt;  æ–‡ä»¶å¤¹å†…åˆ›å»ºå¯¹åº”æ•°æ®é›†åç§°çš„ &lt;code&gt;json&lt;/code&gt;  æ–‡ä»¶ï¼Œå³å¯å®Œæˆè‡ªå®šä¹‰æ•°æ®é›†çš„æ·»åŠ ã€‚æ•°æ®é›†çš„æ ¼å¼éœ€è¦å’Œæ•°æ®é›†æè¿°ä¸€è‡´ï¼Œè¯¦ç»†çš„ç¤ºä¾‹å¯ä»¥å‚è€ƒåˆå§‹åœ¨ &lt;code&gt;LLaMA-Factory-main/data&lt;/code&gt;  æ–‡ä»¶å¤¹ä¸‹çš„å…¶ä»– &lt;code&gt;json&lt;/code&gt;  æ•°æ®é›†æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;34-ä½¿ç”¨llama-factoryè¿›è¡Œå¤§æ¨¡å‹å¾®è°ƒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#34-ä½¿ç”¨llama-factoryè¿›è¡Œå¤§æ¨¡å‹å¾®è°ƒ&#34;&gt;#&lt;/a&gt; 3.4 ä½¿ç”¨ LLaMA-Factory è¿›è¡Œå¤§æ¨¡å‹å¾®è°ƒ&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨å‡†å¤‡å¥½å¾®è°ƒçš„æ•°æ®é›†ä¹‹åï¼Œå³å¯å†æ¬¡è¿è¡Œ &lt;code&gt;LLaMA-Factory-main/src/webui.py&lt;/code&gt; ï¼Œå¯åŠ¨ LLaMA-Factory çš„å¯è§†åŒ–ç•Œé¢ï¼Œå…¶ä¸­çš„éƒ¨åˆ†å‚æ•°å®šä¹‰å¦‚ä¸‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ•°æ®è·¯å¾„åº”è¯¥æŒ‡å®šä¸ºæœ¬åœ°è®¡ç®—æœº &lt;code&gt;LLaMA-Factory-main/data&lt;/code&gt;  æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/LLM_finetune/3.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå®šä¹‰å®Œæˆè®­ç»ƒå‚æ•°åå³å¯ç‚¹å‡» â€œå¼€å§‹â€ æŒ‰é’®ï¼Œå¼€å§‹æ¨¡å‹çš„å¾®è°ƒè®­ç»ƒã€‚æ¨¡å‹è®­ç»ƒå®Œæ¯•åï¼Œç‚¹å‡» &lt;code&gt;Chat&lt;/code&gt;  é€‰é¡¹å¡ï¼Œæ£€æŸ¥ç‚¹è·¯å¾„é€‰æ‹©è®­ç»ƒå¥½çš„å¤§æ¨¡å‹ï¼Œå³å¯å¼€å§‹ä¸å¾®è°ƒå®Œæˆçš„å¤§æ¨¡å‹è¿›è¡Œåœ¨çº¿å¯¹è¯ã€‚ç‚¹å‡» &lt;code&gt;Export&lt;/code&gt;  é€‰é¡¹å¡ï¼ŒæŒ‡å®šå¯¼å‡ºç›®å½•ä»¥åŠå…¶ä»–è®¾ç½®ï¼Œç‚¹å‡» â€œå¼€å§‹å¯¼å‡ºâ€ï¼Œå³å¯å¯¼å‡ºè®­ç»ƒå®Œæ¯•çš„å¤§æ¨¡å‹ã€‚è‡³æ­¤ï¼Œå·²ç»å®Œæˆä½¿ç”¨ &lt;code&gt;LLaMA-Factory&lt;/code&gt;  è¿›è¡Œå¤§æ¨¡å‹å¾®è°ƒçš„å…¨éƒ¨è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h1 id=&#34;æ€»ç»“&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ€»ç»“&#34;&gt;#&lt;/a&gt; æ€»ç»“&lt;/h1&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC82NDk3NTUyNTI=&#34;&gt;https://zhuanlan.zhihu.com/p/649755252&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;BitFit&lt;br&gt;
 å¯¹å¾®è°ƒæœºåˆ¶çš„ä¸€ç§ç§¯ææ¢ç´¢ï¼Œä¹Ÿå¾ˆç®€å•ï¼Œé€šè¿‡ä»…è°ƒæ•´ bias æ•ˆæœå°±èƒ½æœ‰ä¸é”™çš„æ•ˆæœï¼Œä½†æ²¡æœ‰å…·ä½“é˜è¿°åŸç†ï¼Œå°±æ˜¯é€šè¿‡çŒœæµ‹åŠ å®éªŒå¾—åˆ°çš„ç»“æœã€‚åŒæ—¶ï¼Œä½œè€…æå‡ºä¸€ä¸ªè§‚ç‚¹ï¼šå¾®è°ƒçš„è¿‡ç¨‹ä¸æ˜¯è®©æ¨¡å‹é€‚åº”å¦å¤–çš„æ•°æ®åˆ†å¸ƒï¼Œè€Œæ˜¯è®©æ¨¡å‹æ›´å¥½çš„åº”ç”¨å‡ºæœ¬èº«çš„è¡¨å¾èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;è®­ç»ƒå‚æ•°é‡æå°ï¼ˆçº¦ 0.1%ï¼‰ã€‚&lt;br&gt;
åœ¨å¤§éƒ¨åˆ†ä»»åŠ¡ä¸Šæ•ˆæœä¼šå·®äº LoRAã€Adapter ç­‰æ–¹æ³•ã€‚&lt;br&gt;
Prefix Tuning&lt;br&gt;
 åœ¨æ¯ä¸€ä¸ª Transformer å±‚éƒ½å¸¦ä¸Šä¸€äº› virtual token ä½œä¸ºå‰ç¼€ï¼Œä»¥é€‚åº”ä¸åŒçš„ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;å‰ç¼€ Token ä¼šå ç”¨åºåˆ—é•¿åº¦ï¼Œæœ‰ä¸€å®šçš„é¢å¤–è®¡ç®—å¼€é”€ã€‚&lt;br&gt;
Prefix Tuning çš„çº¿æ€§æ’å€¼æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚&lt;br&gt;
Prompt Tuning&lt;br&gt;
 è¯¥æ–¹æ³•å¯ä»¥çœ‹ç€æ˜¯ Prefix Tuning çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒçš„ä»»åŠ¡ï¼Œä»…åœ¨è¾“å…¥å±‚å¼•å…¥ virtual token å½¢å¼çš„è½¯æç¤ºï¼ˆsoft promptï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;ç›¸å¯¹äº Prefix Tuningï¼Œå‚ä¸è®­ç»ƒçš„å‚æ•°é‡å’Œæ”¹å˜çš„å‚æ•°é‡æ›´å°ï¼Œæ›´èŠ‚çœæ˜¾å­˜ã€‚&lt;br&gt;
å¯¹ä¸€äº›ç®€å•çš„ NLU ä»»åŠ¡è¿˜ä¸é”™ï¼Œä½†å¯¹ç¡¬åºåˆ—æ ‡è®°ä»»åŠ¡ï¼ˆå³åºåˆ—æ ‡æ³¨ï¼‰è¡¨ç°æ¬ ä½³ã€‚&lt;br&gt;
P-Tuning&lt;br&gt;
 å°† Prompt è½¬æ¢ä¸ºå¯ä»¥å­¦ä¹ çš„ Embedding å±‚ï¼Œå¹¶ç”¨ MLP+LSTM çš„æ–¹å¼æ¥å¯¹ Prompt Embedding è¿›è¡Œä¸€å±‚å¤„ç†ã€‚ç›¸æ¯” Prefix Tuningï¼Œä»…åœ¨è¾“å…¥å±‚åŠ å…¥çš„å¯å¾®çš„ virtual tokenï¼›å¦å¤–ï¼Œvirtual token çš„ä½ç½®ä¹Ÿä¸ä¸€å®šæ˜¯å‰ç¼€ï¼Œæ’å…¥çš„ä½ç½®æ˜¯å¯é€‰çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;å¼•å…¥ä¸€ä¸ª prompt encoderï¼ˆç”±ä¸€ä¸ªåŒå‘çš„ LSTM + ä¸¤å±‚ MLP ç»„æˆï¼‰æ¥å»ºæ¨¡ virtual token çš„ç›¸äº’ä¾èµ–ä¼šæ”¶æ•›æ›´å¿«ï¼Œæ•ˆæœæ›´å¥½ã€‚&lt;br&gt;
P-Tuning v2&lt;br&gt;
 è¯¥æ–¹æ³•åœ¨æ¯ä¸€ä¸ª Transformer å±‚éƒ½åŠ å…¥äº† prompt token ä½œä¸ºè¾“å…¥ï¼Œå¼•å…¥å¤šä»»åŠ¡å­¦ä¹ ï¼Œé’ˆå¯¹ä¸åŒä»»åŠ¡é‡‡ç”¨ä¸åŒçš„æç¤ºé•¿åº¦ã€‚å¹¶ä¸”å›å½’ä¼ ç»Ÿçš„åˆ†ç±»æ ‡ç­¾èŒƒå¼ï¼Œè€Œä¸æ˜¯æ˜ å°„å™¨ã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;è§£å†³äº† Prompt Tuning æ— æ³•åœ¨å°æ¨¡å‹ä¸Šæœ‰æ•ˆæå‡çš„é—®é¢˜ã€‚&lt;br&gt;
ç§»é™¤äº†å¯¹æ¨¡å‹æ•ˆæœæ”¹è¿›è¾ƒå°çš„é‡å‚æ•°åŒ–çš„ç¼–ç å™¨ï¼ˆå¦‚ï¼šPrefix Tuning ä¸­çš„ MLPã€P-Tuning ä¸­çš„ LSTMï¼‰ã€‚&lt;br&gt;
å¯¹äºä¸€äº›å¤æ‚çš„ç¡¬åºåˆ—æ ‡è®°ä»»åŠ¡ï¼ˆå³åºåˆ—æ ‡æ³¨ï¼‰å–å¾—äº†ä¸é”™çš„æ•ˆæœã€‚&lt;br&gt;
Adapter Tuning&lt;br&gt;
 è¯¥æ–¹æ³•è®¾è®¡äº† Adapter ç»“æ„ï¼Œå¹¶å°†å…¶åµŒå…¥ Transformer çš„ç»“æ„é‡Œé¢ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ª Transformer å±‚ï¼Œå¢åŠ äº†ä¸¤ä¸ª Adapter ç»“æ„ï¼Œåœ¨è®­ç»ƒæ—¶ï¼Œå›ºå®šä½åŸæ¥é¢„è®­ç»ƒæ¨¡å‹çš„å‚æ•°ä¸å˜ï¼Œåªå¯¹æ–°å¢çš„ Adapter ç»“æ„å’Œ Layer Norm å±‚è¿›è¡Œå¾®è°ƒã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;é€šè¿‡åœ¨ Transformer å±‚ä¸­åµŒå…¥ Adapter ç»“æ„ï¼Œåœ¨æ¨ç†æ—¶ä¼šé¢å¤–å¢åŠ æ¨ç†æ—¶é•¿ã€‚&lt;br&gt;
AdapterFusion&lt;br&gt;
 ä¸€ç§èåˆå¤šä»»åŠ¡ä¿¡æ¯çš„ Adapter çš„å˜ä½“ï¼Œåœ¨ Adapter çš„åŸºç¡€ä¸Šè¿›è¡Œä¼˜åŒ–ï¼Œé€šè¿‡å°†å­¦ä¹ è¿‡ç¨‹åˆ†ä¸ºä¸¤é˜¶æ®µæ¥æå‡ä¸‹æ¸¸ä»»åŠ¡è¡¨ç°ã€‚&lt;/p&gt;
&lt;p&gt;AdapterDrop&lt;br&gt;
 è¯¥æ–¹æ³•åœ¨ä¸å½±å“ä»»åŠ¡æ€§èƒ½çš„æƒ…å†µä¸‹ï¼Œå¯¹ Adapter åŠ¨æ€é«˜æ•ˆçš„ç§»é™¤ï¼Œå°½å¯èƒ½çš„å‡å°‘æ¨¡å‹çš„å‚æ•°é‡ï¼Œæé«˜æ¨¡å‹åœ¨åå‘ä¼ æ’­ï¼ˆè®­ç»ƒï¼‰å’Œæ­£å‘ä¼ æ’­ï¼ˆæ¨ç†ï¼‰æ—¶çš„æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;é€šè¿‡ä»è¾ƒä½çš„ Transformer å±‚åˆ é™¤å¯å˜æ•°é‡çš„ Adaper æ¥æå‡æ¨ç†é€Ÿåº¦ã€‚ å½“å¯¹å¤šä¸ªä»»åŠ¡æ‰§è¡Œæ¨ç†æ—¶ï¼ŒåŠ¨æ€åœ°å‡å°‘äº†è¿è¡Œæ—¶çš„è®¡ç®—å¼€é”€ï¼Œå¹¶åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¿æŒäº†ä»»åŠ¡æ€§èƒ½ã€‚&lt;br&gt;
LoRA&lt;br&gt;
 è¯¥æ–¹æ³•é€šè¿‡ä½ç§©åˆ†è§£æ¥æ¨¡æ‹Ÿå‚æ•°çš„æ”¹å˜é‡ï¼Œä»è€Œä»¥æå°çš„å‚æ•°é‡æ¥å®ç°å¤§æ¨¡å‹çš„é—´æ¥è®­ç»ƒã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;å°† BA åŠ åˆ° W ä¸Šå¯ä»¥æ¶ˆé™¤æ¨ç†å»¶è¿Ÿã€‚&lt;br&gt;
å¯ä»¥é€šè¿‡å¯æ’æ‹”çš„å½¢å¼åˆ‡æ¢åˆ°ä¸åŒçš„ä»»åŠ¡ã€‚&lt;br&gt;
è®¾è®¡çš„æ¯”è¾ƒå¥½ï¼Œç®€å•ä¸”æ•ˆæœå¥½ã€‚&lt;/p&gt;
&lt;p&gt;AdaLoRA&lt;br&gt;
 å¯¹ LoRA çš„ä¸€ç§æ”¹è¿›ï¼Œå®ƒæ ¹æ®é‡è¦æ€§è¯„åˆ†åŠ¨æ€åˆ†é…å‚æ•°é¢„ç®—ç»™æƒé‡çŸ©é˜µï¼Œå°†å…³é”®çš„å¢é‡çŸ©é˜µåˆ†é…é«˜ç§©ä»¥æ•æ‰æ›´ç²¾ç»†å’Œä»»åŠ¡ç‰¹å®šçš„ä¿¡æ¯ï¼Œè€Œå°†è¾ƒä¸é‡è¦çš„çŸ©é˜µçš„ç§©é™ä½ï¼Œä»¥é˜²æ­¢è¿‡æ‹Ÿåˆå¹¶èŠ‚çœè®¡ç®—é¢„ç®—ã€‚&lt;/p&gt;
&lt;p&gt;QLoRA&lt;br&gt;
 ä½¿ç”¨ä¸€ç§æ–°é¢–çš„é«˜ç²¾åº¦æŠ€æœ¯å°†é¢„è®­ç»ƒæ¨¡å‹é‡åŒ–ä¸º 4 bitï¼Œç„¶åæ·»åŠ ä¸€å°ç»„å¯å­¦ä¹ çš„ä½ç§©é€‚é…å™¨æƒé‡ï¼Œè¿™äº›æƒé‡é€šè¿‡é‡åŒ–æƒé‡çš„åå‘ä¼ æ’­æ¢¯åº¦è¿›è¡Œå¾®è°ƒã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ QLoRA å¾®è°ƒæ¨¡å‹ï¼Œå¯ä»¥æ˜¾è‘—é™ä½å¯¹äºæ˜¾å­˜çš„è¦æ±‚ã€‚åŒæ—¶ï¼Œæ¨¡å‹è®­ç»ƒçš„é€Ÿåº¦ä¼šæ…¢äº LoRAã€‚&lt;br&gt;
MAM Adapter&lt;br&gt;
 ä¸€ç§åœ¨ Adapterã€Prefix Tuning å’Œ LoRA ä¹‹é—´å»ºç«‹è”ç³»çš„ç»Ÿä¸€æ–¹æ³•ã€‚æœ€ç»ˆçš„æ¨¡å‹ MAM Adapter æ˜¯ç”¨äº FFN çš„å¹¶è¡Œ Adapter å’Œ è½¯æç¤ºçš„ç»„åˆã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;æ•´ä½“ä¸Šæ¥è¯´ï¼Œæœ€ç»ˆçš„æ¨¡å‹ MAM Adapter æ•ˆæœä¼šä¼˜äºå•ä¸ªé«˜æ•ˆå¾®è°ƒæ–¹æ³•ã€‚&lt;br&gt;
UniPELT&lt;br&gt;
 ä¸€ç§å°†ä¸åŒçš„ PELT æ–¹æ³• LoRAã€Prefix Tuning å’Œ Adapter ä½œä¸ºå­æ¨¡å—ï¼Œå¹¶é€šè¿‡é—¨æ§æœºåˆ¶å­¦ä¹ æ¿€æ´»æœ€é€‚åˆå½“å‰æ•°æ®æˆ–ä»»åŠ¡çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;ç›¸å¯¹äº LoRAï¼ŒBitFitï¼ŒPrefix-tuningï¼Œè®­ç»ƒçš„å‚æ•°é‡æ›´å¤§ï¼›åŒæ—¶ï¼Œæ¨ç†æ›´è€—æ—¶ï¼›å¹¶ä¸”ï¼Œè¾“å…¥ä¼šå ç”¨é¢å¤–çš„åºåˆ—é•¿åº¦ã€‚&lt;br&gt;
å¤šç§ PELT æ–¹æ³•çš„æ··åˆæ¶‰åŠ PLM çš„ä¸åŒéƒ¨åˆ†å¯¹æ¨¡å‹æœ‰æ•ˆæ€§å’Œé²æ£’æ€§éƒ½æœ‰å¥½å¤„ã€‚&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/07/23/AI/Prompt_engineering/</guid>
            <title>å¤§æ¨¡å‹æç¤ºè¯å·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰</title>
            <link>http://qianqiu-cell.github.io/2024/07/23/AI/Prompt_engineering/</link>
            <category>AI</category>
            <pubDate>Tue, 23 Jul 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3dzeWFkYy9nZW5lcmF0aXZlLWFpLWZvci1iZWdpbm5lcnM=&#34;&gt;https://github.com/wsyadc/generative-ai-for-beginners&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸€-ä»€ä¹ˆæ˜¯æç¤ºè¯å·¥ç¨‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-ä»€ä¹ˆæ˜¯æç¤ºè¯å·¥ç¨‹&#34;&gt;#&lt;/a&gt; ä¸€ã€ä»€ä¹ˆæ˜¯æç¤ºè¯å·¥ç¨‹&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒæç¤ºå·¥ç¨‹è¢«å®šä¹‰ä¸ºè®¾è®¡å’Œä¼˜åŒ–æ–‡æœ¬è¾“å…¥ï¼ˆæç¤ºï¼‰ä»¥æä¾›ä¸€è‡´ä¸”é«˜è´¨é‡å“åº”ï¼ˆå®Œæˆï¼‰çš„è¿‡ç¨‹ï¼Œä»¥å®ç°ç‰¹å®šçš„åº”ç”¨ç›®æ ‡å’Œæ¨¡å‹ã€‚æç¤ºå·¥ç¨‹æ˜¯åˆ›å»ºå°†äº§ç”Ÿæ‰€éœ€ç»“æœçš„æç¤ºçš„è¿‡ç¨‹ã€‚ æç¤ºå·¥ç¨‹ä¸ä»…ä»…æ˜¯ç¼–å†™æ–‡æœ¬æç¤ºã€‚æç¤ºå·¥ç¨‹ä¸æ˜¯ä¸€é—¨å·¥ç¨‹å­¦ç§‘ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ç»„å¯ä»¥åº”ç”¨ä»¥è·å¾—æ‰€éœ€ç»“æœçš„æŠ€æœ¯ã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºä¸€ä¸ªä¸¤æ­¥è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ºç‰¹å®šæ¨¡å‹å’Œç›®æ ‡è®¾è®¡åˆå§‹æç¤º&lt;/li&gt;
&lt;li&gt;è¿­ä»£åœ°ä¼˜åŒ–æç¤ºä»¥æé«˜å“åº”è´¨é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒè¿™å¿…ç„¶æ˜¯ä¸€ä¸ªéœ€è¦ç”¨æˆ·ç›´è§‰å’ŒåŠªåŠ›çš„è¯•é”™è¿‡ç¨‹ï¼Œä»¥è·å¾—æœ€ä½³ç»“æœã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿè¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£ä¸‰ä¸ªæ¦‚å¿µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tokenization = æ¨¡å‹å¦‚ä½• â€œçœ‹åˆ°â€ æç¤º&lt;/li&gt;
&lt;li&gt;Base LLMs = åŸºç¡€æ¨¡å‹å¦‚ä½• â€œå¤„ç†â€ æç¤º&lt;/li&gt;
&lt;li&gt;Instruction-Tuned LLMs = æ¨¡å‹ç°åœ¨å¦‚ä½•çœ‹åˆ° â€œä»»åŠ¡â€&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äºŒ-ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æç¤ºè¯å·¥ç¨‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æç¤ºè¯å·¥ç¨‹&#34;&gt;#&lt;/a&gt; äºŒã€ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æç¤ºè¯å·¥ç¨‹&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒç°åœ¨æˆ‘ä»¬çŸ¥é“äº† LLMs å¦‚ä½•å¤„ç†æç¤ºï¼Œè®©æˆ‘ä»¬è°ˆè°ˆä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æç¤ºå·¥ç¨‹ã€‚ ç­”æ¡ˆåœ¨äºï¼Œå½“å‰çš„ LLMs çš„ç®—æ³•ä¹Ÿæœ‰è®¸å¤šæŒ‘æˆ˜ï¼Œå¦‚æœä¸åŠæ—¶ä¼˜åŒ–ï¼Œå°±å¾ˆéš¾å®ç° â€œå¯é ä¸”ä¸€è‡´çš„è¡¥å…¨â€ã€‚ ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;== æ¨¡å‹å“åº”æ˜¯éšæœºçš„ã€‚== ç›¸åŒçš„æç¤ºå¯èƒ½ä¼šé’ˆå¯¹ä¸åŒçš„æ¨¡å‹æˆ–æ¨¡å‹ç‰ˆæœ¬äº§ç”Ÿä¸åŒçš„å“åº”ã€‚ ç”šè‡³å¯èƒ½åœ¨ä¸åŒæ—¶é—´ä½¿ç”¨ç›¸åŒæ¨¡å‹äº§ç”Ÿä¸åŒçš„ç»“æœã€‚ æç¤ºå·¥ç¨‹æŠ€æœ¯å¯ä»¥é€šè¿‡æä¾›æ›´å¥½å¸®åŠ©æˆ‘ä»¬æœ€å¤§é™åº¦åœ°å‡å°‘è¿™äº›å˜åŒ–æ‰€å¸¦æ¥çš„å½±å“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;== æ¨¡å‹å¯ä»¥äº§ç”Ÿå¹»è§‰å“åº”ã€‚== æ¨¡å‹æ˜¯ä½¿ç”¨å¤§å‹ä½†æœ‰é™æ•°æ®é›†è¿›è¡Œé¢„è®­ç»ƒçš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬ç¼ºä¹æœ‰å…³è®­ç»ƒèŒƒå›´ä¹‹å¤–çš„æ¦‚å¿µçš„çŸ¥è¯†ã€‚ å› æ­¤ï¼Œå®ƒä»¬å¯èƒ½ä¼šäº§ç”Ÿä¸å‡†ç¡®ã€è™šæ„æˆ–ä¸å·²çŸ¥äº‹å®ç›´æ¥çŸ›ç›¾çš„å®Œæˆç»“æœã€‚ æç¤ºå·¥ç¨‹æŠ€æœ¯å¯ä»¥å¸®åŠ©ç”¨æˆ·è¯†åˆ«å’Œå‡è½»å¹»è§‰ï¼Œä¾‹å¦‚é€šè¿‡å‘äººå·¥æ™ºèƒ½è¯¢é—®å‡ºå¤„æˆ–æ¨ç†è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;== æ¨¡å‹åŠŸèƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ == è¾ƒæ–°çš„æ¨¡å‹æˆ–æ¨¡å‹è¿­ä»£å°†å…·æœ‰æ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼Œä½†ä¹Ÿä¼šå¸¦æ¥ç‹¬ç‰¹çš„æ€ªç™–ä»¥åŠæˆæœ¬å’Œå¤æ‚æ€§æ–¹é¢çš„å¹³è¡¡ã€‚ æç¤ºå·¥ç¨‹å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¼€å‘æœ€ä½³å®è·µå’Œå·¥ä½œæµç¨‹ï¼Œä»¥å¯æ‰©å±•å’Œæ— ç¼çš„æ–¹å¼æ¶ˆé™¤å·®å¼‚å¹¶é€‚åº”ç‰¹å®šäºæ¨¡å‹çš„è¦æ±‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;ä¸‰-æç¤ºå·¥ç¨‹çš„æŠ€å·§&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-æç¤ºå·¥ç¨‹çš„æŠ€å·§&#34;&gt;#&lt;/a&gt; ä¸‰ã€æç¤ºå·¥ç¨‹çš„æŠ€å·§&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒç®€å•æç¤ºçš„å±€é™æ€§ï¼šç®€å•æç¤ºå¯èƒ½æ— æ³•å¾—åˆ°ä½ æƒ³è¦çš„ç»“æœï¼ŒåŸå› å¦‚ä¸‹ï¼šï¼ˆ1ï¼‰å¤§è¯é¢˜ï¼›ï¼ˆ2ï¼‰æ²¡æœ‰é™å®šè¾“å‡ºæ ¼å¼ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›åŸºæœ¬æŠ€å·§æ¥æç¤º LLMã€‚&lt;/p&gt;
&lt;h2 id=&#34;31-zero-shot-prompting-é›¶æ ·æœ¬æç¤º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#31-zero-shot-prompting-é›¶æ ·æœ¬æç¤º&#34;&gt;#&lt;/a&gt; 3.1 Zero-shot prompting ï¼ˆé›¶æ ·æœ¬æç¤ºï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒè¿™ç§æç¤ºé£æ ¼éå¸¸ç®€å•ï¼Œå®ƒåªæœ‰ä¸€ä¸ªæç¤ºã€‚å½“ä½ å¼€å§‹å­¦ä¹  LLM æ—¶ï¼Œå¯èƒ½å°±ä¼šç”¨åˆ°è¿™ç§æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Prompt: â€œWhat is Algebra?â€&lt;/li&gt;
&lt;li&gt;Answer: â€œAlgebra is a branch of mathematics that studies mathematical symbols and the rules for manipulating these symbols.â€&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;32-few-shot-prompting-å°‘æ ·æœ¬æç¤º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#32-few-shot-prompting-å°‘æ ·æœ¬æç¤º&#34;&gt;#&lt;/a&gt; 3.2 Few-shot prompting ï¼ˆå°‘æ ·æœ¬æç¤ºï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒè¿™ç§æç¤ºæ–¹å¼é€šè¿‡åœ¨æå‡ºè¯·æ±‚çš„åŒæ—¶æä¾›ä¸€äº›ç¤ºä¾‹æ¥å¸®åŠ©æ¨¡å‹ã€‚å®ƒç”±å•ä¸ªæç¤ºå’Œé™„åŠ çš„ç‰¹å®šä»»åŠ¡æ•°æ®ç»„æˆã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Prompt: &amp;quot;ä»¥èå£«æ¯”äºšçš„é£æ ¼å†™ä¸€é¦–è¯—ã€‚ä¸‹é¢æ˜¯ä¸€äº›èå£«æ¯”äºšåå››è¡Œè¯—çš„ä¾‹å­ï¼šåå››è¡Œè¯—ç¬¬ 18 é¦–ï¼š&amp;quot; æˆ‘è¦æŠŠä½ æ¯”ä½œå¤æ—¥å—ï¼Ÿä½ æ›´å¯çˆ±ï¼Œæ›´æœ‰èŠ‚åˆ¶â€¦&#39; ç¬¬ 116 é¦–åå››è¡Œè¯—ï¼š&amp;quot; è®©æˆ‘ä¸è¦ä¸ºçœŸæ­£å¿ƒçµçš„ç»“åˆè®¾ç½®éšœç¢ã€‚çˆ±ä¸æ˜¯çˆ±ï¼Œå½“å®ƒå‘ç°æ”¹å˜æ—¶å°±ä¼šæ”¹å˜â€¦&#39; åå››è¡Œè¯—ç¬¬ 132 é¦–ï¼šâ€œæˆ‘çˆ±ä½ çš„çœ¼ç›ï¼Œå®ƒä»¬æ€œæ‚¯æˆ‘ï¼ŒçŸ¥é“ä½ çš„å¿ƒåœ¨æŠ˜ç£¨æˆ‘ï¼Œå¯¹æˆ‘ä¸å±‘ä¸€é¡¾â€¦ ç°åœ¨ï¼Œè¯·å†™ä¸€é¦–å…³äºæœˆäº®ä¹‹ç¾çš„åå››è¡Œè¯—ã€‚â€&lt;/li&gt;
&lt;li&gt;Answerï¼šâ€œåœ¨å¤©ç©ºä¸­ï¼Œæœˆäº®é—ªçƒç€æŸ”å’Œçš„å…‰èŠ’ï¼Œæ•£å‘ç€æ¸©æŸ”çš„å…‰è¾‰ï¼Œâ€¦â€&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒç¤ºä¾‹ä¸º LLM æä¾›äº†æ‰€éœ€è¾“å‡ºçš„èƒŒæ™¯ã€æ ¼å¼æˆ–é£æ ¼ã€‚å®ƒä»¬æœ‰åŠ©äºæ¨¡å‹ç†è§£å…·ä½“ä»»åŠ¡ï¼Œå¹¶ç”Ÿæˆæ›´å‡†ç¡®ã€æ›´ç›¸å…³çš„å›å¤ã€‚&lt;/p&gt;
&lt;h2 id=&#34;33-chain-of-thought-cot-æ€ç»´é“¾&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#33-chain-of-thought-cot-æ€ç»´é“¾&#34;&gt;#&lt;/a&gt; 3.3 Chain-of-thought ï¼ˆCoT, æ€ç»´é“¾ï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒé“¾å¼æ€ç»´æ˜¯ä¸€ç§éå¸¸æœ‰è¶£çš„æŠ€æœ¯ï¼Œå› ä¸ºå®ƒæ¶‰åŠè®©å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ç»è¿‡ä¸€ç³»åˆ—æ­¥éª¤ã€‚è¿™ä¸ªæƒ³æ³•æ˜¯ä»¥ä¸€ç§æ–¹å¼æŒ‡å¯¼ LLMï¼Œä½¿å…¶ç†è§£å¦‚ä½•å®ŒæˆæŸé¡¹ä»»åŠ¡ã€‚è¯·è€ƒè™‘ä»¥ä¸‹å¸¦æœ‰å’Œä¸å¸¦é“¾å¼æ€ç»´çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Prompt: â€œAlice has 5 apples, throws 3 apples, gives 2 to Bob and Bob gives one back, how many apples does Alice have?â€&lt;/li&gt;
&lt;li&gt;Answer: 5&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒLLM ç»™å‡ºçš„ç­”æ¡ˆä¸º 5ï¼Œè¿™æ˜¯ä¸æ­£ç¡®çš„ã€‚ æ ¹æ®è®¡ç®—ç»“æœ (5 -3 -2 + 1 = 1)ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ 1 ä¸ªè‹¹æœã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé‚£ä¹ˆæˆ‘ä»¬æ€æ ·æ‰èƒ½æ•™ LLM æ­£ç¡®åœ°åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿè®©æˆ‘ä»¬å°è¯•ä¸€ä¸‹æ€ç»´é“¾ã€‚ åº”ç”¨æ€ç»´é“¾æ„å‘³ç€ï¼š&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç»™ LLM ä¸€ä¸ªç±»ä¼¼çš„ä¾‹å­ã€‚å±•ç¤ºè®¡ç®—ç»“æœï¼Œä»¥åŠå¦‚ä½•æ­£ç¡®è®¡ç®—ã€‚æä¾›åŸå§‹æç¤ºã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Prompt: â€œLisa has 7 apples, throws 1 apple, gives 4 apples to Bart and Bart gives one back: 7 -1 = 6 6 -4 = 2 2 +1 = 3&lt;br&gt;
Alice has 5 apples, throws 3 apples, gives 2 to Bob and Bob gives one back, how many apples does Alice have?â€&lt;/li&gt;
&lt;li&gt;Answer: 1&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒè¯·æ³¨æ„æˆ‘ä»¬å¦‚ä½•ç”¨å¦ä¸€ä¸ªç¤ºä¾‹ã€è®¡ç®—å’ŒåŸå§‹æç¤ºç¼–å†™æ›´é•¿çš„æç¤ºï¼Œç„¶åå¾—å‡ºæ­£ç¡®ç­”æ¡ˆ 1ã€‚æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæ€ç»´é“¾æ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå…¶ä»–æ›´åŠ ä¸°å¯Œçš„ CoTï¼Œå¦‚é›¶æ ·æœ¬æ€ç»´é“¾ï¼Œè‡ªæ´½æ€§ç­‰å¯ä»¥å‚è€ƒ&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9wcm9tcHRkZXYuYWkvemgtSGFucy9kb2NzL2ludGVybWVkaWF0ZS9zZWxmX2NvbnNpc3RlbmN5&#34;&gt; https://promptdev.ai/zh-Hans/docs/intermediate/self_consistency&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;34-generated-knowledge-çŸ¥è¯†ç”Ÿæˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#34-generated-knowledge-çŸ¥è¯†ç”Ÿæˆ&#34;&gt;#&lt;/a&gt; 3.4 Generated knowledge ï¼ˆçŸ¥è¯†ç”Ÿæˆï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒç”Ÿæˆçš„çŸ¥è¯†æ–¹æ³•ï¼ˆGenerated Knowledge Approachï¼‰1 è¦æ±‚ LLM åœ¨ç”Ÿæˆå“åº”ä¹‹å‰ç”Ÿæˆä¸é—®é¢˜ç›¸å…³çš„å¯èƒ½æœ‰ç”¨çš„ä¿¡æ¯ã€‚è¯¥æ–¹æ³•ç”±ä¸¤ä¸ªä¸­é—´æ­¥éª¤ç»„æˆï¼Œå³&lt;mark&gt;çŸ¥è¯†ç”Ÿæˆå’ŒçŸ¥è¯†é›†æˆ&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Prompt_engineering/3.4.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰çŸ¥è¯†ç”Ÿæˆ&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨çŸ¥è¯†ç”Ÿæˆæ­¥éª¤ä¸­ï¼Œè¦æ±‚ LLM ç”Ÿæˆæœ‰å…³é—®é¢˜çš„ä¸€ç»„äº‹å®ã€‚å¤§è¯­è¨€æ¨¡å‹å°†ä»¥ few-shot æ–¹å¼è¿›è¡Œæç¤ºï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ä½¿ç”¨ç›¸åŒæç¤ºç”Ÿæˆ M ä¸ªä¸åŒçš„å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Prompt_engineering/3.4.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰çŸ¥è¯†é›†æˆ&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”Ÿæˆ â€œçŸ¥è¯†å¢å¼ºâ€ é—®é¢˜ï¼Œå¹¶ç”¨å®ƒä»¬æç¤º LLM è·å¾—æœ€ç»ˆç­”æ¡ˆã€‚æœ€å¥½çš„ç†è§£æ–¹æ³•æ˜¯é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå‡è®¾æˆ‘ä»¬æ­£åœ¨å°è¯•å›ç­”é—®é¢˜ â€œå¤§å¤šæ•°è¢‹é¼ æœ‰ &lt;mask&gt; è‚¢ä½“â€ã€‚å‡è®¾åœ¨çŸ¥è¯†ç”Ÿæˆæ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆäº† 2 ä¸ªçŸ¥è¯†ï¼ˆM=2ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;çŸ¥è¯† 1ï¼šâ€œè¢‹é¼ æ˜¯ç”Ÿæ´»åœ¨æ¾³å¤§åˆ©äºšçš„æœ‰è¢‹åŠ¨ç‰©ã€‚â€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çŸ¥è¯† 2ï¼šâ€œè¢‹é¼ æ˜¯æœ‰ 5 æ¡è‚¢ä½“çš„æœ‰è¢‹åŠ¨ç‰©ã€‚â€&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒç°åœ¨ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªçŸ¥è¯†ä¸é—®é¢˜è¿æ¥èµ·æ¥ï¼Œç”ŸæˆçŸ¥è¯†å¢å¼ºçš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;çŸ¥è¯†å¢å¼ºé—®é¢˜ 1ï¼šâ€œå¤§å¤šæ•°è¢‹é¼ æœ‰ &lt;mask&gt; è‚¢ä½“ã€‚è¢‹é¼ æ˜¯ç”Ÿæ´»åœ¨æ¾³å¤§åˆ©äºšçš„æœ‰è¢‹åŠ¨ç‰©ã€‚â€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çŸ¥è¯†å¢å¼ºé—®é¢˜ 2ï¼šâ€œå¤§å¤šæ•°è¢‹é¼ æœ‰ &lt;mask&gt; è‚¢ä½“ã€‚è¢‹é¼ æ˜¯æœ‰ 5 æ¡è‚¢ä½“çš„æœ‰è¢‹åŠ¨ç‰©ã€‚â€&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒç„¶åï¼Œæˆ‘ä»¬ç”¨è¿™äº›çŸ¥è¯†å¢å¼ºçš„é—®é¢˜æç¤º LLMï¼Œå¹¶è·å¾—æœ€ç»ˆç­”æ¡ˆçš„ææ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç­”æ¡ˆ 1ï¼šâ€œ4â€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç­”æ¡ˆ 2ï¼šâ€œ5â€&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒæˆ‘ä»¬é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„ç­”æ¡ˆä½œä¸ºæœ€ç»ˆç­”æ¡ˆã€‚æœ€é«˜æ¦‚ç‡å¯èƒ½æ˜¯ç­”æ¡ˆä»¤ç‰Œçš„ softmax æ¦‚ç‡ï¼Œæˆ–ç­”æ¡ˆä»¤ç‰Œçš„å¯¹æ•°æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;35-least-to-most-ltm-ä»å°‘åˆ°å¤š&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#35-least-to-most-ltm-ä»å°‘åˆ°å¤š&#34;&gt;#&lt;/a&gt; 3.5 Least to Most ï¼ˆLtM, ä»å°‘åˆ°å¤šï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒä»æœ€å°‘åˆ°æœ€å¤šæç¤º (LtM) 1 ä½¿ CoT æç¤ºæ›´è¿›ä¸€æ­¥ï¼Œé¦–å…ˆå°†é—®é¢˜åˆ†è§£ä¸ºå­é—®é¢˜ï¼Œç„¶åè§£å†³æ¯ä¸ªé—®é¢˜ã€‚è¿™æ˜¯ä¸€ç§å—ç°å®ä¸–ç•Œå„¿ç«¥æ•™è‚²ç­–ç•¥å¯å‘çš„æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸ CoT æç¤ºä¸€æ ·ï¼Œè¦è§£å†³çš„é—®é¢˜è¢«åˆ†è§£ä¸ºä¸€ç»„ç›¸äº’æ„å»ºçš„å­é—®é¢˜ã€‚ç¬¬äºŒæ­¥ï¼Œå°†è¿™äº›å­é—®é¢˜ä¸€ä¸€è§£å†³ã€‚ä¸æ€ç»´é“¾ç›¸åï¼Œå…ˆå‰å­é—®é¢˜çš„è§£å†³æ–¹æ¡ˆè¢«è¾“å…¥åˆ°å°è¯•è§£å†³ä¸‹ä¸€ä¸ªé—®é¢˜çš„æç¤ºä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Prompt_engineering/3.5.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;36-self-refine-critique-the-results-è‡ªæˆ‘å®Œå–„è´¨ç–‘ç»“æœ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#36-self-refine-critique-the-results-è‡ªæˆ‘å®Œå–„è´¨ç–‘ç»“æœ&#34;&gt;#&lt;/a&gt; 3.6 Self-refine, critique the results ï¼ˆè‡ªæˆ‘å®Œå–„ï¼Œè´¨ç–‘ç»“æœï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äºç”Ÿæˆå¼äººå·¥æ™ºèƒ½å’Œ LLMsï¼Œä½ ä¸èƒ½ç›¸ä¿¡å…¶è¾“å‡ºã€‚ ä½ éœ€è¦éªŒè¯ä¸€ä¸‹ã€‚ æ¯•ç«Ÿï¼Œ LLMs åªæ˜¯å‘æ‚¨å±•ç¤ºä¸‹ä¸€ä¸ªæœ€æœ‰å¯èƒ½è¯´çš„è¯ï¼Œè€Œä¸æ˜¯æ­£ç¡®çš„å†…å®¹ã€‚ å› æ­¤ï¼Œä¸€ä¸ªå¥½ä¸»æ„æ˜¯è¦æ±‚ LLMs è‡ªæˆ‘æ‰¹è¯„ï¼Œè¿™å¼•å¯¼æˆ‘ä»¬è‡ªæˆ‘å®Œå–„æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå…¶å·¥ä½œåŸç†æ˜¯æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¦æ±‚ LLM è§£å†³é—®é¢˜çš„åˆå§‹æç¤º&lt;/li&gt;
&lt;li&gt;LLM äº§ç”Ÿç­”æ¡ˆ&lt;/li&gt;
&lt;li&gt;è´¨ç–‘ç­”æ¡ˆå¹¶è¦æ±‚äººå·¥æ™ºèƒ½æ”¹è¿›&lt;/li&gt;
&lt;li&gt;LLM å†æ¬¡å›ç­”ï¼Œè¿™æ¬¡è€ƒè™‘äº†è´¨ç–‘å¹¶æå‡ºäº†è§£å†³æ–¹æ¡ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒæ‚¨å¯ä»¥æ ¹æ®éœ€è¦å¤šæ¬¡é‡å¤æ­¤è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;37-maieutic-prompting-å¤šç»´åº¦çš„æç¤º&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#37-maieutic-prompting-å¤šç»´åº¦çš„æç¤º&#34;&gt;#&lt;/a&gt; 3.7 Maieutic prompting ï¼ˆå¤šç»´åº¦çš„æç¤ºï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒå¤šç»´åº¦çš„æç¤ºæ˜¯ä¸€ç§ç±»ä¼¼äºè‡ªæˆ‘å®Œå–„çš„æŠ€æœ¯ï¼Œä½†å®ƒæ›´å¤šçš„æ˜¯è¦æ±‚ LLMs è§£é‡Šè‡ªå·±ã€‚ ç›®æ ‡æ˜¯å‡å°‘ LLMs è¾“å‡ºä¸ä¸€è‡´ï¼Œä»¥ç¡®ä¿å¾—å‡ºæ­£ç¡®çš„ç­”æ¡ˆã€‚ è¦éµå¾ªçš„å·¥ä½œæµç¨‹æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¯· LLM å›ç­”é—®é¢˜&lt;/li&gt;
&lt;li&gt;å¯¹äºç­”æ¡ˆçš„æ¯ä¸€éƒ¨åˆ†ï¼Œè¯· LLM æ›´æ·±å…¥åœ°è§£é‡Šã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå­˜åœ¨ä¸ä¸€è‡´ï¼Œåˆ™ä¸¢å¼ƒä¸ä¸€è‡´çš„éƒ¨åˆ†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒé‡å¤ 2 å’Œ 3ï¼Œç›´åˆ°æ‚¨å®Œæˆæ‰€æœ‰éƒ¨åˆ†å¹¶å¯¹ç­”æ¡ˆæ„Ÿåˆ°æ»¡æ„ä¸ºæ­¢ã€‚&lt;/p&gt;
&lt;h1 id=&#34;å››-æç¤ºçš„å…³é”®è¦ç´ &#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å››-æç¤ºçš„å…³é”®è¦ç´ &#34;&gt;#&lt;/a&gt; å››ã€æç¤ºçš„å…³é”®è¦ç´ &lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ä¹‹å‰çš„é¡µé¢ä¸­ï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºäº†å‡ ç§ä¸åŒçš„æç¤ºç­–ç•¥ã€‚æœ¬é¡µå°†æä¾›ä¸€èˆ¬å»ºè®®ï¼Œè¿™äº›å»ºè®®å¯¹äºæç¤ºçš„å®é™…ç¼–å†™å¾ˆé‡è¦&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰åŸºæœ¬äº‹å®çš„é‡è¦æ€§ä¸å¤§&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œåœ¨æç¤ºä¸­æä¾›å°‘é‡ exemplars æ—¶ï¼Œå®é™…ç­”æ¡ˆ (gold) å¹¶ä¸é‡è¦ã€‚å³ä½¿åœ¨æ ·æœ¬ä¸­æä¾›éšæœºæ ‡ç­¾ï¼Œæ€§èƒ½ä¹Ÿå‡ ä¹ä¸å—å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰æ ‡ç­¾ç©ºé—´å¾ˆé‡è¦&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå°½ç®¡æ ·æœ¬ä¸­çš„é»„é‡‘æ ‡ç­¾å¹¶ä¸é‡è¦ï¼Œä½† labelspace å¾ˆé‡è¦ã€‚å³ä½¿ä»æ ‡ç­¾ç©ºé—´ä¸­æä¾›éšæœºæ ‡ç­¾ï¼Œä¹Ÿæœ‰åŠ©äºå¤§è¯­è¨€æ¨¡å‹æ›´å¥½åœ°ç†è§£æ ‡ç­¾ç©ºé—´å¹¶æé«˜ç»“æœã€‚æ­¤å¤–ï¼Œæ­£ç¡®åœ°åœ¨ç¤ºä¾‹ä¸­è¡¨ç¤ºæ ‡ç­¾ç©ºé—´çš„åˆ†å¸ƒå¾ˆé‡è¦ã€‚ä¸åœ¨ç¤ºä¾‹ä¸­ä»æ ‡ç­¾ç©ºé—´ä¸­å‡åŒ€é‡‡æ ·ä¸åŒï¼Œæœ€å¥½æŒ‰ç…§æ ‡ç­¾çš„çœŸå®åˆ†å¸ƒè¿›è¡Œé‡‡æ ·ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ3ï¼‰æ ¼å¼å¾ˆé‡è¦&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ ·æœ¬çš„æ ¼å¼æˆ–è®¸æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå› ä¸ºå®ƒæŒ‡ç¤ºå¤§è¯­è¨€æ ¼å¼å¦‚ä½•æ­£ç¡®åœ°æ ¼å¼åŒ–å…¶å¯¹æç¤ºçš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¾‹å¦‚ï¼Œè¯·è€ƒè™‘ä»¥ä¸‹æ ·æœ¬ã€‚å®ƒä»¬ä½¿ç”¨å…¨å¤§å†™çš„å•è¯ä½œä¸ºç­”æ¡ˆã€‚å°½ç®¡è¿™äº›ç­”æ¡ˆå®Œå…¨é”™è¯¯ï¼ˆ2+2 ä¸æ˜¯ 50ï¼‰ï¼Œä½† GPT-3 æ­£ç¡®åœ°å›ç­”äº†æœ€åä¸€ä¸ªé—®é¢˜ï¼Œå¹¶æŒ‰ç…§å…¶ä»–æ ·æœ¬çš„æ ¼å¼è¿›è¡Œå›ç­”ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight markdown&#34;&gt;&lt;figcaption data-lang=&#34;markdown&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;2+2ç­‰äºå¤šå°‘ï¼Ÿ &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;äº”å&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;20+5ç­‰äºå¤šå°‘ï¼Ÿ&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;å››åä¸‰&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;12+9ç­‰äºå¤šå°‘ï¼Ÿ&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;äºŒåä¸€&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒä»¥ä¸‹æ˜¯ä¸€äº›å€¼å¾—è€ƒè™‘çš„è‰¯å¥½åšæ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŒ‡å®šä¸Šä¸‹æ–‡ã€‚ ä¸Šä¸‹æ–‡å¾ˆé‡è¦ï¼Œæ‚¨å¯ä»¥æŒ‡å®šçš„é¢†åŸŸã€ä¸»é¢˜ç­‰è¶Šå¤šè¶Šå¥½ã€‚&lt;/li&gt;
&lt;li&gt;é™åˆ¶è¾“å‡ºã€‚ å¦‚æœæ‚¨æƒ³è¦ç‰¹å®šæ•°é‡çš„é¡¹ç›®æˆ–ç‰¹å®šé•¿åº¦ï¼Œè¯·æŒ‡å®šã€‚&lt;/li&gt;
&lt;li&gt;æŒ‡å®šå†…å®¹å’Œæ–¹å¼ã€‚ è¯·è®°ä½æåŠæ‚¨æƒ³è¦ä»€ä¹ˆä»¥åŠæ‚¨æƒ³è¦å¦‚ä½•å®ç°ï¼Œä¾‹å¦‚ â€œåˆ›å»ºä¸€ä¸ªåŒ…å«è·¯ç”±äº§å“å’Œå®¢æˆ·çš„ Python Web APIï¼Œå°†å…¶åˆ†ä¸º 3 ä¸ªæ–‡ä»¶â€ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ¨¡æ¿ã€‚ é€šå¸¸ï¼Œæ‚¨ä¼šå¸Œæœ›ä½¿ç”¨å…¬å¸çš„æ•°æ®æ¥ä¸°å¯Œæç¤ºã€‚ ä½¿ç”¨æ¨¡æ¿æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚ æ¨¡æ¿å¯ä»¥åŒ…å«ç”¨å®é™…æ•°æ®æ›¿æ¢çš„å˜é‡ã€‚&lt;/li&gt;
&lt;li&gt;æ‹¼å†™æ­£ç¡®ã€‚ LLMs å¯èƒ½ä¼šä¸ºæ‚¨æä¾›æ­£ç¡®çš„ç­”æ¡ˆï¼Œä½†å¦‚æœæ‚¨æ‹¼å†™æ­£ç¡®ï¼Œæ‚¨ä¼šå¾—åˆ°æ›´å¥½çš„ç­”æ¡ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äº”-din-sqlå’Œpet-sql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äº”-din-sqlå’Œpet-sql&#34;&gt;#&lt;/a&gt; äº”ã€DIN-SQL å’Œ PET-SQL&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒç”¨äºå‚èµ›ã€Šä¸­å…´æ§æœˆå¤§èµ› - ç²¾è¨€å¦™å–»ã€‹ï¼Œä¸»è¦å‚è€ƒè®ºæ–‡æœ‰ DIN-SQLï¼šã€ŠDIN-SQL: Decomposed In-Context Learning of Text-to-SQL with Self-Correctionã€‹ï¼ŒPET-SQLï¼šã€ŠPET-SQL: A Prompt-Enhanced Two-Round Refinement of Text-to-SQL with Cross-consistencyã€‹ã€‚ä¸¤ç¯‡è®ºæ–‡çš„ä¸»è¦æ€è·¯å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Prompt_engineering/5.1.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;å…­-ä¸­å…´æ§æœˆå¤§èµ›-ç²¾è¨€å¦™å–»ä¸ªäººåˆèµ›ä»£ç åŠæ€è·¯&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å…­-ä¸­å…´æ§æœˆå¤§èµ›-ç²¾è¨€å¦™å–»ä¸ªäººåˆèµ›ä»£ç åŠæ€è·¯&#34;&gt;#&lt;/a&gt; å…­ã€ã€Šä¸­å…´æ§æœˆå¤§èµ› - ç²¾è¨€å¦™å–»ã€‹ä¸ªäººåˆèµ›ä»£ç åŠæ€è·¯&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒå…·ä½“æ–‡ä»¶å¯è§ U ç›˜å¤‡ä»½â€“&amp;gt; ç§‘ç ”æ–‡ä»¶â€“&amp;gt;9ã€ç¬¬åå››å±Šä¸­å…´æ§æœˆå…¨çƒç²¾è‹±æŒ‘æˆ˜èµ›ç­‰ã€‚&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/05/16/AI/Transformer/</guid>
            <title>Transformeræ¨¡å‹</title>
            <link>http://qianqiu-cell.github.io/2024/05/16/AI/Transformer/</link>
            <category>AI</category>
            <pubDate>Thu, 16 May 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;&lt;img data-src=&#34;/images/AI/Transformer/0.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93YXlsYW5kemhhbmcuZ2l0aHViLmlvL2VuL3RyYW5zZm9ybWVyLWFyY2hpdGVjdHVyZS5odG1sIzQtNy1jYWxjdWxhdGUtdi1hdHRlbnRpb24=&#34;&gt;https://waylandzhang.github.io/en/transformer-architecture.html#4-7-calculate-v-attention&lt;/span&gt;ã€&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vMzU0NjYxMTUyNzQ1MzE2MT9zcG1faWRfZnJvbT0zMzMuNzg4LjAuMA==&#34;&gt;https://space.bilibili.com/3546611527453161?spm_id_from=333.788.0.0&lt;/span&gt;ã€&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ubHAuc2Vhcy5oYXJ2YXJkLmVkdS8yMDE4LzA0LzAzL2F0dGVudGlvbi5odG1s&#34;&gt;https://nlp.seas.harvard.edu/2018/04/03/attention.html&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;Transformer&lt;/code&gt;  æ¨¡å‹ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šç¼–ç å™¨å’Œè§£ç å™¨ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä»…ç¼–ç å™¨çš„æ¶æ„ç²¾é€šäºä»æ–‡æœ¬ä¸­æå–ä¿¡æ¯ï¼Œç”¨äºåˆ†ç±»å’Œå›å½’ç­‰ä»»åŠ¡ï¼Œè€Œä»…è§£ç å™¨çš„æ¨¡å‹ä¸“é—¨ç”¨äºç”Ÿæˆæ–‡æœ¬ã€‚ä¾‹å¦‚ï¼Œ&lt;mark&gt;ä¸“æ³¨äºæ–‡æœ¬ç”Ÿæˆçš„ &lt;code&gt;GPT&lt;/code&gt;  å±äºä»…è§£ç å™¨æ¨¡å‹çš„ç±»åˆ«&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;Transformer&lt;/code&gt;  çš„å¤§è‡´è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç³»åˆ—è¾“å…¥å­—ç¬¦ä½œä¸ºè®­ç»ƒæ•°æ®ã€‚è¿™äº›è¾“å…¥è¢«è½¬æ¢æˆçŸ¢é‡åµŒå…¥æ ¼å¼ã€‚&lt;/li&gt;
&lt;li&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½ç½®ç¼–ç æ·»åŠ åˆ°çŸ¢é‡åµŒå…¥ä¸­ï¼Œä»¥æ•è·åºåˆ—ä¸­æ¯ä¸ªå­—ç¬¦çš„ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;éšåï¼Œè¯¥æ¨¡å‹é€šè¿‡ä¸€ç³»åˆ—è®¡ç®—æ“ä½œå¤„ç†è¿™äº›è¾“å…¥åµŒå…¥ï¼Œæœ€ç»ˆä¸ºç»™å®šçš„è¾“å…¥æ–‡æœ¬ç”Ÿæˆå¯èƒ½çš„ä¸‹ä¸€ä¸ªå­—ç¬¦çš„æ¦‚ç‡åˆ†å¸ƒã€‚&lt;/li&gt;
&lt;li&gt;è¯¥æ¨¡å‹æ ¹æ®è®­ç»ƒæ•°æ®é›†ä¸­çš„å®é™…åç»­ç‰¹å¾æ¥è¯„ä¼°é¢„æµ‹ç»“æœï¼Œå¹¶ç›¸åº”åœ°è°ƒæ•´æ¦‚ç‡æˆ– â€œæƒé‡â€ã€‚&lt;/li&gt;
&lt;li&gt;æœ€åï¼Œè¯¥æ¨¡å‹è¿­ä»£åœ°ç»†åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œä¸æ–­æ›´æ–°å…¶å‚æ•°ï¼Œä»¥æé«˜æœªæ¥é¢„æµ‹çš„ç²¾åº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;ä¸€-tokenizer&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-tokenizer&#34;&gt;#&lt;/a&gt; ä¸€ã€Tokenizer&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;Tokenizer&lt;/code&gt;  åˆ†è¯ç®—æ³•æ˜¯ &lt;code&gt;NLP&lt;/code&gt;  å¤§æ¨¡å‹æœ€åŸºç¡€çš„ç»„ä»¶ï¼ŒåŸºäº &lt;code&gt;Tokenizer&lt;/code&gt;  å¯ä»¥&lt;mark&gt;å°†æ–‡æœ¬è½¬æ¢æˆç‹¬ç«‹çš„ &lt;code&gt;token&lt;/code&gt;  åˆ—è¡¨ï¼Œè¿›è€Œè½¬æ¢æˆè¾“å…¥çš„å‘é‡æˆä¸ºè®¡ç®—æœºå¯ä»¥ç†è§£çš„è¾“å…¥å½¢å¼&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;tiktoken&lt;/code&gt;  æ˜¯ä¸€ç§å¿«é€Ÿ  &lt;code&gt;BPE&lt;/code&gt;  æ ‡è®°å™¨ï¼Œå¯ä¸ &lt;code&gt;OpenAI&lt;/code&gt;  æ¨¡å‹ä¸€èµ·ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;tiktoken&lt;/code&gt;  ä½¿ç”¨æ–¹æ³•ä¸ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; tiktoken&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Using TikToken (Same as GPT3) to tokenize the source text&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;encoding &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tiktoken&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;get_encoding&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;cl100k_base&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# text ä¿å­˜äº† str å˜é‡ç±»å‹çš„æ–‡æœ¬å†…å®¹ --&gt; è¾“å‡ºä¸ºä»¥å•è¯ä¸ºå•ä½çš„ int åˆ—è¡¨&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;tokenized_text &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; encoding&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;encode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;text&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å°† tokenized_text è½¬æ¢ä¸º Tensor.int64 ç±»å‹çš„å¼ é‡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;tokenized_text &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;tensor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dtype&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; device&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒä¸Šè¿°çš„ä»£ç æä¾›äº† &lt;code&gt;encoding&lt;/code&gt;  çš„ç¼–ç è¿‡ç¨‹ï¼ŒåŒæ—¶è¿˜å¯ä»¥æ ¹æ® &lt;code&gt;tokenized&lt;/code&gt;  çš„ç¼–ç ç»“æœè¿›è¡Œè§£ç ï¼Œåªéœ€è¦é€šè¿‡ &lt;code&gt;decode&lt;/code&gt;  å‡½æ•°è¾“å…¥ &lt;code&gt;int&lt;/code&gt;  ç±»å‹çš„åˆ—è¡¨é›†åˆè¿”å›åŸå§‹çš„ str ç±»å‹æ–‡æœ¬&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# è¾“å‡ºå•ä¸ªç¼–ç å¯¹åº”çš„ str æ–‡æœ¬&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;encoding&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;decode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# è¾“å‡ºå¤šä¸ªç¼–ç å¯¹åº”çš„ str æ–‡æœ¬&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;encoding&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;decode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;tolist&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&#34;äºŒ-embedding&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-embedding&#34;&gt;#&lt;/a&gt; äºŒã€Embedding&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;Tokenize&lt;/code&gt;  å®Œçš„ä¸‹ä¸€æ­¥å°±æ˜¯å°† &lt;code&gt;token&lt;/code&gt;  çš„ &lt;code&gt;one-hot&lt;/code&gt;  ç¼–ç è½¬æ¢æˆæ›´ &lt;code&gt;dense&lt;/code&gt;  çš„ &lt;code&gt;embedding&lt;/code&gt;  ç¼–ç ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;Embedding&lt;/code&gt;  çŸ©é˜µçš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªæŸ¥æ‰¾è¡¨ã€‚ç”±äºè¾“å…¥å‘é‡æ˜¯ &lt;code&gt;one-hot&lt;/code&gt;  çš„ï¼Œ &lt;code&gt;embedding&lt;/code&gt;  çŸ©é˜µä¸­æœ‰ä¸”ä»…æœ‰ä¸€è¡Œè¢«æ¿€æ´»ã€‚è¡Œé—´äº’ä¸å¹²æ‰°ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡è®¾è¯æ±‡è¡¨ä¸€å…±æœ‰ &lt;code&gt;6&lt;/code&gt;  ä¸ªè¯ï¼Œåˆ™ &lt;code&gt;one-hot&lt;/code&gt;  è¡¨ç¤ºçš„é•¿åº¦ä¸º &lt;code&gt;6&lt;/code&gt; ã€‚ç°åœ¨æˆ‘ä»¬æœ‰ä¸‰ä¸ªå•è¯ç»„æˆä¸€ä¸ªå¥å­ï¼Œåˆ™è¾“å…¥çŸ©é˜µçš„å½¢çŠ¶ä¸º &lt;code&gt;(3,6)&lt;/code&gt;  ã€‚ç„¶åæˆ‘ä»¬å­¦å‡ºæ¥ä¸€ä¸ª &lt;code&gt;embedding&lt;/code&gt;  çŸ©é˜µï¼Œæ ¹æ®ä¸Šé¢çš„æ¨å¯¼ï¼Œå¦‚æœæˆ‘ä»¬çš„ &lt;code&gt;embedding size&lt;/code&gt; ï¼ˆç¼–ç å‘é‡çš„é•¿åº¦ï¼‰ä¸º &lt;code&gt;4&lt;/code&gt; ï¼Œåˆ™ &lt;code&gt;embedding&lt;/code&gt;  çŸ©é˜µçš„å½¢çŠ¶åº”è¯¥ä¸º &lt;code&gt;(6,4)&lt;/code&gt; ã€‚è¿™æ ·ä¹˜å‡ºæ¥çš„è¾“å‡ºçŸ©é˜µçš„å½¢çŠ¶åº”ä¸º &lt;code&gt;(3,4)&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Transformer/2.1.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äºç¬¬ä¸€ä¸ªå•è¯ &lt;code&gt;I&lt;/code&gt; ï¼Œå‡è®¾å…¶ &lt;code&gt;one-hot&lt;/code&gt;  ç¼–ç ä¸º &lt;code&gt;[0,0,1,0,0,0]&lt;/code&gt; ï¼Œå°†å…¶ä¸ &lt;code&gt;embedding&lt;/code&gt;  çŸ©é˜µç›¸ä¹˜ï¼Œç›¸å½“äºå–å‡º &lt;code&gt;embedding&lt;/code&gt;  çŸ©é˜µçš„ç¬¬ &lt;code&gt;3&lt;/code&gt;  è¡Œï¼ˆ &lt;code&gt;index&lt;/code&gt;  ä¸º &lt;code&gt;2&lt;/code&gt; ï¼‰ã€‚åŒç†ï¼Œå¯¹äºå•è¯ &lt;code&gt;love&lt;/code&gt; ï¼Œç›¸å½“äºå–å‡º &lt;code&gt;embedding&lt;/code&gt;  çŸ©é˜µçš„ç¬¬äºŒè¡Œï¼ˆ &lt;code&gt;index&lt;/code&gt;  ä¸º &lt;code&gt;1&lt;/code&gt; ï¼‰ã€‚å› æ­¤ &lt;code&gt;embedding&lt;/code&gt;  çŸ©é˜µçš„æœ¬è´¨æ˜¯ä¸€ä¸ªæŸ¥æ‰¾è¡¨ï¼Œæ¯ä¸ªå•è¯ä¼šå®šä½è¿™ä¸ªè¡¨ä¸­çš„æŸä¸€è¡Œï¼Œè€Œè¿™ä¸€è¡Œå°±æ˜¯è¿™ä¸ªå•è¯å­¦ä¹ åˆ°çš„åœ¨åµŒå…¥ç©ºé—´çš„è¯­ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé¦–å…ˆå‡†å¤‡æ‰€éœ€è¦çš„æ•°æ®ï¼Œåœ¨ transformer çš„è§£ç å™¨ä¸­ï¼Œéœ€è¦è¾“å…¥ &lt;code&gt;n_batch * context_length * d_model&lt;/code&gt;  ç»´åº¦çš„ &lt;code&gt;Tensor&lt;/code&gt;  æ•°æ®ï¼Œå…¶ä¸­ &lt;code&gt;n_batch&lt;/code&gt;  è¡¨ç¤ºæ‰¹æ¬¡å¤§å°ï¼Œ &lt;code&gt;contex_length&lt;/code&gt;  è¡¨ç¤ºä¸€æ¬¡è¾“å…¥çš„å•æ¬¡æ•°é‡ï¼Œ &lt;code&gt;d_model&lt;/code&gt;  è¡¨ç¤ºç¼–ç å‘é‡çš„é•¿åº¦ã€‚å°† &lt;code&gt;Tokenizer&lt;/code&gt;  ä¸­è·å¾—çš„ &lt;code&gt;tokenized_text&lt;/code&gt;  è¿›è¡Œæ•°æ®é¢„å¤„ç†ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Split train and validation&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;split_idx &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.9&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;train_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;split_idx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;val_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;split_idx&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Get input embedding batch&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train_data&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;idxs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;randint&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;low&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; high&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; context_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;batch_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;x_batch &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;stack&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;idx&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;idx &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; context_length&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; idx &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; idxs&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;y_batch &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;stack&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;idx &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;idx &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; context_length &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; idx &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; idxs&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒä¹‹åä¾¿å¯ä»¥åˆ©ç”¨ &lt;code&gt;torch&lt;/code&gt;  ä¸­çš„ &lt;code&gt;nn.Embedding&lt;/code&gt;  å‡½æ•°æ„é€  &lt;code&gt;Embedding&lt;/code&gt;  å±‚ã€‚å…¶ä¸­ &lt;code&gt;Embedding.weight.data&lt;/code&gt;  æ˜¯ä¸€ä¸ª &lt;code&gt;max_token_value * d_model&lt;/code&gt;  ç»´åº¦çš„ &lt;code&gt;Tensor&lt;/code&gt;  å˜é‡ï¼Œæ˜¯æ¨¡å‹éœ€è¦è®­ç»ƒçš„å‚æ•°ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸Šå›¾ä¸­å¯¹åº”çš„ &lt;code&gt;Embedding&lt;/code&gt;  æŸ¥æ‰¾è¡¨ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# define input embedding table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# è·å– tokenized_text ä¸­çš„æœ€å¤§å€¼ + 1ï¼Œç”¨äºæ„é€  Embedding çš„è¡Œ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;max_token_value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# ä½¿ç”¨ nn.Embedding å‡½æ•°æ„é€  Embedding å±‚&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# `Embedding.weight.data` æ˜¯ä¸€ä¸ª `max_token_value * d_model` ç»´åº¦çš„ `Tensor` å˜é‡&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;token_embedding_lookup_table &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Embedding&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;num_embeddings&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;max_token_value&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; embedding_dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; device&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# é€šè¿‡è¾“å…¥ x_batch æˆ– y_batch å³å¯è·å¾—å¯¹åº”çš„ Embedding ç¼–ç ç»“æœ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# x_batch_embedding å’Œ y_batch_embedding æ˜¯ `n_batch * context_length * d_model` ç»´åº¦çš„ `Tensor` æ•°æ®&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;x_batch_embedding &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; token_embedding_lookup_table&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x_batch&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;y_batch_embedding &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; token_embedding_lookup_table&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;y_batch&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&#34;ä¸‰-position-encoding&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-position-encoding&#34;&gt;#&lt;/a&gt; ä¸‰ã€Position Encoding&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ &lt;code&gt;transformer&lt;/code&gt;  çš„ &lt;code&gt;encoder&lt;/code&gt;  å’Œ &lt;code&gt;decoder&lt;/code&gt;  çš„è¾“å…¥å±‚ä¸­ï¼Œå‡ä½¿ç”¨äº† &lt;code&gt;Positional Encoding&lt;/code&gt; ï¼Œä½¿å¾—æœ€ç»ˆçš„è¾“å…¥æ»¡è¶³ï¼š &lt;code&gt;input = input_embedding + positional_encoding&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;Transformer&lt;/code&gt;  ä½ç½®ç¼–ç çš„å®šä¹‰ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Transformer/3.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå®ç°ä½ç½®ç¼–ç çš„ä»£ç ä¸ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# get positional encoding&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;position_encoding_lookup_table &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;zeros&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;context_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# unsqueeze ç”¨æ¥æ‰©å……ä¸€ä¸ªç»´åº¦ï¼Œä¸ºäº†åé¢çš„é€å…ƒç´ è®¡ç®—æ—¶çš„å¹¿æ’­æœºåˆ¶&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;position &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;arange&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; context_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dtype&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;unsqueeze&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# æ ¹æ®å…¬å¼è®¡ç®—ä½ç½®ç¼–ç &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;div_term &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;exp&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;arange&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;math&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;log&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10000.0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;position_encoding_lookup_table&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sin&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;position &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; div_term&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;position_encoding_lookup_table&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cos&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;position &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; div_term&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# å°† context_length*d_model çš„çŸ©é˜µå¤åˆ¶ n_epoch æ¬¡ï¼Œå½¢æˆ n_epoch*context_length*d_model çš„çŸ©é˜µ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;position_encoding_lookup_table &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; position_encoding_lookup_table&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;unsqueeze&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;expand&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;batch_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒåœ¨è·å¾—ä½ç½®ç¼–ç ä¹‹åå³å¯å°†ä½ç½®ç¼–ç ä¸ &lt;code&gt;Embedding&lt;/code&gt;  è¿›è¡Œç›¸åŠ ï¼Œè·å¾—æœ€ç»ˆè¾“å…¥è‡³ç½‘ç»œçš„è¾“å…¥ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# add positional encoding to the input_embedding&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; x_batch_embedding &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; position_encoding_lookup_table&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;y &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; y_batch_embedding &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; position_encoding_lookup_table&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&#34;å››-transformer-block&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å››-transformer-block&#34;&gt;#&lt;/a&gt; å››ã€Transformer Block&lt;/h1&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Transformer/4.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé€šè¿‡ç¬¬ä¸‰æ­¥ï¼Œæˆ‘ä»¬è·å¾—äº†è¾“å…¥ &lt;code&gt;x&lt;/code&gt; ï¼Œä¸‹ä¸€æ­¥æ˜¯å¼€å§‹å®ç°å¤šå¤´æ³¨æ„åŠ›å—ï¼ˆ &lt;code&gt;Muti-head Attention block&lt;/code&gt; ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;Transformer&lt;/code&gt;  æ¨¡å‹çš„å¼ºå¤§æ¥æºäº &lt;code&gt;self-attention&lt;/code&gt; ï¼Œé€šè¿‡ &lt;code&gt;self-attention&lt;/code&gt; ï¼Œ &lt;code&gt;Transformer&lt;/code&gt;  æ¨¡å‹å¯ä»¥å…³æ³¨åˆ° &lt;code&gt;input&lt;/code&gt;  æ›´åŠ é‡è¦çš„éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;Multi-head attention&lt;/code&gt;  ç”±å‡ ä¸ªå•ç‹¬çš„ &lt;code&gt;heads&lt;/code&gt;  å †å åœ¨ä¸€èµ·ç»„æˆã€‚æ‰€æœ‰ heads éƒ½æ¥æ”¶åˆ°å®Œå…¨ç›¸åŒçš„è¾“å…¥ï¼Œå°½ç®¡å®ƒä»¬åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ä½¿ç”¨äº†è‡ªå·±çš„ç‰¹å®šæƒé‡é›†ã€‚åœ¨å¤„ç†è¾“å…¥ä¹‹åï¼Œæ¥è‡ªæ‰€æœ‰ &lt;code&gt;heads&lt;/code&gt;  çš„è¾“å‡ºè¢«çº§è”ï¼Œç„¶åé€šè¿‡çº¿æ€§å±‚ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ &lt;code&gt;heads&lt;/code&gt;  çš„å·¥ä½œæ–¹å¼æ˜¯é€šè¿‡ä¸‰ä¸ªç‹¬ç‰¹çš„å±‚å¤„ç†ï¼Œå³æŸ¥è¯¢ï¼ˆ &lt;code&gt;Q&lt;/code&gt; ï¼‰ã€é”®ï¼ˆ &lt;code&gt;K&lt;/code&gt; ï¼‰å’Œå€¼ï¼ˆ &lt;code&gt;V&lt;/code&gt; ï¼‰ã€‚ &lt;code&gt;Attention&lt;/code&gt;  çš„è®¡ç®—å…¬å¼å¯ä»¥ä»è®ºæ–‡ã€Š &lt;code&gt;Attention is all you need&lt;/code&gt; ã€‹ä¸­å¾—åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/images/AI/Transformer/4.2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# get Q, K, V&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# æ‰€è°“çš„å¤šå¤´å°±æ˜¯æŠŠ d_model åˆ‡æˆå¤šä»½ï¼Œæ¯ä¸€ä¸ªå¤´é‡Œé¢æœ‰ä¸€éƒ¨åˆ†ç»´åº¦ï¼Œç„¶åå»åšè¿™ä¸€éƒ¨åˆ†çš„è®¡ç®—ï¼Œæœ€åå†æŠŠæ‰€æœ‰çš„è®¡ç®—åˆå¹¶åœ¨ä¸€èµ·&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;head_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; d_model &lt;span class=&#34;token operator&#34;&gt;//&lt;/span&gt; num_heads  &lt;span class=&#34;token comment&#34;&gt;# head size should be divisible by d_model&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# (1) è®¡ç®— Q,K,V çŸ©é˜µ&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;key_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; device&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;query_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; device&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;value_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; device&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# [batch_size, context_length, d_model]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;q &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; query_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;k &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; key_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;v &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; value_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# [batch_size, context_length, num_heads, head_size]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;q &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; q&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;view&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;batch_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; num_heads&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; head_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;k &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; k&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;view&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;batch_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; num_heads&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; head_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;v &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; v&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;view&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;batch_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; num_heads&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; head_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# [batch_size, num_heads, context_length, head_size]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;q &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; q&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transpose&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;k &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; k&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transpose&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;v &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; v&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transpose&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# (2) é€šè¿‡ Q @ K^T /sqrt (d_k) è®¡ç®— Attention&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;attention_score &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;q @ k&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transpose&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1.0&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; math&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sqrt&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;head_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# (3) è®¡ç®— Mask&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;mask &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;triu&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ones&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;context_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; context_length&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; diagonal&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;attention_score &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; attention_score&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;masked_fill&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;mask&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;-inf&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# (4) è®¡ç®— Softmax&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# [batch_size, num_heads, context_length, context_length]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;attention_score &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; F&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;softmax&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;attention_score&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# (5) é€šè¿‡ $V è®¡ç®— A&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# [batch_size, num_heads, context_length, head_size]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;A &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; attention_score @ v&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# (6) è®¡ç®— Concatenate&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# [batch_size, context_length, num_heads, head_size]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;A &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; A&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transpose&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# [batch_size, context_length, d_model]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;A &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; A&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;reshape&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;batch_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# (7) é€šè¿‡ Wo è®¡ç®— Output&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Define the output weight matrix&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Wo &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# [batch_size, context_length, d_model]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; Wo&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;A&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&#34;äº”-residual-connection-and-layer-normalization&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äº”-residual-connection-and-layer-normalization&#34;&gt;#&lt;/a&gt; äº”ã€Residual Connection and Layer Normalization&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒæ®‹å·®è¿æ¥ï¼Œæœ‰æ—¶è¢«ç§°ä¸º &lt;code&gt;skip connection&lt;/code&gt; ï¼Œæ˜¯è®©åŸå§‹è¾“å…¥ &lt;code&gt;X&lt;/code&gt;  ç»•è¿‡ä¸€ä¸ªæˆ–å¤šä¸ªå±‚çš„è¿æ¥ã€‚é€šè¿‡å°†åŸå§‹è¾“å…¥ &lt;code&gt;x&lt;/code&gt;  ä¸æ­¥éª¤å››å¤šå¤´æ³¨æ„åŠ›å±‚çš„è¾“å‡º &lt;code&gt;output&lt;/code&gt;  ç›¸åŠ å³å¯å®Œæˆæ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;output = output + x
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.80952em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.80952em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222222222222222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.43056em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æ®‹å·®è¿æ¥ä¹‹åï¼Œè¿‡ç¨‹è¿›å…¥å±‚å½’ä¸€åŒ–ã€‚å±‚å½’ä¸€åŒ–ï¼ˆ &lt;code&gt;LayerNorm&lt;/code&gt; ï¼‰æ˜¯ä¸€ç§ç”¨äºå¯¹ç½‘ç»œä¸­æ¯ä¸€å±‚çš„è¾“å‡ºè¿›è¡Œå½’ä¸€åŒ–çš„æŠ€æœ¯ã€‚å…¶æ–¹æ³•æ˜¯å‡å»è¾“å‡ºçš„å‡å€¼ï¼Œå¹¶é™¤ä»¥è¾“å‡ºçš„æ ‡å‡†å·®ã€‚ä½¿ç”¨è¿™ç§æŠ€æœ¯æ˜¯ä¸ºäº†é˜²æ­¢æŸä¸€å±‚çš„è¾“å‡ºå˜å¾—è¿‡å¤§æˆ–è¿‡å°ï¼Œä»è€Œé¿å…ç½‘ç»œçš„ä¸ç¨³å®šæ€§ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Add residual connection&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; output &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; X&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Add Layer Normalization&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;layer_norm &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;LayerNorm&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; layer_norm&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;output&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&#34;å…­-feed-forward-network&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å…­-feed-forward-network&#34;&gt;#&lt;/a&gt; å…­ã€Feed-Forward Network&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒä¸€æ—¦æˆ‘ä»¬è·å¾—äº†å½’ä¸€åŒ–çš„æ³¨æ„åŠ›æƒé‡ï¼ˆæ¦‚ç‡åˆ†æ•°ï¼‰ï¼Œå®ƒå°†è¢«ä¼ é€’åˆ°ä¸€ä¸ªä½ç½®çº§å‰é¦ˆç½‘ç»œä¸­è¿›è¡Œå¤„ç†ã€‚å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆ &lt;code&gt;FFN&lt;/code&gt; ï¼‰ç”±ä¸¤ä¸ªçº¿æ€§å±‚å’Œå®ƒä»¬ä¹‹é—´çš„ ReLU æ¿€æ´»å‡½æ•°ç»„æˆã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# update x&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; output&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Define Feed Forward Network&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; d_model &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;output&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ReLU&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;output&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;d_model &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;output&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;output&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; p&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;dropout&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; train&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Add residual connection&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; output &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; x&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Add Layer Normalization&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;layer_norm &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;LayerNorm&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;output &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; layer_norm&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;output&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&#34;ä¸ƒ-repeat-step-4-to-6&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸ƒ-repeat-step-4-to-6&#34;&gt;#&lt;/a&gt; ä¸ƒã€Repeat step 4 to 6&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒä»¥ä¸Šæˆ‘ä»¬å®Œæˆçš„åªæ˜¯ä¸€ä¸ª &lt;code&gt;transformer&lt;/code&gt;  å—ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ä¼šå°†å¤šä¸ª &lt;code&gt;transformer&lt;/code&gt;  å—å †å åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ª &lt;code&gt;transformer&lt;/code&gt;  è§£ç å™¨ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå®é™…ä¸Šï¼Œæˆ‘ä»¬åº”è¯¥å°†ä»£ç å°è£…åˆ°ç±»ä¸­ï¼Œå¹¶ä½¿ç”¨ &lt;code&gt;PyTorch&lt;/code&gt;  çš„ &lt;code&gt;nn.Module&lt;/code&gt;  æ¥æ„å»ºæˆ‘ä»¬çš„ &lt;code&gt;transformer&lt;/code&gt;  è§£ç å™¨ã€‚ä½†ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬åªä½¿ç”¨ä¸€ä¸ªå—ã€‚&lt;/p&gt;
&lt;h1 id=&#34;å…«-output-probabilities&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å…«-output-probabilities&#34;&gt;#&lt;/a&gt; å…«ã€Output Probabilities&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåº”ç”¨æœ€åä¸€ä¸ªçº¿æ€§å±‚æ¥è·å¾—æˆ‘ä»¬çš„ &lt;code&gt;logits&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;logits &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; max_token_value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;output&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;â€ƒâ€ƒæœ€åä¸€æ­¥æ˜¯å¯¹é€»è¾‘å›å½’è¾“å‡ºè¿›è¡Œ &lt;code&gt;softmax&lt;/code&gt;  æ“ä½œï¼Œä»¥è·å¾—æ¯ä¸ª &lt;code&gt;token&lt;/code&gt;  çš„æ¦‚ç‡ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# torch.softmax usually used during inference, during training we use torch.nn.CrossEntropyLoss&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# but for illustration purpose, we&#39;ll use torch.softmax here&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;probabilities &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;softmax&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;logits&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h1 id=&#34;full-working-code&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#full-working-code&#34;&gt;#&lt;/a&gt; Full Working Code&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒå®Œæ•´çš„ä»£ç å¯ä»¥å‚è€ƒ &lt;code&gt;github&lt;/code&gt; : &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3dheWxhbmR6aGFuZy9UcmFuc2Zvcm1lci1mcm9tLXNjcmF0Y2g=&#34;&gt;https://github.com/waylandzhang/Transformer-from-scratch&lt;/span&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight py&#34;&gt;&lt;figcaption data-lang=&#34;Python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; os&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; requests&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; math&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; tiktoken&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; torch&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;nn &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; nn&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;from&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;nn &lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; functional &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; F&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Hyperparameters&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;batch_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# How many batches per training step&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;context_length &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;16&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Length of the token chunk each batch&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;d_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;64&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# The size of our model token embeddings&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;13&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;num_blocks &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;8&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Number of transformer blocks&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;14&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;num_heads &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Number of heads in Multi-head attention&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;15&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;learning_rate &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1e-3&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# 0.001&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;16&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;dropout &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.1&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Dropout rate&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;17&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;max_iters &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;5000&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Total of training iterations &amp;lt;- Change this to smaller number for testing&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;18&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;eval_interval &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;50&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# How often to evaluate&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;19&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;eval_iters &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;20&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Number of iterations to average for evaluation&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;20&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;device &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;cuda&#39;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cuda&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;is_available&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;cpu&#39;&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Use GPU if it&#39;s available.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;21&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;TORCH_SEED &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1337&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;22&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;manual_seed&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;TORCH_SEED&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;23&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;24&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Load training data&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;25&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; os&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;path&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;exists&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;data/sales_textbook.txt&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;26&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    url &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;https://huggingface.co/datasets/goendalf666/sales-textbook_for_convincing_and_selling/raw/main/sales_textbook.txt&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;27&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;data/sales_textbook.txt&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;w&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; f&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;28&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        f&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;write&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;requests&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;get&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;url&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;text&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;29&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;30&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;data/sales_textbook.txt&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;r&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; encoding&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;utf-8&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;as&lt;/span&gt; f&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;31&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    text &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; f&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;read&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;32&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;33&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Using TikToken (Same as GPT3) to tokenize the source text&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;34&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;encoding &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tiktoken&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;get_encoding&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;cl100k_base&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;35&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;tokenized_text &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; encoding&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;encode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;text&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;36&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;max_token_value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# the maximum value of the tokenized numbers&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;37&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;tokenized_text &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;tensor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dtype&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; device&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# put tokenized text into tensor&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;38&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;39&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Split train and validation&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;40&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;split_idx &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0.9&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;41&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;train_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;split_idx&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;42&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;val_data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; tokenized_text&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;split_idx&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;43&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;44&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;45&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Define Feed Forward Network&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;46&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;FeedForward&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Module&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;47&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;48&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token builtin&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__init__&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;49&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; d_model&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;50&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; dropout&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;51&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ffn &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Sequential&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;52&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;53&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ReLU&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;54&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;55&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;dropout&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;56&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;57&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;58&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;59&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ffn&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;60&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;61&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;62&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Define Scaled Dot Product Attention&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;63&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;Attention&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Module&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;64&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; head_size&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;65&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token builtin&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__init__&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;66&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; d_model&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;67&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;head_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; head_size&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;68&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;context_length &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; context_length&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;69&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; dropout&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;70&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;71&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;key_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;head_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;72&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;query_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;head_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;73&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;value_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;head_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; bias&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;74&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;register_buffer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;tril&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;tril&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;75&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ones&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;context_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;context_length&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Lower triangular mask&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;76&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;77&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;78&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;79&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        B&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; T&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; C &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape  &lt;span class=&#34;token comment&#34;&gt;# Batch size, Time steps(current context_length), Channels(dimensions)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;80&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;assert&lt;/span&gt; T &lt;span class=&#34;token operator&#34;&gt;&amp;lt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;context_length&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;81&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;assert&lt;/span&gt; C &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;82&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        q &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;query_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;83&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        k &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;key_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;84&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        v &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;value_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;85&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;86&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# Scaled dot product attention: Q @ K^T / sqrt(d_k)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;87&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        weights &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;q @ k&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transpose&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1.0&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; math&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sqrt&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;k&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;size&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;88&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# Apply masked attention&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;89&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        weights &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; weights&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;masked_fill&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;tril&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;T&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;T&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;-inf&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;90&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        weights &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; F&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;softmax&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;weights&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;91&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        weights &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;weights&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;92&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;93&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# Apply dot product attention: weights @ V&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;94&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        out &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; weights @ v&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;95&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; out&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;96&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;97&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;98&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;MultiHeadAttention&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Module&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;99&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; head_size&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;100&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token builtin&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__init__&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;101&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;num_heads &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; num_heads&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;102&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;head_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; head_size&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;103&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; d_model&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;104&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;context_length &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; context_length&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;105&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; dropout&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;106&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;107&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;heads &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;ModuleList&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;Attention&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;head_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;head_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; _ &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;num_heads&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;108&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;projection_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;109&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Dropout&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;dropout&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;110&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;111&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;112&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        out &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cat&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;h&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; h &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;heads&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;113&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        out &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;projection_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;114&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        out &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;out&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;115&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; out&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;116&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;117&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;118&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;TransformerBlock&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Module&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;119&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;120&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; num_heads&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;121&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token builtin&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__init__&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;122&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; d_model&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;123&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;context_length &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; context_length&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;124&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;head_size &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; d_model &lt;span class=&#34;token operator&#34;&gt;//&lt;/span&gt; num_heads  &lt;span class=&#34;token comment&#34;&gt;# head size should be divisible by d_model&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;125&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;num_heads &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; num_heads&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;126&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; dropout&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;127&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;128&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;multi_head_attention_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; MultiHeadAttention&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;head_size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;head_size&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;129&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;feed_forward_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; FeedForward&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;130&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;layer_norm_1 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;LayerNorm&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;normalized_shape&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;131&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;layer_norm_2 &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;LayerNorm&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;normalized_shape&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;132&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;133&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;134&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# Note: The order of the operations is different from the original Transformer paper&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;135&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# The order here is: LayerNorm -&gt; Multi-head attention -&gt; LayerNorm -&gt; Feed forward&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;136&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; x &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;multi_head_attention_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;layer_norm_1&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Residual connection&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;137&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; x &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;feed_forward_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;layer_norm_2&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;token comment&#34;&gt;# Residual connection&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;138&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; x&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;139&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;140&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;141&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;token class-name&#34;&gt;TransformerLanguageModel&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Module&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;142&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;143&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token builtin&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;__init__&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;144&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; d_model&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;145&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;context_length &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; context_length&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;146&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;num_heads &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; num_heads&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;147&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;num_blocks &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; num_blocks&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;148&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;dropout &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; dropout&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;149&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;max_token_value &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; max_token_value&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;150&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# Set up token embedding look-up table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;151&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;token_embedding_lookup_table &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Embedding&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;num_embeddings&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;max_token_value &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; embedding_dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;152&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;153&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# Run all the transformer blocks&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;154&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# Different from original paper, here we add a final layer norm after all the blocks&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;155&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transformer_blocks &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Sequential&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;156&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;TransformerBlock&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;num_heads&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;num_heads&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; _ &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;num_blocks&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;157&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;                &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;LayerNorm&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;158&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;159&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;language_model_out_linear_layer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; nn&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;Linear&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;in_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; out_features&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;max_token_value&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;160&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;161&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; idx&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; targets&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;162&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        B&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; T &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; idx&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;163&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token triple-quoted-string string&#34;&gt;&#34;&#34;&#34;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;164&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        # Set up position embedding look-up table&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;165&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        # following the same approach as the original Transformer paper (Sine and Cosine functions)&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;166&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &#34;&#34;&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;167&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        position_encoding_lookup_table &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;zeros&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;context_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;168&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        position &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;arange&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;context_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dtype&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;unsqueeze&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;169&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        div_term &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;exp&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;arange&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;math&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;log&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;10000.0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;/&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;d_model&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;170&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        position_encoding_lookup_table&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;sin&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;position &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; div_term&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;171&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        position_encoding_lookup_table&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cos&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;position &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; div_term&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;172&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# change position_encoding_lookup_table from (context_length, d_model) to (T, d_model)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;173&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        position_embedding &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; position_encoding_lookup_table&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;T&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;174&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;token_embedding_lookup_table&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;idx&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; position_embedding&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;175&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;transformer_blocks&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;176&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# The &#34;logits&#34; are the output values of our model before applying softmax&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;177&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        logits &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;language_model_out_linear_layer&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;178&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;179&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; targets &lt;span class=&#34;token keyword&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;180&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            B&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; T&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; C &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; logits&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;shape&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;181&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            logits_reshaped &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; logits&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;view&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;B &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; T&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; C&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;182&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            targets_reshaped &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; targets&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;view&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;B &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; T&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;183&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            loss &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; F&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cross_entropy&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;logits_reshaped&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; target&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;targets_reshaped&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;184&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;185&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            loss &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;186&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; logits&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; loss&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;187&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;188&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;generate&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; idx&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; max_new_tokens&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;189&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token comment&#34;&gt;# idx is (B,T) array of indices in the current context&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;190&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; _ &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;max_new_tokens&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;191&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;# Crop idx to the max size of our positional embeddings table&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;192&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            idx_crop &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; idx&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;self&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;context_length&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;193&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;# Get predictions&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;194&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            logits&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; loss &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; self&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;idx_crop&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;195&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;# Get the last time step from logits where the dimensions of the logits are (B,T,C)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;196&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            logits_last_timestep &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; logits&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;197&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;# Apply softmax to get probabilities&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;198&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            probs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; F&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;softmax&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;logits_last_timestep&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;199&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;# Sample from the probabilities&#39; distribution.&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;200&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            idx_next &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;multinomial&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;probs&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; num_samples&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;201&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            &lt;span class=&#34;token comment&#34;&gt;# Append the sampled indexes idx_next to idx&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;202&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            idx &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;cat&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;idx&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; idx_next&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dim&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;203&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; idx&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;204&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;205&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;206&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Initialize the model&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;207&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; TransformerLanguageModel&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;208&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;model &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;209&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;210&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;211&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Get input embedding batch&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;212&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;get_batch&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;split&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;213&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; train_data &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; split &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;train&#39;&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;else&lt;/span&gt; val_data&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;214&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    idxs &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;randint&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;low&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; high&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; context_length&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; size&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;batch_size&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;215&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;stack&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;idx&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;idx &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; context_length&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; idx &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; idxs&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;216&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    y &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;stack&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;idx &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;idx &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; context_length &lt;span class=&#34;token operator&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; idx &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; idxs&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;to&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;217&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; x&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;218&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;219&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;220&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Calculate loss&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;221&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token decorator annotation punctuation&#34;&gt;@torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;no_grad&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;222&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;token function&#34;&gt;estimate_loss&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;223&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    out &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;224&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;225&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; split &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;train&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;valid&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;226&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        losses &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;zeros&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;eval_iters&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;227&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; k &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;eval_iters&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;228&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            x_batch&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y_batch &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; get_batch&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;split&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;229&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            logits&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; loss &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; model&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x_batch&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; y_batch&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;230&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;            losses&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;k&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; loss&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;231&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        out&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;split&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; losses&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;mean&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;232&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;train&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;233&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;return&lt;/span&gt; out&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;234&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;235&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;236&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Use AdamW optimizer&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;237&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;optimizer &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;optim&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;AdamW&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;params&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;parameters&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; lr&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;learning_rate&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;238&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;tracked_losses &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;239&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;for&lt;/span&gt; step &lt;span class=&#34;token keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;max_iters&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;240&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token keyword&#34;&gt;if&lt;/span&gt; step &lt;span class=&#34;token operator&#34;&gt;%&lt;/span&gt; eval_iters &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;token keyword&#34;&gt;or&lt;/span&gt; step &lt;span class=&#34;token operator&#34;&gt;==&lt;/span&gt; max_iters &lt;span class=&#34;token operator&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;241&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        losses &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; estimate_loss&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;242&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        tracked_losses&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;append&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;losses&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;243&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;        &lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;Step:&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; step&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;Training Loss:&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token builtin&#34;&gt;round&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;losses&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;train&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;Validation Loss:&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;244&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;              &lt;span class=&#34;token builtin&#34;&gt;round&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;losses&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;valid&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;item&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;245&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;246&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    xb&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; yb &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; get_batch&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;train&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;247&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    logits&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; loss &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; model&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;xb&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; yb&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;248&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    optimizer&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;zero_grad&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;set_to_none&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;249&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    loss&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;backward&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;250&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    optimizer&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;step&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;251&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;252&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Save the model state dictionary&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;253&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;save&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;state_dict&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;model-ckpt.pt&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;254&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;255&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;# Generate&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;256&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;257&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;start &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#39;The salesperson&#39;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;258&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;start_ids &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; encoding&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;encode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;start&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;259&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;x &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;tensor&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;start_ids&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; dtype&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;torch&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token builtin&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; device&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;device&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token boolean&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;260&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;y &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; model&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;generate&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;x&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; max_new_tokens&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;261&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;---------------&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;262&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;encoding&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;decode&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;y&lt;span class=&#34;token punctuation&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;tolist&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;263&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#39;---------------&#39;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://qianqiu-cell.github.io/2024/02/01/AI/Neural_networks_classification/</guid>
            <title>ç¥ç»ç½‘ç»œå¤§è‡´åˆ†ç±»</title>
            <link>http://qianqiu-cell.github.io/2024/02/01/AI/Neural_networks_classification/</link>
            <category>AI</category>
            <pubDate>Thu, 01 Feb 2024 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;å‚è€ƒæ–‡ç« ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yNjg3MDk2MTg=&#34;&gt;https://zhuanlan.zhihu.com/p/268709618&lt;/span&gt;&lt;br&gt;
&lt;img data-src=&#34;/images/AI/Neural_networks_classification/0.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸€-mpç¥ç»å…ƒæ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸€-mpç¥ç»å…ƒæ¨¡å‹&#34;&gt;#&lt;/a&gt; ä¸€ã€MP ç¥ç»å…ƒæ¨¡å‹&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒMP æ¨¡å‹æ˜¯é’ˆå¯¹ç”Ÿç‰©ç¥ç»å…ƒçš„ä¸€äº›åŸºæœ¬ç”Ÿç†ç‰¹å¾æ‰€æå‡ºçš„å½¢å¼ç¥ç»å…ƒçš„æ•°å­¦æ¨¡å‹ä¸ç»“æ„ï¼Œå…¶æƒå€¼è¢«è®¤ä¸ºæ˜¯ä¸å¯è°ƒæ•´çš„ã€‚MP ç¥ç»å…ƒæ¨¡å‹æ˜¯å…¶ä»–ç¥ç»ç½‘ç»œçš„åŸºç¡€ã€‚&lt;br&gt;
&lt;img data-src=&#34;/images/AI/Neural_networks_classification/1.1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-å‰é¦ˆç¥ç»ç½‘ç»œfnn&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äºŒ-å‰é¦ˆç¥ç»ç½‘ç»œfnn&#34;&gt;#&lt;/a&gt; äºŒã€å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFNNï¼‰&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒå¯¹äºå‰é¦ˆç½‘ç»œï¼Œæ ¹æ®ç¥ç»å…ƒçš„ä¼ é€’å‡½æ•°ä¸åŒï¼Œä»¥åŠå­¦ä¹ ç®—æ³•å’Œç½‘ç»œç»“æ„ä¸Šçš„åŒºåˆ«ï¼Œå¯ä»¥ç»†åˆ†ç±»æ„ŸçŸ¥å™¨ç½‘ç»œã€çº¿æ€§ç½‘ç»œã€BP ç½‘ç»œã€å¾„å‘åŸºç½‘ç»œåŠ GMDH ç½‘ç»œç­‰ä¸åŒçš„ç½‘ç»œæ¨¡å‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;21-æ„ŸçŸ¥å™¨pla&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21-æ„ŸçŸ¥å™¨pla&#34;&gt;#&lt;/a&gt; 2.1 æ„ŸçŸ¥å™¨ï¼ˆPLAï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒæ„ŸçŸ¥å™¨æ¨¡å‹ï¼ˆPercetron Learning Algorithmï¼Œç®€ç§° PLAï¼‰æ˜¯ç”±ç¾å›½å­¦è€… F.Rosenblatt äº 1958 å¹´æå‡ºçš„ã€‚å®ƒä¸ MP æ¨¡å‹çš„ä¸åŒä¹‹å¤„æ˜¯å®ƒå‡å®šç¥ç»å…ƒçš„çªè§¦æƒå€¼æ˜¯å¯å˜çš„ï¼Œè¿™æ ·å°±å¯ä»¥è¿›è¡Œå­¦ä¹ ã€‚æ„ŸçŸ¥å™¨æ˜¯æœ€ç®€å•å½¢å¼çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼Œæ˜¯ä¸€ç§äºŒå…ƒçº¿æ€§åˆ†ç±»å™¨ã€‚&lt;br&gt;
&lt;img data-src=&#34;/images/AI/Neural_networks_classification/1.2.png&#34; alt=&#34;&#34;&gt;&lt;br&gt;
â€ƒâ€ƒæ„ŸçŸ¥å™¨å…·æœ‰å¦‚ä¸‹çš„å±€é™æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ„ŸçŸ¥å™¨ç¥ç»ç½‘ç»œçš„ä¼ è¾“å‡½æ•°ä¸€èˆ¬é‡‡ç”¨é˜ˆå€¼å‡½æ•°ï¼Œæ‰€ä»¥è¾“å‡ºå€¼åªæœ‰ä¸¤ç§ï¼›&lt;/li&gt;
&lt;li&gt;å•å±‚æ„ŸçŸ¥å™¨ç½‘ç»œåªèƒ½ç”¨äºè§£å†³çº¿æ€§å¯åˆ†çš„åˆ†ç±»é—®é¢˜ï¼Œè€Œå¯¹çº¿æ€§ä¸å¯åˆ†çš„åˆ†ç±»é—®é¢˜æ— èƒ½ä¸ºåŠ›ï¼›&lt;/li&gt;
&lt;li&gt;æ„ŸçŸ¥å™¨å­¦ä¹ ç®—æ³•åªé€‚äºå•å±‚æ„ŸçŸ¥å™¨ç½‘ç»œï¼Œæ‰€ä»¥ä¸€èˆ¬æ„ŸçŸ¥å™¨ç½‘ç»œéƒ½æ˜¯å•å±‚çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;22-å¤šå±‚æ„ŸçŸ¥å™¨mlp&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22-å¤šå±‚æ„ŸçŸ¥å™¨mlp&#34;&gt;#&lt;/a&gt; 2.2 å¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆMLPï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒå¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆMultilayer Perceptron, ç®€ç§° MLPï¼‰æ˜¯æ„ŸçŸ¥å™¨çš„æ¨å¹¿ï¼Œå…‹æœäº†æ„ŸçŸ¥å™¨ä¸èƒ½å¯¹çº¿æ€§ä¸å¯åˆ†æ•°æ®è¿›è¡Œè¯†åˆ«çš„å¼±ç‚¹ã€‚å¯¹äºéçº¿æ€§å‡½æ•°çš„æ¨¡æ‹Ÿï¼Œéœ€è¦é‡‡ç”¨ MLPï¼Œå³åœ¨æœ€åˆçš„è¾“å…¥å’Œè¾“å‡ºå±‚ä¹‹é—´éšè—ç€ä¸€åˆ°å¤šä¸ªå±‚ã€‚&lt;br&gt;
â€ƒâ€ƒ&lt;mark&gt;å…¨è¿æ¥ç¥ç»ç½‘ç»œï¼ˆFully Connected Neural Networkï¼Œç®€ç§° FNNï¼‰ï¼Œæ·±åº¦ç¥ç»ç½‘ç»œï¼ˆ Deep Neural Networksï¼Œç®€ç§° DNNï¼‰å’Œ MLP çš„æ¦‚å¿µç›¸ä¼¼ï¼Œåªæ˜¯ä¾§é‡ç‚¹ä¸åŒã€‚ä¸€ä¸ªå¤šå±‚å…¨è¿æ¥ç¥ç»ç½‘ç»œå³ä½¿ MLPï¼Œåˆæ˜¯ FNNï¼ŒåŒæ—¶ä¹Ÿæ˜¯ DNNã€‚&lt;/mark&gt;&lt;br&gt;
â€ƒâ€ƒ&lt;mark&gt;BP ç¥ç»ç½‘ç»œæ˜¯æŒ‡ä½¿ç”¨äº† BP ç®—æ³•ï¼ˆ Back Propagationï¼Œåå‘ä¼ æ’­ï¼‰è¿›è¡Œè®­ç»ƒçš„ MLP æ¨¡å‹ã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;h2 id=&#34;23-å¾„å‘åŸºç¥ç»ç½‘ç»œrbfnn&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23-å¾„å‘åŸºç¥ç»ç½‘ç»œrbfnn&#34;&gt;#&lt;/a&gt; 2.3 å¾„å‘åŸºç¥ç»ç½‘ç»œï¼ˆRBFNNï¼‰&lt;/h2&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDgwMjY3Ni9hcnRpY2xlL2RldGFpbHMvMTAwODA1NTQ1&#34;&gt;https://blog.csdn.net/weixin_40802676/article/details/100805545&lt;/span&gt;&lt;br&gt;
â€ƒâ€ƒé¦–å…ˆä»‹ç»å¾„å‘åŸºå‡½æ•°ï¼ˆ Radial Basis Functionï¼Œç®€ç§° RBFï¼‰ï¼š&lt;br&gt;
&lt;img data-src=&#34;/images/AI/Neural_networks_classification/1.3.png&#34; alt=&#34;&#34;&gt;&lt;br&gt;
â€ƒâ€ƒæœ€å¸¸ç”¨çš„å¾„å‘åŸºå‡½æ•°æ˜¯é«˜æ–¯å‡½æ•°ï¼ˆradbasï¼‰ã€‚&lt;br&gt;
&lt;img data-src=&#34;/images/AI/Neural_networks_classification/1.4.png&#34; alt=&#34;&#34;&gt;&lt;br&gt;
â€ƒâ€ƒRBFNN çš„ç¥ç»ç½‘ç»œèŠ‚åå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ä¸‰å±‚çš„ç¥ç»ç½‘ç»œå°±å¯ä»¥æ‹Ÿåˆä»»ä½•ä¸€ä¸ªå‡½æ•°ï¼ŒRBFNN å³ä¸ºä¸‰å±‚ï¼ˆå•éšå±‚ï¼‰ä¸”éšè—å±‚ä½¿ç”¨å¾„å‘åŸºå‡½æ•°çš„ç¥ç»ç½‘ç»œã€‚å› æ­¤ RBFNN å®Œå…¨å¯ä»¥æ‹Ÿåˆä»»ä½•ä¸€ä¸ªå‡½æ•°ï¼ˆåªè¦éšè—å±‚ç¥ç»å…ƒè¶³å¤Ÿå¤šï¼‰ã€‚è¾“å…¥å±‚åˆ°éšè—å±‚çš„ç¥ç»å…ƒä¹‹é—´çš„æƒé‡å…¨éƒ¨ä¸º 1ã€‚éšè—å±‚æ˜¯ä½¿ç”¨å¾„å‘åŸºå‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°çš„ç¥ç»å…ƒã€‚éšè—å±‚ä¸è¾“å‡ºå±‚ä¹‹é—´å°±æ˜¯æ™®é€šçš„ç¥ç»ç½‘ç»œçš„è¿æ¥å…³ç³»ï¼Œä»–ä»¬ä¹‹é—´çš„æƒé‡å¯ä»¥è®­ç»ƒè€Œæ”¹å˜ã€‚&lt;br&gt;
â€ƒâ€ƒRBFNN çš„å…³é”®å°±åœ¨äºå¾„å‘åŸºå‡½æ•°çš„ç¡®å®šï¼Œä¸­å¿ƒç‚¹åœ¨å“ªï¼Œå¾„åŸºå®½åº¦å¤šå¤§ï¼Œå¤šå°‘ä¸ªå¾„å‘åŸºå‡½æ•°ï¼Œéƒ½æ˜¯ä¼šå½±å“ç¥ç»ç½‘ç»œçš„æ•ˆæœçš„ã€‚å¹¿ä¹‰å›å½’ç¥ç»ç½‘ç»œ (General Regression Neural Networkï¼Œç®€ç§° GRNN) å’Œå¹¿ä¹‰å›å½’ç¥ç»ç½‘ç»œ (General Regression Neural Networkï¼Œç®€ç§° GPNN) éƒ½æ˜¯ RBFNN çš„å˜åŒ–å½¢å¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;24-å·ç§¯ç¥ç»ç½‘ç»œcnn&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#24-å·ç§¯ç¥ç»ç½‘ç»œcnn&#34;&gt;#&lt;/a&gt; 2.4 å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒå·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional Neural Networksï¼Œç®€ç§° CNNï¼‰æ˜¯ä¸€ç§æ·±åº¦å­¦ä¹ æ¨¡å‹æˆ–ç±»ä¼¼äºäººå·¥ç¥ç»ç½‘ç»œçš„å¤šå±‚æ„ŸçŸ¥å™¨ï¼Œå¸¸ç”¨æ¥åˆ†æè§†è§‰å›¾åƒã€‚&lt;br&gt;
&lt;img data-src=&#34;/images/AI/Neural_networks_classification/1.5.png&#34; alt=&#34;&#34;&gt;&lt;br&gt;
â€ƒâ€ƒä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œä¸»è¦ç”±ä»¥ä¸‹ 5 å±‚ç»„æˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®è¾“å…¥å±‚ / Input layer&lt;/li&gt;
&lt;li&gt;å·ç§¯è®¡ç®—å±‚ / CONV layer&lt;/li&gt;
&lt;li&gt;ReLU æ¿€åŠ±å±‚ / ReLU layer&lt;/li&gt;
&lt;li&gt;æ± åŒ–å±‚     / Pooling layer&lt;/li&gt;
&lt;li&gt;å…¨è¿æ¥å±‚   / FC layer&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;25-çº¿æ€§ç¥ç»ç½‘å’¯&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#25-çº¿æ€§ç¥ç»ç½‘å’¯&#34;&gt;#&lt;/a&gt; 2.5 çº¿æ€§ç¥ç»ç½‘å’¯&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒçº¿æ€§ç¥ç»ç½‘ç»œä¸æ„ŸçŸ¥å™¨çš„ä¸»è¦åŒºåˆ«åœ¨äºæ„ŸçŸ¥å™¨çš„æ¿€æ´»å‡½æ•°åªèƒ½è¾“å‡ºä¸¤ç§å¯èƒ½å€¼ï¼ˆ-1 æˆ– 1ï¼‰ï¼Œè€Œçº¿æ€§ç¥ç»ç½‘ç»œçš„è¾“å‡ºå¯ä»¥å–ä»»æ„å€¼ï¼Œå…¶æ¿€æ´»å‡½æ•°æ˜¯çº¿æ€§å‡½æ•°ã€‚&lt;br&gt;
â€ƒâ€ƒçº¿æ€§ç¥ç»ç½‘ç»œé‡‡ç”¨ Widrow-Hoff å­¦ä¹ è§„åˆ™ï¼ˆæœ€å°å‡æ–¹è§„åˆ™ï¼‰ï¼Œå³ LMSï¼ˆLeast Mean Squareï¼‰ç®—æ³•æ¥è°ƒæ•´ç½‘ç»œçš„æƒå€¼å’Œåç½®å€¼ã€‚ç»“æ„å›¾å¦‚ä¸‹ã€‚è¿™é‡Œä½¿ç”¨ purelin æ¿€æ´»å‡½æ•°è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œè¿™æ ·å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ›´å¥½çš„æ•ˆæœã€‚è¾“å‡ºç»“æœçš„æ—¶å€™è¿˜æ˜¯ä½¿ç”¨ sign æ¿€æ´»å‡½æ•°ã€‚&lt;br&gt;
&lt;img data-src=&#34;/images/AI/Neural_networks_classification/1.6.png&#34; alt=&#34;&#34;&gt;&lt;br&gt;
&lt;img data-src=&#34;/images/AI/Neural_networks_classification/1.7.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-åé¦ˆç¥ç»ç½‘ç»œ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‰-åé¦ˆç¥ç»ç½‘ç»œ&#34;&gt;#&lt;/a&gt; ä¸‰ã€åé¦ˆç¥ç»ç½‘ç»œ&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒæ‰€è°“åé¦ˆç½‘ç»œæ˜¯æŒ‡åœ¨ç½‘ç»œä¸­è‡³å°‘å«æœ‰ä¸€ä¸ªåé¦ˆå›è·¯çš„ç¥ç»ç½‘ç»œã€‚åé¦ˆç½‘ç»œå¯ä»¥åŒ…å«ä¸€ä¸ªå•å±‚ç¥ç»å…ƒï¼Œå…¶ä¸­æ¯ä¸ªç¥ç»å…ƒå°†è‡ªèº«çš„è¾“å‡ºä¿¡å·åé¦ˆç»™å…¶ä»–æ‰€æœ‰ç¥ç»å…ƒçš„è¾“å…¥ åé¦ˆç¥ç»ç½‘ç»œä¸­ç¥ç»å…ƒä¸ä½†å¯ä»¥æ¥æ”¶å…¶ä»–ç¥ç»å…ƒçš„ä¿¡å·ï¼Œè€Œä¸”å¯ä»¥æ¥æ”¶è‡ªå·±çš„åé¦ˆä¿¡å·ã€‚å’Œå‰é¦ˆç¥ç»ç½‘ç»œç›¸æ¯”ï¼Œåé¦ˆç¥ç»ç½‘ç»œä¸­çš„ç¥ç»å…ƒå…·æœ‰è®°å¿†åŠŸèƒ½ï¼Œåœ¨ä¸åŒæ—¶åˆ»å…·æœ‰ä¸åŒçš„çŠ¶æ€ã€‚åé¦ˆç¥ç»ç½‘ç»œä¸­çš„ä¿¡æ¯ä¼ æ’­å¯ä»¥æ˜¯å•å‘ä¹Ÿå¯ä»¥æ˜¯åŒå‘ä¼ æ’­ï¼Œå› æ­¤å¯ä»¥ç”¨ä¸€ä¸ªæœ‰å‘å¾ªç¯å›¾æˆ–è€…æ— å‘å›¾æ¥è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;h2 id=&#34;31-å¾ªç¯ç¥ç»ç½‘ç»œrnn&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#31-å¾ªç¯ç¥ç»ç½‘ç»œrnn&#34;&gt;#&lt;/a&gt; 3.1 å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒå¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRecurrent Neural Networkï¼Œç®€ç§° RNNï¼‰æ˜¯ä¸€ç§æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œä¸“é—¨ç”¨äºå¤„ç†åºåˆ—æ•°æ®å’Œå…·æœ‰æ—¶é—´ä¾èµ–æ€§çš„ä»»åŠ¡ã€‚ç›¸æ¯”äºä¼ ç»Ÿç¥ç»ç½‘ç»œï¼ŒRNN å…·æœ‰ä¸€ç§é€’å½’ç»“æ„ï¼Œä½¿å…¶èƒ½å¤Ÿå¯¹åºåˆ—ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚&lt;br&gt;
â€ƒâ€ƒRNN çš„ä¸»è¦ç‰¹ç‚¹æ˜¯å®ƒèƒ½å¤Ÿä¿æŒå¯¹ä¹‹å‰è¾“å…¥ä¿¡æ¯çš„è®°å¿†ï¼Œè¿™ä½¿å¾—å®ƒåœ¨å¤„ç†æ—¶é—´åºåˆ—ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰ä»»åŠ¡æ—¶éå¸¸æœ‰æ•ˆã€‚å®ƒçš„åŸºæœ¬ç»“æ„åŒ…æ‹¬ä¸€ä¸ªéšè—å±‚ï¼Œå…¶ä¸­çš„ç¥ç»å…ƒå¯ä»¥æ¥æ”¶è¾“å…¥æ•°æ®å’Œå‰ä¸€ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ï¼Œå¹¶è¾“å‡ºä¸€ä¸ªæ–°çš„éšè—çŠ¶æ€ã€‚è¿™ç§é€’å½’ç»“æ„ä½¿å¾— RNN èƒ½å¤Ÿæ•æ‰åºåˆ—ä¸­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»è€Œæ›´å¥½åœ°ç†è§£å’Œå¤„ç†åºåˆ—æ•°æ®ã€‚&lt;br&gt;
â€ƒâ€ƒç„¶è€Œï¼Œä¼ ç»Ÿçš„ RNN å­˜åœ¨æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ç­‰é—®é¢˜ï¼Œå¯¼è‡´éš¾ä»¥æ•æ‰é•¿æœŸä¾èµ–å…³ç³»ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œä¸€äº›æ”¹è¿›å‹çš„å¾ªç¯ç¥ç»ç½‘ç»œè¢«æå‡ºï¼Œå¦‚é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œï¼ˆLong Short-Term Memoryï¼Œç®€ç§° LSTMï¼‰å’Œé—¨æ§å¾ªç¯å•å…ƒï¼ˆGated Recurrent Unitï¼Œç®€ç§° GRUï¼‰ã€‚è¿™äº›æ”¹è¿›æ¨¡å‹å¼•å…¥äº†é—¨æ§æœºåˆ¶ï¼Œä½¿å¾—ç½‘ç»œèƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†é•¿æœŸä¾èµ–å…³ç³»ï¼Œä»è€Œæé«˜äº†æ€§èƒ½ã€‚&lt;br&gt;
â€ƒâ€ƒæ€»çš„æ¥è¯´ï¼Œå¾ªç¯ç¥ç»ç½‘ç»œåœ¨å¤„ç†åºåˆ—æ•°æ®æ–¹é¢å…·æœ‰å¹¿æ³›çš„åº”ç”¨ï¼ŒåŒ…æ‹¬è‡ªç„¶è¯­è¨€å¤„ç†ã€è¯­éŸ³è¯†åˆ«ã€æ—¶é—´åºåˆ—é¢„æµ‹ç­‰é¢†åŸŸã€‚&lt;/p&gt;
&lt;h2 id=&#34;32-hopfieldç¥ç»ç½‘ç»œ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#32-hopfieldç¥ç»ç½‘ç»œ&#34;&gt;#&lt;/a&gt; 3.2 Hopfield ç¥ç»ç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒHopfield ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§åé¦ˆå‹çš„äººå·¥ç¥ç»ç½‘ç»œï¼Œæœ€åˆç”±ç‰©ç†å­¦å®¶çº¦ç¿°ãƒ»éœæ™®è²å°”å¾·ï¼ˆJohn Hopfieldï¼‰äº 1982 å¹´æå‡ºã€‚å®ƒä¸»è¦ç”¨äºæ¨¡æ‹Ÿå’Œå¤„ç†ç¦»æ•£å‹åŠ¨åŠ›ç³»ç»Ÿï¼Œå°¤å…¶åœ¨è§£å†³ä¼˜åŒ–é—®é¢˜å’Œæ¨¡å¼è¯†åˆ«æ–¹é¢åº”ç”¨å¹¿æ³›ã€‚æ ¹æ®å…¶æ¿€æ´»å‡½æ•°çš„ä¸åŒï¼ŒHopfield ç¥ç»ç½‘ç»œæœ‰ä¸¤ç§ï¼šç¦»æ•£ Hopfield ç½‘ç»œï¼ˆDiscrete Hopfield Neural Networkï¼Œç®€ç§° DHNNï¼‰å’Œè¿ç»­ Hopfield ç½‘ç»œï¼ˆContinues Hopfield Neural Networkï¼Œç®€ç§° CHNNï¼‰ã€‚&lt;/p&gt;
&lt;h1 id=&#34;å››-å¯¹æŠ—ç¥ç»ç½‘ç»œgan&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å››-å¯¹æŠ—ç¥ç»ç½‘ç»œgan&#34;&gt;#&lt;/a&gt; å››ã€å¯¹æŠ—ç¥ç»ç½‘ç»œï¼ˆGANï¼‰&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒç®€ä»‹ï¼šå¯¹æŠ—ç¥ç»ç½‘ç»œå…¶å®æ˜¯ä¸¤ä¸ªç½‘ç»œçš„ç»„åˆï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç½‘ç»œç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®ï¼Œå¦ä¸€ä¸ªç½‘ç»œåˆ¤æ–­ç”Ÿæˆçš„æ•°æ®æ˜¯çœŸå®çš„è¿˜æ˜¯æ¨¡æ‹Ÿçš„ã€‚ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®çš„ç½‘ç»œè¦ä¸æ–­ä¼˜åŒ–è‡ªå·±è®©åˆ¤åˆ«çš„ç½‘ç»œåˆ¤æ–­ä¸å‡ºæ¥ï¼Œåˆ¤åˆ«çš„ç½‘ç»œä¹Ÿè¦ä¸æ–­ä¼˜åŒ–è‡ªå·±è®©åˆ¤æ–­çš„æ›´åŠ ç²¾ç¡®ã€‚ä¸¤è€…çš„å…³ç³»å½¢æˆå¯¹æŠ—ï¼Œå› æ­¤å«å¯¹æŠ—ç¥ç»ç½‘ç»œã€‚&lt;br&gt;
â€ƒâ€ƒç»“æ„ï¼šGAN ç”± generatorï¼ˆç”Ÿæˆæ¨¡å‹ï¼‰å’Œ discriminatorï¼ˆåˆ¤åˆ«å¼æ¨¡å‹ï¼‰ä¸¤éƒ¨åˆ†æ„æˆã€‚äºŒè€…ç»“åˆä¹‹åï¼Œç»è¿‡å¤§é‡æ¬¡æ•°çš„è¿­ä»£è®­ç»ƒä¼šä½¿ generator å°½å¯èƒ½æ¨¡æ‹Ÿå‡ºä»¥å‡ä¹±çœŸçš„æ ·æœ¬ï¼Œè€Œ discrimator ä¼šæœ‰æ›´ç²¾ç¡®çš„é‰´åˆ«çœŸä¼ªæ•°æ®çš„èƒ½åŠ›ï¼Œæœ€ç»ˆæ•´ä¸ª GAN ä¼šè¾¾åˆ°æ‰€è°“çš„çº³ä»€å‡è¡¡ï¼Œå³ discriminator å¯¹äº generator çš„æ•°æ®é‰´åˆ«ç»“æœä¸ºæ­£ç¡®ç‡å’Œé”™è¯¯ç‡å„å  50%ã€‚&lt;/p&gt;
&lt;h1 id=&#34;äº”-è‡ªç»„ç»‡ç¥ç»ç½‘ç»œ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#äº”-è‡ªç»„ç»‡ç¥ç»ç½‘ç»œ&#34;&gt;#&lt;/a&gt; äº”ã€è‡ªç»„ç»‡ç¥ç»ç½‘ç»œ&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ç”Ÿç‰©ç¥ç»ç³»ç»Ÿä¸­ï¼Œå­˜åœ¨ç€ä¸€ç§ä¾§æŠ‘åˆ¶ç°è±¡ï¼Œå³ä¸€ä¸ªç¥ç»ç»†èƒå…´å¥‹ä»¥åï¼Œä¼šå¯¹å‘¨å›´å…¶ä»–ç¥ç»ç»†èƒäº§ç”ŸæŠ‘åˆ¶ä½œç”¨ã€‚è¿™ç§æŠ‘åˆ¶ä½œç”¨ä¼šä½¿ç¥ç»ç»†èƒä¹‹é—´å‡ºç°ç«äº‰ï¼Œå…¶ç»“æœæ˜¯æŸäº›è·èƒœï¼Œè€Œå¦ä¸€äº›åˆ™å¤±è´¥ã€‚è¡¨ç°å½¢å¼æ˜¯è·èƒœç¥ç»ç»†èƒå…´å¥‹ï¼Œå¤±è´¥ç¥ç»ç»†èƒæŠ‘åˆ¶ã€‚è‡ªç»„ç»‡ï¼ˆç«äº‰å‹ï¼‰ç¥ç»ç½‘ç»œå°±æ˜¯æ¨¡æ‹Ÿä¸Šè¿°ç”Ÿç‰©ç¥ç»ç³»ç»ŸåŠŸèƒ½çš„äººå·¥ç¥ç»ç½‘ç»œã€‚&lt;/p&gt;
&lt;h1 id=&#34;å…­-åé¦ˆç¥ç»ç½‘ç»œ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å…­-åé¦ˆç¥ç»ç½‘ç»œ&#34;&gt;#&lt;/a&gt; å…­ã€åé¦ˆç¥ç»ç½‘ç»œ&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒä¸€èˆ¬çš„ç¥ç»ç½‘ç»œæ¨¡å‹é€šå¸¸å‡å®šç½‘ç»œç»“æ„æ˜¯äº‹å…ˆå›ºå®šçš„ï¼Œè®­ç»ƒçš„ç›®çš„æ˜¯åˆ©ç”¨è®­ç»ƒæ ·æœ¬æ¥ç¡®å®šåˆé€‚çš„è¿æ¥æƒã€é˜™å€¼ç­‰å‚æ•°ã€‚ä¸æ­¤ä¸åŒï¼Œç»“æ„è‡ªé€‚åº”ç½‘ç»œåˆ™å°†ç½‘ç»œç»“æ„ä¹Ÿå½“ä½œå­¦ä¹ çš„ç›®æ ‡ä¹‹ä¸€ï¼Œå¹¶å¸Œæœ›èƒ½åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ‰¾åˆ°æœ€åˆ©åˆæ•°æ®ç‰¹ç‚¹çš„ç½‘ç»œç»“æ„&lt;/p&gt;
&lt;h1 id=&#34;ä¸ƒ-åé¦ˆç¥ç»ç½‘ç»œ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸ƒ-åé¦ˆç¥ç»ç½‘ç»œ&#34;&gt;#&lt;/a&gt; ä¸ƒã€åé¦ˆç¥ç»ç½‘ç»œ&lt;/h1&gt;
&lt;p&gt;â€ƒâ€ƒéšæœºç¥ç»ç½‘ç»œæ˜¯å¯¹ç¥ç»ç½‘ç»œå¼•å…¥éšæœºæœºåˆ¶ï¼Œè®¤ä¸ºç¥ç»å…ƒæ˜¯æŒ‰ç…§æ¦‚ç‡çš„åŸç†è¿›è¡Œå·¥ä½œçš„ï¼Œè¿™å°±æ˜¯è¯´ï¼Œæ¯ä¸ªç¥ç»å…ƒçš„å…´å¥‹æˆ–æŠ‘åˆ¶å…·æœ‰éšæœºæ€§ï¼Œå…¶æ¦‚ç‡å–å†³äºç¥ç»å…ƒçš„è¾“å…¥ã€‚&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
